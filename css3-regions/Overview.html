<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html dir=ltr lang=en>
 <head profile="http://www.w3.org/2006/03/hcard"><meta content="IE=edge"
  http-equiv=X-UA-Compatible>
  <meta content="text/html; charset=utf-8" http-equiv=Content-Type>

  <title>CSS Regions Module</title>
  <link href="http://dev.w3.org/csswg/default.css" rel=stylesheet
  type="text/css">
  <link href="http://www.w3.org/StyleSheets/TR/W3C-ED.css" rel=Stylesheet
  type="text/css">
  <link href=alternate-spec-style.css id=st rel=stylesheet title="additional
  spec styles" type="text/css">
  <script src=style-toggle.js type="text/javascript">
</script>
  <script defer src="http://test.csswg.org/harness/annotate.js#css3-regions"
  type="text/javascript">
</script>

 <body>
  <div class=head id=div-head> <!--begin-logo-->
   <p><a href="http://www.w3.org/"><img alt=W3C height=48
    src="http://www.w3.org/Icons/w3c_home" width=72></a> <!--end-logo--></p>

   <h1 id=css-regions-module>CSS Regions Module</h1>

   <h2 class="no-num no-toc" id=longstatus-date>Editor's Draft 29 May 2011</h2>

   <dl>
    <dt>This version:

    <dd><a
     href="http://www.w3.org/TR/2011/ED-css3-regions-20110529/">http://www.w3.org/csswg/css3-regions</a>

    <dt>Latest version:

    <dd><a
     href="http://www.w3.org/TR/css3-regions">http://www.w3.org/csswg/css3-regions</a>

    <dt>Previous version:

    <dd>none

    <dt>Editors:

    <dd class=vcard><span class=fn>Vincent Hardy</span>, <span
     class=org>Adobe Systems, Inc.</span>, <span
     class=email>vhardy@adobe.com</span>

    <dt>Authors and Former Editors:

    <dd class=vcard><span class=fn>Stephen Zilles</span>, <span
     class=org>Adobe Systems, Inc.</span>, <span
     class=email>szilles@adobe.com</span>

    <dd class=vcard><span class=fn>Alexandru Chiculita</span>, <span
     class=org>Adobe Systems, Inc.</span>, <span
     class=email>achicu@adobe.com</span>

    <dd class=vcard><span class=fn>Andrei Bucur</span>, <span class=org>Adobe
     Systems, Inc.</span>, <span class=email>abucur@adobe.com</span>

    <dd class=vcard><span class=fn>Mihnea Ovidenie</span>, <span
     class=org>Adobe Systems, Inc.</span>, <span
     class=email>mihnea@adobe.com</span>

    <dd class=vcard><span class=fn>Peter Sorotokin</span>, <span
     class=org>Adobe Systems, Inc.</span>, <span
     class=email>psorotok@adobe.com</span>

    <dd class=vcard><span class=fn>Virgil Palanciuc</span>, <span
     class=org>Adobe Systems, Inc.</span>, <span
     class=email>virgilp@adobe.com</span>

    <dd class=vcard><span class=fn>Arno Gourdol</span>, <span class=org>Adobe
     Systems, Inc.</span>, <span class=email>agourdol@adobe.com</span>
   </dl>
   <!--begin-copyright-->
   <p class=copyright><a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright"
    rel=license>Copyright</a> &copy; 2011 <a
    href="http://www.w3.org/"><acronym title="World Wide Web
    Consortium">W3C</acronym></a><sup>&reg;</sup> (<a
    href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute
    of Technology">MIT</acronym></a>, <a href="http://www.ercim.eu/"><acronym
    title="European Research Consortium for Informatics and
    Mathematics">ERCIM</acronym></a>, <a
    href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a>
    and <a
    href="http://www.w3.org/Consortium/Legal/copyright-documents">document
    use</a> rules apply.</p>
   <!--end-copyright-->
   <hr title="Separator for header">
  </div>

  <h2 class="no-num no-toc" id=abstract>Abstract</h2>

  <p>The CSS Regions module allows content to flow across multiple areas
   called regions. The regions do not necessarily follow the document order.
   The CSS Regions module provides an advanced content flow mechanism, which
   can be combined with positioning schemes as defined by other CSS modules
   such as the Multi-Column Module <a href="#CSS3COL"
   rel=biblioentry>[CSS3COL]<!--{{CSS3COL}}--></a> or the Grid Layout Module
   <a href="#CSS3-GRID-LAYOUT"
   rel=biblioentry>[CSS3-GRID-LAYOUT]<!--{{CSS3-GRID-LAYOUT}}--></a> to
   position the regions where content flows.

  <h2 class="no-num no-toc" id=status-of-this-document>Status of this
   document</h2>
  <!--begin-status-->

  <p>This is a public copy of the editors' draft. It is provided for
   discussion only and may change at any moment. Its publication here does
   not imply endorsement of its contents by W3C. Don't cite this document
   other than as work in progress.

  <p>The (<a
   href="http://lists.w3.org/Archives/Public/www-style/">archived</a>) public
   mailing list <a
   href="mailto:www-style@w3.org?Subject=%5Bcss3-regions%5D%20PUT%20SUBJECT%20HERE">
   www-style@w3.org</a> (see <a
   href="http://www.w3.org/Mail/Request">instructions</a>) is preferred for
   discussion of this specification. When sending e-mail, please put the text
   &#8220;css3-regions&#8221; in the subject, preferably like this:
   &#8220;[<!---->css3-regions<!---->] <em>&hellip;summary of
   comment&hellip;</em>&#8221;

  <p>This document was produced by the <a href="/Style/CSS/members">CSS
   Working Group</a> (part of the <a href="/Style/">Style Activity</a>).

  <p>This document was produced by a group operating under the <a
   href="/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent
   Policy</a>. W3C maintains a <a href="/2004/01/pp-impl/32061/status"
   rel=disclosure>public list of any patent disclosures</a> made in
   connection with the deliverables of the group; that page also includes
   instructions for disclosing a patent. An individual who has actual
   knowledge of a patent which the individual believes contains <a
   href="/Consortium/Patent-Policy-20040205/#def-essential">Essential
   Claim(s)</a> must disclose the information in accordance with <a
   href="/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the
   W3C Patent Policy</a>.</p>
  <!--end-status-->

  <h2 class="no-num no-toc" id=table-of-contents>Table of contents</h2>
  <!--begin-toc-->

  <ul class=toc>
   <li><a href="#introduction"><span class=secno>1. </span>Introduction</a>
    <ul class=toc>
     <li><a href="#named-flows-and-regions"><span class=secno>1.1.
      </span>Named flows and regions</a>

     <li><a href="#region-styling"><span class=secno>1.2. </span>Regions
      Styling</a>
    </ul>

   <li><a href="#css-regions-model"><span class=secno>2. </span>CSS Regions
    Model</a>
    <ul class=toc>
     <li><a href="#named-flows"><span class=secno>2.1. </span>Named flows</a>
      

     <li><a href="#regions"><span class=secno>2.2. </span>Regions</a>

     <li><a href="#flow-breaking-rules"><span class=secno>2.3. </span>Flow
      breaking rules</a>
      <ul class=toc>
       <li><a
        href="#breaking-a-named-flow-and-determining-the-current-flow-region"><span
        class=secno>2.3.1. </span> Breaking a named flow and determining the
        current flow region</a>

       <li><a href="#allowed-region-breaks"><span class=secno>2.3.2.
        </span>Allowed region breaks</a>

       <li><a href="#forced-region-breaks"><span class=secno>2.3.3.
        </span>Forced region breaks</a>

       <li><a href="#best-region-breaks"><span class=secno>2.3.4.
        </span>"Best" region breaks</a>
      </ul>

     <li><a href="#the-visual-formatting-model-and-flows"><span
      class=secno>2.4. </span>The Visual Formatting Model and Flows</a>
      <ul class=toc>
       <li><a href="#normal-flow"><span class=secno>2.4.1. </span>Normal
        flow</a>

       <li><a href="#positioned-flow"><span class=secno>2.4.2.
        </span>Positioned flow</a>

       <li><a href="#column-flow"><span class=secno>2.4.3. </span>Column
        flow</a>

       <li><a href="#generated-flow"><span class=secno>2.4.4.
        </span>Generated flow</a>
      </ul>

     <li><a href="#relation-to-document-events"><span class=secno>2.5.
      </span>Relation to document events</a>
    </ul>

   <li><a href="#properties-and-rules"><span class=secno>3. </span>Properties
    and Rules</a>
    <ul class=toc>
     <li><a href="#the-flow-property"><span class=secno>3.1. </span>The
      &lsquo;<code class=property>flow</code>&rsquo; property</a>

     <li><a href="#the-content-property"><span class=secno>3.2. </span>The
      &lsquo;<code class=property>content</code>&rsquo; property</a>

     <li><a href="#the-content-order-property"><span class=secno>3.3.
      </span>The &lsquo;<code class=property>content-order</code>&rsquo;
      property</a>

     <li><a
      href="#region-flow-break-properties-break-before-break-after-break-inside"><span
      class=secno>3.4. </span>Region flow break properties: &lsquo;<code
      class=property>break-before</code>&rsquo;, &lsquo;<code
      class=property>break-after</code>&rsquo;, &lsquo;<code
      class=property>break-inside</code>&rsquo;</a>

     <li><a href="#the-region-overflow-property"><span class=secno>3.5.
      </span>The region-overflow property</a>

     <li><a href="#the-at-region-style-rule"><span class=secno>3.6.
      </span>The @region rule</a>
    </ul>

   <li><a href="#cssom_view_and_css_regions"><span class=secno>4.
    </span>CSSOM View and CSS Regions</a>
    <ul class=toc>
     <li><a href="#the-namedflow-interface"><span class=secno>4.1. </span>The
      NamedFlow interface</a>

     <li><a href="#extension-to-the-element-interface"><span class=secno>4.2.
      </span>Extension to the Element interface</a>
    </ul>

   <li><a href="#integration-with-other-specifications"><span class=secno>5.
    </span>Integration with other specifications</a>
    <ul class=toc>
     <li><a href="#region-requirements"><span class=secno>5.1. </span>Region
      requirements</a>

     <li><a href="#integration-examples"><span class=secno>5.2.
      </span>Integration Examples</a>
      <ul class=toc>
       <li><a href="#css-grid-layout"><span class=secno>5.2.1. </span>CSS
        Grid Layout</a>

       <li><a href="#css-multi-column-layout"><span class=secno>5.2.2.
        </span>CSS Multi-Column Layout</a>

       <li><a href="#css-visual-formatting"><span class=secno>5.2.3.
        </span>CSS Visual Formatting</a>
      </ul>
    </ul>

   <li><a href="#relation-to-other-specifications"><span class=secno>6.
    </span>Relation to other specifications</a>

   <li><a href="#conformance"><span class=secno>7. </span>Conformance</a>

   <li class=no-num><a href="#acknowledgments">Acknowledgments</a>

   <li class=no-num><a href="#references">References</a>
    <ul class=toc>
     <li class=no-num><a href="#normative-references">Normative
      references</a>

     <li class=no-num><a href="#other-references">Other references</a>
    </ul>

   <li class=no-num><a href="#index">Index</a>

   <li class=no-num><a href="#property-index">Property index</a>
  </ul>
  <!--end-toc-->

  <h2 id=introduction><span class=secno>1. </span>Introduction</h2>

  <p>Capturing the complex layouts of a typical magazine, newspaper, or
   textbook requires capabilities beyond those available in existing CSS
   modules. This is the purpose of the CSS Regions module.

  <p>&nbsp;

  <p>The CSS Regions module can be seen as an extension of the concept of
   multi-column elements. With CSS Multi-column layout <a href="#CSS3COL"
   rel=biblioentry>[CSS3COL]<!--{{CSS3COL}}--></a>, columns share the same
   dimensions and define column boxes organized in rows. Content flows from
   one column to the next.

  <p>&nbsp;

  <p>The multi-column model is an example of flowing content from one area to
   another, where the areas are the multi-column element's column boxes and
   the flow is made of the multi-column element's children.

  <p>&nbsp;

  <p>However, for more complex layouts, content needs to flow from one area
   of the page to the next without limitation of the areas' sizes and
   positions. These arbitrary areas are the target of specific content flows.
   In this document these areas are called regions, and the content flows are
   called named flows. Regions are based on the rectangular geometry of the
   CSS box model. Elements in a named flow are taken out of the normal visual
   formatting and rendered in a chain of regions.

  <h3 id=named-flows-and-regions><span class=secno>1.1. </span>Named flows
   and regions</h3>

  <p>Consider the layout illustrated in figure 1.

  <div class=figure> <img alt="multiple chained regions which should receive
   content from a flow" src="images/regions-intro.svg" width=400>
   <p class=caption>Layout requiring sophisticated content flow</p>
  </div>

  <p>The designer's intent is to position an image in region &lsquo;<code
   class=property>A</code>&rsquo; and to flow an article's text from region
   &lsquo;<code class=css>1</code>&rsquo;, to region &lsquo;<code
   class=css>2</code>&rsquo;, &lsquo;<code class=css>3</code>&rsquo; and
   &lsquo;<code class=css>4</code>&rsquo;.

  <p>The following code snippet shows the content to flow between the regions
   1, 2, 3 and 4.

  <pre>
&lt;div <em>id="article"</em>&gt;
&lt;h1&gt;Introduction&lt;/h1&gt;
    &lt;p&gt;This is an example ...&lt;/p&gt;
    
&lt;h1&gt;More Details&lt;/h1&gt;
    &lt;p&gt;This illustrates ...&lt;/p&gt;
    &lt;p&gt;Then, the example ...&lt;/p&gt;
    &lt;p&gt;Finally, this ...&lt;/p&gt;
&lt;/div&gt;
        
</pre>

  <p>CSS layout facilities can position and size regions as needed. However,
   there is no existing mechanism to associate the content with the regions
   so that content flows as intended. Figure 2 shows an example of the
   intended visual rendering of the content.

  <div class=figure> <img alt="Sample rendering showing a single thread of
   text flowing through a chain of regions"
   src="images/regions-intro-rendering.png" width=450>
   <p class=caption>Sample rendering for desired layout</p>
  </div>

  <p>Since the CSS Regions module is independent of the layout of regions and
   the mechanism used to create them, the following assumes there is a CSS
   selector for the regions and, for the purpose of the example, the
   selectors for regions 1, 2, 3 and 4 show as &lsquo;<code
   class=css>&lt;region1_sel&gt;</code>&rsquo;, &lsquo;<code
   class=css>&lt;region2_sel&gt;</code>&rsquo;, &lsquo;<code
   class=css>&lt;region3_sel&gt;</code>&rsquo; and &lsquo;<code
   class=css>&lt;region4_sel&gt;</code>&rsquo; respectively. Such a selector
   could be an id selector (e.g., &lsquo;<code
   class=css>#region_1</code>&rsquo;) or a grid cell selector (e.g.,
   &lsquo;<code class=css>#myGrid::grid-cell([cell-name])</code>&rsquo;) if
   using the CSS Grid Layout module, for example.

  <div class=example>
   <pre>
&lt;style&gt;

#article {
    <strong>flow: article_flow;</strong>
}

&lt;region1_sel&gt;, &lt;region2_sel&gt;, 
&lt;region3_sel&gt;, &lt;region4_sel&gt; {
    <strong>content: from-flow(article_flow);</strong>
}
&lt;/style&gt;
</pre>
  </div>

  <p>The above stylesheet directs the &lsquo;<code
   class=css>#article</code>&rsquo; element to a named flow called
   &lsquo;<code class=css>article_flow</code>&rsquo; by setting the &lsquo;<a
   href="#flow2"><code class=property>flow</code></a>&rsquo; property. Then,
   content is "poured" from that named flow into the desired regions by
   setting the regions' &lsquo;<a href="#content-from"><code
   class=property>content</code></a>&rsquo; property to &lsquo;<code
   class=css>from-flow(article_flow)</code>&rsquo;.

  <h3 id=region-styling><span class=secno>1.2. </span>Regions Styling</h3>

  <p>Region styling allows content to be styled depending on the region it
   flows into. It is a form of context-based styling, similar to <a
   href="#CSSMEDIAQUERIES">Media Queries</a> <a href="#MEDIAQ"
   rel=biblioentry>[MEDIAQ]<!--{{MEDIAQ}}--></a> which enable or disable
   selectors depending on the rendering context. With region styling,
   additional selectors may apply depending on the region into which content
   flows.

  <p>In our example, the designer wants to make text flowing into region 1
   larger, bold and dark blue. In addition, <code
   class=html>&lt;h1&gt;</code> headers should be run-ins and crimson.

  <p>This design can be expressed with region styling as shown below.

  <div class=example>
   <pre>
&lt;style&gt;
/*
 * Default article styling.
 */
#article {
    color:#777;
    text-align: justify;
}

#article h1 {
    border-left: 1px solid #777;
    padding-left: 2ex;
}

/*
 * Additional styling to apply to content when it falls into 
 * region_1
 */
<strong>@region &lt;region1_sel&gt; {</strong>
    #article::region-lines {
        font-weight: bold;
        color: #0C3D5F;
        font-size: larger;
    }

    #article h1 {
        color: crimson;
        display: run-in;
        border: none;
        padding: 0px;
    }
<strong>}</strong>
&lt;/style&gt;
</pre>
  </div>

  <p>The &lsquo;<code class=css>@region</code>&rsquo; rule for region 1
   limits its selectors to content flowing into region 1. The following
   figure shows how the rendering changes if we do not increase the font size
   nor make it bold for content flowing into region 1. As more content can be
   fitted, more content is subject to the contextual selectors, resulting in
   more dark blue text into region 1.

  <p>The &lsquo;<code class=css>::region-lines</code>&rsquo; pseudo-element
   is described later in this specification.

  <div class=figure> <img alt="Illustrate how changing region styling affects
   the flow of content." src="images/region-styling.png" width=450>
   <p class=caption>Different rendering with a different region styling</p>
  </div>

  <h2 id=css-regions-model><span class=secno>2. </span>CSS Regions Model</h2>

  <h3 id=named-flows><span class=secno>2.1. </span>Named flows</h3>

  <p>In the <a href="http://www.w3.org/TR/CSS21/visuren.html">CSS formatting
   model</a>, elements can be in the <a href="#normal-flow-def"><em>normal
   flow</em></a> or out of the <a href="#normal-flow-def"><em>(normal)
   flow</em></a>. Boxes generated by elements in the normal flow are subject
   to their container box's normal layout scheme. Boxes generated by elements
   out of the normal flow are subject to a different layout scheme. For
   example, absolutely positioned elements are subject to absolute
   positioning into their <a
   href="http://www.w3.org/TR/CSS21/visudet.html#containing-block-details">containing
   block</a>. This can be described by saying that the absolutely positioned
   elements are part of a special flow (called <a href="#positioned-flow0"
   title=positioned-flow>positioned flow</a>) which is subject to a special
   layout by its container box (i.e., its container box positions it into the
   containing block's box).

  <p>&nbsp;

  <p>In both cases, there is a notion of flow containing a sequence of
   elements and there is a notion of <a
   href="http://www.w3.org/Style/Group/css2-src/visuren.html#block-boxes">(block)
   container box</a> into which the elements flow.

  <p>&nbsp;

  <p>The CSS Regions module generalizes the concept of flow by adding the
   concept of a <em>named flow</em>. This module lets authors explicitly
   place elements into a <em>named flow</em>.

  <p>&nbsp;

  <p>With this model, all elements are moved to a flow as part of the visual
   formatting. That flow may be the normal flow, a named flow or a positioned
   flow, for example. A flow gets formatted visually when associated with one
   or several elements' container box(es). When an flow is associated with
   container boxes, the boxes generated by the flow's elements are laid out
   according to the container box's layout scheme and the flow is subject to
   the <a href="#flow-breaking-rules">&lsquo;<code class=css>flow breaking
   rules</code>&rsquo;</a> described below.

  <p>A container's layout scheme is the strategy used by a container to
   position the boxes generated by its children and itself. Examples are the
   normal layout (block and inline formatting) (<a href="#CSS21"
   rel=biblioentry>[CSS21]<!--{{CSS21}}--></a>), table layout (<a
   href="#CSS21" rel=biblioentry>[CSS21]<!--{{CSS21}}--></a>), the
   multi-column layout (<a href="#CSS3COL"
   rel=biblioentry>[CSS3COL]<!--{{CSS3COL}}--></a>) or the grid layout (<a
   href="#CSS3-GRID-LAYOUT"
   rel=biblioentry>[CSS3-GRID-LAYOUT]<!--{{CSS3-GRID-LAYOUT}}--></a>).

  <h3 id=regions><span class=secno>2.2. </span>Regions</h3>

  <p class=index id=region title=region>A region is an element that generates
   a <a href="http://www.w3.org/TR/CSS21/visuren.html#block-boxes">block
   container box</a> and has an associated <em>named flow</em> (see the
   &lsquo;<a href="#content-from"><code
   class=property>content</code></a>&rsquo; property).

  <p>A <span title=region>region</span>&lsquo;<code class=css>s intrinsic
   width is zero.</code>

  <h3 id=flow-breaking-rules><span class=secno>2.3. </span>Flow breaking
   rules</h3>

  <p>Breaking a named flow across multiple regions is similar to breaking a
   document&rsquo;s content across multiple pages. One important difference
   is that page boxes are generated based on the available content whereas
   regions are a predefined set of recipients for the named flow content.

  <h4 id=breaking-a-named-flow-and-determining-the-current-flow-region><span
   class=secno>2.3.1. </span> Breaking a named flow and determining the
   current flow region</h4>

  <p>The &lsquo;<a href="#content-order"><code
   class=property>content-order</code></a>&rsquo; property defines how <span
   title=region>regions</span> are organized in to a <span
   title=region-chain>region chain</span>.

  <p>Each region in turn consumes content from its associated <span
   title=named-flow>named flow</span>. This means that the named flow content
   is positioned in the <dfn id=current-region title=current-region>current
   region</dfn> until a region break occurs, at which point the <a
   href="#current-region" title=current-region>current region</a> becomes the
   next one in the <span title=region-chain>region chain</span>. If there is
   no more <span>region</span> in the region chain and there is still content
   in the flow, the positioning of the remaining content is controlled by the
   &lsquo;<a href="#region-overflow"><code
   class=property>region-overflow</code></a>&rsquo; property on the last
   <span>region</span> in the chain.

  <p>The following sections define where region breaks may happen when
   positioning a named flow across <span title=region>regions</span> in a
   <span title=region-chain>region chain</span>.

  <div class=issue>
   <p>The sections on "Allowed region breaks", "Forced region breaks" and
    ""Best" region breaks" are adapted from the <a href="#CSS21"
    rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a> specification. There is an
    updated version of these paragraphs in <a href="#CSS3PAGE"
    rel=biblioentry>[CSS3PAGE]<!--{{CSS3PAGE}}--></a> as well.</p>

   <p>In addition, the CSS Multi-column Layout Module <a href="#CSS3COL"
    rel=biblioentry>[CSS3COL]<!--{{CSS3COL}}--></a> defines unified breaking
    properties (which this specification extends).</p>

   <p>It seems that we should:</p>

   <ol>
    <li>Define a common set of rules for breaking content that accounts for
     pages, columns and regions.

    <li>Define the properties for breaking content in a single specification
     as well.

    <li>Specify how column, page and region breaks interact.
   </ol>
  </div>

  <h4 id=allowed-region-breaks><span class=secno>2.3.2. </span>Allowed region
   breaks</h4>

  <p>In a named flow, region breaks can occur at the following places:

  <ol>
   <li>In the vertical margin between block-level boxes. When an unforced
    region break occurs here, the <a href="cascade.html#used-value">used
    values</a> of the relevant <a class=noxref
    href="box.html#propdef-margin-top"><span
    class=propinst-margin-top>&lsquo;<code
    class=property>margin-top</code>&rsquo;</span></a> and <a class=noxref
    href="box.html#propdef-margin-bottom"><span
    class=propinst-margin-bottom>&lsquo;<code
    class=property>margin-bottom</code>&rsquo;</span></a> properties are set
    to &lsquo;<code class=css>0</code>&rsquo;. When a forced region break
    occurs here, the used value of the relevant <a class=noxref
    href="box.html#propdef-margin-bottom"><span
    class=propinst-margin-bottom>&lsquo;<code
    class=property>margin-bottom</code>&rsquo;</span></a> property is set to
    &lsquo;<code class=css>0</code>&rsquo;; the relevant <a class=noxref
    href="box.html#propdef-margin-top"><span
    class=propinst-margin-top>&lsquo;<code
    class=property>margin-top</code>&rsquo;</span></a> used value may either
    be set to &lsquo;<code class=css>0</code>&rsquo; or retained.

   <li>Between <a href="visuren.html#line-box">line boxes</a> inside a <a
    href="visuren.html#block-boxes">block container</a> box.

   <li>Between the content edge of a block container box and the outer edges
    of its child content (margin edges of block-level children or line box
    edges for inline-level children) if there is a (non-zero) gap between
    them.
  </ol>

  <p>These breaks are subject to the following rules:

  <ul>
   <li><strong>Rule A:</strong> Breaking at (1) is allowed only if the
    &lsquo;<a href="#break-after"><code
    class=property>break-after</code></a>&rsquo; &lsquo;<a
    href="#break-before"><code class=property>break-before</code></a>&rsquo;
    properties of all the elements generating boxes that meet at this margin
    allow it, which is when at least one of them has the value &lsquo;<code
    class=property>always</code>&rsquo;, &lsquo;<code
    class=property>left</code>&rsquo;, or &lsquo;<code
    class=property>right</code>&rsquo;, or when all of them are &lsquo;<code
    class=property>auto</code>&rsquo;.

   <li><strong>Rule B:</strong> However, if all of them are &lsquo;<code
    class=property>auto</code>&rsquo; and a common ancestor of all the
    elements has a &lsquo;<a href="#break-inside"><code
    class=property>break-inside</code></a>&rsquo; value of &lsquo;<code
    class=property>avoid-region</code>&rsquo;, then breaking here is not
    allowed.

   <li><strong>Rule C:</strong> Breaking at (2) is allowed only if the number
    of <a href="visuren.html#line-box">line boxes</a> between the break and
    the start of the enclosing block box is the value of &lsquo;<code
    class=property>orphans</code>&rsquo; or more, and the number of line
    boxes between the break and the end of the box is the value of
    &lsquo;<code class=property>widows</code>&rsquo; or more.

   <li><strong>Rule D:</strong> In addition, breaking at (2) or (3) is
    allowed only if the &lsquo;<a href="#break-inside"><code
    class=property>break-inside</code></a>&rsquo; property of the element and
    all its ancestors is &lsquo;<code class=property>auto</code>&rsquo;.
  </ul>

  <p>If the above does not provide enough break points to keep content from
   overflowing the region boxes, then rules A, B and D are dropped in order
   to find additional breakpoints.

  <p>If that still does not lead to sufficient break points, rule C is
   dropped as well, to find still more break points.

  <h4 id=forced-region-breaks><span class=secno>2.3.3. </span>Forced region
   breaks</h4>

  <p>A region break <em>must</em> occur at (1) if, among the &lsquo;<a
   href="#break-after"><code class=property>break-after</code></a>&rsquo; and
   &lsquo;<a href="#break-before"><code
   class=property>break-before</code></a>&rsquo; properties of all the
   elements generating boxes that meet at this margin, there is at least one
   with the value &lsquo;<code class=property>always</code>&rsquo;,
   &lsquo;<code class=property>left</code>&rsquo;, or &lsquo;<code
   class=property>right</code>&rsquo;.

  <h4 id=best-region-breaks><span class=secno>2.3.4. </span>"Best" region
   breaks</h4>

  <p>CSS&nbsp;2.1 does <em>not</em> define which of a set of allowed region
   breaks must be used; CSS&nbsp;2.1 does not forbid a user agent from
   breaking at every possible break point, or not to break at all. But
   CSS&nbsp;2.1 does recommend that user agents observe the following
   heuristics (while recognizing that they are sometimes contradictory):

  <ul>
   <li>Break as few times as possible.

   <li>Avoid breaking inside a replaced element.
  </ul>

  <div class=example>
   <p style="display:none">Example(s):</p>

   <p>Suppose, for example, that the style sheet contains &lsquo;<code
    class=css>orphans: 4</code>&rsquo;, &lsquo;<code class=css>widows:
    2</code>&rsquo;, and there are 20 lines (<a
    href="visuren.html#line-box">line boxes</a>) available at the bottom of
    the current region:</p>

   <ul>
    <li>If a paragraph at the end of the current region contains 20 lines or
     fewer, it should be placed on the current region.

    <li>If the paragraph contains 21 or 22 lines, the second part of the
     paragraph must not violate the <a class=noxref
     href="page.html#propdef-widows"><span class=propinst-widows>&lsquo;<code
     class=property>widows</code>&rsquo;</span></a> constraint, and so the
     second part must contain exactly two lines

    <li>If the paragraph contains 23 lines or more, the first part should
     contain 20 lines and the second part the remaining lines.
   </ul>

   <p>Now suppose that <a class=noxref href="page.html#propdef-orphans"><span
    class=propinst-orphans>&lsquo;<code
    class=property>orphans</code>&rsquo;</span></a> is &lsquo;<code
    class=css>10</code>&rsquo;, <a class=noxref
    href="page.html#propdef-widows"><span class=propinst-widows>&lsquo;<code
    class=property>widows</code>&rsquo;</span></a> is &lsquo;<code
    class=css>20</code>&rsquo;, and there are 8 lines available at the bottom
    of the current region:</p>

   <ul>
    <li>If a paragraph at the end of the current region contains 8 lines or
     fewer, it should be placed on the current region.

    <li>If the paragraph contains 9 lines or more, it cannot be split (that
     would violate the orphan constraint), so it should move as a block to
     the next region.
   </ul>
  </div>

  <h3 id=the-visual-formatting-model-and-flows><span class=secno>2.4.
   </span>The Visual Formatting Model and Flows</h3>

  <p>This section describes the flows to which elements formatted according
   to the CSS <a href="http://www.w3.org/TR/CSS21/visuren.html">Visual
   Formatting Model</a> and other layout modules (such as Multi-Column Layout
   <a href="#CSS3COL" rel=biblioentry>[CSS3COL]<!--{{CSS3COL}}--></a>) belong
   to.

  <p>In particular, this section describes the &lsquo;<a
   href="#generated-flow-def"><code class=css>generated
   flow</code></a>&rsquo; where generated content of pseudo-elements is
   placed and several <dfn id=auto-flow title="auto flows">&lsquo;<code
   class=css>auto flows</code>&rsquo;</dfn> where children of content
   elements are automatically placed.

  <h4 id=normal-flow><span class=secno>2.4.1. </span>Normal flow</h4>

  <p>In the CSS formatting model, elements are by default placed in the <dfn
   id=normal-flow-def>normal flow</dfn> of their container. Also by default,
   a container element gets its content from its <a
   href="#normal-flow-def"><em>normal flow</em></a>. This means that by
   default, a container element will visually format its children elements
   and will be the only container associated with its normal flow.

  <p>Note that floats and relatively positioned elements, in this model, are
   part of the same flow of content and flow into the same container but are
   positioned in different ways.

  <p>The <a href="#normal-flow-def"><em>normal flow</em></a> is one of the <a
   href="#auto-flow"><em>auto flows</em></a>.

  <h4 id=positioned-flow><span class=secno>2.4.2. </span>Positioned flow</h4>

  <p>An absolutely positioned element is placed into the <dfn
   id=positioned-flow0 title=positioned-flow>positioned flow</dfn> of its
   container. The container positions this element into its <em>containing
   block</em>.

  <p>If a container has children in the <a href="#normal-flow-def"><em>normal
   flow</em></a> and in the <em>positioned flow</em>, it applies different
   positioning schemes to each flow.

  <p>The <em>positioned flow</em> is one of the <a href="#auto-flow"><em>auto
   flows</em></a>.

  <h4 id=column-flow><span class=secno>2.4.3. </span>Column flow</h4>

  <p>Children of the multi-column element are placed in the element's <dfn
   id=column-flow-def>column flow</dfn>. The column boxes are then implicitly
   associated with the element's &lsquo;<a href="#column-flow-def"><code
   class=css>column flow</code></a>&rsquo;. In this model, multiple regions
   (column boxes) get their content from a single flow (the element's
   &lsquo;<a href="#column-flow-def"><code class=css>column
   flow</code></a>&rsquo;, which is the content of the element).

  <p>The <a href="#column-flow-def"><em>column flow</em></a> is one of the <a
   href="#auto-flow"><em>auto flows</em></a>.

  <div class=issue> Need to add a <dfn id=grid-cell-flow>grid cell flow</dfn>
   section.</div>

  <div class=issue> Need to add examples for the different flow types.</div>

  <h4 id=generated-flow><span class=secno>2.4.4. </span>Generated flow</h4>

  <p>In the CSS formatting model, when the &lsquo;<code
   class=css>::before</code>&rsquo; or &lsquo;<code
   class=css>::after</code>&rsquo; pseudo-elements have their content
   property set to one of &lsquo;<code
   class=css>&lt;string&gt;</code>&rsquo;, &lsquo;<code
   class=css>&lt;uri&gt;</code>&rsquo;, &lsquo;<code
   class=css>&lt;counter&gt;</code>&rsquo;, &lsquo;<code
   class=css>attr(&lt;identifier&gt;)</code>&rsquo;, &lsquo;<code
   class=css>open-quote</code>&rsquo;, &lsquo;<code
   class=css>close-quote</code>&rsquo;, &lsquo;<code
   class=css>no-open-quote</code>&rsquo; or &lsquo;<code
   class=css>no-close-quote</code>&rsquo;, they create a <dfn
   id=generated-flow-def>generated flow</dfn> which they format visually.

  <h3 id=relation-to-document-events><span class=secno>2.5. </span>Relation
   to document events</h3>

  <p>The CSS Region module does not alter in any way the normal processing of
   events in the document tree. In particular, if an event occurs on an
   element that is part of a named flow, the <a
   href="http://www.w3.org/TR/DOM-Level-3-Events/#dom-event-architecture">event's
   bubble and capture phases</a> happen following the document tree order.

  <div class=issue>
   <p>Should we consider having something to be able to add event listeners
    to a region to detect events happening in the range of the flow it
    positions?</p>

   <pre class=code>
&lt;script&gt;
var region = ...; // get DOM reference to region

region.addEventListener('click', function (evt) {
    alert('I was able to capture an event from the flow content!');
}, true /* useCapture */);  
       
region.addEventListener('click', function (evt) {
    alert('I was able to see an event bubble from the flow content!');
}, false /* useCapture */);         
        
</pre>

   <p>Note that this is a complex proposition since it modifies the normal
    bubble and capture event propagation model. However, it seems that it
    would be a worthwhile feature.</p>
  </div>

  <h2 id=properties-and-rules><span class=secno>3. </span>Properties and
   Rules</h2>

  <p>The main CSS Regions module properties are the ‘flow’ and &lsquo;<a
   href="#content-from"><code class=property>content</code></a>&rsquo;
   properties. The ‘flow’ property places an element into a specific
   named flow or lets the <a href=auto-flows>automatic flow assignment</a>
   take place. The ‘content’ property binds a region with a flow. When
   multiple regions are bound to the same flow, the &lsquo;<a
   href="#content-order"><code class=property>content-order</code></a>&rsquo;
   property determines the order in which content flows into the sequence of
   regions. This sequences of regions is called a <dfn id=region-chain>region
   chain</dfn>.

  <p>&nbsp;

  <p>The way in which the content is broken into segments that fit in a
   region can be controlled by the “break” properties. Finally, styling
   that is unique to the region can be specified by ‘region-style’ rules.

  <h3 id=the-flow-property><span class=secno>3.1. </span>The &lsquo;<a
   href="#flow2"><code class=property>flow</code></a>&rsquo; property</h3>

  <p>The ‘flow’ property places an element into a named flow or
   automatically places it in the appropriate flow (see the <a
   href="#formatting-model-considerations">Visual Formatting Model and
   Flows</a> section). Elements that belong to the same flow are laid out in
   the regions associated with that flow.

  <table class=propdef summary="flow property definition">
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=flow2>flow</dfn>

    <tr>
     <th>Value:

     <td>&lt;string&gt;

    <tr>
     <th>Initial:

     <td>auto

    <tr>
     <th>Applies to:

     <td>any element

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&nbsp;value:

     <td>as specified
  </table>

  <dl>
   <dt>auto

   <dd>The element is automatically moved to the appropriate flow according
    to the <a href="#formatting_model_considerations">Visual Formatting Model
    and Flows</a> definitions.

   <dt>&lt;string&gt;

   <dd>The element is placed (appended) to the flow with that name. The
    element is said to have a <dfn id=specified-flow>specified flow</dfn>.
  </dl>

  <div class=issue> Should the &lsquo;<a href="#flow2"><code
   class=property>flow</code></a>&rsquo; property be an identifier and not a
   string?</div>

  <p>A named flow needs to be associated with one or more regions for its
   elements to be visually formatted. If no region is associated with a given
   named flow, the elements in the named flow are not rendered: they do not
   generate boxes and are not displayed.

  <p>The children of an element with a specified flow may themselves have a
   specified flow.

  <p>If an element has a the same specified flow value as one of its
   ancestors, it is moved out of its parent's normal flow and becomes a
   sibling of it's ancestor for the purpose of layout in the regions taking
   content from this flow.

  <p>The &lsquo;<a href="#flow2"><code class=property>flow</code></a>&rsquo;
   property does not affect the CSS cascade and inheritance for the elements
   on which it is specified. The flow property affects the visual formatting
   of elements associated to a named flow and of regions getting their
   content from a named flow.

  <p>The containing block for absolutely positioned descendants of an element
   with a specified flow is the region into which the element is rendered.

  <p>All the elements participating inside a named flow are rendered as
   children of an anonymous block that spans across all the regions
   associated with the specified named flow. The elements flowed inside the
   same named flow are taken in document order.

  <p><span title=region>Regions</span> create a new stacking context, but
   inherit the floats that are already defined by the parent context.

  <div class=example>
   <p>In the following example, the inline content coming from the <a
    href="#content-from"><code class=html>content</code></a> <span
    title=named-flow>named flow</span> wraps around the <code
    class=html>#float</code> box.</p>

   <pre>
&lt;style&gt;
#float {
    float: left;
    width: 100px;
    height: 300px;
}

#region1, #region2 {
    width: 200px;
    height: 200px;
    content: from-flow(body_text);
}

#content {
    flow: body_text;
}
&lt;/style&gt;

&lt;div id="float"&gt;&lt;/div&gt;

&lt;div id="region1"&gt;&lt;/div&gt;
&lt;div id="region2"&gt;&lt;/div&gt;

&lt;div id="content"&gt;&lt;/div&gt; 
</pre>
  </div>

  <h3 id=the-content-property><span class=secno>3.2. </span>The &lsquo;<a
   href="#content-from"><code class=property>content</code></a>&rsquo;
   property</h3>

  <p>This specification extends the definition of the &lsquo;<a
   href="#content-from"><code class=property>content</code></a>&rsquo;
   property and makes it applicable to all block elements and
   pseudo-elements.

  <table class=propdef summary="content property definition">
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=content-from>content</dfn>

    <tr>
     <th>Value:

     <td>normal | none | from-flow(&lt;string&gt;)| [ &lt;string&gt; |
      &lt;uri&gt; | &lt;counter&gt; | attr(&lt;identifier&gt;) | open-quote |
      close-quote | no-open-quote | no-close-quote ]+ | inherit

    <tr>
     <th>Initial:

     <td>normal

    <tr>
     <th>Applies to:

     <td>non-replaced block elements and the ::before and ::after
      pseudo-elements

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&nbsp;value:

     <td>as specified
  </table>

  <dl>
   <dt><a id=x9 name=x9><span class=index-inst id=none
    title=none><strong>none</strong></span></a>

   <dd>For &lsquo;<code class=css>::before</code>&rsquo; and &lsquo;<code
    class=css>::after</code>&rsquo; pseudo-elements, the pseudo-element is
    not generated. For other elements, the element will not get any content
    for its visual formatting. If the children of the element are not
    directed to a flow referenced by another region, then they are not
    visually formatted. An element with its value set to &lsquo;<code
    class=property>none</code>&rsquo; is said to be <dfn
    id=disconnected>disconnected</dfn>

   <dt><strong>normal</strong>

   <dd>Computes to &lsquo;<code class=property>none</code>&rsquo; for the
    &lsquo;<code class=css>::before</code>&rsquo; and &lsquo;<code
    class=css>::after</code>&rsquo; pseudo-elements. For other elements, the
    element uses the flow assigned to its children following the <a
    href=auto-flows>automatic flow assignment for the Visual Formatting
    Model..</a>

   <dt><strong>&lt;string&gt;</strong>

   <dd>Text content (see the section on <a
    href="syndata.html#strings">strings</a>).

   <dt><strong>&lt;uri&gt;</strong>

   <dd>The value is a URI that designates an external resource (such as an
    image). If the user agent cannot display the resource it must either
    leave it out as if it were not specified or display some indication that
    the resource cannot be displayed.

   <dt><strong>&lt;counter&gt;</strong>

   <dd><a href="syndata.html#counter">Counters</a> may be specified with two
    different functions: &lsquo;<code class=css>counter()</code>&rsquo; or
    &lsquo;<code class=css>counters()</code>&rsquo;. The former has two
    forms: &lsquo;<code class=css>counter(<var>name</var>)</code>&rsquo; or
    &lsquo;<code class=css>counter(<var>name</var>,
    <var>style</var>)</code>&rsquo;. The generated text is the value of the
    innermost counter of the given name in scope at this pseudo-element; it
    is formatted in the indicated <a href="#counter-styles">style</a>
    (&lsquo;<code class=property>decimal</code>&rsquo; by default). The
    latter function also has two forms: &lsquo;<code
    class=css>counters(<var>name</var>, <var>string</var>)</code>&rsquo; or
    &lsquo;<code class=css>counters(<var>name</var>, <var>string</var>,
    <var>style</var>)</code>&rsquo;. The generated text is the value of all
    counters with the given name in scope at this pseudo-element, from
    outermost to innermost separated by the specified string. The counters
    are rendered in the indicated <a href="#counter-styles">style</a>
    (&lsquo;<code class=property>decimal</code>&rsquo; by default). See the
    section on <a href="#counters">automatic counters and numbering</a> for
    more information. The name must not be &lsquo;<code
    class=property>none</code>&rsquo;, &lsquo;<code
    class=property>inherit</code>&rsquo; or &lsquo;<code
    class=property>initial</code>&rsquo;. Such a name causes the declaration
    to be ignored.

   <dt><strong>open-quote</strong> and <strong>close-quote</strong>

   <dd>These values are replaced by the appropriate string from the <a
    class=noxref
    href="http://www.w3.org/TR/CSS21/generate.html#propdef-quotes"><span
    class=propinst-quotes><strong>&lsquo;<code
    class=property>quotes</code>&rsquo;</strong></span></a> property.

   <dt><strong>no-open-quote</strong> and <strong>no-close-quote</strong>

   <dd>Introduces no content, but increments (decrements) the level of
    nesting for quotes.

   <dt><strong>attr(X)</strong>

   <dd>This function returns as a string the value of attribute X for the
    subject of the selector. The string is not parsed by the CSS processor.
    If the subject of the selector does not have an attribute X, an empty
    string is returned. The case-sensitivity of attribute names depends on
    the document language.

   <dt><dfn id=from-flow-name>from-flow(&lt;string&gt;)</dfn>

   <dd>The element will visually format the available elements in the named
    flow with name &lt;string&gt;. If there is no flow with name
    &lt;string&gt;, then the element is disconnected and does not format any
    children visually. Multiple elements may be associated with the same
    named flow. See the &lsquo;<a href="#content-order"><code
    class=property>content-order</code></a>&rsquo; property discussion to
    understand how content segments are associated with different regions.
  </dl>

  <div class=note>
   <p>The &lsquo;<a href="#content-from"><code
    class=property>content</code></a>&rsquo; property applies to block-level
    elements and the &lsquo;<code class=css>::before</code>&rsquo; and
    &lsquo;<code class=css>::after</code>&rsquo; pseudo elements. User agents
    may apply the content property to inline elements. The behavior is
    undefined in that case, but is generally expected to be similar to that
    of inline &lsquo;<code class=css>::before</code>&rsquo; and &lsquo;<code
    class=css>::after</code>&rsquo; pseudo-elements.</p>

   <p>In particular, note that the behavior of a &lsquo;<code
    class=css>::before</code>&rsquo; or &lsquo;<code
    class=css>::after</code>&rsquo; pseudo-element with a &lsquo;<code
    class=property>display</code>&rsquo; value that makes it an inline
    element combined with a &lsquo;<a href="#content-from"><code
    class=property>content</code></a>&rsquo; value set to &lsquo;<code
    class=css>from-flow(&lt;name&gt;)</code>&rsquo; is undefined.</p>
  </div>

  <div class=issue>
   <p>Should we consider adding the ability to do the following:</p>

   <ul>
    <li>Support repeatable content. For example, have a repeatable heading at
     the start of each region where content flows.

    <li>Support flow breaking marks. It might be very useful to support a
     <em>mark</em> (such as "<code class=html>...</code>") at the region
     breaking points to indicate that content has been broken out and is
     continuing on a different region.</li>
    <!--
            <li>Support "atomic pull-outs". For example, we could have a named
            flow made of a set of atomic quotes that should be placed, one by
            one, in discrete regions. In that use case, we would need a
            property to specify that content should be taken atomically from
            the flow. May be something like the following.
                <pre class="code">
&lt;div id="quote_1" class="quote"&gt;...&lt;/div&gt;
...
&lt;div id="quote_n" class="quote"&gt;...&lt;/div&gt;

&lt;div id="pull-out-1" class="pull-out"&gt;&lt;/div&gt;
...
&lt;div id="pull-out-n" class="pull-out"&gt;&lt;/div&gt;

&lt;style&gt;
.quote {
    flow: "quotes";
}

.pull-out {
    content: from-flow(quotes);
    content-consume: atomic;
}
&lt;/style&gt;
                    
</pre>
            </li>
            -->
   </ul>
  </div>

  <div class=issue>
   <p><a
    href="http://lists.w3.org/Archives/Public/www-style/2011May/0521.html">Mailing
    list comment</a></p>

   <p>&lsquo;<code class=css>content: from-flow(&lt;name&gt;)</code>&rsquo;
    moves an element to a named flow. Should we allow the content to be
    copied to a flow instead of moved to a flow. For example:</p>

   <div class=code> #quote_A { flow: "quotes"; content: contents; }</div>

   <p>would keep &lsquo;<code class=css>#quote_A</code>&rsquo; in the normal
    flow but also copy its content to the &lsquo;<code
    class=css>quotes</code>&rsquo; flow. This essentially clones the node and
    raises questions regarding DOM access, CSSOM View and the computed style.</p>
  </div>

  <h3 id=the-content-order-property><span class=secno>3.3. </span>The
   &lsquo;<a href="#content-order"><code
   class=property>content-order</code></a>&rsquo; property</h3>

  <p>Defines the ordering of the chain of regions into which content flows.
   If region A and region B are in the same chain of regions and the
   ‘content-order’ of region A is lower than that of region B, then
   region A will precede region B in that chain: content will flow into
   region A before it flows into region B.

  <table class=propdef summary="content-order property definition">
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=content-order>content-order</dfn>

    <tr>
     <th>Value:

     <td>&lt;float&gt;

    <tr>
     <th>Initial:

     <td>0

    <tr>
     <th>Applies to:

     <td>any block container

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed&nbsp;value:

     <td>as specified
  </table>

  <dl>
   <dt>&lt;float&gt;

   <dd>Specifies the region's priority in the chain it belongs to, i.e.., the
    chain of regions associated with the same content flow. Negative values
    are allowed.
  </dl>

  <div class=issue> Should the type of &lsquo;<a href="#content-order"><code
   class=property>content-order</code></a>&rsquo; be &lsquo;<code
   class=css>float</code>&rsquo; or &lsquo;<code
   class=css>integer</code>&rsquo;?</div>

  <p>If two or more regions with the same &lsquo;<code class=css>from-flow(
   &lt;name&gt;)</code>&rsquo; value for their &lsquo;<a
   href="#content-from"><code class=property>content</code></a>&rsquo;
   property, they are first sorted according to their &lsquo;<a
   href="#content-order"><code class=property>content-order</code></a>&rsquo;
   value. If multiple regions in have the same &lsquo;<a
   href="#content-order"><code class=property>content-order</code></a>&rsquo;
   value, they are sorted according to the document order.

  <div class=issue> CSS Modules should define the document order for pseudo
   elements. For example, the [CSSGRID] specification should define the
   document order for the &lsquo;<code class=css>::grid-cell</code>&rsquo;
   pseudo elements (e.g., row-major sorting or column major sorting of
   cells).</div>

  <h3
   id=region-flow-break-properties-break-before-break-after-break-inside><span
   class=secno>3.4. </span>Region flow break properties: &lsquo;<a
   href="#break-before"><code class=property>break-before</code></a>&rsquo;,
   &lsquo;<a href="#break-after"><code
   class=property>break-after</code></a>&rsquo;, &lsquo;<a
   href="#break-inside"><code class=property>break-inside</code></a>&rsquo;</h3>

  <p>When content is laid out in multiple regions, the user agent must
   determine where content breaks occur. The problem of breaking content into
   segments fitting in regions is similar to breaking content into pages or
   columns.

  <p>Each break ends layout in the current region and causes remaining pieces
   of content from the named flow to be visually formatted in the following
   region, in the order defined by the &lsquo;<a href="#content-order"><code
   class=property>content-order</code></a>&rsquo; computed values. Note that
   there is no region break in the last region associated with a named flow.

  <p>The following extends the &lsquo;<a href="#break-before"><code
   class=property>break-before</code></a>&rsquo;, &lsquo;<a
   href="#break-after"><code class=property>break-after</code></a>&rsquo; and
   &lsquo;<a href="#break-inside"><code
   class=property>break-inside</code></a>&rsquo; properties from the <a
   href="#CSS3COL" rel=biblioentry>[CSS3COL]<!--{{!CSS3COL}}--></a>
   specification to account for regions. The additional values are described
   below.

  <table class=propdef summary="break-before property definition">
   <tbody>
    <tr>
     <td><em>Name:</em>

     <td><dfn id=break-before>break-before</dfn>

    <tr>
     <td><em>Value:</em>

     <td>auto | always | avoid | left | right | page | column | region |
      avoid-page | avoid-column | avoid-region

    <tr>
     <td><em>Initial:</em>

     <td>auto

    <tr>
     <td><em>Applies to:</em>

     <td>block-level elements

    <tr>
     <td><em>Inherited:</em>

     <td>no

    <tr>
     <td><em>Percentages:</em>

     <td>N/A

    <tr>
     <td><em>Media:</em>

     <td>paged

    <tr>
     <td><em>Computed&nbsp;value:</em>

     <td>specified value
  </table>

  <table class=propdef summary="break-after property definition">
   <tbody>
    <tr>
     <td><em>Name:</em>

     <td><dfn id=break-after>break-after</dfn>

    <tr>
     <td><em>Value:</em>

     <td>auto | always | avoid | left | right | page | column | region |
      avoid-page | avoid-column | avoid-region

    <tr>
     <td><em>Initial:</em>

     <td>auto

    <tr>
     <td><em>Applies to:</em>

     <td>block-level elements

    <tr>
     <td><em>Inherited:</em>

     <td>no

    <tr>
     <td><em>Percentages:</em>

     <td>N/A

    <tr>
     <td><em>Media:</em>

     <td>paged

    <tr>
     <td><em>Computed&nbsp;value:</em>

     <td>specified value
  </table>

  <table class=propdef summary="break-inside property definition">
   <tbody>
    <tr>
     <td><em>Name:</em>

     <td><dfn id=break-inside>break-inside</dfn>

    <tr>
     <td><em>Value:</em>

     <td>auto | avoid | avoid-page | avoid-column | avoid-region

    <tr>
     <td><em>Initial:</em>

     <td>auto

    <tr>
     <td><em>Applies to:</em>

     <td>block-level elements

    <tr>
     <td><em>Inherited:</em>

     <td>no

    <tr>
     <td><em>Percentages:</em>

     <td>N/A

    <tr>
     <td><em>Media:</em>

     <td>paged

    <tr>
     <td><em>Computed&nbsp;value:</em>

     <td>specified value
  </table>

  <p>These properties describe page, column and region break behavior
   before/after/inside the generated box. These values are normatively
   defined in <a href="#CSS3COL"
   rel=biblioentry>[CSS3COL]<!--{{!CSS3COL}}--></a>:

  <dl>
   <dt>auto

   <dd>Neither force nor forbid a page/column break before (after, inside)
    the generated box.

   <dt>always

   <dd>Always force a page break before (after) the generated box.

   <dt>avoid

   <dd>Avoid a page/column break before (after, inside) the generated box.

   <dt>left

   <dd>Force one or two page breaks before (after) the generated box so that
    the next page is formatted as a left page.

   <dt>right

   <dd>Force one or two page breaks before (after) the generated box so that
    the next page is formatted as a right page.

   <dt>page

   <dd>Always force a page break before (after) the generated box.

   <dt>column

   <dd>Always force a column break before (after) the generated box.

   <dt>avoid-page

   <dd>Avoid a page break before (after, inside) the generated box.

   <dt>avoid-column

   <dd>Avoid a column break before (after, inside) the generated box.
  </dl>

  <p>This specification adds the following new values:

  <dl>
   <dt>region

   <dd>Always force a region break before (after) the generated box.

   <dt>avoid-region

   <dd>Avoid a region break before (after, inside) the generated box.
  </dl>

  <p>When a break splits a box, the box's margins, borders, and padding have
   no visual effect where the split occurs. However, the margin immediately
   after a forced page/column/region break will be preserved. A forced
   page/column/region break is a break that does not occur naturally.

  <p><strong>Note:</strong> When the &lsquo;<code
   class=property>avoid</code>&rsquo; value is used, regions may overflow. In
   that case the &lsquo;<a href="#dom-namedflow-overflow"><code
   class=property>overflow</code></a>&rsquo; property specified on the region
   element should be used to determine how to render the overflow.

  <h3 id=the-region-overflow-property><span class=secno>3.5. </span>The
   region-overflow property</h3>

  <table class=propdef summary="break-after property definition">
   <tbody>
    <tr>
     <td><em>Name:</em>

     <td><dfn id=region-overflow>region-overflow</dfn>

    <tr>
     <td><em>Value:</em>

     <td>auto | break

    <tr>
     <td><em>Initial:</em>

     <td>auto

    <tr>
     <td><em>Applies to:</em>

     <td><em title="region element">region elements</em>

    <tr>
     <td><em>Inherited:</em>

     <td>no

    <tr>
     <td><em>Percentages:</em>

     <td>N/A

    <tr>
     <td><em>Media:</em>

     <td>paged

    <tr>
     <td><em>Computed&nbsp;value:</em>

     <td>specified value
  </table>

  <p>The &lsquo;<a href="#region-overflow"><code
   class=property>region-overflow</code></a>&rsquo; property controls the
   behavior of the <em id=last-region>last region</em> associated with a
   <span>named flow</span>.

  <dl>
   <dt>auto

   <dd>Content flows as it would in a regular content element. If the content
    exceeds the container box, it is subject to the <a href="">overflow</a>
    property's computed value on the region element.

   <dt>break

   <dd>If the content fits within the <em>region element</em>, then this
    property has no effect. If the content does not fit within the <em>region
    element</em>, the content breaks as if flow was going to continue in a
    subsequent region. See the <a href="#breaking-rules">breaking rules</a>
    section.
  </dl>

  <p>The following code sample illustrates the usage of the &lsquo;<a
   href="#region-overflow"><code
   class=property>region-overflow</code></a>&rsquo; property.

  <div class=example>
   <pre>
&lt;style&gt;
#article {
    flow: "article";
}

#region_1, #region_2 {
    content: from-flow(article);
    <strong>region-overflow: break;</strong> /* or none */
    <strong>overflow: visible;</strong> /* or hidden */
}

&lt;/style&gt;

&lt;div id="article"&gt;...&lt;/div&gt;

&lt;div id="region_1"&gt;&lt;/div&gt;
&lt;div id="region_2"&gt;&lt;/div&gt;
        
</pre>
  </div>

  <div class=figure>
   <table style="border: 1px solid gray;width: 100%;" summary="Different
    values for the region-overflow property - Illustration.">
    <tbody>
     <tr>
      <td>&lsquo;<code class=css>flow: "article"</code>&rsquo;

      <td><code class=html>region_1</code> and <code
       class=html>region_2</code>

      <td>&lsquo;<code class=css>region-overflow: auto</code>&rsquo;<br>
       &lsquo;<code class=css>overflow:visible</code>&rsquo;

     <tr>
      <td rowspan=3 style="vertical-align: top;"><img alt="regions receiving
       the flow content" src="images/region-overflow-flow.png">

      <td><img alt="result if region-overflow is set to 'break'"
       src="images/region-overflow-regions.png">

      <td><img alt="regions receiving the flow content"
       src="images/region-overflow-auto-overflow-visible.png">

     <tr>
      <td>&lsquo;<code class=css>region-overflow: break</code>&rsquo;

      <td>&lsquo;<code class=css>region-overflow: auto</code>&rsquo;<br>
       &lsquo;<code class=css>overflow:hidden</code>&rsquo;

     <tr>
      <td><img alt="result if region-overflow is set to 'break'"
       src="images/region-overflow-break.png">

      <td><img alt="regions receiving the flow content"
       src="images/region-overflow-auto-overflow-hidden.png">
   </table>

   <p class=caption>Different values for the region-overflow property</p>
  </div>

  <h3 id=the-at-region-style-rule><span class=secno>3.6. </span>The @region
   rule</h3>

  <p>An &lsquo;<code class=css>@region</code>&rsquo; rule contains style
   declarations specific to particular regions.

  <p>The &lsquo;<code class=css>@region</code>&rsquo; rule consists of the
   keyword &lsquo;<code class=css>@region</code>&rsquo; followed by a <a
   href="http://www.w3.org/TR/css3-selectors/#selector-syntax">selector</a>
   and a declarations block. The &lsquo;<code class=css>@region</code>&rsquo;
   rule and the selector constitute the region's &lsquo;<code class=css>flow
   segment</code>&rsquo; selector. The region's flow segment selector
   specifies which range of elements in the flow are subject to the following
   declaration blocks: it applies to the range (see <a
   href="#DOM-LEVEL-2-TRAVERSAL-RANGE"
   rel=biblioentry>[DOM-LEVEL-2-TRAVERSAL-RANGE]<!--{{DOM-LEVEL-2-TRAVERSAL-RANGE}}--></a>)
   from the region's flow that flow in the selected region(s).

  <p>Only elements that are fully in the &lsquo;<code class=css>flow
   segment</code>&rsquo; may match any of the selectors found in the style
   rule. If an element is split across regions, it will not be subject to
   region styling in any of the regions it is part of. However, it's children
   element or pseudo-elements may be.

  <p>In addition, the &lsquo;<code class=css>::region-lines</code>&rsquo;
   pseudo-element can be used to select the inline content of an element that
   falls into a particular region.

  <pre class=code>
<strong>@region &lt;selector&gt; {
    ... CSS styling rules ...
}</strong>          
</pre>

  <div class=example id=region-style-example>
   <p>In the following example, the named flow &lsquo;<code
    class=css>article_flow</code>&rsquo; flows through &lsquo;<code
    class=css>region_1</code>&rsquo; and &lsquo;<code
    class=css>region_2</code>&rsquo;.</p>

   <pre>
&lt;style&gt;
    #div_1 {
        <strong>flow: "article_flow";</strong>
    }
    
    &lt;region1_sel&gt;, &lt;region2_sel&gt; {
        <strong>content: from-flow(article_flow);</strong>
    }

    /* region style RSA */
    <strong>@region &lt;region1_sel&gt;, &lt;region2_sel&gt;</strong> {
        p<strong>::region-lines</strong> {...}
        div {...}
        p {...}
    }
    
    /* region style RSB */
    <strong>@region &lt;region1_sel&gt;</strong> {
        p {...}
        #p_2::region-lines {...}
    }
        
&lt;/style&gt;

&lt;div id="div_1"&gt;
    &lt;p id="p_1"&gt;...&lt;/p&gt;
    &lt;p id="p_2"&gt;...&lt;/p&gt;
&lt;/div&gt;

        
</pre>

   <div id="region_styling_illustration"> <img alt="Illustration showing how
    a named flow content fits into regions to illustrate the @region
    styling." id="region_styling_img_2" name="region_styling_img_2"
    src="images/region-styling-2.png">
    <ul class=swatch-list>
     <li><span class=swatch style="background:#1C75BC">&nbsp;</span>div div_1

     <li><span class=swatch style="background:crimson">&nbsp;</span>paragraph
      p_1

     <li><span class=swatch style="background:white">&nbsp;</span>paragraph
      p_2

     <li><span class=swatch style="background:#E6E7E8">&nbsp;</span>range of
      flow that fits into region_1

     <li><span class=swatch style="background:#BCBEC0">&nbsp;</span>range of
      flow that fits into region_2
    </ul>
   </div>

   <p>The region style &lsquo;<code class=css>RSA</code>&rsquo; applies to
    flow content that fits in either &lsquo;<code
    class=css>region_1</code>&rsquo; or &lsquo;<code
    class=css>region_2</code>&rsquo;.</p>

   <p>The first rule set &lsquo;<code class=css>p::region-lines
    {...}</code>&rsquo; uses the &lsquo;<code
    class=css>::regions-line</code>&rsquo; pseudo-element. Since all the
    content is fitted in either &lsquo;<code class=css>region_1</code>&rsquo;
    or &lsquo;<code class=css>region_1</code>&rsquo;, this rule set applies
    to all content lines.</p>

   <p>The second rule set &lsquo;<code class=css>div {...}</code>&rsquo;
    applies to all <code class=html>&lt;div&gt;</code> elements that fit
    fully into &lsquo;<code class=css>region_1</code>&rsquo; or &lsquo;<code
    class=css>region_2</code>&rsquo;. In our example, there is no <code
    class=html>&lt;div&gt;</code> in the flow that fits fully in a region,
    because <code class=html>div_1</code> is split between &lsquo;<code
    class=css>region_1</code>&rsquo; and &lsquo;<code
    class=css>region_2</code>&rsquo;.</p>

   <p>The third rule set &lsquo;<code class=css>p {...}</code>&rsquo; applies
    to all <code class=html>&lt;p&gt;</code> elements that fit fully into
    &lsquo;<code class=css>region_1</code>&rsquo; or &lsquo;<code
    class=css>region_2</code>&rsquo;. In our example, only <code
    class=html>p_1</code> fully fits in a region, &lsquo;<code
    class=css>region_1</code>&rsquo;.</p>

   <p>The region style &lsquo;<code class=css>RSB</code>&rsquo; applies to
    flow content that fits in &lsquo;<code class=css>region_1</code>&rsquo;.</p>

   <p>The first rule set &lsquo;<code class=css>p {...}</code>&rsquo; matches
    <code class=html>p_1</code> because that paragraph fully fits in
    &lsquo;<code class=css>region_1</code>&rsquo;.</p>

   <p>The second rule set &lsquo;<code class=css>#p_2::region-lines
    {...}</code>&rsquo; matches lines in <code class=html>p_2</code> that
    flow into &lsquo;<code class=css>region_1</code>&rsquo;. These lines will
    be subject to the additional style.</p>
  </div>

  <div>
   <p>The properties applying to the &lsquo;<code
    class=css>::region-lines</code>&rsquo; pseudo-element is limited to the
    same set as those available on the <a
    href="http://www.w3.org/TR/css3-selectors/#first-line">&lsquo;<code
    class=property>first-line</code>&rsquo;</a> pseudo-element, as listed in
    the <a
    href="http://www.w3.org/TR/css3-selectors/#first-formatted-line">First
    formatted line definition in CSS</a> in <a href="#SELECT"
    rel=biblioentry>[SELECT]<!--{{!SELECT}}--></a></p>
  </div>

  <div class=issue> Is the proposed restriction that elements are only
   selected selector in a rule set appearing in an @region rule sufficient?</div>

  <div class=issue> There is <a
   href="http://lists.w3.org/Archives/Public/www-style/2011May/0518.html">concern</a>
   that the &lsquo;<code class=css>first-line</code>&rsquo; precedent is
   underspecified and that more specification is needed in addition to
   referencing the existing precedent.</div>

  <p>The specificity of the selectors in a &lsquo;<code
   class=css>@region</code>&rsquo; rule is calculated as <a
   href="http://www.w3.org/TR/css3-selectors/#specificity">defined</a> in the
   CSS Selectors module (see <a href="#SELECT"
   rel=biblioentry>[SELECT]<!--{{SELECT}}--></a>). In other words, the
   &lsquo;<code class=css>@region</code>&rsquo; rule adds an extra condition
   to the selector's matching, but does not change the selector's
   specificity. This is the same behavior as selectors appearing in
   &lsquo;<code class=css>@media</code>&rsquo; rules declaration blocks (see
   <a href="#MEDIAQ" rel=biblioentry>[MEDIAQ]<!--{{MEDIAQ}}--></a>), where
   the rule does not influence the selectors' specificity.

  <p>&nbsp;

  <p>Consequently, selectors that match a given element (as describe above),
   participate in the <a href="CSS2.1%20section%206.4.1">CSS Cascading
   order</a> as defined in <a href="#CSS21"
   rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>.

  <h2 id="cssom_view_and_css_regions"><span class=secno>4. </span>CSSOM View
   and CSS Regions</h2>

  <p>Since content may flow into multiple regions, authors need a way to
   determine if there are enough regions to flow all the content from a named
   flow. This is especially important considering that the size of regions
   may change depending on the display context. For example, flowing the same
   content on a mobile phone with a small screen may require more regions
   than on a large desktop display.

  <p>Here is another example where creating more regions might be needed. If
   the user may change the font size of text flowing through regions, new
   regions may be needed to accommodate for the additional space required to
   fit the larger text or some may need to be removed for smaller text.

  <p>The CSS OM View (<a href="#CSSOM-VIEW"
   rel=biblioentry>[CSSOM-VIEW]<!--{{CSSOM-VIEW}}--></a>) specification
   defines extensions to the <code class=idl>Element</code> interface that
   would let an author find out if the last region overflows its content
   boundaries (by comparing its &lsquo;<code
   class=property>scrollHeight</code>&rsquo; with its &lsquo;<code
   class=property>contentHeight</code>&rsquo;). However, this assumes the
   region is a document element, which may not always be the case. For
   example, as described in a later section, a grid cell (see <a
   href="#CSS3-GRID-LAYOUT"
   rel=biblioentry>[CSS3-GRID-LAYOUT]<!--{{CSS3-GRID-LAYOUT}}--></a>) may be
   a region, but it is a pseudo-element, not an document element. Therefore,
   it is not possible to access its &lsquo;<code
   class=property>scrollHeight</code>&rsquo; or &lsquo;<code
   class=property>contentHeight</code>&rsquo;.

  <div class=note>
   <p>Since an element may be split into multiple regions, invoking <code
    class=idl><a
    href="http://www.w3.org/TR/cssom-view/#dom-element-getclientrects">getClientRects</a></code>
    on it must return the list of rectangles for the element in all the
    regions it is part of.</p>
  </div>

  <h3 id=the-namedflow-interface><span class=secno>4.1. </span>The NamedFlow
   interface</h3>

  <p>This specification adds a method to the <a
   href="http://www.w3.org/TR/DOM-Level-3-Core/core.html#i-Document"><code
   class=idl>Document</code></a> interface to access the document's <span
   title=named-flow>named flow</span> instances.

  <pre class=idl>
[Supplemental] interface <a href="http://www.w3.org/TR/DOM-Level-3-Core/core.html#i-Document">Document</a> {
  <a href="#dom-namedflow">NamedFlow</a> <a href="#dom-document-flowwithname">flowWithName(</a><a href="http://www.w3.org/TR/DOM-Level-3-Core/core.html#DOMString">DOMString</a> name);
};               
</pre>

  <p>The <dfn id=dom-namedflow><code class=idl>NamedFlow</code></dfn>
   interface offers a representation of the <span>named flow</span>.

  <pre class=idl>
interface <a href="#dom-namedflow">NamedFlow</a> {
  readonly attribute boolean <a href=dom-namedflow-overflow>overflow</a>;
};    
    
</pre>

  <p>The <dfn id=dom-namedflow-overflow><code class=idl>overflow</code></dfn>
   property is true if the named flow does not fully fit in the associated
   regions. Otherwise, it is false.

  <p>With the <a href="#dom-namedflow"><code class=idl>NamedFlow</code></a>
   interface, authors can easily check if all content has been fitted into
   existing regions. If it has, the overflow property would be true.

  <div class=issue>
   <p>See <a
    href="http://lists.w3.org/Archives/Public/www-style/2011May/0379.html">Mailing
    list discussion</a>.</p>

   <p>Alex has suggested to not have a NamedFlow interface but instead expand
    the Element interface to provide access to the regions (e.g., does the
    flow fit? which flow elements fall into which region?) and pointed out
    that the <a href="#dom-namedflow"><code class=idl>NamedFlow</code></a>
    interface implies there is only one view on the flow. He asked that we
    prepare for multiple views.</p>

   <p>Alex's proposal has been added (see below) but the <a
    href="#dom-namedflow"><code class=idl>NamedFlow</code></a> interface was
    kept for now because it covers the most basic need (does the flow fit?)
    in the case where regions are not elements.</p>

   <p>There needs to be a discussion about how to get a single set of APIs
    that would both be &lsquo;<code class=property>multi-view</code>&rsquo;
    ready and work on elements and pseudo-elements.</p>
  </div>

  <h3 id=extension-to-the-element-interface><span class=secno>4.2.
   </span>Extension to the Element interface</h3>

  <p>When an region is an actual <a
   href="http://www.w3.org/TR/DOM-Level-3-Core/glossary.html#dt-element">element</a>,
   it is convenient to easily find out if content fully fits into the
   <span>region</span> or not. The supplemental interface on <a
   href="http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-745549614"><code
   class=idl>Element</code></a> provides that functionality.

  <pre class=idl>
[Supplemental] interface <a href="http://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-745549614">Element</a> {
    readonly attribute <a href="http://www.w3.org/TR/DOM-Level-3-Core/core.html#DOMString">DOMString</a> <a href="#dom-element-regionoverflow">regionOverflow</a>;
    readonly <a href="#">Range</a>[] <a href="#dom-element-flowranges">flowRanges</a>;
};               
    
</pre>

  <p>The <dfn id=dom-element-regionoverflow><code
   class=idl>regionOverflow</code></dfn> attribute can take one of the
   following values:

  <dl>
   <dt>overflow

   <dd>the region element's content overflows the region's <a
    href="http://www.w3.org/TR/CSS21/box.html#box-dimensions">content
    box</a>. Note that the region's <a
    href="http://www.w3.org/TR/CSS21/visufx.html#overflow"><code
    class=idl>overflow</code></a> property value can be used to control the
    visibility of the overflowing content. This means that the region is the
    last one in the <span title=region-chain>region chain</span> and not able
    to fit the remaining content from the <span title=named-flow>named
    flow</span>.

   <dt>fit

   <dd>the region element's content fits into the region's <a
    href="http://www.w3.org/TR/CSS21/box.html#box-dimensions">content
    box</a>. It does not overflow. If the region is the last one in the <span
    title=region-chain>region chain</span>, it means that the content fits
    without overflowing. If the region is not the last one in the region
    chain, that means the <span title=named-flow>named flow</span> content is
    further fitted in subsequent regions. In particular, in this last case,
    that means the region may have received no content from the <span
    title=named-flow>named flow</span> (for example if the region is too span
    to accommodate any content).

   <dt>empty

   <dd>the region element has no content and is empty. All content from the
    <span title=named-flow>named flow</span> was fitted in regions with a
    lower &lsquo;<a href="#content-order"><code
    class=property>content-order</code></a>&rsquo; value.
  </dl>

  <p>If an element is not a <span>region</span>, then the <code
   class=idl>contentOverflow</code> attribute value is &lsquo;<code
   class=property>fit</code>&rsquo;.

  <p>&nbsp;

  <p>The <dfn id=dom-element-flowranges>flowRanges</dfn> attribute is an
   array of <a
   href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-idl">
   Range</a> instances corresponding to the content from the region flow that
   is positioned in the region.

  <p>If an element is not an <span>region</span>, then the <a
   href="#dom-element-flowranges"><code class=idl><span
   title="#document-element-flowranges">flowRanges</span></code></a>
   attribute returns an array with a single <code class=idl><span
   title=range>Range</span></code> matching the element's full content.

  <div class=issue> The Element interface extension is only available to
   regions that are document elements and not to regions that are
   pseudo-elements. For example, when regions are created with a grid layout,
   this interface cannot be used because the regions are not document
   elements but pseudo-elements.</div>

  <div class=issue> <strong>Re-layout event?</strong>
   <p>It has been <a
    href="http://lists.w3.org/Archives/Public/www-style/2011May/0379.html">suggested</a>
    to add a &lsquo;<code class=css>layout changed</code>&rsquo; event to
    notify any change on the region layout or regionOverflow value. Should we
    add that?</p>
   <strong>Find the region containing a particular flow element</strong>
   <p>It has been <a
    href="http://lists.w3.org/Archives/Public/www-style/2011May/0379.html">suggested</a>
    to add an API to find which region displays an element in a named flow.
    Should we add such an API? How would it work in a &lsquo;<code
    class=property>multi-view</code>&rsquo; context as suggested by Alex.</p>
  </div>

  <h2 id=integration-with-other-specifications><span class=secno>5.
   </span>Integration with other specifications</h2>

  <p>This specification does not specify how regions are created or laid out.
   This section illustrates how regions can be crated and laid out with other
   specifications. It first defines the requirements for integrating CSS
   Regions. Then it provides examples for different existing solutions.

  <h3 id=region-requirements><span class=secno>5.1. </span>Region
   requirements</h3>

  <p>For a container element (or pseudo-element) to become a region, it must
   be selectable with a CSS selector and accept the content property as
   defined in this specification.

  <h3 id=integration-examples><span class=secno>5.2. </span>Integration
   Examples</h3>

  <p>Authors can use different methods to layout regions in CSS. Some
   solutions can be expressed with CSS only and not require document changes,
   some solutions leverage the document tree. The following examples
   illustrate these different options.

  <h4 id=css-grid-layout><span class=secno>5.2.1. </span>CSS Grid Layout</h4>

  <p>The CSS Grid Layout specification (see <a href="#CSS3-GRID-LAYOUT"
   rel=biblioentry>[CSS3-GRID-LAYOUT]<!--{{CSS3-GRID-LAYOUT}}--></a>) defines
   a <a
   href="http://www.w3.org/TR/css3-grid-layout/#grid-cell-pseudo-element-selector">grid-cell
   pseudo-element</a> selector for grid cells. Consequently, grid cells can
   be a region.

  <p>The following example shows how CSS Grid Layout could be use to create
   regions and position them to create the example given in the introduction.

  <div class=issue> There is a pending issue in the CSS Grid Layout module
   draft (section 7.2) about whether or not grid cells should generate a box
   and have an associated &lsquo;<code class=property>display</code>&rsquo;
   property. To completely allow the use-case presented below, &lsquo;<code
   class=css>::grid-cell</code>&rsquo; pseudo elements should allow box
   sizing properties and behave as block level elements.</div>

  <div class=example>
   <pre>
&lt;style&gt;
body:before {
    display: grid;
    grid-template: "aae"
                   "bbe"
                   "cde";
}

body:before::grid-cell(a) {
    content: url('illustration.png');
}

body:before::grid-cell(b),
body:before::grid-cell(c),
body:before::grid-cell(d),
body:before::grid-cell(e) {
    content: from-flow('article_flow');
}
&lt;/style&gt;
</pre>
  </div>

  <h4 id=css-multi-column-layout><span class=secno>5.2.2. </span>CSS
   Multi-Column Layout</h4>

  <p>The CSS Multi-Column Layout (see <a href="#CSS3COL"
   rel=biblioentry>[CSS3COL]<!--{{CSS3COL}}--></a>) does not specify a
   selector for column regions.

  <p>&nbsp;

  <p>The CSS Multi-Column specification could offer a pseudo-element selector
   (e.g., called &lsquo;<code class=css>nth-column</code>&rsquo;) for its
   column boxes. This would enable different content to flow through
   different columns. The following example illustrates how two different
   content flows could be threaded on alternate columns.

  <div class=example>
   <pre>
&lt;style&gt;
body:before {
    columns: 4;
}

body:before::nth-column(even) {
    content: from-flow('article_1_flow');
}

body:before::nth-column(odd) {
    content: from-flow('article_2_flow');
}
&lt;/style&gt;

&lt;body&gt;
    &lt;div id="article_1"&gt;...&lt;/div&gt;
    &lt;div id="article_2"&gt;...&lt;/div&gt;
&lt;/body&gt;
</pre>
  </div>

  <p>Note that if a column box becomes associated with a flow by its content
   property, it is no longer associated to the &lsquo;<a
   href="#column-flow-def"><code class=css>column flow</code></a>&rsquo;, as
   discussed <a href=column-flow>before</a>. For example, if the second
   column in a multi column element was associated with the &lsquo;<code
   class=property>illustration</code>&rsquo; named flow, the regular
   &lsquo;<code class=property>column-flow</code>&rsquo; would thread through
   the first and third column while column two would flow content from the
   &lsquo;<code class=property>illustration</code>&rsquo; named flow.

  <h4 id=css-visual-formatting><span class=secno>5.2.3. </span>CSS Visual
   Formatting</h4>

  <p>CSS (see <a href="#CSS21" rel=biblioentry>[CSS21]<!--{{CSS21}}--></a>)
   offers a way to visually format content with different layout schemes:
   inline and block formatting, float, absolute positioning, relative
   positioning or table layout.

  <p>Elements laid out using these schemes can be regions, as illustrated
   below, using absolutely positioned elements for simplicity.

  <div class=example>
   <pre>
&lt;style&gt;
#article {
    flow: article_flow;
}

#region_1, #region_2, #region_3, #region_4 {
    content: from-flow(article_flow);
}

#region_1 {
    /* positioning properties */
}

/* ... positioning of other regions ... */

&lt;/style&gt;
&lt;html&gt;
    &lt;body&gt;
        &lt;div id="article"&gt;...&lt;/div&gt;
        &lt;div id="region_A"&gt;&lt;/div&gt;
        &lt;div id="region_1"&gt;&lt;/div&gt;
        &lt;div id="region_2"&gt;&lt;/div&gt;
        &lt;div id="region_3"&gt;&lt;/div&gt;
        &lt;div id="region_4"&gt;&lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
  
</pre>
  </div>

  <h2 id=relation-to-other-specifications><span class=secno>6.
   </span>Relation to other specifications</h2>

  <p>This specification is related to other specifications as described in
   the <a href="#references">references</a> section. In addition, it is
   related to the following specifications:

  <ol>
   <li>CSS Exclusions Module [[CSS3EXCLUSIONS]]. This module defines a
    generic way to define arbitrarily shaped exclusions into which content
    can flow or around which content can flow. This can be seen as an
    extension to the way CSS floats provide rectangular areas into which
    content flows and around which content flows. In advanced layout designs,
    it is expected that the CSS Exclusions module will be commonly combined
    with the CSS Regions module.

   <li>CSS Line Grid Module [[CSS3LINEGRID]]. This module defines a concept
    of line grid to align the position of lines in different elements. The
    line grid functionality is related and needed for aligning content
    flowing in separate regions.
  </ol>

  <h2 id=conformance><span class=secno>7. </span>Conformance</h2>

  <h2 class=no-num id=acknowledgments>Acknowledgments</h2>

  <h2 class=no-num id=references>References</h2>

  <h3 class=no-num id=normative-references>Normative references</h3>
  <!--begin-normative-->
  <!-- Sorted by label -->

  <dl class=bibliography>
   <dt style="display: none"><!-- keeps the doc valid if the DL is empty -->
    <!---->

   <dt id=CSS21>[CSS21]

   <dd>Bert Bos; et al. <a
    href="http://www.w3.org/TR/2009/CR-CSS2-20090423"><cite>Cascading Style
    Sheets Level 2 Revision 1 (CSS&#160;2.1) Specification.</cite></a> 23
    April 2009. W3C Candidate Recommendation. (Work in progress.) URL: <a
    href="http://www.w3.org/TR/2009/CR-CSS2-20090423">http://www.w3.org/TR/2009/CR-CSS2-20090423</a>
    </dd>
   <!---->

   <dt id=CSS3COL>[CSS3COL]

   <dd>H&#229;kon Wium Lie. <a
    href="http://www.w3.org/TR/2011/CR-css3-multicol-20110412"><cite>CSS
    Multi-column Layout Module.</cite></a> 12 April 2011. W3C Candidate
    Recommendation. (Work in progress.) URL: <a
    href="http://www.w3.org/TR/2011/CR-css3-multicol-20110412">http://www.w3.org/TR/2011/CR-css3-multicol-20110412</a>
    </dd>
   <!---->

   <dt id=SELECT>[SELECT]

   <dd>Tantek &#199;elik; et al. <a
    href="http://www.w3.org/TR/2009/PR-css3-selectors-20091215"><cite>Selectors
    Level 3.</cite></a> 15 December 2009. W3C Proposed Recommendation. (Work
    in progress.) URL: <a
    href="http://www.w3.org/TR/2009/PR-css3-selectors-20091215">http://www.w3.org/TR/2009/PR-css3-selectors-20091215</a>
    </dd>
   <!---->
  </dl>
  <!--end-normative-->

  <h3 class=no-num id=other-references>Other references</h3>
  <!--begin-informative-->
  <!-- Sorted by label -->

  <dl class=bibliography>
   <dt style="display: none"><!-- keeps the doc valid if the DL is empty -->
    <!---->

   <dt id=CSS21>[CSS21]

   <dd>Bert Bos; et al. <a
    href="http://www.w3.org/TR/2009/CR-CSS2-20090423"><cite>Cascading Style
    Sheets Level 2 Revision 1 (CSS&#160;2.1) Specification.</cite></a> 23
    April 2009. W3C Candidate Recommendation. (Work in progress.) URL: <a
    href="http://www.w3.org/TR/2009/CR-CSS2-20090423">http://www.w3.org/TR/2009/CR-CSS2-20090423</a>
    </dd>
   <!---->

   <dt id=CSS3-GRID-LAYOUT>[CSS3-GRID-LAYOUT]

   <dd>Alex Mogilevsky; et al. <a
    href="http://www.w3.org/TR/2011/WD-css3-grid-layout-20110407"><cite>Grid
    Layout.</cite></a> 7 April 2011. W3C Working Draft. (Work in progress.)
    URL: <a
    href="http://www.w3.org/TR/2011/WD-css3-grid-layout-20110407">http://www.w3.org/TR/2011/WD-css3-grid-layout-20110407</a>
    </dd>
   <!---->

   <dt id=CSS3COL>[CSS3COL]

   <dd>H&#229;kon Wium Lie. <a
    href="http://www.w3.org/TR/2011/CR-css3-multicol-20110412"><cite>CSS
    Multi-column Layout Module.</cite></a> 12 April 2011. W3C Candidate
    Recommendation. (Work in progress.) URL: <a
    href="http://www.w3.org/TR/2011/CR-css3-multicol-20110412">http://www.w3.org/TR/2011/CR-css3-multicol-20110412</a>
    </dd>
   <!---->

   <dt id=CSS3PAGE>[CSS3PAGE]

   <dd>H&#229;kon Wium Lie; Melinda Grant. <a
    href="http://www.w3.org/TR/2006/WD-css3-page-20061010"><cite>CSS3 Module:
    Paged Media.</cite></a> 10 October 2006. W3C Working Draft. (Work in
    progress.) URL: <a
    href="http://www.w3.org/TR/2006/WD-css3-page-20061010">http://www.w3.org/TR/2006/WD-css3-page-20061010</a>
    </dd>
   <!---->

   <dt id=CSSOM-VIEW>[CSSOM-VIEW]

   <dd>Anne van Kesteren. <a
    href="http://www.w3.org/TR/2009/WD-cssom-view-20090804/"><cite>CSSOM View
    Module.</cite></a> 4 August 2009. W3C Working Draft. (Work in progress.)
    URL: <a
    href="http://www.w3.org/TR/2009/WD-cssom-view-20090804/">http://www.w3.org/TR/2009/WD-cssom-view-20090804/</a>
    </dd>
   <!---->

   <dt id=DOM-LEVEL-2-TRAVERSAL-RANGE>[DOM-LEVEL-2-TRAVERSAL-RANGE]

   <dd>Joe Kesselman; et al. <a
    href="http://www.w3.org/TR/2000/REC-DOM-Level-2-Traversal-Range-20001113"><cite>Document
    Object Model (DOM) Level 2 Traversal and Range Specification.</cite></a>
    13 November 2000. W3C Recommendation. URL: <a
    href="http://www.w3.org/TR/2000/REC-DOM-Level-2-Traversal-Range-20001113">http://www.w3.org/TR/2000/REC-DOM-Level-2-Traversal-Range-20001113</a>
    </dd>
   <!---->

   <dt id=MEDIAQ>[MEDIAQ]

   <dd>H&#229;kon Wium Lie; et al. <a
    href="http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/"><cite>Media
    Queries.</cite></a> 27 July 2010. W3C Candidate Recommendation. (Work in
    progress.) URL: <a
    href="http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/">http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/</a>
    </dd>
   <!---->

   <dt id=SELECT>[SELECT]

   <dd>Tantek &#199;elik; et al. <a
    href="http://www.w3.org/TR/2009/PR-css3-selectors-20091215"><cite>Selectors
    Level 3.</cite></a> 15 December 2009. W3C Proposed Recommendation. (Work
    in progress.) URL: <a
    href="http://www.w3.org/TR/2009/PR-css3-selectors-20091215">http://www.w3.org/TR/2009/PR-css3-selectors-20091215</a>
    </dd>
   <!---->
  </dl>
  <!--end-informative-->

  <h2 class=no-num id=index>Index</h2>
  <!--begin-index-->

  <ul class=indexlist>
   <li>auto flows, <a href="#auto-flow" title="auto
    flows"><strong>2.4.</strong></a>

   <li>break-after, <a href="#break-after"
    title=break-after><strong>3.4.</strong></a>

   <li>break-before, <a href="#break-before"
    title=break-before><strong>3.4.</strong></a>

   <li>break-inside, <a href="#break-inside"
    title=break-inside><strong>3.4.</strong></a>

   <li>column flow, <a href="#column-flow-def" title="column
    flow"><strong>2.4.3.</strong></a>

   <li>content, <a href="#content-from"
    title=content><strong>3.2.</strong></a>

   <li>content-order, <a href="#content-order"
    title=content-order><strong>3.3.</strong></a>

   <li>current-region, <a href="#current-region"
    title=current-region><strong>2.3.1.</strong></a>

   <li>disconnected, <a href="#disconnected"
    title=disconnected><strong>3.2.</strong></a>

   <li>flow, <a href="#flow2" title=flow><strong>3.1.</strong></a>

   <li>flowRanges, <a href="#dom-element-flowranges"
    title=flowRanges><strong>4.2.</strong></a>

   <li>from-flow(&lt;string&gt;), <a href="#from-flow-name"
    title="from-flow(&lt;string&gt;)"><strong>3.2.</strong></a>

   <li>generated flow, <a href="#generated-flow-def" title="generated
    flow"><strong>2.4.4.</strong></a>

   <li>grid cell flow, <a href="#grid-cell-flow" title="grid cell
    flow"><strong>2.4.3.</strong></a>

   <li><a href="#dom-namedflow"><code class=idl>NamedFlow</code></a>, <a
    href="#dom-namedflow" title=NamedFlow><strong>4.1.</strong></a>

   <li>none, <a href="#none" title=none>3.2.</a>

   <li>normal flow, <a href="#normal-flow-def" title="normal
    flow"><strong>2.4.1.</strong></a>

   <li><a href="#dom-namedflow-overflow"><code class=idl>overflow</code></a>,
    <a href="#dom-namedflow-overflow"
    title=overflow><strong>4.1.</strong></a>

   <li>positioned-flow, <a href="#positioned-flow0"
    title=positioned-flow><strong>2.4.2.</strong></a>

   <li>region, <a href="#region" title=region>2.2.</a>

   <li>region chain, <a href="#region-chain" title="region
    chain"><strong>3.</strong></a>

   <li><a href="#dom-element-regionoverflow"><code
    class=idl>regionOverflow</code></a>, <a
    href="#dom-element-regionoverflow"
    title=regionOverflow><strong>4.2.</strong></a>

   <li>region-overflow, <a href="#region-overflow"
    title=region-overflow><strong>3.5.</strong></a>

   <li>specified flow, <a href="#specified-flow" title="specified
    flow"><strong>3.1.</strong></a>
  </ul>
  <!--end-index-->

  <h2 class=no-num id=property-index>Property index</h2>
  <!--begin-properties-->

  <table class=proptable>
   <thead>
    <tr>
     <th>Property

     <th>Values

     <th>Initial

     <th>Applies&nbsp;to

     <th>Inh.

     <th>Percentages

     <th>Media

   <tbody>
    <tr>
     <td><a class=property href="#break-after">break-after</a>

     <td>auto | always | avoid | left | right | page | column | region |
      avoid-page | avoid-column | avoid-region

     <td>auto

     <td>block-level elements

     <td>no

     <td>N/A

     <td>paged

    <tr>
     <td><a class=property href="#break-before">break-before</a>

     <td>auto | always | avoid | left | right | page | column | region |
      avoid-page | avoid-column | avoid-region

     <td>auto

     <td>block-level elements

     <td>no

     <td>N/A

     <td>paged

    <tr>
     <td><a class=property href="#break-inside">break-inside</a>

     <td>auto | avoid | avoid-page | avoid-column | avoid-region

     <td>auto

     <td>block-level elements

     <td>no

     <td>N/A

     <td>paged

    <tr>
     <td><a class=property href="#content-from">content</a>

     <td>normal | none | from-flow(&lt;string&gt;)| [ &lt;string&gt; |
      &lt;uri&gt; | &lt;counter&gt; | attr(&lt;identifier&gt;) | open-quote |
      close-quote | no-open-quote | no-close-quote ]+ | inherit

     <td>normal

     <td>non-replaced block elements and the ::before and ::after
      pseudo-elements

     <td>no

     <td>N/A

     <td>visual

    <tr>
     <td><a class=property href="#content-order">content-order</a>

     <td>&lt;float&gt;

     <td>0

     <td>any block container

     <td>no

     <td>N/A

     <td>visual

    <tr>
     <td><a class=property href="#flow2">flow</a>

     <td>&lt;string&gt;

     <td>auto

     <td>any element

     <td>no

     <td>N/A

     <td>visual

    <tr>
     <td><a class=property href="#region-overflow">region-overflow</a>

     <td>auto | break

     <td>auto

     <td>region elements

     <td>no

     <td>N/A

     <td>paged
  </table>
  <!--end-properties-->
  <!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
