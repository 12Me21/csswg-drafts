<!DOCTYPE html public '-//W3C//DTD HTML 4.01//EN'
  'http://www.w3.org/TR/html4/strict.dtd'>
<html lang="en">
<head profile="http://www.w3.org/2006/03/hcard">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>CSS Regions Module Level 3</title>
  <link rel="stylesheet" type="text/css" href="../shared/style/default.css">
  <script src='http://test.csswg.org/harness/annotate.js#CSS3-REGIONS_DEV' type='text/javascript' defer></script>

       <style type="text/css">
         #region-style-example p, #region-style-example pre {
         	clear: both;
         }

         #region_styling_illustration {
         	margin: 0px auto;
         	width: 70ex;
         }
       </style>
       
       <link rel="stylesheet" type="text/css"
        href="http://www.w3.org/StyleSheets/TR/W3C-ED.css">
        
        <link rel="stylesheet" type="text/css"
         href="../shared/style/issues.css">

       <link id="st" href="../shared/style/alternate-spec-style.css" rel="stylesheet" 
              type="text/css" title="alternate spec style">
</head>


<body>
    <div class="head" id="div-head">
        <p><a href="http://www.w3.org/"><img id="mobile-logo" alt="W3C" height="53" src=
        "http://www.w3.org/2008/site/images/logo-w3c-mobile-lg" width="90"></a> 
        
        
        <!--begin-logo-->

        <p><a href="http://www.w3.org/"><img id="logo" alt="W3C" height="48" src=
        "http://www.w3.org/Icons/w3c_home" width="72"></a> <!--end-logo--></p>

        <h1 id="css-regions-module">CSS Regions Module Level 3</h1>

        <h2 class="no-num no-toc" id="longstatus-date">[LONGSTATUS]
        [DATE]</h2>

        <dl>
            <dt>This version:</dt>

            <dd><a href=
            "[VERSION]">http://www.w3.org/csswg/css3-regions</a></dd>

            <dt>Latest version:</dt>

            <dd><a href=
            "http://www.w3.org/TR/css3-regions/">http://www.w3.org/TR/css3-regions/</a></dd>

            <dt>Previous version:</dt>

            <dd><a href="http://www.w3.org/TR/2011/WD-css3-regions-20111129/">http://www.w3.org/TR/2011/WD-css3-regions-20111129/</a></dd>
                
            <dt>Editors:</dt>

            <dd class="vcard"><span class="fn">Vincent Hardy</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">vhardy@adobe.com</span></dd>
			<dd class="vcard"><span class="fn">Rossen Atanassov</span>,
            <span class="org">Microsoft Corporation</span>, <span class=
            "email">ratan@microsoft.com</span></dd>
            <dd class="vcard"><span class="fn">Alan Stearns</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">stearns@adobe.com</span></dd>

		    <dt>Authors and former editors:</dt>
			<dd class="vcard"><span class="fn">Alex Mogilevsky</span>,
            <span class="org">Microsoft Corporation</span>, <span class=
            "email">alexmog@microsoft.com</span></dd>

            <dt>Issues List:</dt>
                <dd><a href="https://www.w3.org/Bugs/Public/buglist.cgi?product=CSS&amp;component=Regions&amp;resolution=---">Bugzilla Bugs for CSS regions</a></dd>
                <dt>Discussion:</dt>
                <dd><a href="http://lists.w3.org/Archives/Public/www-style/">www-style@w3.org</a> with subject line "<code>[css3-regions] message topic</code>"</dd>
        </dl><!--begin-copyright--><!--end-copyright-->
        <hr title="Separator for header">
    </div>
    
    <h2 class="no-num no-toc" id="abstract">Abstract</h2>
    
    <p>The CSS regions module allows content to flow across multiple areas
    called regions. The regions are not necessarily contiguous in the document order.
    The CSS regions module provides an advanced content flow mechanism, which
    can be combined with positioning schemes as defined by other CSS modules
    such as the Multi-Column Module [[CSS3COL]] or the Grid Layout Module
    [[CSS3-GRID-LAYOUT]] to position the regions where content flows.</p>

    <h2 class="no-num no-toc" id="status-of-this-document">Status of this
    document</h2>
    
    <p class="big note"><span class="note-prefix">Note </span>This document uses an experimental style
       sheet. We welcome your feedback on the styles at
       <a href="mailto:site-comments@w3.org">site-comments@w3.org</a>.</p>
    
    <!--status-->

    <p>This draft is related to the drafts about Multi-column Layout
    [[CSS3COL]], Grid Layout [[CSS3GRID]], Flexible Box Layout
    [[CSS3-FLEXBOX]], and Template Layout [[CSS3LAYOUT]].</p>

    <h2 class="no-num no-toc" id="table-of-contents">Table of contents</h2>
    <!--begin-toc--><!--end-toc-->

    <h2 id="introduction">Introduction</h2>

    <p><em>This section is non-normative.</em></p>
    
    <p>Displaying the complex layouts 
      of a typical magazine, newspaper, or textbook on the web 
      requires capabilities beyond those available in existing CSS modules. 
      Dynamic magazine layout in particular requires flexibility
      in placement of boxes for content flows.
      This is the purpose of the CSS regions module.</p>
    
    <div class="issue-marker" data-bug_id="15733" data-bug_status="NEW">
        <a href=
        "https://www.w3.org/Bugs/Public/show_bug.cgi?id=15733">Issue-15733</a>

        <div class="issue-details">
            <p class="short-desc">Should the region specification define a
            mechanism to create blocks that can be regions with CSS
            syntax?</p>
        </div>
    </div>

    <p>For more complex layouts, 
      content needs to flow from one area of the page to the next 
      without limitation on the areas' sizes and positions. 
      These arbitrary areas are the target of specific content flows 
      which this document calls <span>named flows</span>. 
      Each <span>named flow</span> can be associated 
      with a set of CSS Regions called a region chain. 
      CSS Regions are based on the rectangular geometry 
      of the CSS box model. 
      Elements in a <span>named flow</span> 
      are taken out of the normal visual formatting 
      and rendered in a chain of CSS Regions.</p>

    <h3 id="named-flows-and-regions">Named flows and region chains</h3>

    <p>Consider the layout illustrated in figure 1.</p>


    <div class="figure">
        <img src="images/intro-example-layout.svg" width="400" alt=
        "multiple chained regions which should receive content from a flow">

        <p class="caption">Layout requiring sophisticated content flow</p>
    </div>
    
    <p>The designer's intent is 
      to position an image in box 'A' 
      and to flow an article's content 
      from box '1' through boxes '2', '3' and '4'. 
      Note that the second box should have two columns,
      and the image is not contained in the article. 
      Box '4' should auto-size to render 
      the remainder of the article content 
      that did not fit in the earlier boxes.</p>

    <p>Figure 2 shows an example 
      of the intended visual rendering 
      of the content.</p>

    <div class="figure">
        <img src="images/regions-intro-rendering.png" width="450" alt=
        "Sample rendering showing a single thread of text flowing through a chain of regions">

        <p class="caption">Sample rendering for desired layout</p>
    </div>

    
    <p>There is no existing mechanism in CSS 
      to associate the content with these boxes 
      arranged in this manner
      so that content flows as intended. 
      The CSS regions module properties provide that mechanism.</p>
    
    <p>The following example illustrates 
      how the content of an <code>&lt;article&gt;</code> element 
      becomes a <span>named flow</span> 
      and how boxes marked with 'region1', 'region2', 'region3' and 'region4' IDs
      become CSS Regions that consume the 'article-flow' content.</p>

    <div class="example">
      <pre>
&lt;style&gt;
  article {
    <strong>flow-into: article-flow;</strong>
  }

  #region1, #region2, #region3, #region4 {
    <strong>flow-from: article-flow;</strong>
  }
&lt;/style&gt;
      </pre>
    </div>
    
    <p>The 'article-flow' value on the 'flow-into' property 
      directs the <code>article</code> element 
      to the 'article-flow' <span>named flow</span>. 
      Setting the 'flow-from' property on block containers
      to 'article-flow' makes them CSS Regions 
      and associates the resulting region chain  
      with the <span>named flow</span>: 
      the flow is ''poured'' 
      into the region chain.</p>

    <p>See <a href="#intro-example-code">Appendix A</a> 
      for sample code using grid layout 
      and custom elements  
      that implements this example</p>

    <div class="issue-marker" data-bug_id="16858" data-bug_status="ASSIGNED">
    <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=16858">Issue-16858</a>
    <div class="issue-details">
        <p class="short-desc">Should creation of regions from elements be disallowed?</p>
    </div>  
    </div>
    
    <div class="note"><span class="note-prefix">Note </span>
      <p><strong>CSS Regions are independent from layout</strong></p>
      
      <p>Any of the CSS layout facilities can be used 
        to create, position and size boxes that can become CSS Regions. 
        Using a grid layout [[CSS3-GRID-LAYOUT]] is just an example.
        The example could use 
        a flexible box layout [[CSS3-FLEXBOX]] instead.</p>
      <p>The CSS regions specification does not 
        define a layout mechanism 
        and is meant to integrate 
        with existing and future CSS layout facilities.</p>

      <p><strong>CSS Regions do not have to be elements</strong></p>
      
      <p>The CSS regions module is independent 
        of the layout of boxes and 
        the mechanism used to create them. 
        For simplicity, 
        our example code in <a href="#intro-example-code">Appendix A</a>
        uses elements to define the boxes.</p>


      <p>While the example uses elements for CSS Regions 
        (since [[CSS3-GRID-LAYOUT]] requires elements to create grid items) 
        it is important to note that 
        this is not required. 
        CSS Regions can be pseudo-elements, 
        such as '::before' and '::after'. 
        The only requirement 
        for an element or pseudo-element 
        to become a CSS Region 
        is that it needs to be subject 
        to CSS styling 
        to receive the 'flow-from' property. 
        The CSS page template module 
        (see [[CSS3-PAGE-TEMPLATE]]) 
        proposes another mechanism 
        to create stylable boxes that can become CSS Regions 
        with the <code class="css">@slot</code> syntax.</p>
    </div>

    <h3 id="region-styling">CSS Region names and styling</h3>

<div class="issue-marker" data-bug_id="16859" data-bug_status="NEW">
    <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=16859">Issue-16859</a>
    <div class="issue-details">
        <p class="short-desc">Reconsider using @rule for region styling</p>
    </div>  
</div>

    <p>Content can be styled depending on 
      the CSS Region it flows into. 
      It is an extension  
      of pseudo-element styling such as 
      <a href="http://www.w3.org/TR/css3-selectors/#first-line">
        <code class="css">::first-line</code>
      </a>
      which applies a particular style 
      to a fragment of content. 
      With CSS Region styling, 
      additional selectors may apply 
      depending on the CSS Region 
      into which content flows.</p>

    <p>In our example, 
      the designer wants to make 
      text flowing into #region1 
      dark blue and bold.</p>

    <p>This design can be expressed as shown below.</p>

    <div class="example">
        <pre>
&lt;style&gt;
  @region #region1 {
      p {
          color: #0C3D5F;
          font-weight: bold;
      }
&lt;/style&gt;</pre>
    </div>

    <p>The <code class="css">@region #region1</code> rule
      limits its selectors to content 
      flowing into <code class="css">#region1</code>. 
      The following figure shows how 
      the rendering changes 
      if we apply styling specific to <code>#region1</code>. 
      Note how less text fits into this box 
      now that the 'font-weight' is 
      bold instead of normal.</p>

    <div class="figure">
        <img src="images/region-styling.png" width="450" alt=
        "Illustrate how changing region styling affects the flow of content.">

        <p class="caption">Different rendering with a different region
        styling</p>
    </div>

    <h2 id="css-regions-concepts">CSS regions concepts</h2>

    <h3 id="regions">Regions</h3>

    <p id="region">
      A <dfn title="region">CSS Region</dfn> 
      is a block container 
      that has an associated 
      <em><span>named flow</span></em> 
      (see the 'flow-from' property).</p>
        
    <h3 id="region-chain">Region chain</h3>
    
    <p>A <dfn>region chain</dfn> is the sequence of regions that are associated with 
        a <span>named flow</span>. <span title="region">CSS Regions</span> in a 
        region chain receive content from the 
        named flow following their order in the chain. <span title="region">CSS Regions</span> are organized 
          into a <span title="region-chain">region chain</span> 
          according to the document order.</p>
    
    <h3 id="named-flow">Named flows</h3>
    
    <p>A <dfn>named flow</dfn> is the ordered sequence of elements 
    associated with a flow with a given identifier. 
    Elements in a <span>named flow</span> are ordered
    according to the document order.</p>
    
    <p>Elements are placed into a <span>named flow</span> 
      with the 'flow-into' property. 
      The elements in a <span>named flow</span> are laid out 
      in the <span title="region-chain">region chain</span> 
      that is associated with this <span>named flow</span>. 
      </p> 
    
    <p>Content from a <span>named flow</span> 
      is broken up between regions 
      according to the regions flow breaking rules.</p>

    <p>A <span>named flow</span> is created when 
      at least one element is moved 
      into the flow with the given identifier 
      or when at least one CSS Region 
      requests content from that flow.</p>

    <h3 id="regions-flow-breaking-rules">Regions flow breaking rules</h3>

    <p>Breaking a <span>named flow</span> across a region chain 
      is similar to breaking a document's content across pages 
      (see [[CSS3PAGE]]) 
      or a multi-column element's content across column boxes 
      (see [[CSS3COL]]). 
      One difference is that page boxes are generated 
      based on the available content 
      whereas a region chain is a set of recipient boxes 
      for the <span>named flow</span> content 
      whose dynamic generation is not in the scope 
      of this specification.</p>

    <p>Each CSS Region in turn 
      consumes content from its associated <span>named flow</span>. 
      The <span>named flow</span> content is positioned 
      in the current region 
      until a natural or forced region break occurs, 
      at which point the next region 
      in the <span title="region-chain">region chain</span> 
      becomes the <span title="current-region">current region</span>. 
      If there are no more <span>region</span>s 
      in the region chain 
      and there is still content in the flow, 
      the positioning of the remaining content 
      is controlled by the 'region-fragment' property 
      on the last <span>region</span> in the chain.</p>
    
    <p>The CSS regions module follows 
      the fragmentation rules defined 
      in the CSS Fragmentation Module Level 3 
      (see [[!CSS3-BREAK]]).</p>


    <h2 id="properties-and-rules">Properties and rules</h2>

    <h3 id="the-flow-into-property">The 'flow-into' property</h3>

    <div class="issue-marker wrapper">
    <div class="issue-marker" data-bug_id="16527" data-bug_status="ASSIGNED">
    <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=16527">Issue-16527</a>
    <div class="issue-details">
        <p class="short-desc">[Shadow]: getFlowByName and shadow DOM</p>
    </div>  
    </div>
    </div>   

    <p>The ‘flow-into’ property can place an element 
      into a <span>named flow</span>. 
      Elements that belong to the same flow 
      are laid out in the region chain 
      associated with that flow.</p>

    <table class="propdef" summary="flow property definition">
        <tr>
            <th>Name:</th>

            <td><dfn id="flow-into">flow-into</dfn></td>
        </tr>

        <tr>
            <th>Value:</th>

            <td>&lt;ident&gt; | none | inherit</td>
        </tr>

        <tr>
            <th>Initial:</th>

            <td>none</td>
        </tr>

        <tr>
            <th>Applies to:</th>

            <td>All elements, but not 
              <a href="http://www.w3.org/TR/selectors/#pseudo-elements">pseudo-elements</a> such as 
                <code class="css">::first-line</code>, <code class="css">::first-letter</code>,
                <code class="css">::before</code> or <code class="css">::after</code>.</p></td>
        </tr>

        <tr>
            <th>Inherited:</th>

            <td>no</td>
        </tr>

        <tr>
            <th>Percentages:</th>

            <td>N/A</td>
        </tr>

        <tr>
            <th>Media:</th>

            <td>visual</td>
        </tr>

        <tr>
            <th>Computed&nbsp;value:</th>

            <td>as specified</td>
        </tr>
    </table>

    <dl>
        <dt>none</dt>

        <dd>The element is not moved to a <span>named flow</span> and normal CSS processing takes place.</dd>

        <dt><a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier">&lt;ident&gt;</a></dt>

        <dd>The element is taken out 
          of its parent's flow 
          and placed into the flow 
          with the name '<a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier">&lt;ident&gt;</a>'. 
          The element is said to have 
          a <dfn id="specified-flow">specified flow</dfn>. 
          The values 'none', 'inherit', 'default', 'auto' and 'initial' 
          are invalid flow names.</dd>
    </dl>

    <p>The 'flow-into' property does not affect 
      the CSS cascade and inheritance 
      for the elements on which it is specified. 
      The 'flow-into' property does not affect the 
      <a href="http://www.w3.org/TR/2012/WD-dom-20120405/#introduction-to-the-dom">DOM</a> 
      [[!DOM]] position of an element. 
      The 'flow-into' property affects 
      the visual formatting of elements 
      placed into a <span>named flow</span> 
      and of the region chain laying out content 
      from a <span>named flow</span>.</p>

    <p>A <span>named flow</span> needs to be associated 
      with a region chain 
      (one or more CSS regions) 
      for its elements to be visually formatted. 
      If no region chain is associated 
      with a given <span>named flow</span>, 
      the elements in the <span>named flow</span> 
      are not rendered: 
      they do not generate boxes 
      and are not displayed.</p>

    <p>The children of an element 
      with a specified flow 
      may themselves have a specified flow. 
      If an element has 
      the same specified flow 
      as one of its ancestors, 
      it becomes the next sibling 
      of its closest ancestor 
      with the same specified flow.</p>

    <p>Elements in a <span>named flow</span> 
      are sequenced in document order. 
      The visual formatting model 
      uses the relationships between elements 
      in the named flow as input, 
      rather than the elements&rsquo; positions 
      in the DOM.
    </p>

    <p>The edges of the first CSS region in a region chain 
      associated with a <span>named flow</span> 
      establish the rectangle that is the 
      <a href="http://www.w3.org/TR/CSS2/visudet.html#containing-block-details">containing block</a> 
      used for absolutely positioned elements 
      in the <span>named flow</span> 
      which do not have an ancestor 
      with a 'position' of 'absolute', 'relative' or 'fixed' 
      (see [[!CSS21]]). 
      That first CSS region rectangle is used 
      as the containing block 
      instead of the initial containing block. 
      This does not affect 
      fixed position elements 
      in the <span>named flow</span> - 
      they are still positioned relative 
      to the viewport or page area even if 
      they have been redirected 
      to a named flow.</p>

    <p>The first region defines the 
      <a href="http://www.w3.org/TR/css3-writing-modes/#writing-mode">writing mode</a> 
      for the entire flow. 
      The writing mode 
      on subsequent regions is ignored.</p>

    <div class="note"><span class="note-prefix">Note </span>
        <p>The 'flow-into' property moves an element into the flow 
          and the interplay with selectors should be considered carefully.</p>
        <p>For example, </p>
        <pre>table {flow-into: table-content}</pre> 
        <p>will move all tables in the 'table-content' 
          <span>named flow</span>. 
          However, the</p>
        <pre>table &gt; * {flow-into: table-content} ...</pre>
        <p>selector will move all immediate children 
          of all table elements 
          into the ‘table-content’ <span>named flow</span> 
          (which may be useful as it will usually result, 
          if the immediate children are rows, 
          in merging rows of multiple tables), 
          but the</p>
        <pre>table * {flow-into: table-content}</pre>
        <p>selector will move all descendants 
          of table elements into the ‘table-content’ <span>named flow</span>, 
          transforming the element tree 
          into a flat list in order of opening tags 
          (which is probably not intentional). 
          This will make all the descendants 
          of table elements siblings 
          in the <span>named flow</span>. 
          Having the descendants become siblings 
          in the <span>named flow</span> 
          results in a different processing 
          (see <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/tables.html#anonymous-boxes">CSS 2.1's anonymous table objects</a>). 
          This note illustrates how authors must exercise caution 
          when choosing a particular selector 
          for setting the 'flow-into' property 
          to avoid unintended results.</p> 
    </div>

    <div class="note"><span class="note-prefix">Note </span>
      <p>Another consequence of moving elements 
        into named flows is that surrounding whitespace 
        is not moved into the named flow. 
        If you have code like this:
<pre>span {flow-into: span-content}
&lt;span&gt;one&lt;/span&gt;
&lt;span&gt;two&lt;/span&gt;
</pre>
        Then the 'span-content' named flow contents 
        will contain this: 
<pre>&lt;span&gt;one&lt;/span&gt;&lt;span&gt;two&lt;/span&gt;
</pre>
        Which will change the display 
        from "one two" to "onetwo".
        If whitespace is significant, 
        then moving the parent 
        that contains the whitespace 
        to the named flow 
        is required.
    </div>
    
    <div class="note"><span class="note-prefix">Note </span>
      <p>A future CSS Regions module level 
        will define a mechanism 
        for creating a named flow 
        from an external resource.</p>
    </div>
        
    <h3 id="the-flow-from-property">The 'flow-from' property</h3>

    <p>The 'flow-from' property makes 
      a block container a region 
      and associates it with 
      a <span>named flow</span>.</p>
 
    <table class="propdef" summary="flow-from property definition">
        <tr>
            <th>Name:</th>

            <td><dfn id="flow-from">flow-from</dfn></td>
        </tr>

        <tr>
            <th>Value:</th>

            <td>&lt;ident&gt; | none | inherit</td>
        </tr>

        <tr>
            <th>Initial:</th>

            <td>none</td>
        </tr>

        <tr>
            <th>Applies to:</th>

            <td>Non-replaced <a href="http://www.w3.org/TR/CSS21/visuren.html#block-boxes">block containers</a>. 
            <br/>  
            This might be expanded in future versions of the specification
            to allow other types of containers to receive flow content.</td>
        </tr>

        <tr>
            <th>Inherited:</th>

            <td>no</td>
        </tr>

        <tr>
            <th>Percentages:</th>

            <td>N/A</td>
        </tr>

        <tr>
            <th>Media:</th>

            <td>visual</td>
        </tr>

        <tr>
            <th>Computed&nbsp;value:</th>

            <td>as specified</td>
        </tr>
    </table>

    <dl>
        <dt><strong>none</strong></dt>

        <dd>The block container is not a <span title="region">region</span>.</dd>

        <dt><strong><a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier">&lt;ident&gt;</a></strong></dt>

        <dd>
            If the 'content' property computes 
            to something else than 'normal' 
            (or 'none' for a pseudo-element), 
            the block container does not become a <span>CSS Region</span>.
            If the 'content' property computes to 'normal' 
            (or 'none' for a pseudo-element), 
            then the block container becomes a <span>CSS Region</span> 
            and is ordered in a <span>region chain</span> 
            according to its document order. 
            The content from the flow 
            with the <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier">&lt;ident&gt;</a>
            name will be <a href="#region-flow-break">broken 
            into fragments</a> and visually formatted in the 
            <a href="http://www.w3.org/TR/CSS21/visuren.html#principal-box">principal boxes</a> 
            of the <span>regions</span> 
            in the <span>region chain</span>. 
            <br/>
            If there is no flow with name 
            <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier">&lt;ident&gt;</a>, 
            then the block container does not 
            format any content visually. 
        </dd>
    </dl>

    <p>A <span>CSS Region</span>&rsquo;s document children 
      are not visually formatted 
      unless they are directed 
      to a <span>named flow</span> 
      with an associated <span>region chain</span>.</p>

    <p>Block container pseudo-elements where 
      the value of 'flow-from' computes to an 
      <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier">&lt;ident&gt;</a> 
      and the value of 'content' computes to 'none' 
      are generated as CSS Regions, 
      which is an update to the behavior 
      described in [[!CSS21]].</p>
        
    <div class="note"><span class="note-prefix">Note </span>
      <p>A block container becomes a <span>CSS Region</span> 
        when its 'flow-from' property is set 
        to a valid <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier">&lt;ident&gt;</a> value, 
        even if there is no content contributing 
        to the referenced flow.
        For example:</p>
        <pre>
&lt;style&gt;
  .article{
    flow-into: thread;
  }
  .region{
    flow-from: thread;
  }
&lt;/style&gt;
&lt;html&gt;
  &lt;body&gt;
    &lt;div class=region&gt;div content&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
        </pre>
        
        There is no element matching 
        the <code>.article</code> selector 
        and therefore no content 
        in the <code>thread</code> flow. 
        However, the block container matching 
        the <code>.region</code> selector 
        is still associated with 
        that empty <span>named flow</span> 
        and, consequently, 
        its children are not formatted visually.
    </div>
    
    <div class="note"><span class="note-prefix">Note </span>
      <p>At the time of this note-writing, 
        the <code>display</code> values that always result
        in a non-replaced block container include 
        <code>block</code>, 
        <code>inline-block</code>, 
        <code>table-cell</code>, 
        <code>table-caption</code>, 
        and <code>list-item</code>. 
        All of these display values 
        work as regions with 
        non-replaced elements.</p>
      <p>The <code>flex</code> 
        and <code>grid</code> display values 
        do not result in block containers 
        (they are defined as flex containers 
         and grid elements, respectively). 
        So 'flow-from' combined with those display values 
        does not result in a CSS Region.</p>
    </div>
    
    <div class="issue-marker wrapper">
     <div class="issue-marker" data-bug_id="15827" data-bug_status="NEW">
        
        <a href=
        "https://www.w3.org/Bugs/Public/show_bug.cgi?id=15824">Issue-15827</a>

        <div class="issue-details">
            <p class="short-desc">Specify behavior of stacking contexts that are split between regions</p>
        </div>    
     </div>
    </div>

    <p><span title="region">CSS Regions</span> 
      create a new 
      <a href="http://www.w3.org/TR/CSS2/visuren.html#z-index">stacking context</a>. 
      <span title="region">CSS Regions</span> 
      establish a new 
      <a href="http://www.w3.org/TR/CSS2/visuren.html#block-formatting">block formatting Context</a>. 
      Exclusions (see [[CSS3-EXCLUSIONS]]) 
      potentially impact the content 
      laid out in region chains, 
      just as for non-regions.</p>
    
    <div class="note"><span class="note-prefix">Note </span>
        <p>With <span>region chains</span>, 
          an element may be split across multiple boxes 
          and these boxes may overlap 
          (for example if they are absolutely positioned). 
          So fragments of the same element 
          can overlap each other. 
          Since each element has a single z-index, 
          it would be required to find another mechanism 
          to decide in which order 
          the fragments are rendered. 
          Since each <span>CSS Region</span> creates 
          a new stacking context, 
          it is clear that each fragment is rendered separately 
          and their rendering order follows 
          the regular CSS rendering model.</p>
    </div>

    <p>See the 
      <a href="#regions-visual-formatting-details">regions visual formatting details</a> 
      section for a description of how 
      'width' and 'height' values are resolved 
      for <span>CSS Region</span> boxes.</p>

    <h4 id="circular-dependencies">Cycle Detection</h4>

    <p><span>Named flows</span> containing elements 
      where the value of 'flow-from' computes to an 
      <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier">&lt;ident&gt;</a> 
      can produce nonsensical circular relationships,
      such as a <span>named flow</span> containing <span>CSS Regions</span> 
      in its own <span>region chain</span>. 
      These relationships can be easily 
      and reliably detected and resolved, however, 
      by keeping track of a dependency graph 
      and using common cycle-detection algorithms.</p>

    <p>The dependency graph consists of edges such that:</p>

    <ul>
      <li>Every <span>named flow</span> depends on its elements 
        where the value of 'flow-from' computes to an 
        <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier">&lt;ident&gt;</a>
        .</li>
      <li>Every element in a <span>named flow</span> 
        where the value of 'flow-from' computes to an 
        <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier">&lt;ident&gt;</a> 
        depends on the <span>named flow</span> with the 
        <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier">&lt;ident&gt;</a> 
        name.</li>
    </ul>

    <p>If the graph contains a cycle, 
      any elements where the value of 'flow-from' 
      computes to an 
      <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/syndata.html#value-def-identifier">&lt;ident&gt;</a> 
      participating in the cycle 
      do not become <span>CSS Regions</span>.</p>

    <h4 id="fragmenting-regions">Nested fragmentation contexts</h4>

    <p>A <span>CSS Region</span> that contains 
      a fragment of a <span>named flow</span> 
      can itself be fragmented if it is nested 
      within a fragmentation context [[!CSS3-BREAK]], 
      such as when a layout 
      using a region chain is printed. 
      In these cases break opportunities 
      in the named flow fragment 
      contained by the <span>CSS Region</span> 
      are determined using the standard 
      <a href="http://www.w3.org/TR/css3-break/">fragmentation rules</a>. 
      In other words, 
      each region box and its associated fragment 
      should break as if it were a simple div 
      containing the fragment contents. 
      This can be controlled by using 
      an avoid break value on the <span>CSS Region</span>, 
      if that is desired.</p>

    <h3 id=
    "region-flow-break">Region
    flow break properties: 'break-before', 'break-after', 'break-inside'</h3>

    <div class="note"><span class="note-prefix">Note </span>
      <p>This section is also defined in [[!CSS3-BREAK]]. 
        If that specification moves to last call 
        with the region values, 
        the section here can be replaced by a reference.</p>
    </div>

    <p>User agents laying out content in multiple regions must
    determine where content breaks occur. The problem of breaking content into
    fragments fitting in regions is similar to breaking content into pages or
    columns.</p>

    <p>Each break ends layout in the current region and causes remaining pieces
    of content from the <span>named flow</span> to be visually formatted in the following
    region in the region chain, if there is one.</p>

    <p>The following extends the 'break-before', 'break-after' and
    'break-inside' properties from the [[!CSS3COL]] specification to account
    for regions. The additional values are described below.</p>

    <table class="propdef" summary="break-before property definition">
        <tr>
            <td><em>Name:</em></td>

            <td><dfn>break-before</dfn></td>
        </tr>

        <tr>
            <td><em>Value:</em></td>

            <td>auto | always | avoid | left | right | page | column | region |
            avoid-page | avoid-column | avoid-region</td>
        </tr>

        <tr>
            <td><em>Initial:</em></td>

            <td>auto</td>
        </tr>

        <tr>
            <td><em>Applies to:</em></td>

            <td>block-level elements</td>
        </tr>

        <tr>
            <td><em>Inherited:</em></td>

            <td>no</td>
        </tr>

        <tr>
            <td><em>Percentages:</em></td>

            <td>N/A</td>
        </tr>

        <tr>
            <td><em>Media:</em></td>

            <td>visual</td>
        </tr>

        <tr>
            <td><em>Computed&nbsp;value:</em></td>

            <td>specified value</td>
        </tr>
    </table>

    <table class="propdef" summary="break-after property definition">
        <tr>
            <td><em>Name:</em></td>

            <td><dfn>break-after</dfn></td>
        </tr>

        <tr>
            <td><em>Value:</em></td>

            <td>auto | always | avoid | left | right | page | column | region |
            avoid-page | avoid-column | avoid-region</td>
        </tr>

        <tr>
            <td><em>Initial:</em></td>

            <td>auto</td>
        </tr>

        <tr>
            <td><em>Applies to:</em></td>

            <td>block-level elements</td>
        </tr>

        <tr>
            <td><em>Inherited:</em></td>

            <td>no</td>
        </tr>

        <tr>
            <td><em>Percentages:</em></td>

            <td>N/A</td>
        </tr>

        <tr>
            <td><em>Media:</em></td>

            <td>visual</td>
        </tr>

        <tr>
            <td><em>Computed&nbsp;value:</em></td>

            <td>specified value</td>
        </tr>
    </table>

    <table class="propdef" summary="break-inside property definition">
        <tr>
            <td><em>Name:</em></td>

            <td><dfn>break-inside</dfn></td>
        </tr>

        <tr>
            <td><em>Value:</em></td>

            <td>auto | avoid | avoid-page | avoid-column | avoid-region</td>
        </tr>

        <tr>
            <td><em>Initial:</em></td>

            <td>auto</td>
        </tr>

        <tr>
            <td><em>Applies to:</em></td>

            <td>block-level elements</td>
        </tr>

        <tr>
            <td><em>Inherited:</em></td>

            <td>no</td>
        </tr>

        <tr>
            <td><em>Percentages:</em></td>

            <td>N/A</td>
        </tr>

        <tr>
            <td><em>Media:</em></td>

            <td>visual</td>
        </tr>

        <tr>
            <td><em>Computed&nbsp;value:</em></td>

            <td>specified value</td>
        </tr>
    </table>

    <p>These properties describe page, column and region break behavior
    before/after/inside the generated box. These values are normatively defined
    in [[!CSS3COL]]:</p>

    <p>This specification adds the following new values:</p>

    <dl>
        <dt>region</dt>

        <dd>Always force a region break before (after) the generated box.</dd>

        <dt>avoid-region</dt>

        <dd>Avoid a region break before (after, inside) the generated box.</dd>
    </dl>

    <p>The behavior of region breaks with regards to regions is identical to the behavior
        of page breaks with regards to pages, as defined in the [[!CSS21]].</p>

    <h3 id="the-region-fragment-property">The region-fragment property</h3>

    <table class="propdef" summary="break-after property definition">
        <tr>
            <td><em>Name:</em></td>

            <td><dfn>region-fragment</dfn></td>
        </tr>

        <tr>
            <td><em>Value:</em></td>

            <td>auto | break</td>
        </tr>

        <tr>
            <td><em>Initial:</em></td>

            <td>auto</td>
        </tr>

        <tr>
            <td><em>Applies to:</em></td>

            <td><em title="region element">CSS Regions</em></td>
        </tr>

        <tr>
            <td><em>Inherited:</em></td>

            <td>no</td>
        </tr>

        <tr>
            <td><em>Percentages:</em></td>

            <td>N/A</td>
        </tr>

        <tr>
            <td><em>Media:</em></td>

            <td>visual</td>
        </tr>

        <tr>
            <td><em>Computed&nbsp;value:</em></td>

            <td>specified value</td>
        </tr>
    </table>
    
    <p>The 'region-fragment' property controls the behavior of the <em id=
    "last-region">last region</em> associated with a <span>named
    flow</span>.</p>

    <dl>
        <dt>auto</dt>

        <dd>Content flows as it would in a regular content box. If the
        content exceeds the container box, it is subject to the <a href=
        "http://www.w3.org/TR/CSS21/visufx.html#propdef-overflow">overflow</a>
        property's computed value on the CSS Region. Region breaks must be 
        ignored on the last region.</dd>

        <dt>break</dt>

        <dd><p>If the content fits within the <em>CSS Region</em>, then this
        property has no effect. If the content does not fit within the
        <em>CSS Region</em>, the content breaks as if flow was going to
        continue in a subsequent region. See the <a href=
        "#regions-flow-breaking-rules">breaking rules</a> section. A forced region break takes precedence over
        a natural break point.</p>
        
        <p>Flow content that follows the last break in the last region is not rendered.</p>
        
        
        </dd>
    </dl>

    <p>The 'region-fragment' property does not influence 
      the size of the region it applies to.</p>
    
    <p>The following code sample illustrates 
      the usage of the 'region-fragment' property.</p>

    <div class="example">
      <pre>
&lt;body is="two-region-example"&gt;
  &lt;article&gt;...&lt;/article&gt;
&lt;/body&gt;

&lt;element name="two-region-example" extends="body"&gt;
  &lt;style&gt;
    article {
      flow-into: article-flow;
    }
    #region-1, #region-2 {
      flow-from: article-flow;
      <strong>region-fragment: break;</strong> /* or auto */
      <strong>overflow: visible;</strong> /* or hidden */
    }
  &lt;/style&gt;

  &lt;template&gt;
    &lt;div id="region-1"&gt;&lt;/div&gt;
    &lt;div id="region-2"&gt;&lt;/div&gt;
  &lt;/template&gt;
&lt;/element&gt;

      </pre>
    </div>

    <div class="figure">
        <table style="border: 1px solid gray;width: 100%;" summary=
        "Different values for the region-fragment property - Illustration.">
            <tr>
                <td>''flow-into: "article"''</td>

                <td><code>region-1</code> and <code class=
                "html">region-2</code></td>

                <td>''region-fragment: auto''<br>
                ''overflow:visible''</td>
            </tr>

            <tr>
                <td rowspan="3" style="vertical-align: top;"><img src=
                "images/region-overflow-flow.png" alt=
                "regions receiving the flow content"></td>

                <td><img src="images/region-overflow-regions.png" alt=
                "result if region-overflow is set to 'break'"></td>

                <td><img src="images/region-overflow-auto-overflow-visible.png"
                alt="regions receiving the flow content"></td>
            </tr>

            <tr>
                <td>''region-fragment: break''</td>

                <td>''region-fragment: auto''<br>
                ''overflow:hidden''</td>
            </tr>

            <tr>
                <td><img src="images/region-overflow-break.png" alt=
                "result if region-overflow is set to 'break'"></td>

                <td><img src="images/region-overflow-auto-overflow-hidden.png"
                alt="regions receiving the flow content"></td>
            </tr>
        </table>

        <p class="caption">Different values for the region-fragment
        property</p>
    </div>
    
    <div class="note"><span class="note-prefix">Note </span>
        <p>The 'overflow' property is honored on a region: if region content overflows, 
        such as the borders of elements on the 
        last line, the 'overflow' property controls the visibility of the overflowing 
        content. See the 'overflow' property definition
        ([[CSS21]]).</p>
    </div>

    <h3 id="the-at-region-style-rule">The @region rule</h3>
    
    <p>An '@region' rule contains style declarations specific to particular
    regions.</p>

        <pre>
@region &lt;selector&gt; {
    ... CSS styling rules ...
}         
    </pre>

    <p>The '@region' rule consists of the keyword '@region' followed by a
    <a href="http://www.w3.org/TR/css3-selectors/#selector-syntax">selector</a>
    and a block of style rules. The '@region' rule and the selector constitute
    the region's 'flow fragment' selector. The region's flow fragment selector
    specifies which range of elements in the flow are subject to the style rules in the 
    following block: it applies to the range (see
    [[!DOM]]) from the region's flow that flows in the
    selected region(s).</p>

    <div class="issue-marker" data-bug_id="15713" data-bug_status="NEW">
        <a href=
        "https://www.w3.org/Bugs/Public/show_bug.cgi?id=15713">Issue-15713</a>

        <div class="issue-details">
            <p class="short-desc">Model for styling element fragments</p>
        </div>
    </div>

    <p>Elements that are fully or partially in the 'flow fragment' may match any of the
    selectors found in the style rule. However, the style rules only apply to the 
    portion of the element that falls into the corresponding region.</p>
    
    

    <p>Only a limited list of properties can be set in a region style rule:</p>

    <ol>
        <li><a href="http://www.w3.org/TR/CSS2/fonts.html">font properties</a></li>
        <li><a href="http://www.w3.org/TR/CSS2/colors.html">color property</a></li>
        <li><a href="http://www.w3.org/TR/css3-color/#transparency">opacity property</a></li>
        <li><a href="http://www.w3.org/TR/css3-background/#backgrounds">background property</a></li>
        <li><a href="http://www.w3.org/TR/CSS2/text.html#propdef-word-spacing">'word-spacing'</a></li>
        <li><a href="http://www.w3.org/TR/CSS2/text.html#propdef-letter-spacing">'letter-spacing'</a></li>
        <li><a href="http://www.w3.org/TR/CSS2/text.html#propdef-text-decoration">'text-decoration'</a></li>
        <li><a href="http://www.w3.org/TR/CSS2/text.html#propdef-text-transform">'text-transform'</a></li>
        <li><a href="http://www.w3.org/TR/CSS2/visudet.html#propdef-line-height">'line-height'</a></li>
        <li><a href="http://www.w3.org/TR/css3-text/#justification">alignment and justification properties</a></li>
        <li><a href="http://www.w3.org/TR/css3-background/#borders">border properties</a></li>
        <li><a href="http://www.w3.org/TR/css3-background/#corners">rounded corner properties</a></li>
        <li><a href="http://www.w3.org/TR/css3-background/#border-images">border images properties</a></li>
        <li><a href="http://www.w3.org/TR/CSS2/box.html#margin-properties">margin properties</a></li>
        <li><a href="http://www.w3.org/TR/CSS2/box.html#padding-properties">padding properties</a></li>
        <li><a href="http://www.w3.org/TR/css3-text/#text-shadow">'text-shadow' property</a></li>
        <li><a href="http://www.w3.org/TR/css3-background/#the-box-shadow">'box-shadow' property</a></li>
        <li><a href="http://www.w3.org/TR/css3-background/#the-box-decoration-break">'box-decoration-break' property</a></li>
        <li><a href="http://www.w3.org/TR/CSS2/visudet.html#the-width-property">'width' property</a></li>
    </ol> 

    <div class="example" id="region-style-example">
        <p>In the following example, the <span>named flow</span> 'article-flow' flows
        through 'region-1' and 'region-2'.</p>
        <pre>
&lt;body is="x-region-style-example"&gt;
  &lt;div id="div-1"&gt;
      &lt;p id="p-1"&gt;...&lt;/p&gt;
      &lt;p id="p-2"&gt;...&lt;/p&gt;
  &lt;/div&gt;
&lt;/body&gt;

&lt;element name="x-region-style-example" extends="body"&gt;
  &lt;template&gt;
    &lt;style&gt;
      #div-1 {
        <strong>flow-into: article-flow;</strong>
      }

      #region-1, #region-2 {
        <strong>flow-from: article-flow;</strong>
      }

      /* region style "RSA" */
      <strong>@region #region-1, #region-2</strong> {
        div {...}
        p {...}
      }

      /* region style "RSB" */
      <strong>@region #region-1</strong> {
        p {
          margin-right: 5em;
        }
      }
    &lt;/style&gt;

    &lt;div id="region-1"&gt;&lt;/div&gt;
    &lt;div id="region-2"&gt;&lt;/div&gt;
  &lt;/template&gt;
&lt;/element&gt;        
</pre>

        <div id="region_styling_illustration">
            <img id="region_styling_img_2" src="images/region-styling-2.png"
            alt=
            "Illustration showing how a named flow content fits into regions to illustrate the @region styling."
            name="region_styling_img_2">

            <ul class="swatch-list">
                <li><span class="swatch" style=
                "background:#1C75BC">&nbsp;</span>div div-1</li>

                <li><span class="swatch" style=
                "background:crimson">&nbsp;</span>paragraph p-1</li>

                <li><span class="swatch" style=
                "background:white">&nbsp;</span>paragraph p-2</li>

                <li><span class="swatch" style=
                "background:#E6E7E8">&nbsp;</span>range of flow that fits into
                region-1</li>

                <li><span class="swatch" style=
                "background:#BCBEC0">&nbsp;</span>range of flow that fits into
                region-2</li>
            </ul>
        </div>

        <p>The region style ''RSA'' applies 
          to flow content that is laid out 
          in either 'region-1' or 'region-2'.</p>

        <p>The first rule set ''div {...}'' applies 
          to all <code>&lt;div&gt;</code> elements 
          that fit partially or fully 
          into 'region-1' or 'region-2'. 
          'div-1' is split between 'region-1' 
          and 'region-2' and gets the style 
          from this style rule.</p>

        <p>The second rule set ''p {...}'' applies 
          to all <code>&lt;p&gt;</code> elements 
          that fit into 'region-1' or 'region-2'. 
          In our example, 
          both 'p-1'and 'p-2' are selected.</p>

        <p>The region style ''RSB'' applies 
          to flow content that fits in 'region-1'.</p>

        <p>The first rule set ''p {...}'' 
          matches 'p-1' and 'p-2' 
          because these paragraphs 
          flow into 'region-1'. 
          Only the fragment of 'p-2' 
          that flows into 'region-1' 
          is styled with this rule.</p>
    </div>



    <div class="issue-marker" data-bug_id="15734" data-bug_status="NEW">
        <a href=
        "https://www.w3.org/Bugs/Public/show_bug.cgi?id=15734">Issue-15734</a>

        <div class="issue-details">
            <p class="short-desc">@region and specificity</p>
        </div>
    </div>
    
    <p>The specificity of the selectors in a '@region' rule is calculated as
    <a href="http://www.w3.org/TR/css3-selectors/#specificity">defined</a> in
    the CSS Selectors module (see [[SELECT]]). In other words, the '@region'
    rule adds an extra condition to the selector's matching, but does not
    change the selector's specificity. This is the same behavior as selectors
    appearing in '@media' rules declaration blocks (see [[MEDIAQ]]), where the
    rule does not influence the selectors' specificity.</p>

    <p>Consequently, selectors that match a given element (as describe above),
    participate in the <a href="http://www.w3.org/TR/2011/REC-CSS2-20110607/cascade.html#cascading-order">CSS Cascading
    order</a> as defined in [[!CSS21]].</p>
    
    <div>
        Region styling does not apply to nested regions. For example, if a region
        'A' receives content from a flow that contains region 'B', the content that
        flows into 'B' does not receive the region styling specified for region 'A'.
    </div>
    
    <h2 id="multi-column-regions">Multi-column regions</h2>
    
    <p>A 
      <a href="http://dev.w3.org/csswg/css3-multicol/#multi-column-element">multi-column</a> 
      [[CSS3COL]]
      element can have 
      an assigned <em><span>named flow</span></em>. 
      The element becomes part 
      of the region chain 
      for that named flow, 
      and flows its content fragments 
      through columns according to 
      the multi-column specification 
      [[!CSS3COL]]. 
      In particular, 
      when computing the 
      <a href="#rfcb-flow-fragment-height-resolution">flow fragment height</a> 
      of a multi-column element 
      that is associated with a <em><span>named flow</span></em>, 
      the <a href="http://dev.w3.org/csswg/css3-multicol/#column-fill">'column-fill'</a> 
      [[!CSS3COL]]
      property is honored 
      to balance the fragments of content 
      that would flow through 
      its columns.</p>

    <div class="example">
        <p>The following example:</p>
        <pre>
&lt;body is="x-multicol-region"&gt;
  &lt;article&gt;...&lt;/article&gt;
&lt;/body&gt;

&lt;element name="x-multicol-region" extends="body"&gt;
  &lt;template&gt;
    &lt;style&gt;    
       #multi-col {
           column-count: 2;
           flow-from: article;
           height: 6em;
           column-gap: 1em; 
       }
       
       #remainder {
           flow-from: article;
           height: auto;
       }
    &lt;/style&gt;
    &lt;div id="multicol"&gt&lt;/div&gt;
    &lt;div id="remainder"&gt;&lt;/div&gt;
  &lt;/template&gt;
&lt;/element&gt;</pre>

        <p>is equivalent in rendering to, for example:</p>
                <pre>
&lt;body is="x-single-col-regions"&gt;
  &lt;article&gt;...&lt;/article&gt;
&lt;/body&gt;

&lt;element name="x-single-col-regions" extends="body"&gt;
  &lt;template&gt;
    &lt;style&gt;    
       #flex {
           display: flex;
           flex-pack: justify;
           height: 6em;
       }
       #flex > div {
           flow-from: article;
           width: calc(50% - 0.5em);
       }

       #remainder {
           flow-from: article;
           height: auto;
       }
    &lt;/style&gt;
    &lt;div id="flex"&gt;
      &lt;div /&gt;
      &lt;div /&gt;
    &lt;/div&gt;
    &lt;div id="remainder"&gt;&lt;/div&gt;
  &lt;/template&gt;
&lt;/element&gt;</pre>  
        

    </div>
    
    <p>Overflow of multicol regions 
      is mostly handled 
      according to the same rules 
      as other CSS Regions. 
      If the remainder of the named flow 
      does not fit 
      in the multicol region, 
      then the rest 
      of the content flows into 
      the remaining region chain. 
      However, 
      if a multicol region 
      is the last region 
      in a <span>region chain</span>, 
      then the multicol region must follow the 
      <a href="http://dev.w3.org/csswg/css3-multicol/#overflow-columns">overflow column rules</a> 
      [[!CSS3COL]].</p>
        
    <h2 id="pseudo_elements">Pseudo-elements</h2>
    
    <p>It can be useful 
      to visually mark the content 
      to highlight that a content thread 
      is flowing through the region chain. 
      For example, a marker 
      such as <em>'continued below'</em> clearly indicates, 
      at the end of a CSS Region, 
      that there is more content in the flow 
      which can be found by scrolling past 
      whatever content interrupts the region chain.</p>
        
    <p>The '::before' and '::after' pseudo-elements (see [[!SELECT]]) 
      let content authors mark the beginning 
      and end of a region with such markers.</p>
        
    <h3 id="processing-model">Processing model</h3>
        
    <p>The '::before' content is laid out 
      in the region prior to 
      any other content coming from the flow. 
      Note that it is possible 
      to set the '::before' pseudo-element's 'display' property 
      to 'run-in' to align it 
      with the content's inline boxes.</p>
        
    <p>The '::after' content is laid out 
      in the region after laying out 
      the flow fragment content. 
      Then, flow content is removed from the fragment 
      to accommodate the '::after' content. 
      Accommodating means that the '::after' content 
      is laid out without overflowing the region.
      The 'display' property of the '::after' content 
      can be set to 'run-in' to align 
      with the region's content's inline boxes. 
      In that case, the '::after' content aligns with 
      the last inline box of the previous element 
      in the flow that has some visual rendering 
      in the region and can accommodate for the '::after' box.</p>

    <p>If there is not enough room to accommodate 
      the ::before content, 
      the '::after' content after removing all flow fragment content, 
      or a combination of the two, 
      then the ::before and/or ::after content overflows that region.</p>
 
    <h2 id="cssom_view_and_css_regions">CSSOM</h2>

    <div class="issue-marker-wrapper">
    <div class="issue-marker" data-bug_id="15679" data-bug_status="NEW">
        <a href=
        "https://www.w3.org/Bugs/Public/show_bug.cgi?id=15679">Issue-15679</a>

        <div class="issue-details">
            <p class="short-desc">elementFromPoint and CSS regions</p>
        </div>
    </div>
    </div>
    </div>

    <p>Since content may flow into multiple regions, authors need a way to
    determine if there are enough regions to flow all the content from a named
    flow. This is especially important considering that the size of regions or
    the size of the content may change depending on the display context. For
    example, flowing the same content on a mobile phone with a small screen may
    require more regions than on a large desktop display. Another example is the
    user changing the font size of text flowing through regions. Depending on
    the change, new regions may be needed to accommodate for the additional
    space required to fit the larger text or some regions may need to be removed
    for smaller text.
    </p>

    <h3 id="the-namedflow-interface">The NamedFlow interface</h3>
    
    <p>The following APIs allow scripts 
      to reference a <code class="idl">NamedFlow</code> 
      object representation of a <span>named flow</span>.</p>
        
    <p>An additional method on the <a href=
    "http://www.w3.org/TR/dom/#interface-document"><code class=
    "idl">Document</code></a> interface provide access to <span>named flows</span>.</p>
    
    <pre class="idl">
partial interface <a href=
"http://www.w3.org/TR/dom/#interface-document">Document</a> {
  <a href="#dom-named-flow-collection">NamedFlowCollection</a> <a href="#document-getnamedflows">getNamedFlows()</a>;
};               
</pre>

    <p>The <dfn id="document-getnamedflows"><code class="idl">getNamedFlows()</code></dfn> method on the <a href=
    "http://www.w3.org/TR/dom/#interface-document"><code class=
    "idl">Document</code></a> interface returns a static snapshot of all the current <span>named
    flows</span> in the document. </p>
    
    <p>The <code class="idl">namedFlows</code> collection must include all <span>named flows</span> 
    that are currently in the <code>CREATED</code> state. 
    The list must not include <span>named flows</span> that are in the <code>NULL</code> state. </p>

    <p>The <dfn id="dom-named-flow-collection"><code class="idl">NamedFlowCollection</code></dfn> 
    interface provides a list of current 
    <code class="idl">NamedFlow</code> instances 
    in the document. 
    The collection is 
    a snapshot of the data.</p>
    
    <pre class="idl">
interface <a href="#dom-named-flow-collection">NamedFlowCollection</a> {
  readonly attribute unsigned long <a href="#dom-named-flow-collection-length">length</a>;
  [IndexGetter] <a href="#dom-named-flow">NamedFlow?</a> <a href="#dom-named-flow-collection-item">item</a> (unsigned long index);
  [NameGetter] <a href="#dom-named-flow">NamedFlow?</a> <a href="#dom-named-flow-collection-named-item">namedItem</a> (DOMString name);
};</pre>
    
    <p>The <dfn id="dom-named-flow-collection-length"><code class="idl">length</code></dfn> 
        attribute returns 
        the number of items 
        in the collection.</p>
    <p>The <dfn id="dom-named-flow-collection-item"><code class="idl">item(index)</code></dfn> 
        method returns 
        the <code>NamedFlow</code> instance 
        at index <em>index</em>
        in the collection 
        or <code class="idl">undefined</code> 
        if <em>index</em> is out of range.
        An object <code>collection</code> 
        implementing <code>NamedFlowCollection</code> 
        supports indices in the range 
        <code>0 ≤ index < collection.length</code>.</p>

    <p>The <dfn id="dom-named-flow-collection-named-item"><code class="idl">namedItem(name)</code></dfn> 
        method returns the <code>NamedFlow</code> instance 
        in the collection 
        whose name attribute 
        matches the supplied <em>name</em>, 
        or <code class="idl">undefined</code> 
        if there is no match.

    <p>The <dfn id="dom-named-flow"><code class="idl">NamedFlow</code></dfn> 
      interface offers a representation 
      of a <span>named flow</span> instance.</p>

    <p>The <code class="idl">NamedFlow</code> interface 
      can be used for different purposes. 
      For example, the <code>getRegionsByContent()</code> method 
      can help navigate by bookmark: 
      a script can find the <span>region</span>s 
      that display a particular anchor 
      and bring them to view.</p>

    <p>Likewise, the interface allows authors 
      to check if all content has been fitted 
      into existing regions. 
      If it has, the <code>overset</code> attribute 
      would be false.</p>

    <pre class="idl">
interface <a href="#dom-named-flow">NamedFlow</a> : <a href="http://www.w3.org/TR/dom/#interface-eventtarget">EventTarget</a> {
  readonly attribute DOMString <a href="#dom-named-flow-name">name</a>;
  readonly attribute boolean <a href="#dom-named-flow-overset">overset</a>;
  sequence&lt;<a href="#region-interface">Region</a>&gt; <a href="#dom-named-flow-get-regions">getRegions()</a>;
  readonly attribute integer <a href="#dom-named-flow-first-empty-region-index">firstEmptyRegionIndex</a>;
  <a href="http://www.w3.org/TR/dom/#interface-nodelist">NodeList</a> <a href="#dom-named-flow-get-content">getContent()</a>;
  sequence&lt;<a href="#region-interface">Region</a>&gt; <a href="#dom-named-flow-get-regions-by-content">getRegionsByContent</a>(<a href="http://www.w3.org/TR/dom/#interface-node">Node</a> node);
};</pre>

    <p>The <dfn id="dom-named-flow-name"><code class="idl">name</code></dfn> attribute
     returns the name of the <code class="idl">NamedFlow</code> instance.</p>

    <p>The <dfn id="dom-named-flow-overset"><code class= "idl">overset</code></dfn> 
      attribute returns true 
      if there are <span>named flow</span> fragments 
      that do not fit 
      in the associated region chain 
      (including the case where 
      there are <span>named flow</span> fragments 
      but no regions in the <span>region chain</span>). 
      Otherwise, it returns false. </p>
    
    <p>The <dfn id="dom-named-flow-get-regions"><code class="idl">getRegions()</code></dfn> 
      method returns the sequence 
      of regions in the <span>region chain</span> 
      associated with the <span>named flow</span>. 
      Note that the returned values 
      is a static sequence 
      in document order.</p>
    
    <p>The <dfn id="dom-named-flow-first-empty-region-index">firstEmptyRegionIndex</dfn> 
      is the index of the first region 
      in the region chain with the <code>regionOverset</code> attribute 
      set to <code>empty</code>. 
      If all regions have the <code>regionOverset</code> attribute 
      set to <code>fit</code> or <code>overset</code>, 
      the value for <code>firstEmptyRegionIndex</code> is <code>-1</code>. 
      If there are no regions in the <span>region chain</span>, 
      the value is <code>-1</code> as well. </p>
        
    <p>The <dfn id="dom-named-flow-get-content">getContent()</dfn> 
      method returns an ordered collection 
      of nodes that constitute the <span>named flow</span>. 
      The returned list is a static snapshot 
      of the <span>named flow</span> content 
      at the time the method is invoked. 
      This list contains the elements 
      that were moved to the <span>named flow</span> 
      by their flow-into property 
      but not their descendants 
      (unless the descendants are themselves 
      moved to the <span>named flow</span>).
    </p>
    
    <p>The <dfn id="dom-named-flow-get-regions-by-content">getRegionsByContent()</dfn> 
      method returns the sequence of regions 
      that contain at least part 
      of the target content node 
      if it belongs to the <span>named flow</span> directly 
      or one of its ancestors belongs to the <span>named flow</span>. 
      Otherwise, the method returns 
      an empty sequence. 
      The returned value
      is a static sequence 
      in document order.</p> 
        
        
    <p>The <span>named flow</span> states are :</p>
        
    <ul>
        <li><code class="idl">NULL</code>: the <span>named flow</span> contains no elements and has no region chain.</li>
        <li><code class="idl">CREATED</code>: the <span>named flow</span> either contains an element or has a region chain.</li>
    </ul>
        
    <p>A <code class="idl">NamedFlow</code> 
    object is live: it always represents the <span>named flow</span> with the corresponding
    name even if that <span>named flow</span> has transitioned to the <code>NULL</code> state.</p>
        
    <h3 id="the-region-interface">The Region interface</h3>

    <p>The <dfn id='region-interface'>
      <code class="idl">Region</code> 
      interface</dfn> is a 
      <a href="http://www.w3.org/TR/WebIDL/#idl-implements-statements">supplemental interface</a>
      which must be implemented by all objects 
      (<a href="http://www.w3.org/TR/dom/#interface-element">
        <code class= "idl">Elements</code></a>, 
      pseudo-elements or other CSS constructs 
      such as <a href="http://dev.w3.org/csswg/css3-page-template/#templates-and-slots">slots</a>) in an implementation which can be CSS Regions.</p>
        
        <pre class="idl">
[NoInterfaceObject]
interface <a href="#region-interface">Region</a> {
  readonly attribute DOMString <a href="#dom-region-regionoverset">regionOverset</a>;
  sequence&lt;<a href="#">Range</a>&gt;? <a href=
"#dom-region-getregionflowranges">getRegionFlowRanges()</a>;
  <a href="http://dev.w3.org/csswg/cssom/#the-cssstyledeclaration-interface">CSSStyleDeclaration</a> <a href="#dom-region-getComputedRegionStyle">getComputedRegionStyle</a>(Element elt);
  <a href="http://dev.w3.org/csswg/cssom/#the-cssstyledeclaration-interface">CSSStyleDeclaration</a> <a href="#dom-region-getComputedRegionStyle">getComputedRegionStyle</a>(Element elt, DOMString pseudoElt);
};

Element implements Region;</pre>

        <p>The <dfn id="dom-region-regionoverset"><code class=
        "idl">regionOverset</code></dfn> attribute returns one of the following
        values:</p>

        <dl>
            <dt>'overset'</dt>

            <dd>The region is the last one in the 
            <span title="region-chain">region chain</span> and
            not able to fit the remaining content from the <span>named flow</span>.
            Note that the region's <a href=
            "http://www.w3.org/TR/CSS21/visufx.html#overflow"><code class=
            "idl">overflow</code></a> property value can be used to control the
            visibility of the overflowing content and the 
            'region-fragment' property controls whether or not fragmentation happens 
            on the content that overflows the last region.</dd>

            <dt>'fit'</dt>

            <dd>The region's flow fragment content 
              fits into the region's 
              <a href="http://www.w3.org/TR/CSS21/box.html#box-dimensions">content box</a>. 
              If the region is the last one 
              in the <span title="region-chain">region chain</span>, 
              it means that the content 
              fits without overflowing.
              If the region is not the last one 
              in the region chain, 
              that means the <span>named flow</span> content 
              may be further fitted in subsequent regions. 
              In this last case, 
              note that the <span>named flow</span> fragment may be empty 
              (for example if the region is too small 
              to accommodate any content). 
              This value is returned if the <span>region</span> object 
              is not (or no longer) a region.</dd>

            <dt>'empty'</dt>

            <dd>All content from the <span>named flow</span> was fitted in prior regions.</dd>
            
        </dl>

        <p>If there is no content 
          in the <span>named flow</span>, 
          all regions associated 
          with that <span>named flow</span> 
          should have their <code class="idl">regionOverset</code> 
          attribute return 'empty'. 
          If there is content in the flow 
          but that content does not 
          generate any box for visual formatting, 
          the 'overset' attribute on the first region 
          in the region chain associated 
          with the flow will return 'fit'.</p>
                
        <p>The <dfn id="dom-region-getregionflowranges">getRegionFlowRanges</dfn> method 
          returns an array of <a href= "http://www.w3.org/TR/dom/#interface-range">Range</a> 
          instances corresponding to fragment 
          from the <span>named flow</span> 
          that is laid out in the region. 
          If the region has not received a fragment 
          because it is too small to accommodate any, 
          the method returns a single <code class="idl">Range</code> 
          where the <code>startContainer</code> 
          and <code>startOffset</code> 
          have the same values as 
          the <code>endContainer</code> 
          and <code>endOffset</code> 
          and therefore the collapsed attribute 
          on the <code class="idl">Range</code> is true. 
          In that situation, 
          if the region is the first 
          in the <span>region chain</span>, 
          the <code>startContainer</code> 
          is the first <code>Node</code> 
          in the <span>named flow</span> 
          and the <code>startOffset</code> is zero. 
          If the region is the last region 
          in the region chain 
          (but not the first and only one), 
          the <code>startContainer</code> 
          and <code>startOffset</code> 
          are the same values as 
          the <code>endContainer</code> 
          and <code>endOffset</code> 
          on the previous region 
          in the <span>region chain</span>. 
          The method returns null 
          if the <span>region</span> object 
          is not (or no longer) a region.</p>

        <p>The <dfn id="dom-region-getComputedRegionStyle">getComputedRegionStyle</dfn> 
          methods on the Region interface work the same as the 
          <a href="http://dev.w3.org/csswg/cssom/#extensions-to-the-window-interface"><code class="idl">getComputedStyle</code></a> [[!CSSOM]] 
          methods on the <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/browsers.html#window"><code class="idl">Window</code></a> 
          interface [[!HTML5]] with the following exceptions. 
          For the <code class="idl">Region</code> interface 
          the <a href="http://dev.w3.org/csswg/cssom/#the-cssstyledeclaration-interface">CSSStyleDeclaration</a> 
          returned must include the result of 
          <a href="#the-at-region-style-rule">region styling</a>. 
          If the element is fragmented across region boundaries, 
          the <a href="http://dev.w3.org/csswg/cssom/#the-cssstyledeclaration-interface">CSSStyleDeclaration</a>  returned must apply only 
          to the fragment that flows through 
          the <span>CSS Region</span>. 
          The method returns null 
          if the <span>region</span> object 
          is not (or no longer) a region.</p>

        <div class="note">
          <p>If the element is not contained 
          in the <span>CSS Region</span> at all, 
          the method returns 
          the <a href="#the-at-region-style-rule">region styling</a> 
          that would apply to the element 
          if it were contained in the <span>CSS Region</span> 
          (following how <a href="http://dev.w3.org/csswg/cssom/#extensions-to-the-window-interface"><code class="idl">getComputedStyle</code></a> works 
          with elements not contained 
          in the window's document).</p>
        </div>

        <p>A <code class="idl">Region</code> instance 
          may represent an object 
          that is no longer a <span>region</span>. 
          This may happen for example 
          if the 'flow-from' property 
          on the corresponding pseudo-element, 
          element or other construct
          becomes 'none' 
          but a script is still holding 
          a reference to the <code class="idl">Region</code> object.</p>

    <h3 id="region-style-rule-interface">The CSSRegionStyleRule interface</h3>

    <p>The <dfn id='dom-region-style-rule-interface'>
      <code class="idl">CSSRegionStyleRule</code> 
      interface</dfn> represents 
      an '@region' rule 
      in a CSS style sheet. 
      This rule type is added 
      to the <a href="http://dev.w3.org/csswg/cssom/#the-cssrule-interface"><code>CSSRule</code></a> [[!CSSOM]] interface.</p>

    <pre class="idl">
partial interface <a href="http://dev.w3.org/csswg/cssom/#the-cssrule-interface">CSSRule</a> {
  const unsigned short <a href="#region-style-rule-const">REGION_STYLE_RULE</a> = 16;
};
</pre>
    <dl>
      <dt><dfn id="region-style-rule-const">REGION_STYLE_RULE</dfn></dt>
      <dd>The rule is a CSSRegionStyleRule</dd>
    </dl>
    <pre class="idl">
interface <a href="#dom-region-style-rule-interface">CSSRegionStyleRule</a> : <a href="http://dev.w3.org/csswg/cssom/#the-cssrule-interface">CSSRule</a> {
  attribute DOMString <a href="#region-style-rule-selectorText">selectorText</a>;
  readonly attribute <a href="http://dev.w3.org/csswg/cssom/#the-cssrulelist-sequence">CSSRuleList</a> <a href="#region-style-rule-cssRules">cssRules</a>;
  unsigned long <a href="#region-style-rule-insertRule">insertRule</a>(DOMString rule,  unsigned long index)
    raises(<a href="http://www.w3.org/TR/dom/#exception-domexception">DOMException</a>);
  void <a href="#region-style-rule-deleteRule">deleteRule</a>(unsigned long index)
    raises(<a href="http://www.w3.org/TR/dom/#exception-domexception">DOMException</a>);
};
</pre>

    <p>The <dfn id="region-style-rule-selectorText">
      <code class="idl">selectorText</code></dfn> 
      attribute gets and sets 
      the associated selector 
      as defined in section <a href="http://dev.w3.org/csswg/cssom/#widl-CSSStyleRule-selectorText">6.4.3</a> of [[!CSSOM]].

    <p>The <dfn id="region-style-rule-cssRules">
      <code class="idl">cssRules</code></dfn> 
      attribute must return a 
      <a href="http://dev.w3.org/csswg/cssom/#the-cssrulelist-sequence"><code>CSSRuleList</code></a> [[!CSSOM]] 
      object for the list of 
      <a href="http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleRule"><code class="idl">CSSStyleRules</code></a> 
      specified in the region style block.</p>

    <p>The <dfn id="region-style-rule-insertRule">
      <code class="idl">insertRule(rule, index)</code></dfn> 
      method inserts a 
      <a href="http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleRule"><code class="idl">CSSStyleRule</code></a> 
      into the region style block 
      before the specified index. 
      If the index is equal to the length 
      of the <a href="http://dev.w3.org/csswg/cssom/#the-cssrulelist-sequence"><code>CSSRuleList</code></a> the 
      <a href="http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleRule"><code class="idl">CSSStyleRule</code></a> 
      is inserted at the end of the list.</p>

    <p>Possible exceptions:</p>
    <ul>
      <li><a href="http://www.w3.org/TR/dom/#dom-domexception-hierarchy_request_err"><code class="idl">HIERARCHY_REQUEST_ERR</code></a>: 
        Raised if the rule to insert is not a 
        <a href="http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleRule"><code class="idl">CSSStyleRule</code></a>.</li>
      <li><a href="http://www.w3.org/TR/dom/#dom-domexception-index_size_err"><code class="idl">INDEX_SIZE_ERR</code></a>: 
        Raised if the specified index 
        is not a valid insertion point.</li>
      <li><a href="http://www.w3.org/TR/dom/#dom-domexception-syntax_err"><code class="idl">SYNTAX_ERR</code></a>: 
        Raised if the specified rule 
        has a syntax error 
        and is unparsable.</li>
    </ul>
    <p>The <dfn id="region-style-rule-deleteRule">
      <code class="idl">deleteRule(index)</code></dfn> 
      method deletes the <a href="http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleRule"><code class="idl">CSSStyleRule</code></a> 
      in the <a href="http://dev.w3.org/csswg/cssom/#the-cssrulelist-sequence"><code>CSSRuleList</code></a> 
      at the specified index.</p>

    <p>Possible exception:</p>
    <ul>
      <li><a href="http://www.w3.org/TR/dom/#dom-domexception-index_size_err"><code class="idl">INDEX_SIZE_ERR</code></a>: 
        Raised if the specified index 
        does not correspond to a rule 
        in the region style block.</li>
    </ul>

    <h3 id="region-flow-layout-events">Region flow layout events</h3>

    <p><a href="#dom-named-flow"><code class="idl">NamedFlow</code></a> 
      objects are <a href="http://www.w3.org/TR/dom/#interface-eventtarget">EventTargets</a> 
      which dispatch <code class="idl">regionlayoutupdate</code> events 
      when there is a possible layout change 
      in their region chain. 
      The event is asynchronous, 
      and fires in the same step of the 
      <a href="http://www.w3.org/TR/html5/webappapis.html#processing-model-2">event loop</a> 
      [[!HTML5]] as when 
      <a href="http://www.w3.org/TR/2012/WD-dom-20120405/#mutation-observers">MutationObservers</a> 
      [[!DOM]] are invoked.</p> 
    <p>If region chain nesting occurs
      (the contents of a <a href="#dom-named-flow"><code class="idl">NamedFlow</code></a> 
      contains regions 
      for a different <a href="#dom-named-flow"><code class="idl">NamedFlow</code></a>)
      then the <code class="idl">regionlayoutupdate</code> event 
      for the nested region(s) 
      must be dispatched 
      before the <code class="idl">regionlayoutupdate</code> event 
      for the containing flow 
      is dispatched.</p>
    
    <table class="event-desc" border="0" summary="This table contains information about the semantics of the given event type" cellpadding="2" cellspacing="0">
                <tbody><tr class="assert must"><th>Type</th>
                <td class="eventname"><strong><code>regionlayoutupdate</code></strong></td></tr>
                <tr class="assert must"><th>Interface</th> <td><code><a href="http://www.w3.org/TR/DOM-Level-3-Events/#events-UIEvent">UIEvent</a></code> (see [[!DOM-LEVEL-3-EVENTS]])</td></tr>
                <tr class="assert must"><th>Sync / Async</th> <td>Async</td></tr>
                <tr class="assert must"><th>Bubbles</th> <td>No</td></tr>
                <tr class="assert must"><th>Target</th> <td><a href="#dom-named-flow"><code class="idl">NamedFlow</code></a></td></tr>
                <tr class="assert must"><th>Cancelable</th> <td>Yes</td></tr>
                <tr class="assert must"><th>Default action</th> <td>none</td></tr>
                <tr class="assert must"><th>Context info</th>
                  <td>
                    <ul>
                      <li><code class="attribute-name">Event.target</code>: 
                          <a href="#dom-named-flow"><code class="idl">NamedFlow</code></a> whose layout may have changed</li>
                    </ul>
                   </td>
                 </tr>
              </tbody></table>

    <h3 id="cssomview-and-regions">Clarifications on pre-existing APIs</h3>
    
    <h4 id="cssomview-getclientrects-and-getboundingclientrect"><code class="idl">getClientRects()</code> and <code>getBoundingClientRects()</code></h4>
    
    <p>The <a href="http://www.w3.org/TR/cssom-view/">CSSOM View Module</a> 
      defines how user agents compute 
      the bounding client rectangle 
      for an element (<code class="idl">getBoundingClientRect()</code>) 
      and its generated boxes (<code class="idl">getClientRects()</code>).</p>

    <p>This definition applies to 
      the (possibly) multiple boxes 
      generated for an element in a named flow 
      flowing through a region chain. 
      The <code class="idl">getClientRects()</code> method 
      returns the list of boxes generated 
      for each of the element fragments 
      laid out in different regions. 
      The <code>getBoundingClientRect()</code> method 
      operates as specified in the 
      <a href="http://www.w3.org/TR/cssom-view/">CSSOM View Module</a> 
      as well and is computed 
      from the set of rectangles 
      returned by <code class="idl">getClientRects()</code>.</p>

    <h4 id="cssomview-offset-attributes"><code class="idl">offsetTop</code>, <code class="idl">offsetLeft</code>,
        <code class="idl">offsetWidth</code> and <code class="idl">offsetWidth</code></h4>
    
    <p>The computation of the <a href="http://dev.w3.org/csswg/cssom-view/#extensions-to-the-htmlelement-interface">offset attributes</a> 
        for elements laid out in a <span>named flow</span> follow the <a href="http://dev.w3.org/csswg/cssom-view/#extensions-to-the-htmlelement-interface">specification</a> [[!CSSOM]]. For the purpose of the 
            algorithm, the <em>first CSS layout box</em> associated
            with an element laid out in a <span>named flow</span> is the box generated for the first region
            the element is laid out into.</p>
        
    <h2 id="regions-visual-formatting-details">Regions visual formatting details</h2>
    
    <p>Regions are laid out by CSS and take part in the normal box model and other layout models
        offered by CSS modules such as flexible boxes ([[CSS3-FLEXBOX]]). However, <span>regions</span>
        lay out a fragment of their <span>named flow</span> instead of laying out descendant content as happens with other 
        boxes.</p>
        
    <p>This section describes the model for laying out <span>regions</span> 
      and for laying out <span>named flow</span> content into regions. 
      The descriptions in this section are biased towards a horizontal writing mode, 
      using <span>width</span> for logical width (or measure) 
      and <span>height</span> for logical height (or extent) 
      as <a href="http://www.w3.org/TR/css3-writing-modes/#abstract-dimensions">defined</a> 
      in the CSS Writing Modes Module [[!CSS3-WRITING-MODES]]). 
      To use this model in a vertical writing mode apply the principles 
      <a href="http://www.w3.org/TR/css3-writing-modes/#vertical-layout">described</a> 
      in that specification.</p>
    
    <h3 id="regions-flow-content-box">The Region Flow Content Box (RFCB)</h3>
    
    <p>A region box lays out the following boxes:</p>
    
    <ul>
        <li>The boxes generated by its <code class="css">::before</code> and 
            <code class="css">::after</code> pseudo-elements, if any.</li>
        <li>The anonymous <dfn>region flow content box</dfn> (called <dfn>RFCB</dfn> in this document) which 
            contains the fragment of the <span>named flow</span> that the region receives.</li>
    </ul>
    
    <div class="figure">
        <img src="images/RFCB.svg" width="600px" alt="The ::before, RFCB and ::after boxes contained in the Region Box"/>
        <p class="caption">The Region Flow Content Box (RFCB)</p>
    </div>
    
    <p>Laying out a <span>region</span> box follows the same processing rules as for any other
        <a href="http://www.w3.org/TR/CSS2/visuren.html#block-boxes">block container box</a>.</p>
        
    <p>The <span>RFCB</span> is a <a href="http://www.w3.org/TR/CSS21/visuren.html#block-boxes">block container box</a>
        with a computed 'width' of 'auto' and a whose used 'height' is 
        resolved as detailed below.</p>
    
    <h4 id="rfcb-width-resolution">RFCB 'width' resolution</h4>

    <p>At various points in the visual formatting of documents containing regions, the 
        used 'width' of RFCBs and regions need to be resolved. In all cases, the resolution is done following the
      rules for <a href="http://www.w3.org/TR/CSS2/visudet.html#Computing_widths_and_margins">calculating 
            widths and margins</a> (see [[!CSS21]]). Sometimes, resolving the used 'width' value
            requires measuring the content's
            <code class="css">min-content</code> and <code class="css">max-content</code> values (as 
            <a href="http://www.w3.org/TR/css3-writing-modes/#intrinsic-sizing">defined</a> in the CSS Writing Modes Module [[!CSS3-WRITING-MODES]]). For an RFCB, <strong>these measures are 
        made on the <em>entire</em> associated <span>named flow</span> content</strong>.</p>

        <p>As a consequence, all <span>RFCBs</span> of <span>regions</span> associated with a given
            <span>named flow</span> share the 
            same <code class="css">min-content</code> and <code class="css">max-content</code> measures.</p>
            
    <p>This approach is consistent with the <a href="http://www.w3.org/TR/css3-break/#varying-size-boxes">box model for breaking</a> ([[!CSS3-BREAK]]).</p>


    <h3 id="regions-visual-formatting-steps">Regions visual formatting steps</h3>
    
    <p>Formatting documents that contain <span>named flows</span> laid out in regions is a three-step
        process:</p>
        
    <ul>
        <li><em>Step 1: RFCB <dfn>flow fragment height</dfn> resolution</em>. In this step, the heights of fragments 
            fitting in the regions' RFCBs are resolved.</li>
        <li><em>Step 2: document and regions layout</em>. In this step, the document content and regions are
            laid out. However, <span>named flow</span> content is not laid out in regions yet.</li>
        <li><em>Step 3: <span>named flow</span> layout</em>. In this step, the content of <span>named flows</span> is laid
            out in their respective <span>region chains</span>.</li>
    </ul>
    
    <div class="figure">
        <img src="images/regions-layout-three-steps.svg" width="600px" alt="visual representation of the three-step process"/>
        <p class="caption">Regions visual formatting steps</p>
    </div>
        
    
    <h4 id="rfcb-flow-fragment-height-resolution">Step 1: RFCB flow fragment height resolution</h4>

    <p>Conceptually, resolving the flow fragment height is a two phase process.</p>
        
    <h5 id="rfcb-flow-fragment-height-resolution-phase-1">RFCB flow fragment height resolution, Phase 1</h5>
    
    <p>The document is laid out with a 
        <a href="http://www.w3.org/TR/CSS2/cascade.html#used-value">used</a> height of zero
        for all <span>RFCB</span>s. In this phase, the content of <span>named flows</span> is not laid out in 
        <span>regions</span>. This phase yields resolved position and sizes for all regions and
        their RFCBs in the document.</p>
        
    <h5 id="rfcb-flow-fragment-height-resolution-phase-2">RFCB flow fragment height resolution, Phase 2</h5>
    
    <p><span>Named flows</span> are laid out in <span>regions</span>. The 
        user agent resolves the <em><span>flow fragment height</span></em> for
        the <span>RFCB</span>s using the remainder of the flow and accounting for 
        <a href="http://www.w3.org/TR/css3-break/">fragmentation rules</a>.
        This process accounts for constraints such as the 'height' or 'max-height' values, as described
        in the CSS 2.1 section on 
        <a href="http://www.w3.org/TR/CSS2/visudet.html#Computing_heights_and_margins">calculating heights 
            and margins</a> (see the <a href="http://www.w3.org/TR/CSS2/visudet.html#normal-block">Block-level 
                non-replaced elements in normal flow when 'overflow' computes to 'visible'</a> section and the
        <a href="http://www.w3.org/TR/CSS2/visudet.html#block-root-margin">complicated cases</a> section). 
        During this phase, generated content is laid out according to the 
        <a href="#processing-model">rules</a> described earlier in this document.
        </p>
        
    <h4 id="regions-boxes-layout">Step 2: region boxes layout</h4>
    
    <p>In this step, the document is laid out according to the normal CSS layout rules.</p>
    
    <p>If a measure of the content is required to resolve the used 'width' of the region box, the value 
        is resolved as described in the
        <a href="#rfcb-width-resolution">RFCB width resolution</a> section.</p>
        
    <p>If a measure of the content
        is required to resolve the used height of the RFCB (for example if the region box is absolutely positioned), 
        the <span>flow fragment height</span> resolved in Step 1 is used for the vertical content measure of the 
        RFCB.</p>
        
    <p>At the end of this step, regions are laid out and ready to receive
    content from their associated <span>named flows</span>.</p>
          
    <h4 id="named-flows-layout">Step 3: named flows layout</h4>
    
    <p>In this final step, the content of <span>named flows</span> is laid out in the <span>regions</span>' RFCBs
        along with the generated content boxes.</p>
        
    <p>The used 'width' for RFCBs is resolved <a href="#rfcb-width-resolution">as described before</a>.</p>
    
    <p>The used 'height' of RFCBs is resolved such that none of the boxes in the region box's normal flow 
        overflow the region's box. In other words, the RFCB boxes are stretched vertically
        to accommodate as much of the flow as possible without overflowing the region box and
        accounting for <a href="http://www.w3.org/TR/css3-break/">fragmentation rules</a> and 
        generated content boxes.</p>
        
    <p>During this phase, generated content is laid out according to the 
        <a href="#processing-model">rules</a> 
        described earlier in this document.</p>
        
    <div class="note">
        <p>The model for resolving auto sized regions will cause, under certain circumstances,
            the flow content to be overset or underset. In other words, it will not fit tightly.
            The model prevents having circular dependencies in the layout model. Implementations
            may decide to apply further layout steps to ensure that the whole flow content is 
            displayed to the user, even in edge cases.</p>
    </div>
        
    <h3 id="regions-visual-formatting-implementation-note">Regions visual formatting: implementation note</h3>
    
    <p>The process for resolving an RFCB's 'height' and the three-step process used to
        lay out documents containing regions and <span>named flows</span> are
        <em>conceptual</em> descriptions of what the layout 
        should yield and implementations should optimize to reduce the number of
        steps and phases necessary wherever possible.</p>
        
    <h3 id="regions-visual-formatting-examples">Regions visual formatting example</h3>
    
    <p>This section is non-normative.</p>
    
    <p>This example considers a document where content flows between three regions,
        and region boxes are intermixed with the normal document content.</p>
        
    <div class="example">
        <pre>
&lt;body is="x-formatting-example"&gt;
    &lt;article&gt;
        &lt;p style="break-after:region;"&gt;I am not a ... &lt;/p&gt;
        &lt;p&gt;...&lt;/p&gt;
    &lt;/article&gt;

    &lt;div id="main-flow"&gt;
        &lt;p&gt;Lorem ipsum dolor ...&lt;/p&gt;
    &lt;/div&gt;
&lt;/body&gt;

&lt;element name="x-formatting-example" extends="body"&gt;
  &lt;template&gt;
    &lt;style&gt;
      article {
          flow-into: article;
      }

      #rA, #rB, #rC {
          flow-from: article;
          height: auto;

          margin: 1em 1em 0em 1em;
          padding: 1em;
          border: 3px solid #46A4E9;
      }

      #rA {
          width: auto;
      }

      #rB {
          float: left;
          width: 15em;
          max-height: 150px;
      }

      #rC {
          float: right;
          width: 12em;
      }

      #main-flow {
          padding: 0em 1em 0em 1em;
      }
    &lt;/style&gt;

    &lt;div id="rA"&gt;&lt;/div&gt;
    &lt;div id="rB"&gt;&lt;/div&gt;
    &lt;div id="rC"&gt;&lt;/div&gt;
    &lt;content&gt;&lt;/content&gt;
  &lt;/template&gt;
&lt;/element&gt;        
        </pre>
    </div>
    
    <p>The following sections and figures illustrate the intermediate results for the visual formatting process.
        In the following, we call RFCB-A, RFCB-B and RFCB-C the <span>RFCBs</span> for 
        regions rA, rB and rC respectively. </p>
    
    <h4>Step 1 - Phase 1: Laying out RFCBs with used height of zero</h4>
    
    <p>Applying the rules for Step 1, Phase 1, the computed 'auto' 'width' values for the RFCBs are resolved
        to used values according to the normal 
        <a href="http://www.w3.org/TR/CSS2/visudet.html#Computing_widths_and_margins">CSS layout rules</a> meaning they
        stretch to the width of their containing block's content box.</p>
    
    <ol>
        <li>RFCB-A: stretches to fit the rA content box.
            <p>Since rA also has an 'auto' 'width', its own used 'width' is stretched to fit the 
            <code>&lt;body&gt;</code> content box.</p></li>
        <li>RFCB-B: stretches to fit the <code>rB</code> content box.</li>
        <li>RFCB-C: stretches to fit the <code>rC</code> content box.</li>
    </ol>
    
    <p>Also applying the rules for Step 1, Phase 1, the used values for the RFCBs 'height' properties are all zero.</p>
    
    <p>Conceptually, this produces the layout illustrated below.</p>
    
    <div class="figure">
        <img src="images/flow-fragment-height-phase-1.png" width="500px" alt="Step 1 - Phase 1: Layout RFCBs with used heights of 0"/>
        <p class="caption">Step 1 - Phase 1: Layout RFCBs with used heights of 0</p>
    </div>

    <h4>Step 1 - Phase 2: Layout flow to compute the RFCBs' flow fragments heights</h4>
    
    <p>In this second phase of Step 1, the named flow is laid out in <span>regions</span> 
        and the height of each fragment falling in each RFCB is computed.</p>
        
    <p>The user agent lays out as much of the flow into an area
        with RFCB-A's used 'width'. rA's 'height' computes to 'auto' and there is no vertical maximum
        height for RFCA's 'height'. However, because there is a break after the 
        first paragraph in the 'article' <code>named flow</code>, only this first paragraph is 
        laid out in RFCB-A and FH-A (the flow fragment height for RFCB-A) is resolved by laying out 
        this first paragraph in the used 'width'.</p>
        
    <p>At this point, the user agent lays out as much of the remaining flow as possible in RFCB-B.
        Because rB's 'max-height' computed value is '150px', the user agent only lays out
        the 'article' named flow using RFCB-B's used 'width' until the point where 
        laying out additional content would cause RFCB-B to overflow rB's box.
        The fragment height for RFCB-B is resolved: FH-B (<code class="css">150px</code>).</p>
        
    <p>Finally, the user agent lays out the remainder of the flow in RFCB-C.
        Because rC has no other constraints and no region breaks, the remaining content is
        laid out in RFCB-C's used 'width'. This results in a resolved flow fragment height: FH-C.</p>
        
    <div class="figure">
        <img src="images/flow-fragment-height-phase-2.png" width="370px" alt="Step 1 - Phase 2: Measure flow fragments heights"/>
        <p class="caption">Step 1 - Phase 2: Measure flow fragments heights</p>
    </div>
    
    <h4>Step 2: Layout document and regions without named flows</h4>
    
    <p>The used 'width' of RFCB-A, RFCB-B and RFCB-C are resolved as in the previous step. However, the
        'height' is resolved differently.</p>
        
    <p>Resolving the 'height' of rA <a href="http://www.w3.org/TR/CSS2/visudet.html#normal-block">requires a content measure</a>
        which is FH-A (the flow fragment height for RFCB-A).</p>
        
    <p>The 'height' of rB results from first computing its 
        <a href="http://www.w3.org/TR/CSS2/visudet.html#block-root-margin">content measure</a> and then applying the 
        <a href="http://www.w3.org/TR/CSS2/visudet.html#min-max-heights">rules for 'max-height'</a>. Here, the 
            vertical content measure evaluates to FH-B. After applying the 
            rules for 'max-height' and accounting for margins, padding and borders, the used 'height' of rB 
            is resolved to LH-B (<code class="css">150px</code>).</p>
    
    <p>The 'height' of rC's box results from 
        <a href="http://www.w3.org/TR/CSS2/visudet.html#block-root-margin">calculating 
            its content measure</a>: FH-C becomes rC's used 'height'.</p>
        
    <div class="figure">
        <img src="images/regions-visual-formatting-step-2.png" width="370px" alt="Step 2: Layout document and regions without named flows"/>
        <p class="caption">Step 2: Layout document and regions without <span>named flows</span></p>
    </div>
    
    <h4>Step 3: named flows layout</h4>
    
    <p>In this final step, the <code class="css">article</code> <span>named flow</span> is laid out in its
        <span>region chain</span>. The used 'width' for each of the RFCB is resolved as in step 1 above.</p>
        
    <p>The used 'height' for the RFCB is a result of laying out the as much of the content in the 
        <span>region</span> without overflowing its content box and following the 
        <a href="http://www.w3.org/TR/css3-break/">fragmentation rules</a>.</p>
        
    <p>Because the computed 'width' of the RFCB has not changed and the fragmentation rules applied are
        the same as in Phase 1, Step 2, the used 'height' for RFCB-A, RFCB-B and RFCB-C are 
        LH-A, LH-B and LH-C, respectively.</p>
        
    <p>There may be situations where the used 'height' of RFCBs resolved in Step 3 are different from the 
        <span>flow fragment height</span> computed in Step 1 Phase 2.</p>
        
    <div class="figure">
        <img src="images/regions-visual-formatting-step-3.png" width="370px" alt="Step 3: Final result after laying out named flows in regions"/>
        <p class="caption">Step 3: Final result after laying out named flows in regions</p>
    </div>
    
    
    <h2 id="relation-to-document-events">Relation to document events</h2>

    <p>The CSS regions module does not alter the normal processing of
    events in the document tree. In particular, if an event occurs on an
    element that is part of a <span>named flow</span>, the <a href=
    "http://www.w3.org/TR/dom/#events">event's
    bubble and capture phases</a> happen following the document tree order.</p>

    <div class="issue-marker" data-bug_id="21132" data-bug_status="ASSIGNED">
      <a href=
      "https://www.w3.org/Bugs/Public/show_bug.cgi?id=21132">Issue-21132</a>

      <div class="issue-details">
          <p class="short-desc">Regions need a way to respond to events in their content fragment</p>
      </div>
    </div>
    
    <h2 id="relation-to-other-specifications">Relation to other
    specifications</h2>

    <p>This specification is related to other specifications as described in
    the <a href='#references'>references</a> section. In addition, it is
    related to the following specifications:</p>

    <ol>
        <li>CSS Fragmentation Module Level 3 [[CSS3-BREAK]]. This module defines the
            rules for fragmenting content over multiple containers and applies to 
            CSS regions in addition to applying to multi-column and paged media.</li>
            
        <li>CSS Pagination Templates Module Level 3 [[CSS3-PAGE-TEMPLATE]]. This module
            defines a syntax to define layout templates which can be used
            when paginating content. The page templates use regions.</li>
            
        <li>CSS Exclusions Module [[CSS3-EXCLUSIONS]]. This module defines a
        generic way to define arbitrarily shaped exclusions into which content
        can flow or around which content can flow. This can be seen as an
        extension to the way CSS floats provide rectangular areas into which
        content flows and around which content flows. In advanced layout
        designs, it is expected that the CSS Exclusions module will be commonly
        combined with the CSS regions module.</li>

        <li>CSS Line Grid Module [[CSS3-LINE-GRID]]. This module defines a
        concept of line grid to align the position of lines in different
        elements. The line grid functionality is related and needed for
        aligning content flowing in separate regions.</li>
    </ol>
    
    <h2 id="usecases">Use Cases</h2>
    
    <p>Use cases are described on 
      <a href="http://wiki.csswg.org/spec/css3-regions/regions-use-cases">these</a> 
      <a href="http://wiki.csswg.org/spec/css3-regions/regions-print-use-cases">pages</a>.</p>

    <h2 id="conformance">Conformance</h2>
    
    <h2 id="changes">Changes</h2>

    <h3 id="changes_from_Aug_28_2012">Changes from <a href="http://www.w3.org/TR/2012/WD-css3-regions-20120823/">August 28<sup>th</sup> 2012</a> version</h3>

    <ul>
      <li>Removed implication of DOM manipulation</li>
      <li>Changed Appendix A to use custom element layout.</li>
      <li>Noted change in pseudo-element generation with flow-from.</li>
      <li>Changed case of regionlayoutupdate to match other events in [[DOM-LEVEL-3-EVENTS]].</li>
      <li>Added section on fragmenting the fragmenters.</li>
      <li>Added section on handling circular flow-from and flow-into situations.</li>
      <li>Added alignment and justification to region styling properties.</li>
      <li>Added timing for regionLayoutUpdate event.</li>
      <li>Clarified interaction between content and flow-from for pseudo-elements.</li>
      <li>Changed NamedFlowCollection getters to return undefined when there is no NamedFlow.</li>
      <li>Changed region-overflow property to region-fragment.</li>
    </ul>

    <h3 id="changes_from_May_03_2012">Changes from <a href="http://www.w3.org/TR/2012/WD-css3-regions-20120503/">May 3<sup>rd</sup> 2012</a> version</h3>

    <ul>
      <li>Removed exceptions from the Region interface.</li>
      <li>Changed NamedFlowCollection from live to a static snapshot.</li>
      <li>Changed NamedFlow to inherit from EventTarget.</li>
      <li>Removed flowFrom from Region interface and changed method name to getComputedRegionStyle().</li>
      <li>Region interface is now a supplemental interface with the [NoInterfaceObject] extended attribute.</li>
      <li>Added note for regionLayoutUpdate dispatching in nested flows.</li>
      <li>Removed Document.getFlowByName() in favor of NamedFlowCollection.namedItem().</li>
      <li>Changed to overset:false for NULL NamedFlow.</li>
      <li>Changed regionLayoutUpdate to not bubble.</li>
    </ul>

    <h3 id="changes_from_November_29_2011">Changes from <a href="http://www.w3.org/TR/2011/WD-css3-regions-20111129/">November 29<sup>th</sup> 2011</a> version</h3>
    
    <ul>
        <li>Modified region styling examples to use element selector instead of of pseudo-code selectors (this had been omitted in the 
            previous pass at removing pseudo-code from the examples).</li>
        <li>Removed divs with class set to "issue moved", "issue stale" and "issue resolved" since these divs where not displayed.
        <li>Minor updates to the alternate stylesheet.</li>
        <li>Removed "This section is normative" paragraphs since in CSS specifications, sections are normative unless 
            otherwise specified.</li>
        <li>Removed "This section is informative" paragraphs since in CSS specifications notes are always informative.</li>
        <li>Reworded the text about flow-into: &lt;ident&gt; and removed obsolete text about the interaction with the
            'content' property.</li>
        <li>Removed "this section is non-normative" from the "Regions Concepts" section.</li>
        <li>In the section on region breaks, removed descriptions of break values normatively defined in external specifications.
            Removed the section about split boxes and replaced with paragraph referencing the page breaking behavior.
            Removed the discussion about how the 'overflow' property applies to content flown in regions from the 
            break section, since this is covered in the section on 'region-overflow' already. See <a href="http://lists.w3.org/Archives/Public/www-style/2011Dec/0477.html">mailing list feedback.</a></li>
        <li>Clarified that @region style rules only apply to the 'portion' of an element that falls into 
            the corresponding region and added an issue that the model for 'partial' styling needs to 
            be defined. See <a href="http://lists.w3.org/Archives/Public/www-style/2011Dec/0480.html">mailing list feedback</a>.</li>
        <li>Clarified that the <code>NodeList</code> returned by <code>getRegionsByContentNode</code> is live.</li>
        <li>Added a name property to the <code>NamedFlow</code> interface. Added a <code>NamedFlowCollection</code>
            interface and added a <code>getNamedFlows</code> method on the <code>Document</code> interface, as
            per <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=15828">Bug 15828</a>.</li>
        <li>Modified wording about containing block resolution for absolutely positioned elements in a 
            named flow.</li>
        <li>Modified initial examples as per <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=15131">Bug 15131</a></li>
        <li>Multiple editorial changes following 
            <a href="http://lists.w3.org/Archives/Public/www-style/2012Feb/0001.html">mailing list review comments</a></li>
        <li>Fixed DOM references to now point to the DOM TR</li>
        <li>Fixed Web IDL issues as reported in <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=15931">Issue 15931</a></li>
        <li>Added text to explain support for multi-column elements as required by <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=15191">Issue 15191</a> and <a href="http://www.w3.org/Style/CSS/Tracker/actions/375">Action 375</a>.</li>
        <li>Renamed 'regionOverflow' to 'regionOverset' to avoid confusion between fitting a flow in 
            regions and the concept of visual overflow that the word 'overflow' (and the property) carry.</li>
        <li>Reworked the partial document interface following the <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=14948">Issue 14948</a> on <code>getFlowByName</code>.</li>
        <li>Updated the object model section as proposed on the <a href="http://wiki.csswg.org/spec/css3-regions/css-om">wiki</a> and in particular:
            <ul>
                <li>introduced a <code>Region</code> interface to replace the supplemental Element interface</li>
                <li>Added a 'flowFrom' attribute on the Region interface</li>
                <li>NamedFlow.getRegions() was added</li>
                <li>Renamed getContentNode to getContent and getRegionsByContentNode to getRegionsByContent as 
                    per <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=15879">Isseu 15879</a></li>
                <li>NamedFlow now returns static lists (see <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=16286">Issue 16286</a>)</li>
                
            </ul>
        </li>
        <li>Modified region layout event to be dispatched on <code>NamedFlow</code> instead of region 
            as before. Was requested by <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=15938">Issue 15938</a>
            and required in the general effort to have the DOM APIs work with non-element regions.</li>
        <li>Changed paragraph on pseudo-elements to disallow 'flow-into' on all pseudo-elements because 
            moving a '::before' element (for a example) to a named flow does not seem useful and causes specification
            and implementation complexity.</li>
        <li>Added section about getClientRects(), getBoundingClientRect(), offsetWidth, offsetHeight, offsetTop and
            offsetLeft.</li>
        <li>Added 'Regions visual formatting details' section to better describe the model for 
            resolving auto sizing on regions.</li>
        <li>Reworked the initial specification example.</li>
        <li>Changed break and region-overflow properties to apply to visual media instead of paged.</li>
        <li>Added opacity to region styling.</li>
        <li>Added possibility of ::before content contributing to overflow.</li>
        <li>Added CSSRegionStyleRule</li>
    </ul>
    

    <h3 id="changes_from_June_09_2011">Changes from <a href="http://www.w3.org/TR/2011/WD-css3-regions-20110609/">June 09<sup>th</sup> 2011</a> version</h3>
    
    <ul>
        <li>Editorial changes (typos, rephrasings).</li>
        <li>Made 'content-order' a &lt;integer&gt; and not a &lt;float&gt; following a working group
            <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0329.html">resolution</a></li>
        <li>Added Alex Mogilevsky as an editor</li>
        <li>Flow names became &lt;ident&gt; instead of &lt;string&gt; following a working group
            <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0413.html">resolution</a></li>
        <li>Removed issue about possibly altering the DOM Events model for region events following
            a working group
            <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0413.html">resolution</a></li>
        <li>Made the "relation to document events" section informative following a     working group
            <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0413.html">resolution</a></li>
        <li>Removed issue in section "The NamedFlow interface" following the working group's 
            <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0413.html">resolution</a> to
            have both NamedFlow and the Element interface extension</li>
        <li>Following a working group <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0413.html">resolution</a>:
        	<ul>
            	<li>Turned the first issue in the "Extensions to the Element interface" into a note 
            explaining that the NamedFlow interface can be used when regions are pseudo-elements.</li>
            	<li>Added NamedFlowUpdate</li>
                </ul>
        </li>
        <li>Excluded 'none', 'inherit' and 'initial' from the possible identifier names on 
        	the flow property following <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0583.html">discussion</a> on the mailing list.</li>
        <li>Simplified integration discussion on multi-column layout and just state that since
        column boxes are not addressable by selectors, they cannot be regions.</li>
        <li>Added specification of how the 'flow-into' property interacts with object, embed and iframe 
        elements.</li>
        <li>Excluded 'default' from the possible identifier names on the flow property because it 
            <a href="http://www.w3.org/TR/2006/WD-css3-values-20060919/#keywords">may get reserved</a>.</li>
        <li>Added to the definition of 'auto' on 'region-overflow' specifying that region breaks must
            be ignored.</li>
        <li>Renamed 'Document.flowWithName' to 'Document.getFlowByName' since it is not a property.</li>
        <li>Added a note that a 'NamedFlow' instance is live.</li>
        <li>Added an 'undefined' string value to the regionOverflow property on the Element interface 
            extension.</li>
        <li>Renamed NamedFlowEvent to regionLayoutUpdate to avoid having 'Event' in the event name.</li>
		<li>Added description for special behavior of iframe/object/embed as 
		flow source</li>
		<li>Removed issue on copying content to a named flow instead of moving elements to named
		    flow following working group <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">resolution</a>.</li>
    	<li>Removed issue on content:flow-from v.s., flow-from property following working group <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">resolution</a>.</li>
    	<li>Renamed 'flow' to 'flow-into' following working group <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">resolution</a>.</li>
    	<li>Updated the css3-grid-align example following working group <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">resolution</a> that 
    	    it should use &lt;div&gt; instead of grid-cell pseudo elements that were removed
    	    from the CSS Grid Layout specification.</li>
        <li>Renamed 'from-flow' to 'flow-from' following a working group <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">resolution</a>.</li>
        <li>Limited the applicability of 'content: flow-from()' to block container box and added
            a note that this might be expanded in the future, following a working group <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0069.html">resolution</a>.</li>
        <li>Removed issue about API to find which region displays an element in a named flow
            since <a href="http://www.w3.org/Style/CSS/Tracker/actions/350">ACTION-350</a> was
            created to add this API.</li>
        <li>In the 'flow' property description, removed the required wrapper anonymous 
            block as agreed on <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0161.html">mailing list discussion</a>.</li>
        <li>Reworded the paragraph on how regions create a new stacking context, as 
            per the <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0025.html">mailing list discussion</a>.</li>
        <li>Reworked the "CSS regions Model" section to now be "CSS regions Layout". Moved the
            definition of a region as the first sub-section.</li>
        <li>Removed the "Visual Formatting Model and Flows" section to match the new Regions Model 
            (now CSS regions Layout) section.</li>
        <li>Moved the sections on allowed region breaks, forced region breaks and "best" regions
            breaks to follow the property definitions to follow the formatting of the paged
            media section in CSS 2.1.</li>
        <li>Added note about why regions create a new stacking context following the discussion
            on the <a href="http://lists.w3.org/Archives/Public/www-style/2011Jul/0158.html">mailing list</a>.</li>
        <li>Removed sentence about content:none making elements disconnected following the 
                discussion on the <a href="http://lists.w3.org/Archives/Public/www-style/2011Jul/0158.html">mailing list</a>.</li>
        <li>Removed sentence about content:none making elements disconnected following the 
                    discussion on the <a href="http://lists.w3.org/Archives/Public/www-style/2011Jul/0158.html">mailing list</a>.</li>
        <li>Added the ::region-before and a ::region-after pseudo-elements.</li>
        <li>Added note of caution when using selectors and the 'flow-into' property following
            a <a href="http://lists.w3.org/Archives/Public/www-style/2011Jul/0191.html">mailing list discussion</a>.</li>
        <li>Removed sections about allowed, forced and best region breaks to align with the 
            multi-column specification approach and until the group agrees on where and how the
            general issue of breaks (regions/pages/columns) should be addressed.</li>
        <li>Removed the section on Integration with other specifications since specifications that
            was superfluous especially since there is no specific integration with multi column,
            grid or template layout.</li>
        <li>Added a note that regions establish a new block formatting context.</li>
        <li>Renamed content-order to region-order.</li>
        <li>Added a note about overflowing content in regions (e.g., for content with borders).</li>
        <li>Added a note that a region cannot layout content it is part of (to avoid creating a 
            circular dependency) in the flow-from description, specifying that if flow-from
            references the flow an element is part of, then the element does not format 
            anything visually.</li>
        <li>Replaced 'content:flow-from(&lt;ident&gt;)' with 'flow-from: &lt;ident&gt;' following a
            <a href="http://krijnhoetmer.nl/irc-logs/css/20110824">working group resolution</a>.</li>
        <li>Added more specific wording about auto width and auto height, following
            <a href="http://www.w3.org/Style/CSS/Tracker/actions/351">ACTION 351</a>.</li>
        <li>Reworked section on region markers to now use '::before' and '::after' and explain
            how 'display:run-in' works with regions.</li>
        <li>Modified the @region style rule to remove the ::region-lines pseudo-selector.</li>
        <li>Removed the 'region-order' property following implementation feedback.</li>
        <li>Specified that region-overflow does not influence a region's size.</li>
        <li>Specified that the flow's writing mode is defined by the first region's writing mode 
            following <a href="http://lists.w3.org/Archives/Public/www-style/2011Aug/0306.html">mailing list discussion</a>.</li>
        <li>Made iframe, object and embed support of flow-into optional following 
            <a href="http://lists.w3.org/Archives/Public/www-style/2011Sep/0073.html">mailing list discussion</a>.</li>
        <li>Clarified that flow content following the last break in the last region is not rendered,
            following <a href="http://lists.w3.org/Archives/Public/www-style/2011Oct/0167.html">mailing list
                discussions.</a></li>
        <li>Modified the rule for computing the width and height of a region when they are set to auto,
            following <a href="http://lists.w3.org/Archives/Public/www-style/2011Oct/0216.html">a mailing list 
                discussion.</a></li>
        <li>Added 'auto' to the list of invalid flow identifiers.</li>
        <li>Made 'none' the initial value for 'flow-into' and aligned with 'flow-from', as 
            explained in this <a href="http://lists.w3.org/Archives/Public/www-style/2011Oct/0576.html">email</a>.
            Also allowed the 'inherit' value on 'flow-from' and 'flow-into' (same email).</li>
        <li>Added note about nested region styling following <a href="http://lists.w3.org/Archives/Public/www-style/2011Oct/0650.html">a mailing list discussion</a>.</li>
        <li>Added additional DOM interface following <a href="http://www.w3.org/Style/CSS/Tracker/actions/350">Action 350</a>.</li>
        <li>Clarified that a region becomes a region only if its 'content' property computes to 
            normal, following the resolution of <a href="http://wiki.csswg.org/spec/css3-regions#issue-22content-vs-flow-from-precedence">Issue 22</a>.</li>
        <li>Removed text about special iframe behavior as a result of 
            <a href="http://www.w3.org/Style/CSS/Tracker/actions/376">ACTION 376</a>.</li>
        <li>Made the selectors explicit in the initial section code examples, following
            discussion in <a href="http://krijnhoetmer.nl/irc-logs/css/20111030">San Jose, October 2011</a> face to face meeting.</li>
        <li>Added section on use cases following <a href="http://www.w3.org/Style/CSS/Tracker/actions/377">ACTION-377</a>.</li>
    </ul>
    
    <h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

    <p>The editors are grateful to the CSS working group for their feedback and help with 
        the genesis of this specification.</p>
        
    <p>In addition, the editors would like to thank the following individuals for their contributions,
        either during the conception of CSS regions or during its development and specification review
        process:</p>
    <p>Rossen Atanassov, 
      Tab Atkins, 
      Mihai Balan, 
      Andrei Bucur, 
      Razvan Caliman, 
      Alexandru Chiculita, 
      Phil Cupp, 
      Arron Eicholz, 
      John Jansen, 
      Dimitri Glazkov, 
      Daniel Glazman, 
      Arno Gourdol, 
      David Hyatt, 
      Brian Heuston, 
      Ian Hickson, 
      Jonathan Hoersch, 
      Michael Jolson, 
      Brad Kemper, 
      Håkon Wium Lie, 
      Kang-Hao (Kenny) Lu, 
      Mihai Maerean, 
      Markus Mielke, 
      Robert O'Callahan, 
      Edward O'Connor, 
      Mihnea Ovidenie, 
      Virgil Palanciuc, 
      Olga Popiv, 
      Christoph Päper, 
      Anton Prowse, 
      Peter Sorotokin, 
      Elliott Sprehn, 
      Christian Stockwell, 
      Eugene Veselov, 
      Boris Zbarsky,  
      Stephen Zilles 
      and the CSS Working Group members.
    </p>

    <h2 id="intro-example-code" class="no-num">Appendix A. Example Code for Introduction</h2>
      <p>The following is one possible way 
        to code the example from 
        the <a href="#introduction">introduction</a>.
        This code uses grid cells in a custom element 
        to define, size and position the region areas 
        but table layout, absolute positioning, 
        or any other CSS layout facility could be used.</p>

    <div class="example"><pre>

&lt;head&gt;
    &lt;title&gt;Regions Intro Example&lt;/title&gt;
    &lt;link rel="components" href="x-fancy-layout.html"&gt;
&lt;/head&gt;

<span class="highlight">&lt;!-- 
     The body element is extended with the 
     layout template from the link above.
--&gt;</span>
&lt;body is="x-fancy-layout"&gt;

<span class="highlight">&lt;!-- 
     The article element is the content to flow 
     through the region chain defined in the 
     layout template. All the presentation 
     is confined to the layout template file.
--&gt;</span>
  &lt;article&gt;
    &lt;h1&gt;Introduction&lt;/h1&gt;
    &lt;p&gt;This is an example ...&lt;/p&gt;
      
    &lt;h2&gt;More Details&lt;/h2&gt;
    &lt;p&gt;This illustrates ...&lt;/p&gt;
    &lt;p&gt;Then, the example ...&lt;/p&gt;
    &lt;p&gt;Finally, this ...&lt;/p&gt;
  &lt;/article&gt;
  &lt;div id="boxA"&gt;&lt;/div&gt;
&lt;/body&gt;

<span class="highlight">&lt;!--
     In a separate file, we lay out the regions with a grid 
     inside a custom element template from Web Components.
--&gt;</span>

&lt;element name="x-fancy-layout" extends="body"&gt;
  &lt;template&gt;
    &lt;style&gt;
      #grid {
        width: 80vw;
        height: 60vw;
        grid-template: "aaa.d"
                       "....d"
                       "bbb.d"
                       "....d"
                       "ccc.d";
        grid-rows: 52% 4% 20% 4% 20%;
        grid-columns: 30% 5% 30% 5% 30%;
      }
      #region1 { grid-cell: a; }
      #region2 { grid-cell: b; }
      #boxA    { grid-cell: c; }
      #region3 { grid-cell: d; }
      
      #region4 {
        width: 80vw;
      }
      
      #region2 {
        column-count: 2;
      }
      
      <span class="highlight">/*
       * Creates the named flow 
       */</span>
      article {
        <strong>flow-into: article-flow;</strong>
      }

      <span class="highlight">/*
       * Associate it with the intended CSS Regions. 
       * This creates a region chain for the named flow.
       */</span>
      #region1, #region2, #region3, #region4 {
        <strong>flow-from: article-flow;</strong>
      }
    &lt;/style&gt;
    &lt;div id="grid"&gt;
      &lt;div id="region1"&gt;&lt;/div&gt;
      &lt;div id="region2"&gt;&lt;/div&gt;
      &lt;content&gt;&lt;/content&gt;
      &lt;div id="region3"&gt;&lt;/div&gt;
    &lt;/div&gt;
    &lt;div id="region4"&gt;&lt;/div&gt;
  &lt;/template&gt;
&lt;/element&gt;
    </pre></div>



    <div class="note"><span class="note-prefix">Note </span>
      <p>A multi-column element is used for #region2, 
        which is a bit gratuitous here 
        (because grid cells could be used). 
        The reason to use a multi-column element  
        is to illustrate that 
        regions can be multi-column.</p>
      <p>Similarly, the last region breaks out  
        of the grid in this example merely to show that 
        regions in a region chain do not need to 
        share a single parent.
    </div>


    <h2 class="no-num" id="references">References</h2>

    <h3 class="no-num" id="normative-references">Normative references</h3>
    <!--begin-normative--><!--end-normative-->

    <h3 class="no-num" id="other-references">Other references</h3>
    <!--begin-informative--><!--end-informative-->

    <h2 class="no-num" id="index">Index</h2>
    <!--index-->

    <h2 class="no-num" id="property-index">Property index</h2>
    <!-- properties -->
    
    <!-- template markup for issues pulled from Bugzilla -->    <!-- template markup for issues pulled from Bugzilla -->
<!--
    <script type="text/template" id="issue-template">
    <div class="issue-marker" data-bug_id="{{bug_id}}" data-bug_status="{{bug_status}}">
        <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id={{bug_id}}">Issue-{{bug_id}}</a>
        <div class="issue-details">
            <p class="short-desc">{{short_desc}}</p>
        </div>  
    </div>
    </script>   

    <script type="text/javascript" src="../shared/scripts/BugzillaTrackerUtil.js"></script>
    <script type="text/javascript" src="../shared/scripts/BugzillaTracker.js"></script>
    <script type="text/javascript">
        checkSpecificationIssues('CSS', 'Regions');        
    </script>
-->

</body>
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
 
