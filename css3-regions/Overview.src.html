<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html dir="ltr" lang="en">
<head profile="http://www.w3.org/2006/03/hcard">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <title>CSS Regions Module</title>
    <link href="http://dev.w3.org/csswg/default.css" rel="stylesheet" type=
    "text/css">
    <link href="http://www.w3.org/StyleSheets/TR/W3C-ED.css" rel="Stylesheet"
    type="text/css">
    <link id="st" href="alternate-spec-style.css" rel="stylesheet" type=
    "text/css" title="additional spec styles">
    <script type="text/javascript" src="style-toggle.js">
</script>
</head>

<body>
    <div class="head" id="div-head">
        <!--begin-logo-->

        <p><a href="http://www.w3.org/"><img alt="W3C" height="48" src=
        "http://www.w3.org/Icons/w3c_home" width="72"></a> <!--end-logo--></p>

        <h1>CSS Regions Module</h1>

        <h2 class="no-num no-toc" id="longstatus-date">Editor's Draft
        [DATE]</h2>

        <dl>
            <dt>This version:</dt>

            <dd><a href=
            "[VERSION]">http://www.w3.org/csswg/css3-regions</a></dd>

            <dt>Latest version:</dt>

            <dd><a href=
            "http://www.w3.org/TR/css3-regions">http://www.w3.org/csswg/css3-regions</a></dd>

            <dt>Previous version:</dt>

            <dd>none</dd>

            <dt>Editors:</dt>

            <dd class="vcard"><span class="fn">Vincent Hardy</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">vhardy@adobe.com</span></dd>

            <dt>Authors and Former Editors:</dt>

            <dd class="vcard"><span class="fn">Stephen Zilles</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">szilles@adobe.com</span></dd>

            <dd class="vcard"><span class="fn">Alexandru Chiculita</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">achicu@adobe.com</span></dd>

            <dd class="vcard"><span class="fn">Andrei Bucur</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">abucur@adobe.com</span></dd>

            <dd class="vcard"><span class="fn">Mihnea Ovidenie</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">mihnea@adobe.com</span></dd>

            <dd class="vcard"><span class="fn">Peter Sorotokin</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">psorotok@adobe.com</span></dd>

            <dd class="vcard"><span class="fn">Virgil Palanciuc</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">virgilp@adobe.com</span></dd>

            <dd class="vcard"><span class="fn">Arno Gourdol</span>,
            <span class="org">Adobe Systems, Inc.</span>, <span class=
            "email">agourdol@adobe.com</span></dd>
        </dl><!--begin-copyright--><!--end-copyright-->
        <hr title="Separator for header">
    </div>

    <h2 class="no-num no-toc" id="abstract">Abstract</h2>

    <p>The CSS Regions module allows content to flow across multiple areas
    called regions. The regions do not necessarily follow the document order.
    The CSS Regions module provides an advanced content flow mechanism, which
    can be combined with positioning schemes as defined by other CSS modules
    such as the Multi-Column Module [[CSS3COL]] or the Grid Layout Module
    [[CSS3-GRID-LAYOUT]] to position the regions where content flows.</p>

    <h2 class="no-num no-toc" id="status">Status of this document</h2>
    <!--begin-status-->

    <p><em>This section describes the status of this document at the time of
    its publication. Other documents may supersede this document. A list of
    current W3C publications and the latest revision of this technical report
    can be found in the <a href="http://www.w3.org/TR/">W3C technical reports
    index at http://www.w3.org/TR/.</a></em></p>

    <p>This is a public copy of the editors' draft. It is provided for
    discussion only and may change at any moment. Its publication here does not
    imply endorsement of its contents by W3C. Don't cite this document other
    than as work in progress.</p>

    <p>The archived public mailing list www-style@w3.org is preferred for
    discussion of this specification. When sending e-mail, please put the text
    "css3-regions" in the subject, preferably like this: "[css3-regions]
    …summary of comment…"</p>

    <p>This draft is related to the drafts about Multi-column Layout <a href=
    '#CSSMULTICOL'>[CSSMULTICOL]</a>, Grid Layout <a href=
    '#CSS3GRID'>[CSS3GRID]</a>, Flexible Box Layout <a href=
    '#CSS3FLEXBOX'>[CSS3FLEXBOX]</a>, and Template Layout <a href=
    '#CSSTEMPLATELAYOUT'>[CSSTEMPLATELAYOUT]</a>.</p><!--end-status-->

    <h2 class="no-num no-toc" id="contents">Table of contents</h2>
    <!--begin-toc--><!--end-toc-->

    <h2 id="introduction">Introduction</h2>

    <p>Capturing the complex layouts of a typical magazine, newspaper, or
    textbook requires capabilities beyond those available in existing CSS
    modules. This is the purpose of the CSS Regions module.</p>

    <p>&nbsp;</p>

    <p>The CSS Regions module can be seen as an extension of the concept of
    multi-column elements. With CSS Multi-column layout [[CSS3COL]], columns
    share the same dimensions and define column boxes organized in rows.
    Content flows from one column to the next.</p>

    <p>&nbsp;</p>

    <p>The multi-column model is an example of flowing content from one area to
    another, where the areas are the multi-column element's column boxes and
    the flow is made of the multi-column element's children.</p>

    <p>&nbsp;</p>

    <p>However, for more complex layouts, content needs to flow from one area
    of the page to the next without limitation of the areas' sizes and
    positions. These arbitrary areas are the target of specific content flows.
    In this document these areas are called regions, and the content flows are
    called named flows. Regions are based on the rectangular geometry of the
    CSS box model. Elements in a named flow are taken out of the normal visual
    formatting and rendered in a chain of regions.</p>

    <h3>Named flows and regions</h3>

    <p>Consider the layout illustrated in figure 1.</p>

    <div class="figure">
        <img src="images/regions-intro.svg" width="400" alt=
        "multiple chained regions which should receive content from a flow">

        <p class="caption">Layout requiring sophisticated content flow</p>
    </div>

    <p>The designer's intent is to position an image in region 'A' and to flow
    an article's text from region '1', to region '2', '3' and '4'.</p>

    <p>The following code snippet shows the content to flow between the regions
    1, 2, 3 and 4.</p>
    <pre>
&lt;div <em>id="article"</em>&gt;
&lt;h1&gt;Introduction&lt;/h1&gt;
    &lt;p&gt;This is an example ...&lt;/p&gt;
    
&lt;h1&gt;More Details&lt;/h1&gt;
    &lt;p&gt;This illustrates ...&lt;/p&gt;
    &lt;p&gt;Then, the example ...&lt;/p&gt;
    &lt;p&gt;Finally, this ...&lt;/p&gt;
&lt;/div&gt;
        
</pre>

    <p>CSS layout facilities can position and size regions as needed. However,
    there is no existing mechanism to associate the content with the regions so
    that content flows as intended. Figure 2 shows an example of the intended
    visual rendering of the content.</p>

    <div class="figure">
        <img src="images/regions-intro-rendering.png" width="450" alt=
        "Sample rendering showing a single thread of text flowing through a chain of regions">

        <p class="caption">Sample rendering for desired layout</p>
    </div>

    <p>Since the CSS Regions module is independent of the layout of regions and
    the mechanism used to create them, the following assumes there is a CSS
    selector for the regions and, for the purpose of the example, the selectors
    for regions 1, 2, 3 and 4 are showing as &lt;<code>region1_sel</code>&gt;,
    &lt;<code>region2_sel</code>&gt;, &lt;<code>region3_sel</code>&gt; and
    &lt;<code>region4_sel</code>&gt; respectively. Such a selector could be an
    id selector (e.g., <code>#region_1</code>) or a grid cell selector (e.g.,
    <code>#myGrid::grid-cell([cell-name])</code>) if using the CSS Grid Layout
    module, for example.</p>

    <div class="example">
        <pre>
&lt;style&gt;

#article {
    <strong>flow: article_flow;</strong>
}

&lt;region1_sel&gt;, &lt;region2_sel&gt;, 
&lt;region3_sel&gt;, &lt;region4_sel&gt; {
    <strong>content: from(article_flow);</strong>
}
&lt;/style&gt;
</pre>
    </div>

    <p>The above stylesheet directs the <code>#article</code> element to a
    named flow called 'article_flow' by setting the 'flow' property. Then,
    content is "poured" from that named flow into the desired regions by
    setting the regions' 'content' property to
    <code>from(article_flow)</code>.</p>

    <h3 id="region-styling">Regions Styling</h3>

    <p>Region styling allows content to be styled depending on the region it
    flows into. It is a form of context-based styling, similar to <a href=
    "#CSSMEDIAQUERIES">Media Queries</a> [[MEDIAQ]] which enable or disable
    selectors depending on the rendering context. With region styling,
    additional selectors may apply depending on the region into which content
    flows.</p>

    <p>In our example, the designer wants to make text that falls into region 1
    larger, bold and dark blue. In addition, &lt;h1&gt; headers should be
    run-ins and crimson.</p>

    <p>This design can be expressed with region styling as shown below.</p>

    <div class="example">
        <pre>
&lt;style&gt;
/*
 * Default article styling.
 */
#article {
    color:#777;
    text-align: justify;
}

#article h1 {
    border-left: 1px solid #777;
    padding-left: 2ex;
}

/*
 * Additional styling to apply to content when it falls into 
 * region_1
 */
<strong>@region_style &lt;region1_sel&gt; {</strong>
    #article {
        font-weight: bold;
        color: #0C3D5F;
        font-size: larger;
    }

    #article h1 {
        color: crimson;
        display: run-in;
        border: none;
        padding: 0px;
    }
<strong>}</strong>
&lt;/style&gt;
</pre>
    </div>

    <p>The '@region_style' rule for region 1 limits its selectors to content
    flowing into region 1. The following figure shows how the rendering changes
    if we do not increase the font size nor make it bold for content flowing
    into region 1. As more content can be fitted, more content is subject to
    the contextual selectors, resulting in more dark blue text into region
    1.</p>

    <div class="figure">
        <img src="images/region-styling.png" width="450" alt=
        "Illustrate how changing region styling affects the flow of content.">

        <p class="caption">Different rendering with a different region
        styling</p>
    </div>

    <h2 id="css-regions-model">CSS Regions Model</h2>

    <h3 id="named-flows">Named flows</h3>

    <p>In the <a href="http://www.w3.org/TR/CSS21/visuren.html">CSS formatting
    model</a>, elements can be in the <em>normal flow</em> or out of the
    <em>(normal) flow</em>. Boxes generated by elements in the normal flow are
    subject to their container box's normal layout scheme. Boxes generated by
    elements out of the normal flow are subject to a different layout scheme.
    For example, absolutely positioned elements are subject to absolute
    positioning into their <a href=
    "http://www.w3.org/TR/CSS21/visudet.html#containing-block-details">containing
    block</a>. This can be described by saying that the absolutely positioned
    elements are part of a special flow (called 'positioned flow') which is
    subject to a special layout by its container box (i.e., its container box
    positions it into the containing block's box).</p>

    <p>&nbsp;</p>

    <p>In both cases, there is a notion of flow containing a sequence of
    elements and there is a notion of <a href=
    "http://www.w3.org/Style/Group/css2-src/visuren.html#block-boxes">(block)
    container box</a> into which the elements flow.</p>

    <p>&nbsp;</p>

    <p>The CSS Regions module generalizes the concept of flow by adding the
    concept of a <em>named flow</em>. This module lets authors explicitly place
    elements into a <em>named flow</em>.</p>

    <p>&nbsp;</p>

    <p>With this model, all elements are moved to a flow as part of the visual
    formatting. That flow may be the normal flow, a named flow or a positioned
    flow, for example. A flow gets formatted visually when associated with one
    or several elements' container box(es). When an flow is associated with
    container boxes, the boxes generated by the flow's elements are laid out
    according to the container box's layout scheme and the flow is subject to
    the <a href='#flow-breaking-rules'>'flow breaking rules'</a> described
    below.</p>

    <p>A container's layout scheme is the strategy used by a container to
    position the boxes generated by its children and itself. Examples are the
    normal layout (block and inline formatting) ([[CSS21]]), table layout
    ([[CSS21]]), the multi-column layout ([[CSS3COL]]) or the grid layout
    ([[CSS3-GRID-LAYOUT]]).</p>

    <h3 id="regions">Regions</h3>

    <p class="index" title="region" id="region">A region is an element that
    generates a <a href=
    "http://www.w3.org/TR/CSS21/visuren.html#block-boxes">block container
    box</a> and has an associated <em>named flow</em> (see the 'content'
    property).</p>

    <div class="issue">
        Could inline elements also be regions?
    </div>

    <h3 id="flow-breaking-rules">Flow breaking rules</h3>

    <p>This section describes how container boxes consume content from a flow.
    The previous sections described how a flow may be referenced by one or more
    regions. The regions are the flow consumers and are ordered in a chain (see
    the 'content-order' property). The current flow consumer is initially the
    first one in the chain.</p>

    <p>&nbsp;</p>

    <p><strong>Positioning recursion</strong> -- while there are remaining
    boxes in the flow, the current flow consumer is allowed to take more boxes
    from the flow and position them. If the consumer is unable to position
    additional boxes without overflowing, then one of two things happen:</p>

    <ol>
        <li>If the flow consumer is the last in the chain, then it should
        proceed to the end of the flow and position all remaining generated
        boxes, even if they overflow.</li>

        <li>Otherwise, the next flow consumer becomes the current one and a new
        iteration of the positioning recursion starts.</li>
    </ol>

    <div class="issue">
        The above describes the simple case. It should explain how breaks
        influence this recursion. It should also discuss how boxes are split in
        general.
    </div>

    <div class="issue">
        Should the model provide a way to <a href=
        "http://www.w3.org/TR/css3-multicol/#column-fill">balance</a> regions,
        as in the [[CSS3COL]] module?
    </div>

    <div class="issue">
        Is there a way to allow regions to be generated when content that does
        not fit into the last region remains. This would be analogous to the
        way the additional columns are generated when a multi-column box
        <a href=
        "http://www.w3.org/TR/css3-multicol/#pagination-and-overflow-outside-multicol">
        overflows</a> (see [[CSS3COL]]).
    </div>

    <h3 id="formatting-model-considerations">The Visual Formatting Model and
    Flows</h3>

    <p>This section describes the flows to whichi elements formatted according
    to the CSS <a href="http://www.w3.org/TR/CSS21/visuren.html">Visual
    Formatting Model</a> and other layout modules (such as Multi-Column Layout
    [[CSS3COL]]) belong to.</p>

    <p>In particular, this section describes the 'generated flow' where
    generated content of pseudo-elements is placed and several <dfn id=
    "auto-flow" title="auto flows">'auto flows'</dfn> where children of content
    elements are automatically placed.</p>

    <h4 id="normal-flow">Normal flow</h4>

    <p>In the CSS formatting model, elements are by default placed in the
    <dfn id="normal-flow-def">normal flow</dfn> of their container. Also by
    default, a container element gets its content from its <em>normal
    flow</em>. This means that by default, a container element will visually
    format its children elements and will be the only container associated with
    its normal flow.</p>

    <p>Note that floats and relatively positioned elements, in this model, are
    part of the same flow of content and flow into the same container but are
    positioned in different ways.</p>

    <p>The <em>normal flow</em> is one of the <em>auto flows</em>.</p>

    <h4 id="positioned-flow">Positioned flow</h4>

    <p>An absolutely positioned element is placed into the <dfn id=
    "positioned-flow-def">positioned flow</dfn> of its container. The container
    positions this element into its <em>containing block</em>.</p>

    <p>If a container has children in the <em>normal flow</em> and in the
    <em>positioned flow</em>, it applies different positioning schemes to each
    flow.</p>

    <p>The <em>positioned flow</em> is one of the <em>auto flows</em>.</p>

    <h4 id="column-flow">Column flow</h4>

    <p>Children of the multi-column element are placed in the element's
    <dfn id="column-flow-def">column flow</dfn>. The column boxes are then
    implicitly associated with the element's 'column flow'. In this model,
    multiple regions (column boxes) get their content from a single flow (the
    element's 'column flow', which is the content of the element).</p>

    <p>The <em>column flow</em> is one of the <em>auto flows</em>.</p>

    <div class="issue">
        Need to add a <dfn id="grid-cell-flow">grid cell flow</dfn> section.
    </div>

    <h4 id="generated-flow">Generated flow</h4>

    <p>In the CSS formatting model, when the <code>::before</code> or
    <code>::after</code> pseudo-elements have their content property set to one
    of <code>&lt;string&gt;</code>, <code>&lt;uri&gt;</code>,
    <code>&lt;counter&gt;</code>, <code>attr(&lt;identifier&gt;)</code>,
    <code>open-quote</code>, <code>close-quote</code>,
    <code>no-open-quote</code> or <code>no-close-quote</code>, they create a
    <dfn id="generated-flow-def">generated flow</dfn> which they format
    visually.</p>

    <h3>Relation to document events</h3>

    <p>The CSS Region module does not alter in any way the normal processing of
    events in the document tree. In particular, if an event occurs on an
    element that is part of a named flow, the <a href=
    "http://www.w3.org/TR/DOM-Level-3-Events/#dom-event-architecture">event's
    bubble and capture phases</a> happen following the document tree order.</p>

    <h2 id="regions-properties">Properties and Rules</h2>

    <p>The main CSS Regions module properties are the ‘flow’ and 'content'
    properties. The ‘flow’ property is places an element into a specific named
    flow or lets the <a href="auto-flows">automatic flow assignment</a> take
    place. The ‘content’ property binds a region with a flow. When multiple
    regions are bound to the same flow, the 'content-order' property determines
    the order in which content flows into the sequence of regions. This
    sequences of regions is called a <dfn>chain of regions</dfn>.</p>

    <p>&nbsp;</p>

    <p>The way in which the content is broken into segments that fit in a
    region can be controlled by the “break” properties. Finally, styling that
    is unique to the region can be specified by ‘region-style’ rules.</p>

    <h3>The 'flow' property</h3>

    <p>The ‘flow’ property places an element into a named flow or automatically
    places it in the appropriate flow (see the <a href=
    "#formatting-model-considerations">Visual Formatting Model and Flows</a>
    section). Elements that belong to the same flow are laid out in the regions
    associated with that flow.</p>

    <table class="propdef" summary="flow property definition">
        <tr>
            <th>Name:</th>

            <td><dfn id="flow2">flow</dfn></td>
        </tr>

        <tr>
            <th>Value:</th>

            <td>&lt;name&gt;</td>
        </tr>

        <tr>
            <th>Initial:</th>

            <td>auto</td>
        </tr>

        <tr>
            <th>Applies to:</th>

            <td>any element</td>
        </tr>

        <tr>
            <th>Inherited:</th>

            <td>no</td>
        </tr>

        <tr>
            <th>Percentages:</th>

            <td>N/A</td>
        </tr>

        <tr>
            <th>Media:</th>

            <td>visual</td>
        </tr>

        <tr>
            <th>Computed&nbsp;value:</th>

            <td>as specified</td>
        </tr>
    </table>

    <dl>
        <dt>auto</dt>

        <dd>The element is automatically moved to the appropriate flow
        according to the <a href="#formatting_model_considerations">Visual
        Formatting Model and Flows</a> definitions.</dd>

        <dt>&lt;name&gt;</dt>

        <dd>The element is placed (appended) to the flow with that name. The
        element is said to have a <dfn id="specified-flow">specified
        flow</dfn>.</dd>
    </dl>

    <p>A named flow needs to be associated with one or more regions for its
    elements to be visually formatted. If no region is associated with a given
    named flow, the elements in the named flow are not rendered: they do not
    generate boxes and are not displayed.</p>

    <p>The children of an element with a specified flow may themselves have a
    specified flow.</p>

    <p>If an element has a the same specified flow value as one of its
    ancestors, it is moved out of its parent's normal flow and becomes a
    sibling of it's ancestor for the purpose of layout in the regions taking
    content from this flow.</p>

    <p>The 'flow' property does not affect the CSS cascade and inheritance for
    the elements on which it is specified. The flow property affects the visual
    formatting of elements associated to a named flow and of regions getting
    their content from a named flow.</p>

    <p>The containing block for absolutely positioned descendants of an element
    with a specified flow is the region into which the element is rendered.</p>

    <p>All the elements participating inside a named flow are rendered as
    children of an anonymous block that spans across all the regions associated
    with the specified named flow. The elements flowed inside the same named
    flow are taken in document order.</p>

    <h3>The 'content' property</h3>

    <p>This specification extends the definition of the 'content' property and
    makes it applicable to all block elements and pseudo-elements.</p>

    <table class="propdef" summary="content property definition">
        <tr>
            <th>Name:</th>

            <td><dfn id="content-from">content</dfn></td>
        </tr>

        <tr>
            <th>Value:</th>

            <td>normal | none | from(&lt;name&gt;)| [ &lt;string&gt; |
            &lt;uri&gt; | &lt;counter&gt; | attr(&lt;identifier&gt;) |
            open-quote | close-quote | no-open-quote | no-close-quote ]+ |
            inherit</td>
        </tr>

        <tr>
            <th>Initial:</th>

            <td>normal</td>
        </tr>

        <tr>
            <th>Applies to:</th>

            <td>any block element</td>
        </tr>

        <tr>
            <th>Inherited:</th>

            <td>no</td>
        </tr>

        <tr>
            <th>Percentages:</th>

            <td>N/A</td>
        </tr>

        <tr>
            <th>Media:</th>

            <td>visual</td>
        </tr>

        <tr>
            <th>Computed&nbsp;value:</th>

            <td>as specified</td>
        </tr>
    </table>

    <dl>
        <dt><a name="x9" id="x9"><span class="index-inst" title=
        "none"><strong>none</strong></span></a></dt>

        <dd>For <code>::before</code> and <code>::after</code> pseudo-elements,
        the pseudo-element is not generated. For other elements, the element
        will not get any content for its visual formatting. If the children of
        the element are not directed to a flow referenced by another region,
        then they are not visually formatted. An element with its value set to
        'none' is said to be <dfn>disconnected</dfn></dd>

        <dt><strong>normal</strong></dt>

        <dd>Computes to 'none' for the <code>::before</code> and
        <code>::after</code> pseudo-elements. For other elements, the element
        uses the flow assigned to its children following the <a href=
        "auto-flows">automatic flow assignment for the Visual Formatting
        Model..</a></dd>

        <dt><strong>&lt;string&gt;</strong></dt>

        <dd>Text content (see the section on <a href=
        "syndata.html#strings">strings</a>).</dd>

        <dt><strong>&lt;uri&gt;</strong></dt>

        <dd>The value is a URI that designates an external resource (such as an
        image). If the user agent cannot display the resource it must either
        leave it out as if it were not specified or display some indication
        that the resource cannot be displayed.</dd>

        <dt><strong>&lt;counter&gt;</strong></dt>

        <dd><a href="syndata.html#counter">Counters</a> may be specified with
        two different functions: 'counter()' or 'counters()'. The former has
        two forms: 'counter(<var>name</var>)' or 'counter(<var>name</var>,
        <var>style</var>)'. The generated text is the value of the innermost
        counter of the given name in scope at this pseudo-element; it is
        formatted in the indicated <a href="#counter-styles">style</a>
        ('decimal' by default). The latter function also has two forms:
        'counters(<var>name</var>, <var>string</var>)' or
        'counters(<var>name</var>, <var>string</var>, <var>style</var>)'. The
        generated text is the value of all counters with the given name in
        scope at this pseudo-element, from outermost to innermost separated by
        the specified string. The counters are rendered in the indicated
        <a href="#counter-styles">style</a> ('decimal' by default). See the
        section on <a href="#counters">automatic counters and numbering</a> for
        more information. The name must not be 'none', 'inherit' or 'initial'.
        Such a name causes the declaration to be ignored.</dd>

        <dt><strong>open-quote</strong> and <strong>close-quote</strong></dt>

        <dd>These values are replaced by the appropriate string from the
        <a href="http://www.w3.org/TR/CSS21/generate.html#propdef-quotes"
        class="noxref"><span class=
        "propinst-quotes"><strong>'quotes'</strong></span></a> property.</dd>

        <dt><strong>no-open-quote</strong> and
        <strong>no-close-quote</strong></dt>

        <dd>Introduces no content, but increments (decrements) the level of
        nesting for quotes.</dd>

        <dt><strong>attr(X)</strong></dt>

        <dd>This function returns as a string the value of attribute X for the
        subject of the selector. The string is not parsed by the CSS processor.
        If the subject of the selector does not have an attribute X, an empty
        string is returned. The case-sensitivity of attribute names depends on
        the document language.</dd>

        <dt><dfn id="from-name">from(&lt;name&gt;)</dfn></dt>

        <dd>The element will visually format the available elements in the
        named flow with name &lt;name&gt;. If there is no flow with name
        &lt;name&gt;, then the element is disconnected and does not format any
        children visually. Multiple elements may be associated with the same
        named flow. See the 'content-order' property discussion to understand
        how content segments are associated with different regions.</dd>
    </dl>

    <div class="issue">
        <p>Should we consider adding the ability to do the following:</p>

        <ul>
            <li>Support repeatable content. For example, have a repeatable
            heading at the start of each region where content flows.</li>

            <li>Support flow breaking marks. It might be very useful to support
            a <em>mark</em> (such as <code>...</code>) at the region breaking
            points to indicate that content has been broken out and is
            continuing on a different region.</li>
        </ul>
    </div>

    <div class="issue">
        Should the 'content' property be limited to block elements or should it
        be allowed on all elements?
    </div>

    <h3>The 'content-order' property</h3>

    <p>Defines the ordering of the chain of regions into which content flows.
    If region A and region B are in the same chain of regions and the
    ‘content-order’ of region A is lower than that of region B, then region A
    will precede region B in that chain: content will flow into region A before
    it flows into region B.</p>

    <table class="propdef" summary="content-order property definition">
        <tr>
            <th>Name:</th>

            <td><dfn id="content-order">content-order</dfn></td>
        </tr>

        <tr>
            <th>Value:</th>

            <td>&lt;float&gt;</td>
        </tr>

        <tr>
            <th>Initial:</th>

            <td>0</td>
        </tr>

        <tr>
            <th>Applies to:</th>

            <td>any block container</td>
        </tr>

        <tr>
            <th>Inherited:</th>

            <td>no</td>
        </tr>

        <tr>
            <th>Percentages:</th>

            <td>N/A</td>
        </tr>

        <tr>
            <th>Media:</th>

            <td>visual</td>
        </tr>

        <tr>
            <th>Computed&nbsp;value:</th>

            <td>as specified</td>
        </tr>
    </table>

    <dl>
        <dt>&lt;float&gt;</dt>

        <dd>Specifies the region's priority in the chain it belongs to, i.e..,
        the chain of regions associated with the same content flow. Negative
        values are allowed.</dd>
    </dl>

    <p>If two or more regions with the same 'from( &lt;name&gt;)' value for
    their 'content' property, they are first sorted according to their
    'content-order' value. If multiple regions in have the same 'content-order'
    value, they are sorted according to the document order.</p>

    <div class="issue">
        CSS Modules should define the document order for pseudo elements. For
        example, the [CSSGRID] specification should define the document order
        for the '::grid-cell' pseudo elements (e.g., row-major sorting or
        column major sorting of cells).
    </div>

    <h3>Region flow break properties: 'break-before', 'break-after',
    'break-inside'</h3>

    <p>When content is laid out in multiple regions, the user agent must
    determine where content breaks occur. The problem of breaking content into
    segments fitting in regions is similar to breaking content into pages or
    columns.</p>

    <p>Each break ends layout in the current region and causes remaining pieces
    of content from the named flow to be visually formatted in the following
    region, in the order defined by the 'content-order' computed values. Note
    that there is no region break in the last region associated to a named
    flow.</p>

    <p>The following extends the 'break-before', 'break-after' and
    'break-inside' properties from the [[!CSS3COL]] specification to account
    for regions. The additional values are described below.</p>

    <table class="propdef" summary="break-before property definition">
        <tr>
            <td><em>Name:</em></td>

            <td><dfn>break-before</dfn></td>
        </tr>

        <tr>
            <td><em>Value:</em></td>

            <td>auto | always | avoid | left | right | page | column | region |
            avoid-page | avoid-column | avoid-region</td>
        </tr>

        <tr>
            <td><em>Initial:</em></td>

            <td>auto</td>
        </tr>

        <tr>
            <td><em>Applies to:</em></td>

            <td>block-level elements</td>
        </tr>

        <tr>
            <td><em>Inherited:</em></td>

            <td>no</td>
        </tr>

        <tr>
            <td><em>Percentages:</em></td>

            <td>N/A</td>
        </tr>

        <tr>
            <td><em>Media:</em></td>

            <td>paged</td>
        </tr>

        <tr>
            <td><em>Computed&nbsp;value:</em></td>

            <td>specified value</td>
        </tr>
    </table>

    <table class="propdef" summary="break-after property definition">
        <tr>
            <td><em>Name:</em></td>

            <td><dfn>break-after</dfn></td>
        </tr>

        <tr>
            <td><em>Value:</em></td>

            <td>auto | always | avoid | left | right | page | column | region |
            avoid-page | avoid-column | avoid-region</td>
        </tr>

        <tr>
            <td><em>Initial:</em></td>

            <td>auto</td>
        </tr>

        <tr>
            <td><em>Applies to:</em></td>

            <td>block-level elements</td>
        </tr>

        <tr>
            <td><em>Inherited:</em></td>

            <td>no</td>
        </tr>

        <tr>
            <td><em>Percentages:</em></td>

            <td>N/A</td>
        </tr>

        <tr>
            <td><em>Media:</em></td>

            <td>paged</td>
        </tr>

        <tr>
            <td><em>Computed&nbsp;value:</em></td>

            <td>specified value</td>
        </tr>
    </table>

    <table class="propdef" summary="break-inside property definition">
        <tr>
            <td><em>Name:</em></td>

            <td><dfn>break-inside</dfn></td>
        </tr>

        <tr>
            <td><em>Value:</em></td>

            <td>auto | avoid | avoid-page | avoid-column | avoid-region</td>
        </tr>

        <tr>
            <td><em>Initial:</em></td>

            <td>auto</td>
        </tr>

        <tr>
            <td><em>Applies to:</em></td>

            <td>block-level elements</td>
        </tr>

        <tr>
            <td><em>Inherited:</em></td>

            <td>no</td>
        </tr>

        <tr>
            <td><em>Percentages:</em></td>

            <td>N/A</td>
        </tr>

        <tr>
            <td><em>Media:</em></td>

            <td>paged</td>
        </tr>

        <tr>
            <td><em>Computed&nbsp;value:</em></td>

            <td>specified value</td>
        </tr>
    </table>

    <p>These properties describe page, column and region break behavior
    before/after/inside the generated box. These values are normatively defined
    in [[!CSS3COL]]:</p>

    <dl>
        <dt>auto</dt>

        <dd>Neither force nor forbid a page/column break before (after, inside)
        the generated box.</dd>

        <dt>always</dt>

        <dd>Always force a page break before (after) the generated box.</dd>

        <dt>avoid</dt>

        <dd>Avoid a page/column break before (after, inside) the generated
        box.</dd>

        <dt>left</dt>

        <dd>Force one or two page breaks before (after) the generated box so
        that the next page is formatted as a left page.</dd>

        <dt>right</dt>

        <dd>Force one or two page breaks before (after) the generated box so
        that the next page is formatted as a right page.</dd>

        <dt>page</dt>

        <dd>Always force a page break before (after) the generated box.</dd>

        <dt>column</dt>

        <dd>Always force a column break before (after) the generated box.</dd>

        <dt>avoid-page</dt>

        <dd>Avoid a page break before (after, inside) the generated box.</dd>

        <dt>avoid-column</dt>

        <dd>Avoid a column break before (after, inside) the generated box.</dd>
    </dl>

    <p>This specification adds the following new values:</p>

    <dl>
        <dt>region</dt>

        <dd>Always force a region break before (after) the generated box.</dd>

        <dt>avoid-region</dt>

        <dd>Avoid a region break before (after, inside) the generated box.</dd>
    </dl>

    <p>When a break splits a box, the box's margins, borders, and padding have
    no visual effect where the split occurs. However, the margin immediately
    after a forced page/column/region break will be preserved. A forced
    page/column/region break is a break that does not occur naturally.</p>

    <p><strong>Note:</strong> When the 'avoid' value is used, regions may
    overflow. In that case the 'overflow' property specified on the region
    element should be used to determine how to render the overflow.</p>

    <div class="issue">
        There are elements, such as tables, where it is desirable to use
        <code>break-inside</code> to <code>avoid</code> so that the end user
        experience reading the page is not deteriorated. It such cases, it
        might be useful to provide some flexibility in the order in which
        content is pulled from the flow. For example, it might be good to allow
        a non breakable table to be moved to the next region where it fits and
        show more of the content that follows that table in the flow in the
        previous region. This could be achieved with a <code>flow-priority:
        flexible</code> setting, for example.
    </div>

    <h3>The region-style rule</h3>

    <p>Authors define style declarations specific to a regions within an
    '@region-style' rule. An '@region-style' rule consists of the keyword
    '@region-style' followed by a <a href=
    "http://www.w3.org/TR/css3-selectors/#selector-syntax">selector</a> and a
    declarations block. The '@region-style' rule and the selector constitute
    the region's 'flow segment' selector. The region's flow segment selector
    specifies which range in the flow is subject to the following declaration
    blocks: it applies to the range (see [[DOM-LEVEL-2-TRAVERSAL-RANGE]]) from
    the region's flow that flow in the selected region(s).</p>
    <pre class="lexical">
@region-style &lt;selector&gt; {
    ... CSS styling rules ...
}         
          
</pre>

    <div class="example">
        <p>In the following example, the named flow 'article_flow' flows
        through 'region1' and 'region2'. If the flow contains an &lt;h1&gt;
        element that falls into any of these two regions, it will be displayed
        as a 'run-in'. Likewise, if a &lt;p&gt; element falls into any of these
        two regions, its 'color' will be 'cornflowerblue'. However, if an
        &lt;h1&gt; header falls into region1, its text will be transformed to
        uppercase, but not if it falls in region2.</p>
        <pre>
&lt;style&gt;

&lt;region1_sel&gt;, &lt;region2_sel&gt; {
    content: from(article_flow);
}

@region_style &lt;region1_sel&gt;, &lt;region2_sel&gt; {
    p {
        color: cornflowerblue;
    }
    
    h1 {
        display: run-in;
    }
}

@region_style &lt;region1_sel&gt; {
    h1 {
         text-transform: uppercase;
    }
}
&lt;/style&gt;
</pre>
    </div>

    <div>
        <p>The properties allowed in '@region-style' declarations is limited to
        the same set as those available on the 'first-line' pseudo-element:</p>

        <ul>
            <li>font properties</li>

            <li>color properties</li>

            <li>background properties</li>

            <li>word-spacing</li>

            <li>letter-spacing</li>

            <li>text-decoration</li>

            <li>vertical-align</li>

            <li>text-transform</li>

            <li>line-height</li>

            <li>clear</li>
        </ul>
    </div>

    <div class="issue">
        This list of properties may be too limiting. For example, it prohibits
        the use of <code>display: run-in</code> as in the examples given
        earlier in this draft.
    </div>

    <p>The selectors for style declarations in a '@region-style' rule only
    match an element if the element flows into one of the regions in the rule
    selector.</p>

    <p>&nbsp;</p>

    <p>The specificity of the selectors in a '@region-style' rule is calculated
    as <a href="http://www.w3.org/TR/css3-selectors/#specificity">defined</a>
    in the CSS Selectors module (see [[SELECT]]). In other words, the
    '@region-style' rule adds an extra condition to the selector's matching,
    but does not change the selector's specificity. This is the same behavior
    as selectors appearing in '@media' rules declaration blocks (see
    [[MEDIAQ]]), where the rule does not influence the selectors'
    specificity.</p>

    <p>&nbsp;</p>

    <p>Consequently, selectors that match a given element (as describe above),
    participate in the <a href="CSS2.1%20section%206.4.1">CSS Cascading
    order</a> as defined in [[!CSS21]].</p>

    <div class="issue">
        <p>The above text defines that the @region-style &lt;selector&gt;
        matches a <em>range</em> in the flow because elements may be split
        across regions. For example, a paragraph element may start in region A
        and end in region B. Let's assume there are @region-style rules that
        apply to region A and region B content that would select the paragraph,
        for example to get red text in region A and blue text in region B. The
        intention is to have the red text styling applied to the range that
        flows into region A and the blue text styling applied to the range that
        flows into region B. This means that the selector really matches
        segments of elements, so to speak.</p>
    </div>

    <h2 id="om_regions">CSSOM View and CSS Regions</h2>

    <p>Since content may flow into multiple regions, authors need a way to
    determine if there are enough regions to flow all the content in a named
    flow. This is especially important considering that the size of regions may
    change depending on the display context. For example, flowing the same
    content on a mobile phone with a small screen may require more regions than
    on a large desktop display. Another example where creating more regions
    might be needed is if the user may change the font size of text flowing
    through regions: it might be required to add new regions to accommodate for
    the additional space required to fit the larger text or reduce the number
    of regions for smaller text.</p>

    <p>The CSS OM View ([[CSSOM-VIEW]]) specification defines extensions to the
    <code>Element</code> interface that would let an author find out if the
    last region overflows its content boundaries (by comparing its
    'scrollHeight' with its 'contentHeight'). However, this assumes the region
    is a document element, which may not always be the case. For example, as
    described in a later section, a grid cell (see [[CSS3-GRID-LAYOUT]]) may be
    a region, but it is a pseudo-element, not an document element. Therefore,
    it is not possible to access its 'scrollHeight' or 'contentHeight'.</p>

    <div class="issue">
        <p>Since an element may be split into multiple regions, there should be
        a way to get the client rectangles for the region. Note that this issue
        exists for elements children of a multi-column container.</p>
    </div>

    <div class="issue">
        <p>Should we use the <code>Range</code> interface and definition to
        interface with the flow segments, to represent how the flow gets broken
        into segments, and to represent what matches the
        <code>@region-style</code> selectors?</p>
    </div>

    <p>&nbsp;</p>

    <p>To address this need, this specification proposes to add a method to the
    <code>Document</code> interface to access an element's flow.</p>
    <pre class="idl">
[Supplemental] interface Document {
  ContentFlow flowWithName(string name);
};          
          
</pre>
    <pre class="idl">
interface ContentFlow {
  readonly attribute boolean overflows;
};
          
</pre>

    <p>With the <code>ContentFlow</code> interface, authors can easily check if
    all content has been fitted into existing regions. If it has, the overflow
    property would be true.</p>

    <h2 id="integration">Integration with other specifications</h2>

    <p>This specification does not specify how regions are created or laid out.
    This section illustrates how regions can be crated and laid out with other
    specifications. It first defines the requirements for integrating CSS
    Regions. Then it provides examples for different existing solutions.</p>

    <h3>Region requirements</h3>

    <p>For a container element (or pseudo-element) to become a region, it must
    be selectable with a CSS selector and accept the content property as
    defined in this specification.</p>

    <h3>Integration Examples</h3>

    <p>Authors can use different methods to layout regions in CSS. Some
    solutions can be expressed with CSS only and not require document changes,
    some solutions leverage the document tree. The following examples
    illustrate these different options.</p>

    <h4>CSS Grid Layout</h4>

    <p>The CSS Grid Layout specification (see [[CSS3-GRID-LAYOUT]]) defines a
    <a href=
    "http://www.w3.org/TR/css3-grid-layout/#grid-cell-pseudo-element-selector">grid-cell
    pseudo-element</a> selector for grid cells. Consequently, grid cells can be
    a region.</p>

    <p>The following example shows how CSS Grid Layout could be use to create
    regions and position them to create the example given in the
    introduction.</p>

    <div class="issue">
        There is a pending issue in the CSS Grid Layout module draft (section 7.2) about
        whether or not grid cells should generate a box and have an associated
        'display' property.
        To completely allow the use-case presented in the introduction,
        <code>::grid-cell</code> pseudo elements should allow box sizing properties 
        and behave as block level elements.
    </div>

    <div class="example">
        <pre>
&lt;style&gt;
body:before {
    display: grid;
    grid-template: "aae"
                   "bbe"
                   "cde";
}

body:before::grid-cell(a) {
    content: url('illustration.png');
}

body:before::grid-cell(b),
body:before::grid-cell(c),
body:before::grid-cell(d),
body:before::grid-cell(e) {
    content: from('article_flow');
}
&lt;/style&gt;
</pre>
    </div>

    <h4>CSS Multi-Column Layout</h4>

    <p>The CSS Multi-Column Layout (see [[CSS3COL]]) does not specify a
    selector for column regions.</p>

    <p>&nbsp;</p>

    <p>The CSS Multi-Column specification could offer a pseudo-element selector
    (e.g., called <code>nth-column</code>) for its column boxes. This would
    enable different content to flow through different columns. The following
    example illustrates how two different content flows could be threaded on
    alternate columns.</p>

    <div class="example">
        <pre>
&lt;style&gt;
body:before {
    columns: 4;
}

body:before::nth-column(even) {
    content: from('article_1_flow');
}

body:before::nth-column(odd) {
    content: from('article_2_flow');
}
&lt;/style&gt;

&lt;body&gt;
    &lt;div id="article_1"&gt;...&lt;/div&gt;
    &lt;div id="article_2"&gt;...&lt;/div&gt;
&lt;/body&gt;
</pre>
    </div>

    <p>Note that if a column box becomes associated with a flow by its content
    property, it is no longer associated to the 'column flow', as discussed
    <a href="column-flow">before</a>. For example, if the second column in a
    multi column element was associated with the 'illustration' named flow, the
    regular 'column-flow' would thread through the first and third column while
    column two would flow content from the 'illustration' named flow.</p>

    <h4>CSS Flexible Box Layout Module</h4>

    <p>The CSS Flexible Box Layout Module (see [[CSS3-FLEXBOX]]) aranges
    elements vertically or horizontally depending on various properties.</p>

    <p>The following example shows how CSS Flexible Box Layout could be use to
    create regions and position them to create the example given in the
    introduction.</p>

    <div class="example">
        <pre>
&lt;style&gt;
#article {
    flow: article_flow;
}

#region_1, #region_2, #region_3, #region_4 {
    content: from(article_flow);
}

#top_flex {
    display: flexbox;
    flex-direction: lr;
}

#left_col {
     display: flexbox;
     flex-direction: tb;
}

#bottom_row {
     display: flexbox;
     flex-direction: lr;
}
&lt;/style&gt;
&lt;html&gt;
    &lt;body&gt;
        &lt;div id="article"&gt;...&lt;/div&gt;
        &lt;div id="top_flex"&gt; 
            &lt;div id="left_col"&gt; 
                &lt;div id="region_A"&gt;&lt;/div&gt; 
                &lt;div id="region_1"&gt;&lt;/div&gt;
                &lt;div id="bottom-row"&gt;
                    &lt;div id="region_2"&gt;&lt;/div&gt;
                    &lt;div id="region_3"&gt;&lt;/div&gt;
                &lt;/div&gt; 
            &lt;/div&gt;
            &lt;div id="region_4"&gt;&lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
  
</pre>
    </div>

    <h4>CSS Visual Formatting</h4>

    <p>CSS (see [[CSS21]]) offers a way to visually format content with
    different layout schemes: inline and block formatting, float, absolute
    positioning, relative positioning or table layout.</p>

    <p>Elements laid out using these schemes can be regions, as illustrated
    below, using absolutely positioned elements for simplicity.</p>

    <div class="example">
        <pre>
&lt;style&gt;
#article {
    flow: article_flow;
}

#region_1, #region_2, #region_3, #region_4 {
    content: from(article_flow);
}

#region_1 {
    /* positioning properties */
}

/* ... positioning of other regions ... */

&lt;/style&gt;
&lt;html&gt;
    &lt;body&gt;
        &lt;div id="article"&gt;...&lt;/div&gt;
        &lt;div id="region_A"&gt;&lt;/div&gt;
        &lt;div id="region_1"&gt;&lt;/div&gt;
        &lt;div id="region_2"&gt;&lt;/div&gt;
        &lt;div id="region_3"&gt;&lt;/div&gt;
        &lt;div id="region_4"&gt;&lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
  
</pre>
    </div>

    <h2 id="relation-to-other-specs">Relation to other specifications</h2>

    <p>This specification is related to other specifications as described in
    the <a href='#references'>references</a> section. In addition, it is
    related to the following specifications:</p>

    <ol>
        <li>CSS Exclusions Module [[CSS3EXCLUSIONS]]. This module defines a
        generic way to define arbitrarily shaped exclusions into which content
        can flow or around which content can flow. This can be seen as an
        extension to the way CSS floats provide rectangular areas into which
        content flows and around which content flows. In advanced layout
        designs, it is expected that the CSS Exclusions module will be commonly
        combined with the CSS Regions module.</li>

        <li>CSS Line Grid Module [[CSS3LINEGRID]]. This module defines a
        concept of line grid to align the position of lines in different
        elements. The line grid functionality is related and needed for
        aligning content flowing in separate regions.</li>
    </ol>

    <h2 id="conformance">Conformance</h2>

    <h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

    <h2 class="no-num" id="references">References</h2>

    <h3 class="no-num" id="normative-references">Normative references</h3>
    <!--begin-normative--><!--end-normative-->

    <h3 class="no-num" id="other-references">Other references</h3>
    <!--begin-informative--><!--end-informative-->

    <h2 class="no-num" id="index">Index</h2><!--index-->

    <h2 class="no-num" id="property-index">Property index</h2>
    <!-- properties -->
    <!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
</body>
</html>
