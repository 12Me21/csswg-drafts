<!DOCTYPE html>
<html><head>
	<title>CSS Lists and Counters Module Level 3</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
	<link rel="stylesheet" type="text/css" href="http://dev.w3.org/csswg/css-module/default.css">
	<style>
	code.inline { white-space: nowrap; }
	.alphabetic-example { font-family: monospace; font-size: 90%; margin: 1em 0 1em 2em; }
	.alphabetic-example > span { display: inline-block; width: 50px;}
	.alphabetic-example > span > img { width: 16px; height: 16px; }
	pre > code { white-space: pre-wrap; }
	.nobr { white-space: nowrap;}
	</style>
	<link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/W3C-ED">
</head><body>

<div class="head">
<!--logo-->

<h1>CSS Lists and Counters Module Level 3</h1>

<h2 class="no-num no-toc">[LONGSTATUS] [DATE]</h2>
<dl>
	<dt>This version:
	<dd><!--<a href="http://www.w3.org/TR/[YEAR]/WD-[SHORTNAME]-[CDATE]">http://www.w3.org/TR/[YEAR]/WD-[SHORTNAME]-[CDATE]</a></dd>-->
	<a href="http://dev.w3.org/csswg/css3-lists/">http://dev.w3.org/csswg/css3-lists/</a></dd>

	<dt>Latest version:
	<dd><a href="http://www.w3.org/TR/css3-lists/">http://www.w3.org/TR/css3-lists/</a></dd>

	<dt>Previous version:</dt>
	<dd><a href="http://www.w3.org/TR/2002/WD-css3-lists-20021107/">http://www.w3.org/TR/2002/WD-css3-lists-20021107/</a></dd>

	<dt>Editor:</dt>
	<dd><a href="http://www.xanthir.com/contact">Tab Atkins Jr.</a>, Google Inc.</dd>

	<dt>Previous Editors:</dt> <!-- in the order tantek requested -->
	<dd>Ian Hickson, <a href="mailto:ian@hixie.ch">ian@hixie.ch</a></dd>
	<dd><span lang="tr">Tantek &#x00C7;el&#x0131;&#x0307;k</span>, Microsoft Corporation,
	<a href="mailto:tantekc@microsoft.com">tantekc@microsoft.com</a></dd>

	<dt>Contributors:</dt> <!-- in order of volume of input -->
	<dd>Simon Montagu, AOL-TW/Netscape, <a href="mailto:smontagu@netscape.com">smontagu@netscape.com</a></dd>
	<dd>Daniel Yacob, <a href="mailto:yacob@geez.org">yacob@geez.org</a></dd>
	<dd>Christopher Hoess, <a href="mailto:choess@stwing.upenn.edu">choess@stwing.upenn.edu</a></dd>
	<dd>Daniel Glazman, AOL-TW/Netscape, <a href="mailto:glazman@netscape.com">glazman@netscape.com</a></dd>
</dl>

<!--copyright-->

<hr title="Separator for header">
</div>


<h2 class="no-num no-toc" id="abstract">
Abstract</h2>

	<p>CSS is a language for describing the rendering of structured documents
	(such as HTML and XML) on screen, on paper, in speech, etc.
	This draft contains the features of CSS level&nbsp;3 relating to
	list styling. It includes and extends the functionality of
	CSS level&nbsp;2 [[!CSS21]], which builds on CSS level&nbsp;1
	[[CSS1]]. The main extensions compared to level&nbsp;2 are a pseudo-element
	representing the list marker, 
	and a method for authors to define their own list-styles.</p>


<h2 class="no-num no-toc" id="status">
Status of this document</h2>

<!--status-->


<h2 class="no-num no-toc" id="contents">
Table of contents</h2>

<!--toc-->

<hr>

<!-- ====================================================================== -->

<h2>
Introduction</h2>

	<p>The list model in this module differs in some important ways from the list model in CSS2,
	specifically in its handling of markers. Implementation experience suggested the CSS2 model
	overloaded the ::before and ::after pseudo-elements with too much behavior, while at the same time
	introducing new properties when existing properties were sufficient.</p>

	<p>Most block-level elements in CSS generate one principal block box. In this module, we discuss two
	CSS mechanisms that cause an element to have an associated marker: one method associates one
	principal block box (for the element's content) with a separate marker box (for decoration such as a
	bullet, image, or number), and the other inserts a marker box into the principal box. Unlike :before
	and :after content, the marker box cannot affect the position of the principal box, whatever the
	positioning scheme.</p>

	<div class="html-example">

		<p>For instance, the following example illustrates how markers may be used to add parentheses around each numbered list item. This HTML application and style sheet:</p>

		<pre>
&lt;style>
li::marker { content: "(" counter(list-item, lower-roman) ")"; }
li { display: list-item; }
&lt;/style>
&lt;ol>
	&lt;li>This is the first item.&lt;/li>
	&lt;li>This is the second item.&lt;/li>
	&lt;li>This is the third item.&lt;/li>
&lt;/ol></pre>

		<p>should produce something like this: </p>

		<pre>
  (i) This is the first item.
 (ii) This is the second item.
(iii) This is the third item.
</pre>
	</div>

	<p>With descendant selectors and child selectors, it's possible to specify different marker types depending on the depth of embedded lists.</p>

	<p class="issue">A future release of this module will probably include ways to render tree
	lists.</p>

<!-- ====================================================================== -->

<h2>
Declaring a List Item</h2>

	<p>To declare a <dfn>list item</dfn>, the 'display'
	property must be set to ''list-item'' or ''inline-list-item'' (defined
	later in this section). This, in addition to generating a <code class=css>::marker</code> 
	pseudo-element and enabling the properties described below for that element, 
	causes that element to increment the list item counter ''list-item''.
	(This does not affect the specified or computed values of the counter
	properties.)</p>

	<p>The ''list-item'' counter is a real counter,
	and can be directly affected using the 'counter-increment' and ''counter-reset'' 
	properties. It can also be used in the ''counter()'' and ''counters()'' functions.</p>


	<table class="propdef">
		<tbody>
			<tr>
				<th>Property:
				<td>'display'
			<tr>
				<th>New Value:
				<td><dfn>inline-list-item</dfn>
			<tr>
				<th>Initial:
				<td>same as CSS2.1
			<tr>
				<th>Applies to:
				<td>same as CSS2.1
			<tr>
				<th>Inherited:
				<td>same as CSS2.1
			<tr>
				<th>Percentages:
				<td>same as CSS2.1
			<tr>
				<th>Media:
				<td>same as CSS2.1
			<tr>
				<th>Computed&nbsp;value:
				<td>same as CSS2.1
		</tbody>
	</table>

	<p>The ''inline-list-item'' display value makes the element a list item,
	which means it can generate a <code class=css>::marker</code> pseudo-element.  The element also 
	affects the predefined ''list-item'' counter, as specified above. Otherwise, 
	this display value is treated identically to ''inline''.</p>

	<p class='note'>This display value is silly, and only necessary because we
	haven't yet defined 'display' to be split into subproperties.  When that
	happens, "being a list item" will just be a property value that can apply
	to block, inline, and other elements.</p>

<!-- ====================================================================== -->

<h2 id='marker-content'>
Marker Content: The 'list-style-image' and 'list-style-type' properties</h2>

	<table class="propdef">
		<tr>
			<th>Name:
			<td><dfn>list-style-image</dfn>
		<tr>
			<th>Value:
			<td>&lt;image> | none
		<tr>
			<th>Initial
			<td>none
		<tr>
			<th>Applies To:
			<td><i title="list item">list items</i>
		<tr>
			<th>Inherited:
			<td>yes
		<tr>
			<th>Percentages:
			<td>N/A
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Computed Value:
			<td>specified value
	</table>

	<p>The 'list-style-type' property specifies an image that will be used as the list marker.  If the value resolves to a valid image, the image must be used as the default contents of the <code class=css>::marker</code> pseudo-element.</p>

	<p>If the value ''none'' is provided, or the <i>&lt;image></i> doesn't resolve to a valid image, then the default contents are given by 'list-style-type' instead.</p>

	<div class="example">
		<p>The following example sets the marker at the beginning of each list item to
		be the image "ellipse.png".</p>

		<pre>LI { list-style-image: url("http://www.example.com/ellipse.png") }</pre>
	</div>

	<table class="propdef">
		<tr>
			<th>Name:
			<td><dfn>list-style-type</dfn>
		<tr>
			<th>Value:
			<td>&lt;string> | &lt;counter-style> | none
		<tr>
			<th>Initial:
			<td>disc
		<tr>
			<th>Applies To:
			<td><i title="list item">list items</i>
		<tr>
			<th>Inherited:
			<td>yes
		<tr>
			<th>Percentages:
			<td>N/A
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Computed Value:
			<td>specified value
	</table>

	<p>When the 'list-style-image' property is ''none'' or not a valid image, the 'list-style-type' property must be used to construct the default contents of a list item's marker; otherwise, the 'list-style-type' property must be ignored and have no effect.</p>

	<dl>
		<dt>&lt;string></dt>
		<dd>The <code class=css>::marker</code> pseudo-element must use the provided string as its default contents.</dd>

		<dt><i>&lt;counter-style></i></dt>
		<dd>
			<p>The <code class=css>::marker</code> pseudo-element's default contents must be the value of the ''list-item'' counter, formatted according to the given counter style. Algorithms for formatting a value according to a counter style are given later in this spec.</p> 

			<p>This specification defines a method for authors to create their own counter styles, both <a href="#counter-style">named</a> and <a href="#symbols-function">anonymous</a>, which may be used here.  Additionally, many useful counter styles are predefined in the sections on <a href="#predefined-counters">Complex Counter Styles</a> and <a href="#ua-stylesheet">Predefined Counter Styles</a>.</p>
		</dd>

		<dt><dfn>none</dfn></dt>
		<dd>The <code class=css>::marker</code> pseudo-element must have no default contents.  This will suppress the creation of a marker unless the <code class=css>::marker</code> has its contents specified directly through the 'content' property.</dd>
	</dl>

	<div class='example'>
		<p>The following examples illustrate how to set markers to various values:</p>

		<pre>
ul { list-style-type: "★"; }
/* Sets the marker to a "star" character */

p.note { 
	display: list-item; 
	list-style-type: "Note:"; 
	list-style-position: inside;
}
/* Gives note paragraphs a marker consisting of the string "Note:" */

ol { list-style-type: upper-roman; }
/* Sets all ordered lists to use the upper-roman counter-style 
   (<a href="#upper-roman">defined in this specification</a>) */

ul { list-style-type: symbols('○' '●' as repeating); }
/* Sets all unordered list items to alternate between empty and 
   filled circles for their markers. */

ul { list-style-type: none; }
/* Suppresses the marker entirely, unless list-style-image is specified
   with a valid image, or the marker's contents are set explicitly via
   the 'content' property. */</pre>
	</div>

	<p>The <i>&lt;counter-style></i> type is defined as:</p>

	<pre><dfn>&lt;counter-style></dfn> = &lt;identifier> | &lt;symbols-function></pre>

	<p>where the &lt;identifier> must be the name of a valid custom counter style defined with the ''@counter-style'' rule.</p>

<!-- ====================================================================== -->

<h2 id='list-style-position-property'>
Marker Position: The 'list-style-position' property</h2>

	<table class="propdef">
		<tr>
			<th>Name:
			<td><dfn>list-style-position</dfn>
		<tr>
			<th>Value:
			<td>inside | outside
		<tr>
			<th>Initial:
			<td>outside
		<tr>
			<th>Applies To:
			<td><i title="list item">list items</i>
		<tr>
			<th>Inherited:
			<td>yes
		<tr>
			<th>Percentages:
			<td>N/A
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Computed Value:
			<td>specified value
	</table>

	<p>This property specifies the position of the <code class=css>::marker</code> pseudo-element's box 
	in the <i>list item</i>. Values have the following meanings:</p>

	<dl>
		<dt><dfn>inside</dfn></dt>
		<dd>The <code class=css>::marker</code> pseudo-element is a 'display:inline' element placed immediately before the ''::before'' pseudo-element in the <i>list item</i>'s principle box, after which the element's content flows. Note that if there is no inline content, this will create a line box, just as content in an inline ''::before'' pseudo-element would. Also note that all the properties that apply to inline elements apply to the <code class=css>::marker</code> pseudo-element in this state, and this <code class=css>::marker</code> box participates in the inline box model in the normal manner.</dd>

		<dt><dfn>outside</dfn></dt>
		<dd>As ''inside'', plus the 'position' property on the <code class=css>::marker</code> pseudo-element must computer to ''marker''.  The section on the new 'marker' value for 'position' explains the consequences of this.  Additionally, the base directionality of the <code class=css>::marker</code> pseudo-element (used as an input to the bidi resolution algorithm) must be taken from the marker's  <i>marker positioning reference element</i>.</dd>
	</dl>

	<p>Note that a marker is only generated if the computed value of the 'content' 
	property for the element's <code class=css>::marker</code> pseudo-element is not ''none''.</p>

	<p class='issue'>Should I make this always compute to ''inside'' when the list item is ''display:inline-list-item''?  See the thread at <a href="http://lists.w3.org/Archives/Public/www-style/2011Jun/0232.html">http://lists.w3.org/Archives/Public/www-style/2011Jun/0232.html</a>.</p>

	<div class=example>
		<p>For example:

		<pre>
&lt;style>
	ul.compact { list-style: inside; }
	ul         { list-style: outside; }
&lt;/style>
&lt;ul class=compact>
	&lt;li>first "inside" list item comes first&lt;/li>
	&lt;li>second "inside" list item comes first&lt;/li>
&lt;/ul>
&lt;hr>
&lt;ul>
	&lt;li>first "outside" list item comes first&lt;/li>
	&lt;li>second "outside" list item comes first&lt;/li>
&lt;/ul></pre>

		<p>The above example may be formatted as:</p>

		<pre>
  * first "inside" list
  item comes first
  * second "inside" list
  item comes second

========================

* first "outside" list
  item comes first
* second "outside" list
  item comes second</pre>
	</div>

<!-- ====================================================================== -->

<h2 id='list-style-property'>
The 'list-style' shorthand property</h2>

	<table class="propdef">
		<tr>
			<th>Name:
			<td><dfn>list-style</dfn>
		<tr>
			<th>Value:
			<td>&lt;'list-style-type'> || &lt;'list-style-position'> || &lt;'list-style-image'>
		<tr>
			<th>Initial:
			<td>see individual properties
		<tr>
			<th>Applies To:
			<td><i title="list item">list items</i>
		<tr>
			<th>Inherited:
			<td>yes
		<tr>
			<th>Percentages:
			<td>N/A
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Computed Value:
			<td>see individual properties
	</table>

	<p>The 'list-style' property is a shorthand notation for setting the
	three properties 'list-style-type', 'list-style-image', and 'list-style-position'
	at the same place in the style sheet.</p>

	<div class="example">
		<p>For example:</p>

		<pre>
UL { list-style: upper-roman inside }  /* Any UL */
UL UL { list-style: circle outside } /* Any UL child of a UL */
		</pre>
	</div>

	<p>Using a value of ''none'' in the shorthand is potentially ambiguous, as ''none'' is a valid value for both 'list-style-image' and 'list-style-type'.  To resolve this ambiguity, a value of ''none'' in the shorthand must be applied to whichever of the two properties aren't otherwise set by the shorthand.</p>

	<div class='example'>
		<pre>
list-style: none disc;
/* Sets the image to "none" and the type to "disc". */

list-style: none url(bullet.png);
/* Sets the image to "url(bullet.png)" and the type to "none". */

list-style: none;
/* Sets both image and type to "none". */

list-style: none disc url(bullet.png);
/* Syntax error */</pre>
	</div>

	<p>Although authors may specify 'list-style' information directly on list item elements (e.g., LI in HTML), they should do so with care.  Consider the following rules:</p>
	
	<div class=example>
		<pre>
ol.alpha li { list-style: lower-alpha; }
ul li       { list-style: disc; }
/* These won't work as expected.  If you nest a &lt;ul>
into an &lt;ol class=alpha>, the first rule's specificity 
will make the &lt;ul>'s list items use the lower-alpha style. */

ol.alpha > li { list-style: lower-alpha; }
ul > li       { list-style: disc; }
/* These work as intended. */

ol.alpha { list-style: lower-alpha; }
ul       { list-style: disc; }
/* So do these, since inheritance will transfer the 
'list-style' value to the list items. */</pre>
	</div>


<!-- ====================================================================== -->

<h2 id='marker-pseudo-element'>
Markers: The <code class=css>::marker</code> pseudo-element</h2>

	<p>Markers are created by setting an element's 'display' property to
	''list-item'' or ''inline-list-item''.  The <code class=css>::marker</code> pseudo-element is only created if 
	the computed value of the 'content' property for the pseudo-element is not 
	''none''.</p>

	<p>Just like other generated content, markers generate a box when they're created, which can be styled with the full range of properties and values.  Markers are placed at the beginning of their superior parent's content, before the ::before pseudo-element (if it exists).  <code class=css>::marker</code> pseudo-elements are inline by default, though certain values for 'list-style-position' on the list item can make the marker box positioned, which can have an effect on the computed value of display.</p>

	<div class="example">
		<p>In the following example, the content is centered within a marker
		box of a fixed width. This document:</p>

		<pre>
&lt;style>
li::marker { 
  content: "(" counter(counter) ")";
  width: 6em;
  text-align: center;
}
li {
  display: list-item;
  counter-increment: counter;
}
&lt;/style>
&lt;ol>
	&lt;li>This is the first item.&lt;/li>
	&lt;li>This is the second item.&lt;/li>
	&lt;li>This is the third item.&lt;/li>
&lt;/ol></pre>

		<p>should render something like this: </p>

		<pre>
  (1)    This is the 
         first item.
  (2)    This is the 
         second item.
  (3)    This is the 
         third item.</pre>
	</div>

	<div class="example">
		<p>In this example, markers are used to number paragraphs that are designated as "notes":</p>

		<pre>
&lt;style>
p { margin-left: 12 em; }
p.note::marker { 
  content: "Note " counter(note-counter) ":";
  text-align: left;
  width: 10em;
}
p.note {
 display: list-item;
 counter-increment: note-counter;
}
&lt;/style>
&lt;p>This is the first paragraph in this document.&lt;/p>
&lt;p class="note">This is a very short document.&lt;/p>
&lt;p>This is the end.&lt;/p>
		</pre>

		<p>It should render something like this:</p>

		<pre>
            This is the first paragraph 
            in this document.

  Note 1:   This is a very short 
            document.
           
            This is the end.</pre>
	</div>

	<div class="example">
		<p>By using the <code class=css>::marker</code> pseudo-element, a list's markers can be positioned much more flexibly, and even be styled independently from the text of the list item itself:</p>

		<pre>
&lt;style>
p { margin-left: 8em } /* Make space for counters */
li { list-style-type: lower-roman; }
li::marker { margin: 0 3em 0 0; color: blue; }
&lt;/style>
&lt;p>This is a long preceding paragraph ...&lt;/p>
&lt;ol>
	&lt;li>This is the first item.&lt;/li>
	&lt;li>This is the second item.&lt;/li>
	&lt;li>This is the third item.&lt;/li>
&lt;/ol>
&lt;p>This is a long following paragraph ...&lt;/p></pre>

		<p>The preceding document should render something like this: </p>

		<pre>
        This is a long preceding
        paragraph ...
      
   <span style=color:blue>i.</span>   This is the first item.
  <span style=color:blue>ii.</span>   This is the second item.
 <span style=color:blue>iii.</span>   This is the third item.

        This is a long following
        paragraph ...</pre>

        <p>Previously the only way to style a marker was through inheritance; one had to put the desired marker styling on the list item, and then revert that on a wrapper element around the list item's actual contents.  Non-inherited properties like 'margin' couldn't be adjusted at all on the marker.</p>
	</div>

<!-- ====================================================================== -->

<h3 id='content-property'>
Generating the computed value of the 'content' property</h3>

	<p>If a <code class=css>::marker</code> pseudo-element has its 'content' property set to ''normal'',
	the computed value of the marker's 'content' property must be determined
	according to the following algorithm:</p>

	<ol>
		<li>If the computed value of 'list-style-image' is a valid &lt;image>, then 
		the computed value of the 'content' property is that image.</li>

		<li>Otherwise, if the computed value of 'list-style-type' is a &lt;string>, then 
		the computed value of the 'content' property is that string.</li>

		<li>Otherwise, if the computed value of 'list-style-type' is a valid <i>&lt;counter-style></i>, then the computed value of the 'content' property is <code>&lt;counter-prefix> counter(list-item, &lt;counter-style>) &lt;counter-suffix></code>, where <i>&lt;counter-prefix></i> and <i>&lt;counter-suffix></i> are the values of the <i title='counter-prefix'>prefix</i> and <i title='counter-suffix'>suffix</i> descriptors for the counter style.</li>

		<li>Otherwise the computed value is ''none''.</li>
	</ol>

	<div class="example">
		<p>Given the following style sheet:</p>

		<pre>
li { display: list-item; list-style-type: decimal /* initial value */; }
li<code class=css>::marker</code> { content: normal /* initial value */; }</pre>

		<p>And the following document fragment:</p>

		<pre>&lt;li>List Item&lt;/li></pre>

		<p>The computed value of the 'content' property on the <code class=css>::marker</code> pseudo-element of the list item element is:</p>

		<pre>counter(list-item, decimal) "."</pre>
	</div>

<!-- ===================================================================== -->
<h2 id='positioning-markers'>
Positioning Markers</h2>

	<p>This section introduces a new positioning scheme, designed to model the 
	way in which "outside" list markers were traditionally positioned in CSS 2.1.  
	Outside list markers now have their positioning defined	in terms of this new 
	value.</p>

	<p>The new positioning scheme defined in this section can be used on all 
	elements, not just <code class=css>::marker</code> pseudo-elements.  In some situations, such as 
	legal proceedings or official minutes, the precise form that the list marker 
	takes is a vital part of the content.  It's not acceptable for the marker to 
	change (from a custom-defined marker to a default bullet or alpha marker) 
	just because the UA is not rendering CSS, or a server error is temporarily 
	preventing the CSS file from being loaded, as the precise form of the marker 
	is used to officially refer to that segment. The only way to guarantee that 
	the marker will be rendered correctly, regardless of whether CSS is applied, 
	is to specify the marker outside of CSS, directly in the document's markup.  
	However, the page author may still want to style the marker in many of the 
	ways that are available to them when using ordinary CSS-generated markers.  
	To accomodate this, the new positioning scheme can be used to position the 
	marker-in-content as if it were an ordinary CSS-generated marker.</p>

<h3 id='position-marker'>
The ''marker'' value for 'position'</h3>

	<table class="propdef">
		<tr>
			<th>Property:
			<td>'position'
		<tr>
			<th>New Value:
			<td>''marker''
		<tr>
			<th>Initial:
			<td>same as CSS2.1
		<tr>
			<th>Applies to:
			<td>same as CSS2.1
		<tr>
			<th>Inherited:
			<td>same as CSS2.1
		<tr>
			<th>Percentages:
			<td>same as CSS2.1
		<tr>
			<th>Media:
			<td>same as CSS2.1
		<tr>
			<th>Computed&nbsp;value:
			<td>see prose, otherwise same as CSS2.1
	</table>

	<p>The ''marker'' value for 'position' depends on the element it is set on having a list item ancestor.  If the specified value of 'position' is ''marker'' and the element does not have a list item ancestor, 'position' must compute to 'relative' on the element.  An element with <code class=css>position:marker</code> counts as <a href="http://www.w3.org/TR/CSS21/visuren.html#absolutely-positioned">absolutely positioned</a>.</p>

	<p>To calculate the marker's position, we must first define a few terms:</p>

	<dl>
		<dt><dfn title="ancestor list item|ancestor list item's">ancestor list item</dfn></dt>
		<dd>The <i>ancestor list item</i> is the marker's nearest list item ancestor element.</dd>

		<dt><dfn>marker positioning reference element</dfn></dt>
		<dd>
			<p>If the <i>ancestor list item</i> has ''marker-attachment:list-item'', the <i>marker positioning reference element</i> is the <i>ancestor list item</i>.</p>

			<p>Otherwise, if the <i>ancestor list item</i> has ''marker-attachment:list-container'' and has a parent element, the <i>marker positioning reference element</i> is the <i>ancestor list item's</i> parent.</p>
			
			<p>Otherwise, the <i>marker positioning reference element</i> is the <i>ancestor list item</i>.</p>
		</dd>

		<dt><dfn>list item positioning edge</dfn></dt>
		<dd>The border edge of the <i>ancestor list item</i> corresponding to the "start" or "before" edge of the <i>marker positioning reference element</i>, whichever is in the <i>ancestor list item's</i> inline axis.</dd>

		<dt><dfn>marker positioning edge</dfn></dt>
		<dd>The opposing edge relative to the <i>list item positioning edge</i> on the marker's margin box.  For example, if the <i>list item positioning edge ended up being the left border edge of the <i>ancestor list item</i>, the <i>marker positioning edge</i> would be the right margin edge of the marker.</dd>
	</dl>

	<p>The marker's position in the <i>ancestor list item's</i> block axis is calculated according to the <a href="http://www.w3.org/TR/CSS21/visuren.html#normal-flow">normal flow</a>. <span class='note'>In the Positioned Layout Module this will be defined more precisely in terms of placeholders.</span></p>

	<p>The marker's position in the <i>ancestor list item's</i> inline axis must be set such that the <i>marker positioning edge</i> is flush with the <i>list item positioning edge</i>.</p>

	<p class='note'>The purpose of this somewhat convoluted definition is to position the marker flush against its list item, and then when "marker-attachment:list-container", keep all the markers for a given list on the same side of their list items even in mixed-direction text, so that authors can specify padding on only one side and still ensure their markers are visible.  And on top of all that, do something sane in the face of potentially differing writing-modes on the marker, list item, and container.</p>

	<p>All elements or pseudo-elements with <code class=css>"position:marker"</code> that share a common <i>ancestor list item</i> are known as <dfn title='associated-marker'>markers associated with that list item</dfn>.</p>

	<p>The 'top', 'right', 'bottom', and 'left' properties specify offsets relative to the top, right, bottom, and left edges (respectively) of the element itself, similar to how relative positioning works.</p>

	<div class='example'>
		<p>''position:marker'' can be used when the precise list marker is important for the content, not a stylistic choice, but the normal <em>appearance</em> of lists is still desired.  For example, this trimmed snippet of the US Code of Laws may be marked up as the following in HTML:</p>

		<pre>
&lt;style>
ol { list-style: none; }
.marker { position: marker; }
&lt;/style>
&lt;ol>
   &lt;li>
      &lt;span class='marker'>(a)&lt;/span> Definitions.— For purposes of this section—
      &lt;ol>
         &lt;li>&lt;span class='marker'>(1)&lt;/span> the term “agency” means agency as...&lt;/li>
         &lt;li>&lt;span class='marker'>(2)&lt;/span> the term “individual” means a citizen...&lt;/li>
      &lt;/ol>
   &lt;/li>
   &lt;li>
      &lt;span class='marker'>(b)&lt;/span> Conditions of Disclosure.— No agency shall disclose...
      &lt;ol>
         &lt;li>&lt;span class='marker'>(1)&lt;/span> to those officers and employees of the agency which...&lt;/li>
         &lt;li>&lt;span class='marker'>(2)&lt;/span> required under section 552 of this title;&lt;/li>
      &lt;/ol>
   &lt;/li>
&lt;/ol></pre>

		<p>The preceding document should render something like this:</p>

		<pre>
 (a) Definitions.— For purposes of this section—
     (1) the term “agency” means agency as...
     (2) the term “individual” means a citizen...
 (b) Conditions of Disclosure.— No agency shall disclose...
     (1) to those officers and employees of the agency which...
     (2) required under section 552 of this title;</pre>

		<p>Importantly, it will <strong>always</strong> be presented something like that, with those exact list markers, even if the stylesheet is unavailable, so other documents can refer to those list markers and be confident that the reference will always be resolvable.</p>
	</div>

<h3 id='marker-attachment'>
The 'marker-attachment' property</h3>

	<p>By default, elements or <code class=css>::marker</code> pseudo-elements with ''position:marker'' position themselves according to their list item's directionality.  However, if the list item is grouped with several other list items which may have different directionality (for example, multiple &lt;li>s with different "dir" attributes in an &lt;ol> in HTML), it is sometimes more useful to have all the markers line up on one side, so the author can specify a single "gutter" on that side and be assured that all the markers will lie in that gutter and be visible.  The 'marker-attachment' property defined in this section allows an author to control this, switching list items to positioning their markers based off the list container's directionality instead.</p>

	<table class="propdef">
		<tr>
			<th>Property:
			<td><dfn>marker-attachment</dfn>
		<tr>
			<th>Value:
			<td>list-item | list-container
		<tr>
			<th>Initial:
			<td>list-item
		<tr>
			<th>Applies to:
			<td><i title="list item">list items</i>
		<tr>
			<th>Inherited:
			<td>yes
		<tr>
			<th>Percentages:
			<td>N/A
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Computed Value:
			<td>specified value
	</table>

	<p>When a list item has ''marker-attachment:list-item'', any <i title='associated-marker'>markers associated with the list item</i> base their positioning off of the directionality of the list item.  When a list item has ''marker-attachment:list-container'', the <i title='associated-marker'>associated markers</i> instead base their positioning off of the directionality of the list item's parent element.  The normative meaning of this is specified in the section defining <a href="#position-marker">position:marker</a>.</p>

	<div class='example'>
		<p>Here is a visual rendering of the effect that 'marker-attachment' can have on a list.  Both of the following renderings are generated from the following HTML, with the only difference being the value of 'marker-attachment' on the list:</p>

		<pre>
&lt;ul>
	&lt;li>english one
	&lt;li dir=rtl>OWT WERBEH
	&lt;li>english three
	&lt;li dir=rtl>RUOF WERBEH
&lt;/ul></pre>

		<table class=data style="width: 35em;">
			<thead>
				<tr>
					<th>list-item
					<th>list-container
			<tbody>
				<tr>
					<td style="border-right: thin solid">
						<ul>
							<li>english one
							<li dir=rtl>OWT WERBEH
							<li>english three
							<li dir=rtl>RUOF WERBEH
						</ul>
					<td>
						<ul>
							<li>english one
							<li>OWT WERBEH
							<li>english three
							<li>RUOF WERBEH
						</ul>
		</table>
	</div>



<!-- ===================================================================== -->

<h2 id='counter-style'>
Defining Custom Counter Styles: the ''@counter-style'' rule</h2>

	<p>CSS 2.1 defined a handful of useful counter styles based on the styles that
	HTML traditionally allowed on ordered and unordered lists.  This tiny set, though,
	is quite inadequate for modern web pages; displaying an ordered list with markers 
	based on the latin alphabet while the content is Arabic seems quite incongruous!</p>

	<p>Unfortunately, the set of potentially useful list styles is too large to
	specify ahead of time - the world contains thousands of languages and hundreds
	of scripts, not to mention the near-infinite stylistic variations found on the
	web that go beyond mere languaged-based variation.  The ''@counter-style'' rule
	allows CSS to address this in an open-ended manner, by allowing the author
	to define their own counter styles.  These styles can then be used in the
	'list-style-type' property or in the ''counter()'' and ''counters()'' functions,
	exactly like the Complex Counter Styles in CSS.</p>

	<p>A <dfn>counter style</dfn> defines how to construct the representation of a
	counter value.  Counter styles are composed of:</p>
	
	<ul>
		<li>a <dfn title='counter-name'>name</dfn>, to identify the style</li>
		
		<li>an <dfn title='counter-algorithm'>algorithm</dfn> that transforms counter 
		values into a string representation</li>
		
		<li>a <dfn title='counter-negative'>negative sign</dfn>, which is prepended or
		appended to the representation of a negative counter value</li>
		
		<li>a <dfn title='counter-prefix'>prefix</dfn>, to prepend to the representation</li>
		
		<li>a <dfn title='counter-suffix'>suffix</dfn>, to append to the representation</li>
		
		<li>an <dfn title='counter-upper-bound'>upper</dfn> and 
		<dfn title='counter-lower-bound'>lower range bound</dfn>, to specify the 
		(inclusive) range that the counter style can handle</li>
		
		<li>and a <dfn title='counter-fallback'>fallback style</dfn>, to render the 
		representation with when the counter value is outside the counter style's 
		range or the counter style otherwise can't render the counter value</li>
	</ul>
	
	<p>The algorithm is usually specified implicitly by a combination of the ''type'',
	''symbols'', and ''additive-symbols'' properties, but some counter styles
	instead have their algorithm explicitly defined in the 
	<a href='#predefined-counters'>Complex Counter Styles</a> section.</p>

	<p>When asked to <i title='generate-a-counter'>generate a counter representation</i>
	using a particular counter style for a particular counter value, follow these steps:</p>

	<ol>
		<li>If the counter value is less than the <i title='counter-lower-bound'>lower bound</i>
		or greater than the <i title='counter-upper-bound'>upper bound</i> of the counter
		style, exit this algorithm and instead <i title='generate-a-counter'>generate a counter representation</i>
		using the counter style's fallback style and the same counter value.</li>

		<li>If the counter value is negative, set the <var>negative</var> flag and
		run the rest of this algorithm with the counter value set to its absolute value instead.</li>

		<li>Using the counter value and the <i title='counter-algorithm'>counter algorithm</i> 
		for the counter style, generate an initial representation for the counter value.</li>

		<li>If the <var>negative</var> flag is set, wrap the initial representation in the
		counter style's <i title='counter-negative'>negative sign</i>, as specified in
		the section for the <a href='#counter-style-negative'>negative descriptor</a>.</li>

		<li>Return the representation.</li>
	</ol>

	<p class='note'>Note that the prefix and suffix don't play a part in this algorithm.  This is intentional; the prefix and suffix aren't part of the string returned by the counter() or counters() functions.  Instead, the prefix and suffix are added by the algorithm that constructs the computed value of the 'contents' property for the <code class=css>::marker</code> pseudo-element.  This also implies that the prefix and suffix always come from the specified counter-style, even if the actual representation is constructed by a fallback style.</p>

	<p>The general form of an ''@counter-style'' rule is:</p>

	<pre>
@counter-style <i>&lt;counter-style-name></i> {
	[ descriptor: value; ]+
}
	</pre>

	<p>Each @counter-style rule specifies a value for every counter-style descriptor,
	either implicitly or explicitly.  Those not given explicit value in the rule
	take the initial value listed with each descriptor in this specification.
	These descriptors apply solely within the context of the @counter-style rule
	in which they are defined, and do not apply to document language elements.
	There is no notion of which elements the descriptors apply to or whether the
	values are inherited by child elements.  When a given descriptor occurs 
	multiple times in a given @counter-style rule, only the last specified value
	is used; all prior values for that descriptor must be ignored.</p>

	<p>This at-rule conforms with the forward-compatible parsing requirement of CSS; parsers may ignore these rules without error. Any descriptors that are not recognized or implemented by a given user agent must be ignored.  The <i>&lt;counter-style-name></i> must be be a valid identifier and must not be "decimal", "default", "inherit", "initial", "inside", "none", or "outside"; otherwise the @counter-style is invalid and must be ignored.</p>

<h3 id='counter-style-type'>
Counter algorithms: the 'type' descriptor</h3>

	<table class='descdef'>
		<tr>
			<th>Name:
			<td><dfn id="descdef-type">type</dfn>
		<tr>
			<th>Value:
			<td>repeating | numeric | alphabetic | symbolic | additive | <span class=nobr>[non-repeating &lt;integer>?]</span> | <span class=nobr>[ override &lt;counter-style-name> ]</span>
		<tr>
			<th>Initial:
			<td>symbolic
	</table>

	<p>The 'type' descriptor specifies which algorithm will be used to construct
	the counter's representation based on the counter value.  For example, 
	''repeating'' type counter styles just cycle through their symbols repeatedly, 
	while <i>numeric</i> type counter styles interpret their symbols as digits and 
	build their representation accordingly.  The types are defined as follows:</p>


<h4>
repeating</h4>

	<p>If the type is <a href=#repeating>repeating</a>, the 'symbols' descriptor must contain 
	at least one <i>counter symbol</i>. This type is defined over all counter 
	values.</p>

	<p>The <i>repeating</i> counter type cycles repeatedly through its provided
	symbols, looping back to the beginning when it reaches the end of the
	list, similar to the default <i>disc</i> counter style.  It can be used for 
	simple bullets (just provide a single <i>counter symbol</i>), or for cycling 
	through multiple bullets.  The first <i>counter symbol</i> is used as the 
	representation of the value 1, the second <i>counter symbol</i> (if it exists) 
	is used as the representation of the value 2, etc.</p>

	<p>In general, if there are <var>length</var> <i>counter symbols</i> and
	a representation is being constructed for the value <var>value</var>, 
	the representation is the <i>counter symbol</i> at index 
	(<var>value</var> mod <var>length</var>) of the list of <i>counter symbol</i>s
	(0-indexed).</p>

	<div class=example>
		<p>A "triangle bullet" counter style can be defined as:</p>

		<pre>
@counter-style <dfn>triangle</dfn> {
	type: repeating;
	symbols: '▶';
	suffix: '';
}
		</pre>

		<p>It will then produce lists that look like:</p>

		<pre>
▶  One
▶  Two
▶  Three
		</pre>
	</div>

<h4>
numeric</h4>

	<p>If the type is <a href=#numeric>numeric</a>, the 'symbols' descriptor must contain at
	least two <i>counter symbol</i>s. This type is defined over all counter 
	values.</p>

	<p>The <i>numeric</i> counter type cycles interprets the list of 
	<i>counter symbol</i>s as digits to a number system, similar to the default
	<i>decimal</i> counter style.  The first <i>counter symbol</i> in the list is 
	interpreted as the digit 0, the second as the digit 1, and so on.  If there 
	are <var>length</var> <i>counter symbol</i>s, the representation is a base 
	<var>length</var> number using the <i>counter symbol</i>s as digits.</p>

	<p>To construct the representation, run the following algorithm. Let
	<var>length</var> be the length of the list of <i>counter symbols</i>, 
	<var>value</var> initially be the counter value, <var>S</var>
	initially be the empty string, <var>negative</var> be a boolean flag
	that is initially false, and <var>symbol(n)</var> be the nth
	<i>counter symbol</i> in the list of <i>counter symbol</i>s (0-indexed).</p>

	<ol>
		<li>If <var>value</var> is 0, append <var>symbol(0)</var> to 
		<var>S</var> and return <var>S</var>.</li>

		<li>While <var>value</var> is not equal to 0:

			<ol>
				<li>Prepend <var>symbol( <var>value</var> mod <var>length</var> )</var> 
				to <var>S</var>.</li>

				<li>Set <var>value</var> to <code>floor( <var>value</var> / <var>length</var> )</code>.</li>
			</ol>
		</li>

		<li>Return <var>S</var>.</li>
	</ol>

	<div class=example>
		<p>A "trinary" counter style can be defined as:</p>

		<pre>
@counter-style <dfn>trinary</dfn> {
	type: numeric;
	symbols: '0' '1' '2';
}
		</pre>

		<p>It will then produce lists that look like:</p>

		<pre>
1.   One
2.   Two
10.  Three
11.  Four
12.  Five
20.  Six
		</pre>
	</div>


<h4>
alphabetic</h4>

	<p>If the type is <a href=#alphabetic>alphabetic</a>, the 'symbols' descriptor must contain
	at least two <i>counter symbol</i>s.  This type is defined only over
	positive counter values.</p>

	<p>The <i>alphabetic</i> counter type interprets the list of <i>counter symbols</i>
	as digits to an <em>alphabetic</em> numbering system, similar to the default
	''lower-alpha'' counter style. Alphabetic numbering systems are commonly used 
	for lists, and also appear in many spreadsheet programs to number columns. 
	The first <i>counter symbol</i> in the list is interpreted as the digit 1, 
	the second as the digit 2, and so on.  If there are <var>length</var> 
	<i>counter symbol</i>s, the representation is a base <var>length</var> alphabetic 
	number using the <i>counter symbol</i>s as digits.  Alphabetic numbering 
	systems do not contain a digit representing 0.</p>

	<p>To construct the representation, run the following algorithm.  Let
	<var>length</var> be the length of the list of <i>counter symbol</i>s,
	<var>value</var> initially be the counter value, <var>S</var> initially
	be the empty string, and <var>symbol(n)</var> be the nth <i>counter symbol</i>
	in the list of <i>counter symbol</i>s (0-indexed).</p>

	<p>While <var>value</var> is not equal to 0:</p>

	<ol>
		<li>Set <var>value</var> to <code><var>value</var> - 1</code>.</li>

		<li>Prepend <var>symbol( <var>value</var> mod <var>length</var> )</var>
		to <var>S</var>.</li>

		<li>Set <var>value</var> to <code>floor( <var>value</var> / <var>length</var> )</code>.</li>
	</ol>

	<p>Finally, return <var>S</var>.</p>

	<div class=example>
		<p>A counter style using go stones can be defined as:</p>

		<pre>
@counter-style <dfn>go</dfn> {
	type: alphabetic;
	symbols: url(white.svg) url(black.svg);
	suffix: '';
}
		</pre>

		<p>It will then produce lists that look like:</p>

		<div class='alphabetic-example'>
<span><img src=white.svg alt=''></span> One<br>
<span><img src=black.svg alt=''></span> Two<br>
<span><img src=white.svg alt=''><img src=white.svg alt=''></span>  Three<br>
<span><img src=white.svg alt=''><img src=black.svg alt=''></span>  Four<br>
<span><img src=black.svg alt=''><img src=white.svg alt=''></span>  Five<br>
<span><img src=black.svg alt=''><img src=black.svg alt=''></span>  Six<br>
<span><img src=white.svg alt=''><img src=white.svg alt=''><img src=white.svg alt=''></span> Seven
		</div>

		<p class='note'>This example requires support for SVG images to display
		correctly.</p>
	</div>

	<div class='example'>
		<p>Alphabetic styles may also be used to simulate a fixed-width numeric
		style:</p>

		<pre>
@counter-style <dfn>fixed-decimal</dfn> {
	type: alphabetic;
	symbols: '0' '1' '2' '3' '4' '5' '6' '7' '8' '9';
}

ol { 
	list-style: fixed-decimal;
	counter-reset: list-item 1111; 
}
		</pre>

		<p>This will produce lists that look like:</p>

		<pre>
0001.  One
0002.  Two
0003.  Three
0004.  Four
0005.  Five
0006.  Six
		</pre>

		<p>Two-digit numbers start at value 11, three-digit numbers start at 
		value 111, etc..</p>

		<p class='issue'>Should I instead explicitly provide a fixed-width numeric
		counter type?  I'd like to see if this sort of numbering is used in the
		wild first.</p>
	</div>


<h4>
symbolic</h4>

	<p>If the type is <a href=#symbolic>symbolic</a>, the 'symbols' descriptor must contain at
	least one <i>counter symbol</i>.  This type is defined only over positive
	counter values.</p>

	<p>The <i>symbolic</i> counter type cycles repeatedly through its provided symbols,
	doubling, tripling, etc. the symbols on each successive pass through the list.
	For example, if the original symbols were "*" and "†", then on the second pass
	they would instead be "**" and "††", while on the third they would be "***"
	and "†††", etc.
	It can be used for footnote-style markers, and is also sometimes used for
	alphabetic-style lists for a slightly different presentation than what the
	<i>alphabetic</i> type presents.</p>

	<p>To construct the representation, run the following algorithm.  Let
	<var>length</var> be the length of the list of <i>counter symbol</i>s,
	<var>value</var> initially be the counter value, <var>S</var> initially
	be the empty string, and <var>symbol(n)</var> be the nth <i>counter symbol</i>
	in the list of <i>counter symbol</i>s (0-indexed).</p>

	<ol>
		<li>Let the <var>chosen symbol</var> be <code class='inline'>symbol(<var>value</var> mod <var>length</var>)</code>.</li>

		<li>Let the <var>representation length</var> be <code class='inline'>floor( (<var>value</var> - 1) / <var>length</var> )</code>.

		<li>Append the <var>chosen symbol</var> to <var>S</var> a number of times equal to the <var>representation length</var>.</li>
	</ol>

	<p>Finally, return <var>S</var>.</p>

	<div class=example>
		<p>An "footnote" counter style can be defined as:</p>

		<pre>
@counter-style <dfn>footnote</dfn> {
	type: symbolic;
	symbols: '*' '⁑' '†' '‡';
	suffix: '';
}
		</pre>

		<p>It will then produce lists that look like:</p>

		<pre>
*.   One
⁑.   Two
†.   Three
‡.   Four
**.  Five
⁑⁑.  Six
		</pre>
	</div>

	<div class=example>
		<p>Some style guides mandate a list numbering that looks similar to ''upper-alpha'', but repeats differently after the first 26 values, instead going "AA", "BB", "CC", etc.  This can be achieved with the symbolic type:</p>

		<pre>
@counter-style <dfn>upper-alpha-legal</dfn> {
	type: symbolic;
	symbols: 'A' 'B' 'C' 'D' 'E' 'F' 'G' 'H' 'I' 'J' 'K' 'L' 'M' 
	        'N' 'O' 'P' 'Q' 'R' 'S' 'T' 'U' 'V' 'W' 'X' 'Y' 'Z';
}</pre>

		<p>This style is identical to ''upper-alpha'' through the first 27 values, but they diverge after that, with ''upper-alpha'' going "AB", "AC", "AD", etc.  Starting at the 53rd value, ''upper-alpha'' goes "BA", "BB", "BC", etc., while this style jumps up to the triple digits with "AAA", "BBB", "CCC", etc.</p>
	</div>

	<p>The <i>symbolic</i> type will produce representations with sizes that are 
	linear in the magnitude of the counter value.  This can potentially be abused
	to generate excessively large representations and consume undue amounts of
	the user's memory or even hang their browser.  User agents must support
	representations at least 20 characters long, but they may choose to instead
	use the fallback style for representations that would be longer than 20
	characters.</p>


<h4>
non-repeating</h4>

	<p>If the type is <a href=#non-repeating>non-repeating</a>, the 'symbols' descriptor must contain
	at least one <i>counter symbol</i>.  This type is defined over counter
	values in a finite range, starting with the <i>first symbol value</i>
	and having a length equal to the length of the list of <i>counter symbol</i>s.</p>

	<p>The <i>non-repeating</i> counter type is for representing counter styles
	that only have a finite number of representations.  For example, Unicode
	defines several limited-length runs of special characters meant for 
	lists, such as circled digits.</p>

	<p>When this type is specified, it may optionally have an integer provided
	after it, which sets the <dfn>first symbol value</dfn>.  If it is omitted,
	the <i>first symbol value</i> is 1.</p>

	<p>The first <i>counter symbol</i> is the representation for the 
	<i>first symbol value</i>, and subsequent counter values are represented
	by subsequent <i>counter symbol</i>s.  Once the list of <i>counter symbol</i>s
	is exhausted, further values cannot be represented by this type, and must
	instead be represented by the fallback counter style.</p>

	<div class=example>
		<p>A "box-corner" counter style can be defined as:</p>

		<pre>
@counter-style <dfn>box-corner</dfn> {
	type: non-repeating;
	symbols: '◰' '◳' '◲' '◱';
	suffix: ':';
}
		</pre>

		<p>It will then produce lists that look like:</p>

		<pre>
◰:  One
◳:  Two
◲:  Three
◱:  Four
5:  Five
6:  Six
		</pre>
	</div>


<h4>
additive</h4>

	<p>If the type is <a href=#additive>additive</a>, the 'additive-symbols' descriptor must
	contain at least one <i>additive tuple</i>.  This type is nominally
	defined over all positive counter values (see algorithm, below, for
	exact details)</p>

	<p>The <i>additive</i> counter type takes as many of the largest symbols that 
	it can, then as many of the next largest symbol, etc. until the sum of all 
	the symbols equals the counter value.  It can be used to implement roman 
	numerals, and additionally is used to represent the numbering system of 
	several languages which use different characters for the digits in differnt
	positions.</p>

	<p>To construct the representation, run this algorithm.  let <var>value</var> 
	initially be the counter value, <var>S</var> initially be the empty string, 
	and <var>symbol list</var> initially be the list of <i>additive tuple</i>s.

	<p>If <var>value</var> is initially 0, and there is an <i>additive tuple</i>
	with a weight of 0, append that tuple's <i>counter symbol</i> to S
	and return S.</p>

	<p>Otherwise, while <var>value</var> is greater than 0 and there are elements
	left in the <var>symbol list</var>:</p>

	<ol>
		<li>Pop the first <i>additive tuple</i> from the <var>symbol list</var>.
		This is the <dfn title="current tuple|current tuple's">current tuple</dfn>.</li>

		<li>Append the <i>current tuple</i>'s <i>counter symbol</i> to <var>S</var> 
		<code>floor( <var>value</var> / <var><i>current tuple's</i> weight</var> )</code>
		times (this may be 0).</li>

		<li>Decrement <var>value</var> by the <var><i>current tuple's</i> weight multiplied
		by the number of times the <i>current tuple</i> was appended to <var>S</var>
		in the previous step.</li>
	</ol>

	<p>If the loop ended because <var>value</var> is 0, return S.  Otherwise, the 
	given counter value cannot be represented by this counter style, and must
	instead be represented by the fallback counter style.</p>

	<div class=example>
		<p>A "dice" counter style can be defined as:</p>

		<pre>
@counter-style <dfn>dice</dfn> {
	type: additive;
	additive-symbols: 6 '⚅', 5 '⚄', 4 '⚃', 3 '⚂', 2 '⚁', 1 '⚀';
	suffix: '';
}
		</pre>

		<p>It will then produce lists that look like:</p>

		<pre>
⚀    One
⚁    Two
⚂    Three
...
⚅⚄   Eleven
⚅⚅   Twelve
⚅⚅⚀  Thirteen
		</pre>
	</div>

	<p>The <i>additive</i> type will produce representations with sizes that are 
	linear in the magnitude of the counter value.  This can potentially be abused
	to generate excessively large representations and consume undue amounts of
	the user's memory or even hang their browser.  User agents must support
	representations at least 20 characters long, but they may choose to instead
	use the fallback style for representations that would be longer than 20
	characters.</p>


<h4>
override</h4>

	<p>The <a href=#override>override</a> type allows an author to use the <i>algorithm</i> of another counter style, but alter other aspects, such as the negative sign or the suffix.  If a counter style uses the <i>override</i> type, any unspecified descriptors must be taken from the specified counter style, rather than taking their initial values.</p>

	<p>If a @counter-style uses the <i>override</i> type, it must not contain a
	'symbols' or 'additive-symbols' descriptor; otherwise it is invalid and must
	be ignored.  If the specified counter style name isn't the name of any
	currently-defined counter style, it must be treated as if it was overriding
	the <i>decimal</i> counter style.</p>


<h3 id='counter-style-negative'>
Formatting negative values: the 'negative' descriptor</h3>

	<table class='descdef'>
		<tr>
			<th>Name:
			<td><dfn id="descdef-negative">negative</dfn></td>
		<tr>
			<th>Value:
			<td>&lt;string> &lt;string>?
		<tr>
			<th>Initial:
			<td>"\2D" ("-" hyphen-minus)
	</table>

	<p>The 'negative' descriptor defines how to alter the representation when
	the counter value is negative.  Not all counter types can render negative
	numbers.</p>

	<p>The first string in the value is prepended to the representation when the
	counter value is negative.  The second string, if specified, is appended
	to the representation when the counter value is negative.</p>

	<div class='example'>
		<p>For example, specifying ''negative: "(" ")";'' will make negative
		values be wrapped in parentheses, which is sometimes used in financial
		contexts, like "(2) (1) 0 1 2 3...".</p>
	</div>


<h3 id='counter-style-prefix'>
Symbols before the marker: the 'prefix' descriptor</h3>

	<table class='descdef'>
		<tr>
			<th>Name:
			<td><dfn id="descdef-prefix">prefix</dfn>
		<tr>
			<th>Value:
			<td>&lt;string>
		<tr>
			<th>Initial:
			<td>"" (the empty string)
	</table>

	<p>The 'prefix' descripter specifies a string that is prepended to the 
	marker representation.  Prefixes are only added by the algorithm for constructing
	the default contents of the <code class=css>::marker</code> pseudo-element; the prefix is not 
	added automatically when the counter() or counters() functions are used.  
	Prefixes are added to the representation after negative signs.</p>


<h3 id='counter-style-suffix'>
Symbols after the marker: the 'suffix' descriptor</h3>

	<table class='descdef'>
		<tr>
			<th>Name:
			<td><dfn id="descdef-suffix">suffix</dfn>
		<tr>
			<th>Value:
			<td>&lt;string>
		<tr>
			<th>Initial:
			<td>"\2E" ("." full stop)
	</table>

	<p>The 'suffix' descripter specifies a string that is appended to the 
	marker representation.  Suffixes are only added by the algorithm for constructing
	the default contents of the <code class=css>::marker</code> pseudo-element; the suffix is not 
	added automatically when the counter() or counters() functions are used.  
	Suffixes are added to the representation after negative signs.</p>


<h3 id='counter-style-range'>
Limiting the counter scope: the 'range' descriptor</h3>

	<table class='descdef'>
		<tr>
			<th>Name:
			<td><dfn id="descdef-range">range</dfn>
		<tr>
			<th>Value:
			<td>[ &lt;integer> | infinite ]{2}
		<tr>
			<th>Initial:
			<td>infinite infinite
	</table>

	<p>The 'range' descriptor defines the range over which the counter style is defined.
	If a counter style is used to represent a counter value outside of its range,
	the counter style instead drops down to its fallback counter style.</p>

	<p>The first value represents the lower bound of the range (with 'infinite'
	representing negative infinity), and the second value represents the upper bound
	of the range (with 'infinite' representing positive infinity).  This is an inclusive
	range - it includes both the lower and upper bound numbers.  If the lower
	bound is higher than the higher bound, the descriptor is invalid and must
	be ignored.</p>

	<p>Some counter style types have their own implicit ranges, specified above 
	in the individual descriptions for each type.  The explicit range given
	by the ‘<code class="css">range</code>’ descriptor applies at the same time 
	as the implicit range given by the ‘<code class="css">type</code>’ 
	descriptor - if the counter value is less than either lower bound, or greater 
	than either upper bound, the fallback style must instead be used to generate 
	the representation.</p>

	<p class=issue>There's also an implicit range coming from implementation 
	limits.  Should we require UAs to support all values in a signed 2-byte int,
	or a signed 4-byte int?</p>


<h3 id='counter-style-fallback'>
Defining fallback: the 'fallback' descriptor</h3>

	<table class='descdef'>
		<tr>
			<th>Name:
			<td><dfn id="descdef-fallback">fallback</dfn>
		<tr>
			<th>Value:
			<td>&lt;counter-style-name>
		<tr>
			<th>Initial:
			<td>decimal
	</table>

	<p>The 'fallback' descriptor specifies a fallback counter style to be used
	when the current counter style can't create a representation for a given
	counter value.  For example, if a counter style defined with a range of 1-10
	is asked to represent a counter value of 11, the counter value's representation
	is instead constructed with the fallback counter style (or possibly the 
	fallback style's fallback style, if the fallback style can't represent that
	value, etc.).</p>

	<p>If the value of the 'fallback' descriptor isn't the name of any 
	currently-defined counter style, the used value of the 'fallback' descriptor
	is <i>decimal</i> instead.  Similarly, while following fallbacks to find
	a counter style that can render the given counter value, if a loop in the 
	specified fallbacks is detected, the <i>decimal</i> style must be used instead.</p>

	<p class='note'>Note that it is not necessarily an error to specify fallback
	loops.  For example, if an author desires a counter style with significantly
	different representations for even and odd counter values, they may find it 
	easiest to define one style that can only represent odd values and one that 
	can only represent even values, and specify each as the fallback for the 
	other one.  Though the fallback graph is circular, at no point do you encounter 
	a loop while following these fallbacks - every counter value is represented 
	by one or the other counter style.  <span class='issue'>Is it useful to allow
	this case?  If it would be significantly easier for implementations to just
	detect and reject circular fallback graphs, that would probably be acceptable.</span></p>


<h3 id='counter-style-symbols'>
Marker characters: the 'symbols' and 'additive-symbols' descriptors</h3>

	<table class='descdef'>
		<tr>
			<th>Name:
			<td><dfn id="descdef-symbols">symbols</dfn>
		<tr>
			<th>Value:
			<td>[ &lt;string> | &lt;image> | &lt;identifier> ]+
		<tr>
			<th>Initial:
			<td>N/A
	</table>

	<table class='descdef'>
		<tr>
			<th>Name:
			<td><dfn id="descdef-additive-symbols">additive-symbols</dfn>
		<tr>
			<th>Value:
			<td>[ &lt;integer> && [ &lt;string> | &lt;image> | &lt;identifier> ] ]#
		<tr>
			<th>Initial:
			<td>N/A
	</table>

	<p>The 'symbols' and 'additive-symbols' descriptors specify the characters
	used by the marker-construction algorithm specified by the 'type' descriptor.
	The 'symbols' descriptor must be specified if the counter type is <i>repeating</i>,
	<i>numeric</i>, <i>alphabetic</i>, <i>symbolic</i>, or <i>non-repeating</i>, and the 
	'additive-symbols' descriptor must be specified if the counter type is
	<i>additive</i>; otherwise, the @counter-style is invalid and must be ignored.</p>

	<p>Some counter styles specify that the 'symbols' descriptor must have at
	least two entries.  If the counter's style is such a type, and the 'symbols'
	descriptor has only a single entry, the counter style is invalid and must
	be ignored.</p>

	<p>Each entry in the 'symbols' descriptor's value defines a <dfn>counter symbol</dfn>,
	which is interpreted differently based on the counter style's type.  Each
	entry in the 'additive-symbols' descriptor's value defines an <dfn>additive tuple</dfn>,
	which consists of a <i>counter symbol</i> and a non-negative integer weight.  
	Each weight must be a non-negative integer, and the <i>additive tuple</i>s
	must be specified in order of descending weight; otherwise, the @counter-style
	is invalid and must be ignored.</p>

	<p>Counter symbols may be strings, images, or identifiers, and the three types can be mixed in a single descriptor.  Counter representations are constructed by concatenating counter symbols together.  Identifiers are rendered as strings containing the same characters.  Images are rendered as inline replaced elements.  The <a href="http://dev.w3.org/csswg/css3-images/#default-object-size">default object size</a> of an image counter symbol is a 1em by 1em square.</p>


<!-- ====================================================================== -->

<h2 id='symbols-function'>
Defining Anonymous Counter Styles: the ''symbols()'' function</h2>

	<p>The previous chapter specified a way to define custom counter styles.  However, counter styles are sometimes used only once in a stylesheet, and defining a full ''@counter-style'' rule can be overkill for this case (not to mention the possibility of unintentional name collisions).  To address this case, the ''symbols()'' function provides a simple way to define an anonymous counter style as an inline value.  It does not provide the full feature-set of the ''@counter-style'' rule, but provides a sufficient subset to still be useful.  The syntax of the ''symbols()'' rule is:</p>

	<pre><dfn id='type-symbols-function'>&lt;symbols-function></dfn> = symbols( &lt;type>? [ &lt;string> | &lt;image> ]+ )</pre>

	<p>Where &lt;type> is one of the following keywords: ''repeating'', ''numeric'', ''alphabetic'', ''symbolic'', or ''non-repeating''.</p>

	<p>The ''symbols()'' function defines an anonymous counter style with no <i title="counter-name">name</i>, a <i title="counter-prefix">prefix</i> and <i title="counter-suffix">suffix</i> of ''""'' (the empty string), a <i title="counter-lower-bound">lower bound</i> of negative infinity, an <i title="counter-upper-bound">upper bound</i> of infinity, an <i title="counter-fallback">fallback style</i> of ''decimal'', and a <i title="counter-negative">negative sign</i> of "\2D" ("-" hyphen-minus).  The counter style's <i title="counter-algorithm">algorithm</i> is constructed by consulting the previous chapter using the provided type - or ''symbolic'' if the type was omitted - and the provided &lt;string>s and &lt;image>s as the value of the 'symbols' property.</p>

	<div class='example'>
		<p>This code:</p>
		
		<pre>ol { list-style: symbols("*" "\2020" "\2021" "\A7"); }</pre>

		<p>will produce lists that look like:</p>
		
		<pre>
*   One
†   Two
‡   Three
§   Four
**  Five
††  Six
‡‡  Seven</pre>

		<p>On the other hand, specifying the type of counter, like so:</p>
		
		<pre>ol { list-style: symbols(repeating "*" "\2020" "\2021" "\A7"); }</pre>

		<p>will produce lists that look like:</p>
		
		<pre>
*   One
†   Two
‡   Three
§   Four
*   Five
†   Six
‡   Seven</pre>
	</div>

	<p class='note'>Note that the ''symbols()'' function only allows strings and images, while the 'symbols' descriptor of a ''@counter-style'' rule also allows identifiers.</p>


<h2 id="html4">
Sample style sheet for HTML</h2>

	<p>This section is informative, not normative.  HTML itself defines the
	actual default properties that apply to HTML lists.</p>

	<pre>
/* Set up list items */
li { 
	display: list-item; 
	/* counter-increment: list-item; (implied by display: list-item) */ 
}

/* Set up ol and ul so that they reset the list-item counter */
ol, ul { 
	counter-reset: list-item; 
}

/* Default list style types for ordered lists */
ol { 
	list-style-type: decimal; 
}

/* Default list style types for unordered lists up to 3 deep */
ul { list-style-type: disc; }
ul ul { list-style-type: square; }
ul ul ul { list-style-type: circle; }

/* The type attribute on ol and ul elements */
ul[type="disc"] { list-style-type: disc; }
ul[type="circle"] { list-style-type: circle; }
ul[type="square"] { list-style-type: square; }
ol[type="1"] { list-style-type: decimal; }
ol[type="a"] { list-style-type: lower-alpha; }
ol[type="A"] { list-style-type: upper-alpha; }
ol[type="i"] { list-style-type: lower-roman; }
ol[type="I"] { list-style-type: upper-roman; }

/* The start attribute on ol elements */
ol[start] { 
	counter-reset: list-item attr(start, integer, 1); 
	counter-increment: list-item -1; 
}

/* The value attribute on li elements */
li[value] { 
	counter-reset: list-item attr(value, integer, 1); 
	counter-increment: none;<!-- XXX interaction with default increase --> 
}

/* Box Model Rules */
ol, ul { 
	display: block; 
	margin: 1em 0; 
	padding-left: 40px;
	marker-attachment: list-container;
}
 
ol ol, ol ul, ul ul, ul ol { 
	margin-top: 0; 
	margin-bottom: 0; 
}

li {
	text-align: match-parent;
}
 
li<code class=css>::marker</code> { 
	display: inline;
	margin-right: 1em;
	text-align: end;
	unicode-bidi: isolate;
	/* 'position' computes to "static" or "marker" depending on list-style-position */
}
	</pre>

<!-- ====================================================================== -->

<h2 class="no-num" id="profiles">
Profiles</h2>

	<p>This module has two profiles: CSS Level 1 and Full. There is no
	CSS2 profile because this module is incompatible with the CSS2 list
	model.</p>

	<p>The CSS Level 1 module consists of 'list-style', 'list-style-position', 
	'list-style-image', and 'list-style-type' (but only the following
	values: 'disc', 'circle, square', 'decimal', 'lower-roman',
	'upper-roman', 'lower-alpha', 'upper-alpha', 'none'). It does not
	include the <code class=css>::marker</code> pseudo element.</p>

	<p>The Full profile contains everything.</p>

<!-- ====================================================================== -->

<h2 class="no-num" id="acknowledgments">
Acknowledgments</h2>

	<p>The following people and documentation they wrote were very useful
	for defining the numbering systems: <!-- alphabetical by full name -->
	Alexander Savenkov,
	Arron Eicholz,
	Aryeh Gregor,
	Frank Tang,
	Jonathan Rosenne,
	Karl Ove Hufthammer,
	Musheg Arakelyan,
	Nariné Renard Karapetyan,
	Randall Bart,
	Richard Ishida,
	Simon Montagu (Mozilla, smontagu@smontagu.org)
	</p>

	 <!-- see http://www.damowmow.com/temp/csswg/lists/part2.html 
		       http://www.qsm.co.il/Hebrew/Gimatria.htm
		       http://people.netscape.com/smontagu/writings/HebrewNumbers.html
		       http://www.ethiopic.org/Collation/OrderedLists.html
		       http://bugzilla.mozilla.org/show_bug.cgi?id=102252 -->

<!-- ====================================================================== -->

<h2 class="no-num" id="changes">
Changes From CSS2.1</h2>

	<p>As described in the introduction section, there are significant changes in this module when
	compared to CSS2.1.</p>

	<ol>
		<li>The <code class=css>::marker</code> pseudo-element has been introduced to allow styling of the list marker directly.</li>

		<li>The ''marker'' value for 'position' has been added, to allow elements in the document to position themselves similarly to how markers do.</li>

		<li>Many new list style types have been added, along with explicit algorithms for each.</li>

		<li>The list-item predefined counter identifier has been introduced.</li>
	</ol>

<!-- ====================================================================== -->

<h2 class="no-num" id="references">References</h2>

<h3 class="no-num">Normative references</h3>
<!--normative-->

<h3 class="no-num">Other references</h3>
<!--informative-->

<h2 class="no-num">Property index</h2>
<!-- properties -->

<h2 class="no-num">Index</h2>
<!--index-->

</body>
</html>
