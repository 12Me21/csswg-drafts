<!DOCTYPE html public '-//W3C//DTD HTML 4.01//EN' 'http://www.w3.org/TR/html4/strict.dtd'>
<html lang="en">
<head profile="http://www.w3.org/2006/03/hcard">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>CSS Transforms</title>
  <link rel="stylesheet" type="text/css" href="../default.css" />
  <link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/W3C-ED.css" />

  <style type="text/css">
    .prop-name {
      font-weight: bold;
    }
    
    .prop-value {
      font-family: monospace;
    }
    
    .term {
      font-style: italic;
    }
     
     div.issue-marker {
         position: absolute;
         width: 20ex;
         margin-left: -26ex;
         padding-right: 0.5em;
         font-weight: normal;
         font-size: 11px;
         text-align: right;
         background-color: white;
         font-size: 90%;
         padding-top: 0px;
         padding-bottom: 0px;
     }

     div.issue-marker a {
         color: red;
     }
     
     div.issue-marker .desc {
         font-size: 80%;
         line-height: 1.4em;
     }
     
     div.issue-marker .desc strong {
         font-weight: bold;
         font-size: 120%;
         color: red;
     }
          
     .todo {
         font-weight: bold;
         border-left: 0.5em solid #f44;
         padding-left: 1em;
         margin-top: 0.5em;
         color: #a0a0a0;
     }

     .todo:before {
         content: "TO DO : ";
         color: #f44;
     }
  </style>

</head>
<body>
    <div id="div-head" class="head">
        <!--logo-->

        <h1>CSS Transforms</h1>

        <h2 class="no-num no-toc">[LONGSTATUS] [DATE]</h2>
        <dl>
          <dt>This version:
            <dd>
            <a href="[VERSION]">http://dev.w3.org/csswg/css3-transforms/</a>
            <!--http://www.w3.org/TR/[YEAR]/WD-[SHORTNAME]-[CDATE]-->
          <dt>Latest version:
            <dd><a
              href="http://www.w3.org/TR/css3-transforms">[LATEST]</a>
          <dt>Previous version:
            <dd>None
          <dt id="editors-list">Editors:
            <dd>Simon Fraser (<a href="http://www.apple.com/">Apple Inc</a>) &lt;simon.fraser &#64;apple.com&gt;
            <dd>Dean Jackson (<a href="http://www.apple.com/">Apple Inc</a>) &lt;dino &#64;apple.com&gt;
            <dd>David Hyatt (<a href="http://www.apple.com/">Apple Inc</a>) &lt;hyatt &#64;apple.com&gt;
            <dd>Chris Marrin (<a href="http://www.apple.com/">Apple Inc</a>) &lt;cmarrin &#64;apple.com&gt;
            <dd>Edward O'Connor (<a href="http://www.apple.com/">Apple Inc</a>) &lt;eoconnor &#64;apple.com&gt;
            <dd>Vincent Hardy (<a href="http://www.adobe.com/">Adobe Systems, Inc</a>) &lt;vhardy &#64;adobe.com&gt;
            <dd>Dirk Schulze (<a href="http://www.adobe.com/">Adobe Systems, Inc</a>) &lt;dschulze &#64;adobe.com&gt;
        </dl>

        <!--copyright-->

        <hr title="Separator for header">
        </div>

        <h2 class="no-num no-toc" id="abstract">Abstract</h2>
        
        <p>CSS transforms allows elements styled with CSS to be transformed
          in two-dimensional or three-dimensional space. This specification is the convergence of the 
            <a href="http://www.w3.org/TR/css3-2d-transforms/">CSS 2D transforms</a>, 
          <a href="http://www.w3.org/TR/css3-3d-transforms/">CSS 3D transforms</a>
          and <a href="http://www.w3.org/TR/2009/WD-SVG-Transforms-20090320/">SVG transforms</a> 
          specifications.</p>

        <h2 class="no-num no-toc" id="status">Status of this document</h2>

        <p class="note">
          This specification merges the former CSS 2D Transforms and CSS 3D Transforms specifications and 
          will also merge CSS Transforms and SVG Transforms. The merge is in progress and the specification
          is not yet ready for review.
        </p>

        <!--status-->

        <p>
          The <a href="ChangeLog">list of changes made to this specification</a> is
          available.
        </p>

        <h2 class="no-num no-toc" id="contents">Table of contents</h2>
        <!--toc-->


        <h2>Introduction</h2>

          <p><em>This section is not normative.</em></p>
          <p>
            The CSS <a href="http://www.w3.org/TR/REC-CSS2/visuren.html">visual
            formatting model</a> describes a coordinate system within which each
            element is positioned. Positions and sizes in this coordinate space can
            be thought of as being expressed in pixels, starting in the upper left
            corner of the parent with positive values proceeding to the right and
            down.
          </p>
          <p>
            This coordinate space can be modified with the <span
            class="prop-name">'transform'</span> property. Using transform, elements
            can be translated, rotated and scaled in two or three dimensional space.
          </p>
          <p>
            Additional properties make working with transforms easier, and allow the
            author to control how nested three-dimensional transforms interact.
          </p>
          <ul>
            <li>
              The <span class="prop-name">'transform-origin'</span> property
              provides a convenient way to control the origin about which transforms on
              an element are applied.
            </li>
            <li>
              The <span class="prop-name">'perspective'</span> property allows the author
              to make child elements with three-dimensional transforms appear as if they live in a common
              three-dimensional space.
              The <span class="prop-name">'perspective-origin'</span> property provides control
              over the origin at which perspective is applied, effectively changing the location of
              the "vanishing point".
            </li>
            <li>
              The <span class="prop-name">'transform-style'</span> property allows 3D-transformed
              elements and their 3D-transformed descendants to share a common three-dimensional
              space, allowing the construction of hierarchies of three-dimensional objects.
            </li>
            <li>
               The <span class="prop-name">'backface-visibility'</span> property comes into play
               when an element is flipped around via three-dimensional transforms such that its
               reverse side is visible to the viewer. In some situations it is desirable to
               hide the element in this situation, which is possible using the value of 'hidden'
               for this property.
            </li>
          </ul>
          <p>
            Note that while some values of the <span class="prop-name">'transform'</span> property
            allow an element to be transformed in a three-dimensional coordinate system, the elements
            themselves are not three-dimensional objects. Instead, they exist on a two-dimensional
            plane (a flat surface) and have no depth.
          </p>

          <div class="issue">
            There are two roles for transformations in layout: (1) transformations
            that adjust the position of the affected content without changing the
            normal layout of that content (much like relative positioning) and (2)
            transformation of the content prior to layout that affects the layout
            of that content. See <a
            href="http://lists.w3.org/Archives/Public/www-style/2007Oct/0209">http://lists.w3.org/Archives/Public/www-style/2007Oct/0209</a>
            for examples of both cases. The "transform" property (as defined in
            this document) is equally useful for both roles. This document is
            focused on satisfying the first role. There is, however, an
            architectural question that arises because there needs to be a way to
            distinguish which role an author of a stylesheet wants. The key
            question is which is the default behavior/role for the "transform"
            property and how is the other behavior/role indicated by a stylesheet
            author. If you have an opinion on this topic, please send feedback.
          </div>
          <div class="issue">
            What do fixed backgrounds do in transforms? They should probably ignore
            the transform completely, since - even transformed - the object should
            be acting as "porthole" through which the fixed background can be viewed
            in its original form.
          </div>
          
        <!-- ======================================================================================================= -->

        <h2 id="module-interactions">Module Interactions</h2>
          <p>Write me</p>

        <h2 id="module-interactions">CSS Values</h2>
          <p>Write me</p>


        <h2 id="definitions">Definitions</h2>
          <p> When used in this specification, terms have the meanings assigned in
            this section.
          </p>
          <dl>
            <dt id="TermTransformableElement">
              <span class="termDefine">transformable element</span>
            </dt>
            <dd>
              <p>
                A transformable element in the HTML namespace which is either be a block-level or atomic inline-level
                element, or an element the SVG namespace (see [[SVG11]]) which has the attributes 'transform',
                'patternTransform' or 'gradientTransform'.
              </p>
            </dd>

            <dt id="Term3DRenderingContext">
              <span class="termDefine">3D rendering context</span>
            </dt>
            <dd>
              <p>
                All elements in the same <span class="term">3D rendering context</span> share a common three-dimensional
                coordinate system. Elements in the same 3D rendering context which intersect
                may be rendered as intersecting by the user agent.
              </p>
            </dd>
            <!-- Define "three-dimensional transform" ? -->
          </dl>

          <!-- ======================================================================================================= -->
              
          <h2 id="transform-rendering">The Transform Rendering Model</h2>
            <!-- This section is normative -->
              <p>
                Specifying a value other than 'none' for the <span class="prop-name">'transform'</span>
                property establishes a new <em>local coordinate system</em> at the element that it is
                applied to. Transformations are cumulative. That is, elements establish their local
                coordinate system within the coordinate system of their parent. From the perspective of the
                user, an element effectively accumulates all the <span class="prop-name">'transform'</span>
                properties of its ancestors as well as any local transform applied to it. The accumulation
                of these transforms defines a <em>current transformation matrix (CTM)</em> for the element.
              </p>
              <p>
                The coordinate space behaves as described in the <a
                href="http://www.w3.org/TR/SVG/coords.html#EstablishingANewUserSpace">coordinate
                system transformations</a> section of the SVG 1.1 specification. This is
                a coordinate system with two axes: the X axis increases horizontally to
                the right; the Y axis increases vertically downwards. Three-dimensional
                transform functions extent this coordinate space into three dimensions,
                adding a Z axis perpendicular to the plane of the screen, that increases towards the viewer.
              </p>
              <p>
                Transforms apply to <a href="#TermTransformableElement">transformable elements</a>.
              </p>


              <div class="example">
<pre>
div {
    transform: translate(100px, 100px);
}
</pre>
                <p>This transform moves the element by 100 pixels in both the X and Y directions.</p>
                <div class="figure">
                  <img src="transform1.png" alt="The 100px translation in X and Y">
                </div>
              </div>
                
              <div class="example">
<pre>
div {
    height: 100px; width: 100px;
    transform: translate(80px, 80px) scale(1.5, 1.5) rotate(45deg);
}
</pre>
                <p>Move the element by 80 pixels in both the X and Y directions, then scale the element by 150%, then rotate it 45 degrees clockwise about the Z axis. Note that the scale and rotate operate about the center of the element, since the element has the default transform-origin of 50% 50%.</p>
              <div class="figure">
                <img src="compound_transform.png" alt="The transform specified above">
              </div>

              <p>Note that an identical rendering can be obtained by nesting elements with the equivalent transforms:
<pre>
&lt;div style="transform: translate(80px, 80px)"&gt;
  &lt;div style="transform: scale(1.5, 1.5)"&gt;
    &lt;div style="transform: rotate(45deg)"&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
</pre>
            </div>


              <!-- This "in the HTML namespace" is awkward. Is there a better way? -->
              <p>
                In the HTML namespace, the transform property does not affect the flow of the content
                surrounding the transformed element. However, the value of the overflow
                area takes into account transformed elements. This behavior is similar
                to what happens when elements are translated via relative positioning.
                Therefore, if the value of the <span class="prop-name">'overflow'</span>
                property is <span class="prop-value">'scroll'</span> or <span
                class="prop-value">'auto'</span>, scrollbars will appear as needed to
                see content that is transformed outside the visible area.
              </p>
              <p>
                In the HTML namespace, any value other than 'none' for the transform results in the creation of
                both a stacking context and a containing block. The object acts as a
                containing block for fixed positioned descendants.
              </p>
              <p class="issue">
                Is this affect on position:fixed necessary? If so, need to go into more detail here
                about why fixed positioned objects should do this, i.e., that it's much harder to implement otherwise.
              </p>
              
              <h3 id="transform-3d-rendering">3D Transform Rendering</h3>

              <!-- Maybe define "tranform container" in the definitions, and use it everywhere
              in place of "containing block"? I'm not sure if "containing block" is exactly right. -->
              <p>
                Normally, elements render as flat planes, and are rendered into the same plane
                as their containing block. Often this is the plane shared by the rest of the page.
                Two-dimensional transform functions can alter the appearance of an element, but
                that element is still rendered into the same plane as the containing block.
              </p>
              <p>
                Three-dimensional transforms can result in transformation matrices with a non-zero
                Z component<!-- clarify -->, potentially lifting them off the plane of their
                containing block. Because of this, elements with three-dimensional transformations
                could potentially render in an front-to-back order that different from the normal CSS rendering order,
                and intersect with each other. Whether they do so depends on whether the element is a member
                of a <span class="term">3D rendering context</span> or not, as described below.
              </p>
              <div class="issue issue-marker">
                <p class="desc">This description does not exactly match what WebKit implements. Perhaps
                  it should be changed to match current implementations?</p>
              </div>
              <p>
                An element with a three-dimensional transform that is not contained in a
                <span class="term">3D rendering context</span> renders with the appropriate
                transform applied, but does not intersect with any other elements. The three-dimensional
                transform in this case can be considered just as a painting effect, like two-dimensional
                transforms. Similarly, the transform does not affect painting order. For example, a transform with a 
                positive Z translation may make an element look larger, but does not cause that element
                to render in front of elements with no translation in Z.
              </p>
              
              <div class="example">
                <p>This example shows the effect of three-dimensional transform applied to an element.
                </p>
<pre>
div { height: 150px; width: 150px; }
.container { border: 1px solid black; }
.transformed { transform: rotateY(50deg); }
</pre>
<pre>
&lt;div class="container"&gt;
    &lt;div class="transformed"&gt;&lt;/div&gt;
&lt;/div&gt;
</pre>  
<div class="figure">
  <img src="examples/simple-3d-example.png" width="210" height="190" alt="Div with a rotateY transform.">
</div>
                <p>The transform is a 50&deg; rotation about the vertical, Y axis. Note how this makes the blue box appear
                  narrower, but not three-dimensional.
                </p>
              </div>
              
              <div class="example">
                <p>This example shows how perspective can be used to cause three-dimensional transforms to appear more realistic.
                </p>
<pre>
div { height: 150px; width: 150px; }
.container { perspective: 500px; border: 1px solid black; }
.transformed { transform: rotateY(50deg); }
</pre>
<pre>
&lt;div class="container"&gt;
    &lt;div class="transformed"&gt;&lt;/div&gt;
&lt;/div&gt;
</pre>  
<div class="figure">
    <img src="examples/simple-perspective-example.png" width="210" height="190" alt="Div with a rotateY transform,
    and perspective on its container">
</div>
                <p>The inner element has the same transform as in Example 1, but its rendering is now influenced by the perspective
                  property on its parent element. Perspective causes vertices that have positive Z coordinates (closer to the viewer)
                  to be scaled up in X and Y, and those futher away (negative Z coordinates) to be scaled down, giving an appearance of depth.
                </p>
              </div>

              <p>
                An element with a three-dimensional transform that is contained in a
                <span class="term">3D rendering context</span> can visibly interact with other elements
                in that same 3D rendering context; the set of elements participating in the same 
                <span class="term">3D rendering context</span> may obscure each other or intersect,
                based on their computed transforms. They are rendered as if they are all siblings,
                positioned in a common 3D coordinate space. The position of each element in that three-dimensional
                space is determined by accumulating the transformation matrices
                up from the element that establishes the <span class="term">3D rendering context</span>
                through each element that is a containing block for the given element, as described below.
                <!-- More detail required, probably with matrices -->
              </p>

              <p>
                A <span class="term">3D rendering context</span> is established via the following:
              </p>
              <ul>
                <li>
                  A transformable element has a value for the <span type="prop-name">perspective</span> property
                  which is not 'none' and greater than 0, and which is not itself part of a 3D rendering context.
                </li>
                <!-- Part of is wooly. Need to clarify. -->
                <li>
                  An transformable element whose computed value of <span type="prop-name">transform-style</span> is
                  <span class="prop-value">'perserve-3d'</span>, and which itself is not part of a 3D rendering context.
                </li>
              </ul>

              <div class="issue issue-marker">
                <p class="desc">Should intersection behavior be normative?</p>
              </div>
              <p>
                An element whose computed value for <span type="prop-name">transform-style</span> is
                <span style="prop-value">'preserve-3d'</span>, and which is itself a member of a
                <span class="term">3D rendering context</span>, extends the 3D rendering context of which it is a member
                to the elements for which it acts as a containing block.
              </p>

              <p>
                An element participates in a <span class="term">3D rendering context</span> if its containing block
                establishes or extends a <span class="term">3D rendering context</span>.
              </p>
              
              <!-- Need more exposition here on establishes vs. participates -->

              <p>
                The final value of the transform used to render an element in a <span class="term">3D rendering context</span>
                is computed as follows:
              </p>
              <ol>
                <!-- Clarify pre- vs post-multiply? -->
                <li>Start with the identity matrix</li>
                <li>If the root of the <span class="term">3D rendering context</span> has perspective, multiply that into
                  the matrix, taking perspective-origin into account.</li>
                <li>For each ancestor of the element in question, compute a transformation matrix by:
                  <ol>
                    <li>applying perpsective and perspective-origin, if any</li>
                    <li>applying a translation equivalent to the horizontal and vertical offset of the element relative to
                      its containing block as specified by CSS layout rules <!-- (tighten this!) --></li>
                    <li>applying transform and transform-origin, if any</li>
                  </ol>
                  The target matrix is then multiplied with the matrix for this ancestor.
                </li>
              </ol>

              <!-- Discuss whether an element that establishes a 3D rendering context also participates in it; notably,
              does the foreground/background of the element intersect with transformed members of the 3D rendering context? -->
              <!-- Discuss whether non-transformed memebers of the <span class="term">3D rendering context</span> participate in intersection -->

              <div class="issue issue-marker">
                <p class="desc">Does transform-style follow containing block, or parent element ancestry?</p>
              </div>
              <div class="issue issue-marker">
                <p class="desc">Does perspective establish a 3D rendering context?</p>
              </div>


              <div class="example">
<pre>
</pre>
                <p>Example of simple 3D rendering context
                </p>
                <div class="figure">
                </div>
              </div>
  
              <div class="example">
<pre>
</pre>
                <p>Example of deeper 3D rendering context
                </p>
                <div class="figure">
                </div>
              </div>

            <div class="example">
<pre>
</pre>
              <p>Example of flattening inside 3D rendering context
              </p>
              <div class="figure">
              </div>
            </div>


<!--
                <p>
  	              The <span class="prop-name">'transform-style'</span> property defines
                  how nested elements are rendered in three-dimensional space. If the <span
                  class="prop-name">'transform-style'</span> is <span
                  class="prop-value">'flat'</span>, all children of this element are
                  rendered flattened into the 2D plane of the element. Therefore, rotating
                  the element about the X or Y axes will cause children positioned at
                  positive or negative Z positions to appear on the element's plane, rather
                  than in front of or behind it. If the <span
                  class="prop-name">'transform-style'</span> is <span
                  class="prop-value">'preserve-3d'</span>, this flattening is not performed,
                  so children maintain their position in three-dimensional space.
                </p>
                <p>
                  This flattening takes place at each element, so preserving a hierarchy
                  of elements in three-dimensional space requires that each element in the hierarchy
                  have the value <span class="prop-value">'preserve-3d'</span> for <span
                  class="prop-name">'transform-style'</span>. But since <span
                  class="prop-name">'transform-style'</span> affects only an element's
                  children, the leaf nodes in a hierarchy do not require the 
                  <span class="prop-name">'transform-style: preserve-3d'</span> to be specified.
                </p>
                
                <p>
                  For some effects, the author will have to ensure that an ancestor
                  element to a subtree using <span class="prop-value">'preserve-3d'</span>
                  has a <span class="prop-name">'transform-style'</span> of <span
                  class="prop-value">'flat'</span> (or the default). Otherwise, the
                  elements in the 3D tree may be located behind ancestor elements and,
                  thus, invisible (hidden behind an ancestor's background).
                </p>

                <p>
                  Note that while 'preserve-3d' can be specified on an element, the effect may not
                  be possible. Elements that have <span class="prop-name">'overflow'</span> set to
                  <span class="prop-value">'hidden'</span> are unable to keep their children in 3D.
                  In this case the element will behave as if the property was set to 
                  <span class="prop-value">'flat'</span>.
                </p>
                -->
              
              <!-- ======================================================================================================= -->

              <h2 id="transform-property">
                The <span class="prop-name">'transform'</span> Property
              </h2>
              <p>
                A transformation is applied to the coordinate system an element
                renders in through the <span class="prop-name">'transform'</span> property. This property contains a
                list of <a href="#transform-functions">transform functions</a>. The
                final transformation value for a coordinate system is obtained by converting
                each function in the list to its corresponding matrix (either defined in
                this specification or by reference to the SVG specification), then multiplying
                the matrices.
              </p>
              <table class="propdef">
                <tbody>
                  <tr>
                    <td>
                      <em>Name:</em>
                    </td>
                    <td>
                      <dfn id="effects">transform</dfn>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Value:</em>
                    </td>
                    <td>
                      none | &lt;transform-function&gt; [ &lt;transform-function&gt; ]*
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Initial:</em>
                    </td>
                    <td>
                      none
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Applies&nbsp;to:</em>
                    </td>
                    <td>
                      <a href="#TermTransformableElement">transformable elements</a>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Inherited:</em>
                    </td>
                    <td>
                      no
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Percentages:</em>
                    </td>
                    <td>
                      refer to the size of the element's border box
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Media:</em>
                    </td>
                    <td>
                      visual
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Computed value:</em>
                    </td>
                    <td>
                      See below.
                    </td>
                  </tr>
                </tbody>
              </table>
              
              <div class="issue issue-marker">
                <p class="desc">We need to resolve whether the computed value is the same as the specified value, or matrix().</p>
              </div>
              <p>The computed value of the transform property is a matrix() or matrix3d() value that describes the matrix that results from concatenating the individual transform functions. If the resulting matrix can be represented as a two-dimensional matrix with no loss of information, then a matrix() value is returned, otherwise a matrix3d() value. For elements with no transform applied, the computed value is 'none'.</p>

              <!-- ======================================================================================================= -->
              
              <h3 id="svg-transform">The SVG transform attribute</h3>
              
              <p>The <a href="http://www.w3.org/TR/2011/REC-SVG11-20110816/">SVG 1.1 specification</a> did not
                  specify the 'transform' attribute as a <a href="http://www.w3.org/TR/2011/REC-SVG11-20110816/styling.html#UsingPresentationAttributes">presentation attribute</a>. 
                  In order to improve the integration of
                  SVG and HTML, this specification makes the SVG 'transform' attribute a 
                  'presentation attribute' and makes the 'transform' property one that applies to SVG elements.</p>
                  
              <h4 id="transform-attribute-specificity">SVG transform attribute specificity</h4>
              
              <p>Since the SVG attribute becomes a presentation attribute, its participation to the CSS 
                  cascade is determined by the specificity of presentation attributes, as 
                  <a href="http://www.w3.org/TR/2011/REC-SVG11-20110816/styling.html#UsingPresentationAttributes">explained</a>
                  in the SVG specification.</p>
                  
              <h4 id="transform-attribute-dom">SVG transform attribute DOM</h4>
              
              <p>The SVG specification <a href="http://www.w3.org/TR/2011/REC-SVG11-20110816/coords.html#InterfaceSVGAnimatedTransformList">defines</a> a DOM interface to access the animated and base value of 
                  the SVG transform attribute. To ensure backwards compatibility, this API should still be
                  supported by user agents. The <code>baseVal</code> should be the value of the 'transform' attribute, 
                  as set on the element, and the <code>animVal</code> should be the property's computed value which account
                  for CSS animation, if any is underway.</p>
                  
              <div class="issue">
                  <ul>
                      <li>Should we also make gradientTransform and patternTransform presentation attributes? 
                          Proposal: they 
                          are the 'presentation attributes' for &lt;gradient&gt; and &gt;pattern&lt; respectively,
                          for the 'transform' property (i.e., there is no 'gradientTransform' property. Instead, the
                          'gradientTransform' is a presentation attribute that provides a value for the 
                          'transform' property that applies to the &lt;gradient&gt; element.)</li>
                      <li>Is this proposal working for SMIL animation of the transform property?</li>
                  </ul>
              </div>

              <!-- ======================================================================================================= -->

              <h2 id="transform-origin-property">
                The <span class="prop-name">'transform-origin'</span> Property
              </h2>
              <div class="issue issue-marker">
                <p class="desc">Need to add 3D transform-origin variant in a way that is not ambiguous
                  with the background-origin syntax (<a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=15432">bug 15432</a>).</p>
              </div>
              <p>
                The <span class="prop-name">'transform-origin'</span> property
                establishes the origin of transformation for a coordinate system. This property
                is applied by first translating the element's coordinate system by the negated value of the
                property, then applying the local transform, then translating by the
                property value. This effectively moves the desired transformation origin
                of the element to (0,0) in the local coordinate system, then applies
                the local transform, then moves the element back to its original
                position.
              </p>

              <p>If only one value is specified, the second value is assumed to be
              'center'. If two values are given and at least one value is not a keyword,
              then the first value represents the horizontal position (or offset) and
              the second represents the vertical position (or
              offset). <var>&lt;percentage&gt;</var> and <var>&lt;length&gt;</var>
              values here represent an offset of the transform origin from the top left corner
              of the element's border box.
            </p>

              <p>If three or four values are given, then
              each <var>&lt;percentage&gt;</var> or<var>&lt;length&gt;</var>
              represents an offset and must be preceded by a keyword,
              which specifies from which edge the offset is given. For example,
              ''transform-origin: bottom 10px right 20px'' represents a
              ''10px'' vertical offset up from the bottom edge and a
              ''20px'' horizontal offset leftward from the right edge. If
              three values are given, the missing offset is assumed to be zero.
              </p>

              <p>Positive values represent an offset <em>inward</em> from the edge of
              the border box. Negative values represent an offset
              <em>outward</em> from the edge of the border box.
            </p>

              <table class="propdef">
                <tbody>
                  <tr>
                    <td>
                      <em>Name:</em>
                    </td>
                    <td>
                      <dfn id="transform-origin">transform-origin</dfn>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Value:</em>
                    </td>
                    <td>
            [ top | bottom ] |<br>
            [ &lt;percentage> | &lt;length&gt; | left | center | right ] [ &lt;percentage> | &lt;length&gt; | top | center | bottom ]? |<br>
            [ center | [ left | right ] [ &lt;percentage> | &lt;length&gt; ]? ] &amp;&amp; [ center | [ top | bottom ] [ &lt;percentage> | &lt;length&gt; ]? ]<br>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Initial:</em>
                    </td>
                    <td>
                      0 0 for SVG elements, 50% 50% for all other elements
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Applies&nbsp;to:</em>
                    </td>
                    <td>
                      <a href="#TermTransformableElement">transformable element</a>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Inherited:</em>
                    </td>
                    <td>
                      no
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Percentages:</em>
                    </td>
                    <td>
                      refer to the size of the element's border box
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Media:</em>
                    </td>
                    <td>
                      visual
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Computed value:</em>
                    </td>
                    <td>
                      For &lt;length&gt; the absolute value, otherwise a percentage
                    </td>
                  </tr>
                </tbody>
              </table>
              
              <h3 id="svg-transform-origin">The 'transform-origin' property for SVG elements</h3>
              
              <div class="issue issue-marker">
                <p class="desc">Should we use 'auto', or explicitly say that transform-origin is 0 0 for SVG elements, 50% 50% for all other elements (<a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=15504">bug 15504</a>)?</p>
              </div>
              <p>To keep the 'transform' property compatible with existing SVG content that assumed a top/left
                  coordinate system origin, the user agent stylesheet must contain the following:</p>
            
              <pre class="css">
svg | * {
    transform-origin: top left;
}                  
              </pre>
              <div class="issue">
                  <p class="desc">Need to determine how to extend transform-origin to allow it ot affect the z-origin
                    with three-dimensional transforms (<a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=14647">Bug 14647</a>).
              </div

              <!-- ======================================================================================================= -->

              <h2 id="transform-style-property">
                The <span class="prop-name">'transform-style'</span> Property
              </h2>
              <p>
                Property summary here.
              </p>
              <table class="propdef">
                <tbody>
                  <tr>
                    <td>
                      <em>Name:</em>
                    </td>
                    <td>
                      <dfn id="transform-style">transform-style</dfn>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Value:</em>
                    </td>
                    <td>
                      flat | preserve-3d
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Initial:</em>
                    </td>
                    <td>
                      flat
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Applies&nbsp;to:</em>
                    </td>
                    <td>
                      <a href="#TermTransformableElement">transformable elements</a>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Inherited:</em>
                    </td>
                    <td>
                      no
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Percentages:</em>
                    </td>
                    <td>
                      N/A
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Media:</em>
                    </td>
                    <td>
                      visual
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Computed value:</em>
                    </td>
                    <td>
                      Same as specified value.
                    </td>
                  </tr>
                </tbody>
              </table>

              <p>
                A value of <span class="prop-value">preserve-3d</span> for <span class="prop-name">transform-style</span>
                establishes a stacking context.
              </p>

              <div class="issue issue-marker">
                <p class="desc">Should this affect the computed value of transform-style?</p>
              </div>
              <p>
                The following CSS property values require the user agent to create a flattened representation of
                the descendant elements before they can be applied, and therefore override the behavior of 
                <span class="prop-name">transform-style</span>: <span class="prop-value">preserve-3d</span>:
                <ul>
                  <li><span class="prop-name">overflow</span>: any value other than 'visible'.</li>
                  <li><span class="prop-name">opacity</span>: any value other than 1.</li>
                  <li><span class="prop-name">filter</span>: any value other than 'none'.</li>
                  <!-- Others? -->
                </ul>
              </p>

              <!-- ======================================================================================================= -->

              <h2 id="perspective-property">
                The <span class="prop-name">'perspective'</span> Property
              </h2>
              <p>
                
              <p>
                The <span class="prop-name">'perspective'</span> property applies the
                same transform as the <span
                class="prop-value">perspective(&lt;length&gt;)</span> transform
                function, except that it applies only to the positioned or transformed
                children of the element, not to the transform on the element itself.
              </p>

              <table class="propdef">
                <tbody>
                  <tr>
                    <td>
                      <em>Name:</em>
                    </td>
                    <td>
                      <dfn id="perspective">perspective</dfn>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Value:</em>
                    </td>
                    <td>
                      none | &lt;length&gt;
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Initial:</em>
                    </td>
                    <td>
                      none
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Applies&nbsp;to:</em>
                    </td>
                    <td>
                      <a href="#TermTransformableElement">transformable elements</a>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Inherited:</em>
                    </td>
                    <td>
                      no
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Percentages:</em>
                    </td>
                    <td>
                      N/A
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Media:</em>
                    </td>
                    <td>
                      visual
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Computed value:</em>
                    </td>
                    <td>
                      Same as specified value.
                    </td>
                  </tr>
                </tbody>
              </table>

              <p>
                If the value is <span
                class="prop-value">'none'</span>, less than or equal to 0 no perspective transform is applied.
              </p>
              <p>
                The use of this property with any value other than 'none' establishes a
                stacking context. It also establishes a containing block (somewhat
                similar to position:relative), just like the 'transform' property does.
              </p>
              
              <!-- ======================================================================================================= -->
              
              <h2 id="perspective-origin-property">
                The <span class="prop-name">'perspective-origin'</span> Property
              </h2>
              <p>
                The <span class="prop-name">'perspective-origin'</span> property
                establishes the origin for the <em>perspective</em> property. It
                effectively sets the X and Y position at which the viewer appears to be
                looking at the children of the element.
              </p>
              <table class="propdef">
                <tbody>
                  <tr>
                    <td>
                      <em>Name:</em>
                    </td>
                    <td>
                      <dfn id="perspective-origin">perspective-origin</dfn>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Value:</em>
                    </td>
                    <td>
                      [ [ &lt;percentage&gt; | &lt;length&gt; | left | center | right ] [
                      &lt;percentage&gt; | &lt;length&gt; | top | center | bottom ]? ] | [ [ left |
                      center | right ] || [ top | center | bottom ] ]
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Initial:</em>
                    </td>
                    <td>
                      50% 50%
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Applies&nbsp;to:</em>
                    </td>
                    <td>
                      <a href="#TermTransformableElement">transformable elements</a>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Inherited:</em>
                    </td>
                    <td>
                      no
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Percentages:</em>
                    </td>
                    <td>
                      refer to the size of the element's border box
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Media:</em>
                    </td>
                    <td>
                      visual
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Computed value:</em>
                    </td>
                    <td>
                      Same as specified value.
                    </td>
                  </tr>
                </tbody>
              </table>
              
              <!-- ======================================================================================================= -->

              <h2 id="backface-visibility-property">
                The <span class="prop-name">'backface-visibility'</span> Property
              </h2>
              <p>
                The <span class="prop-name">'backface-visibility'</span> property
                determines whether or not the "back" side of a transformed element is
                visible when facing the viewer. With an identity transform, the front
                side of an element faces the viewer. Applying a rotation about Y of 180
                degrees (for instance) would cause the back side of the element to face
                the viewer.
              </p>
              <!-- This should not be in a normative section. -->
              <p>
                This property is useful when you place two elements back-to-back, as you
                would to create a playing card. Without this property, the front and
                back elements could switch places at times during an animation to flip
                the card. Another example is creating a box out of 6 elements, but where
                you want to see the inside faces of the box. This is useful when
                creating the backdrop for a 3 dimensional stage.
              </p>
              <table class="propdef">
                <tbody>
                  <tr>
                    <td>
                      <em>Name:</em>
                    </td>
                    <td>
                      <dfn id="backface-visibility">backface-visibility</dfn>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Value:</em>
                    </td>
                    <td>
                      visible | hidden
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Initial:</em>
                    </td>
                    <td>
                      visible
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Applies&nbsp;to:</em>
                    </td>
                    <td>
                      block-level and inline-level elements
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Inherited:</em>
                    </td>
                    <td>
                      no
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Percentages:</em>
                    </td>
                    <td>
                      N/A
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Media:</em>
                    </td>
                    <td>
                      visual
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <em>Computed value:</em>
                    </td>
                    <td>
                      Same as specified value.
                    </td>
                  </tr>
                </tbody>
              </table>
              

              <!-- ======================================================================================================= -->

              <h2 id="transform-functions">
                The Transformation Functions
              </h2>
              <p>
                The value of the <span class="prop-name">transform</span> property is a
                list of &lt;transform-functions&gt; applied in the order provided. The
                individual transform functions are separated by whitespace. The
                set of allowed transform functions is given below. In this list the
                type &lt;translation-value&gt; is defined as a &lt;length&gt; or
                &lt;percentage&gt; value, and the &lt;angle&gt; type is defined by <a
                href="http://www.w3.org/TR/css3-values/">CSS Values and Units.</a>
                Wherever &lt;angle&gt; is used in this specification, a &lt;number&gt; that is equal to
                zero is also allowed, which is treated the same as an angle of zero degrees.
              </p>

              <h3 id="two-d-transform-functions">2D Transformation Functions</h3>
              <dl>
                <dt>
                  <span class="prop-value">matrix(&lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;)</span>
                </dt>
                <dd>
                  specifies a 2D transformation in the form of a <a href="http://www.w3.org/TR/SVG/coords.html#TransformMatrixDefined">transformation matrix</a> of six values. <span class="prop-value">matrix(a,b,c,d,e,f)</span> is equivalent to applying the transformation matrix <strong>[a b c d e f]</strong>.
                </dd>
                <dt>
                  <span class="prop-value">translate(&lt;translation-value&gt;[, &lt;translation-value&gt;])</span>
                </dt>
                <dd>
                  specifies a <a href="http://www.w3.org/TR/SVG/coords.html#TranslationDefined">2D translation</a> by the vector [tx, ty], where tx is the first translation-value parameter and ty is the optional second translation-value parameter. If <em>&lt;ty&gt;</em> is not provided, ty has zero as a value.
                </dd>
                <dt>
                  <span class="prop-value">translateX(&lt;translation-value&gt;)</span>
                </dt>
                <dd>
                  specifies a <a href="http://www.w3.org/TR/SVG/coords.html#TranslationDefined">translation</a> by the given amount in the X direction.
                </dd>
                <dt>
                  <span class="prop-value">translateY(&lt;translation-value&gt;)</span>
                </dt>
                <dd>
                  specifies a <a href="http://www.w3.org/TR/SVG/coords.html#TranslationDefined">translation</a> by the given amount in the Y direction.
                </dd>
                <dt>
                  <span class="prop-value">scale(&lt;number&gt;[, &lt;number&gt;])</span>
                </dt>
                <dd>
                  specifies a <a href="http://www.w3.org/TR/SVG/coords.html#ScalingDefined">2D scale</a> operation by the [sx,sy] scaling vector described by the 2 parameters. If the second parameter is not provided, it is takes a value equal to the first. For example, scale(1, 1) would leave an element unchanged, while scale(2, 2) would cause it to appear twice as long in both the X
                  and Y axes, or four times its typical geometric size.
                </dd>
                <dt>
                  <span class="prop-value">scaleX(&lt;number&gt;)</span>
                </dt>
                <dd>
                  specifies a scale operation using the [sx,1] scaling vector, where sx is given as the parameter.
                </dd>
                <dt>
                  <span class="prop-value">scaleY(&lt;number&gt;)</span>
                </dt>
                <dd>
                  specifies a scale operation using the [1,sy] scaling vector, where sy is given as the parameter.
                </dd>
                <dt>
                  <span class="prop-value">rotate(&lt;angle&gt;)</span>
                </dt>
                <dd>
                  specifies a <a href="http://www.w3.org/TR/SVG/coords.html#RotationDefined">2D rotation</a> by the angle specified in the parameter about the origin of the element, as defined by the <em>transform-origin</em> property. For example, rotate(90deg) would cause elements to appear
                  rotated one-quarter of a turn in the clockwise direction.
                </dd>
                <dt>
                  <span class="prop-value">skewX(&lt;angle&gt;)</span>
                </dt>
                <dd>
                  specifies a <a href="http://www.w3.org/TR/SVG/coords.html#SkewXDefined">skew transformation along the X axis</a> by the given angle.
                </dd>
                <dt>
                  <span class="prop-value">skewY(&lt;angle&gt;)</span>
                </dt>
                <dd>
                  specifies a <a href="http://www.w3.org/TR/SVG/coords.html#SkewYDefined">skew transformation along the Y axis</a> by the given angle.
                </dd>
              </dl>


              <h3 id="three-d-transform-functions">3D Transformation Functions</h3>
              <dl>
                <dt>
                  <span class="prop-value">matrix3d(&lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;number&gt;)</span>
                </dt>
                <dd>
                  specifies a 3D transformation as a 4x4 homogeneous matrix of 16 values in column-major order.
                </dd>
                <dt>
                  <span class="prop-value">translate3d(&lt;translation-value&gt;, &lt;translation-value&gt;, &lt;translation-value&gt;)</span>
                </dt>
                <dd>
                  specifies a 3D translation by the vector [tx,ty,tz], with tx, ty and tz being the first, second and third translation-value parameters respectively. &lt;Percentage&gt; values are not allowed in the tz translation-value, and if present will cause the propery value to be invalid.
                </dd>
                <dt>
                  <span class="prop-value">translateZ(&lt;translation-value&gt;)</span>
                </dt>
                <dd>
                  specifies a <a href="http://www.w3.org/TR/SVG/coords.html#TranslationDefined">translation</a> by the given amount in the Z direction. &lt;Percentage&gt; values are not allowed in the translateZ translation-value, and if present will cause the propery value to be invalid.
                </dd>
                <dt>
                  <span class="prop-value">scale3d(&lt;number&gt;, &lt;number&gt;, &lt;number&gt;)</span>
                </dt>
                <dd>
                  specifies a 3D scale operation by the [sx,sy,sz] scaling vector described by the 3 parameters.
                </dd>
                <dt>
                  <span class="prop-value">scaleZ(&lt;number&gt;)</span>
                </dt>
                <dd>
                  specifies a scale operation using the [1,1,sz] scaling vector, where sz is given as the parameter.
                </dd>
                <dt>
                  <span class="prop-value">rotate3d(&lt;number&gt;, &lt;number&gt;, &lt;number&gt;, &lt;angle&gt;)</span>
                </dt>
                <div class="todo">Clarify "clockwise". Describe in terms of right-hand rule?</div>
                <dd>
                  specifies a clockwise 3D rotation by the angle specified in last
                  parameter about the [x,y,z] direction vector described by the first 3
                  parameters. If the direction vector is not of unit length, it will be
                  normalized. A direction vector that cannot be normalized, such as [0,
                  0, 0], will cause the rotation to not be applied. This function is
                  equivalent to <code>matrix3d(1 + (1-cos(angle))*(x*x-1), -z*sin(angle)+(1-cos(angle))*x*y, y*sin(angle)+(1-cos(angle))*x*z, 0, z*sin(angle)+(1-cos(angle))*x*y, 1 + (1-cos(angle))*(y*y-1), -x*sin(angle)+(1-cos(angle))*y*z, 0, -y*sin(angle)+(1-cos(angle))*x*z, x*sin(angle)+(1-cos(angle))*y*z, 1 + (1-cos(angle))*(z*z-1), 0, 0, 0, 0, 1)</code>.</dd>
                <dt>
                  <span class="prop-value">rotateX(&lt;angle&gt;)</span>
                </dt>
                <dd>
                  specifies a clockwise rotation by the given angle about the X axis.
                </dd>
                <dt>
                  <span class="prop-value">rotateY(&lt;angle&gt;)</span>
                </dt>
                <dd>
                  specifies a clockwise rotation by the given angle about the Y axis.
                </dd>
                <dt>
                  <span class="prop-value">rotateZ(&lt;angle&gt;)</span>
                </dt>
                <dd>
                  specifies a clockwise rotation by the given angle about the Z axis. This is a synonym for <span class="prop-value">rotate(&lt;angle&gt;)</span>.
                </dd>
                <dt>
                  <span class="prop-value">perspective(&lt;length&gt;)</span>
                </dt>
                <dd>
                  specifies a perspective projection matrix. This matrix maps a <em>viewing cube</em> onto a pyramid whose
                  base is infinitely far away from the viewer and whose peak represents the viewer's position. The
                  viewable area is the region bounded by the four edges of the viewport (the portion of the browser
                  window used for rendering the webpage between the viewer's position and a point at a distance of
                  infinity from the viewer). The <em>depth</em>, given as the parameter to the function, represents the
                  distance of the z=0 plane from the viewer. Lower values give a more flattened pyramid and
                  therefore a more pronounced perspective effect. For example, a value of 1000px
                  gives a moderate amount of foreshortening and a value of 200px gives an extreme amount. The matrix
                  is computed by starting with an identity matrix and replacing the value at row 3, column 4 with
                  the value -1/depth. The value for depth must be greater than zero, otherwise the function is invalid.
                  <div class="issue">I think "viewport" is wrong here. It's the border box of the element with perspective.</div>
                </dd>
              </dl>


              <!-- ======================================================================================================= -->

              <h2 id="transform-values">
                Transform Values and Lists
              </h2>
              <p>
                The &lt;translation-value&gt; values are defined as [&lt;percentage&gt; | &lt;length&gt;]. All other value types are described <a href="http://www.w3.org/TR/REC-CSS2/syndata.html#values">as CSS types</a>. If a list of transforms is provided, then the net effect is as if each transform had been specified separately in the order provided. For example,
              </p>
<pre>
&lt;div style="transform:translate(-10px,-20px) scale(2) rotate(45deg) translate(5px,10px)"/&gt;
</pre>
              <p>
                is functionally equivalent to:
              </p>
<pre>
&lt;div style="transform:translate(-10px,-20px)"&gt;
  &lt;div style="transform:scale(2)"&gt;
    &lt;div style="transform:rotate(45deg)"&gt;
      &lt;div style="transform:translate(5px,10px)"&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
</pre>
          <p>
            That is, in the absence of other styling that affects position and dimensions, a nested set of transforms is equivalent to a single list of transform functions, applied from the outside in. The resulting transform is the matrix multiplication of the list of transforms.
          </p>
          <!-- ======================================================================================================= -->

              <h2 id="animation">
                Transitions and animations between transform values
              </h2>

              <p>
                When animating or transitioning the value of a transform property
                the rules described below are applied. The 'from' transform is
                the transform at the start of the transition or current keyframe. The
                'end' transform is the transform at the end of the transition or
                current keyframe.
              </p>

              <ul>
                <li>
                  If the 'from' and 'to' transforms are both single functions
                  of the same type:
                  <ul>
                    <li>
                      For translate, translateX, translateY, scale,
                      scaleX, scaleY, rotate, skew, skewX and skewY functions:
                        <ul>
                          <li>
                            the individual components of the function are
                            interpolated numerically.
                          </li>
                        </ul>
                    </li>
                    <li>
                      For matrix:
                        <ul>
                          <li>
                            the matrix is
                            decomposed using <a
                            href="http://tog.acm.org/GraphicsGems/gemsii/unmatrix.c">the
                            method described by unmatrix</a> into separate translation,
                            scale, rotation and skew matrices, then each
                            decomposed matrix is interpolated numerically, and finally
                            combined in order to produce a resulting 3x2 matrix.
                          </li>
                        </ul>
                    </li>
                  </ul>
                </li>
                <li>
                  If both the 'from' and 'to' transforms are "none":
                  <ul>
                    <li>
                      There is no interpolation necessary
                    </li>
                  </ul>
                </li>
                <li>
                  If one of the 'from' or 'to' transforms is "none":
                  <ul>
                    <li>
                      The 'none' is replaced by an equivalent identity function list for
                      the corresponding transform function list.
                      <p>
                        For example, if the 'from' transform is "scale(2)" and the 'to'
                        transform is "none" then the value "scale(1)" will be used as the
                        'to' value, and animation will proceed using the rule above.
                        Similarly, if the 'from' transform is "none" and the 'to' transform
                        is "scale(2) rotate(50deg)" then the animation will execute as
                        if the 'from' value is "scale(1) rotate(0)".
                      </p>
                      <p>
                        The identity functions are translate(0), 
                        translateX(0), translateY(0), scale(1), scaleX(1), scaleY(1), rotate(0),
                        skewX(0), skewY(0) and matrix(1, 0, 0, 1, 0, 0).
                      </p>
                    </li>
                  </ul>
                </li>
                <li>
                  If both the 'from' and 'to' transforms have the same number of
                  transform functions and corresponding functions in each transform
                  list are of the same type:
                  <ul>
                    <li>
                      Each transform function is animated with its corresponding
                      destination function in isolation using the rules described above.
                      The individual values are then applied as a list to produce
                      resulting transform value.
                    </li>
                  </ul>
                </li>
                <li>
                  Otherwise:
                  <ul>
                    <li>
                      The transform function lists are each converted into the
                      equivalent matrix value and animation proceeds using the rule
                      for a single function above.
                    </li>
                  </ul>
                </li>
              </ul>

              <p>
                In some cases, an animation might cause a transformation matrix to
                be singular or non-invertible. For example, an animation in which
                scale moves from 1 to -1. At the time when the matrix is in such 
                a state, the transformed element is not rendered.
              </p>

              <h2 id="matrix-decomposition">
                Matrix decomposition for animation
              </h2>

              <p>
                When interpolating between 2 matrices, each is decomposed into the
                corresponding translation, rotation, scale and skew
                values. Not all matrices can be accurately described by these values.
                Those that can't are decomposed into the most accurate representation
                possible, using the technique below. This technique is taken from The
                "unmatrix" method in "Graphics Gems II, edited by Jim Arvo", simplified
                for the 2D case.
              </p>

              <h3 id="unmatrix">Unmatrix</h3>
              <pre>
          Input:  a, b, c, d ; 2x2 matrix (rotate, scale, shear) components
                  tx, ty     ; translation components
          Output: translate  ; a 2 component vector
                  rotate     ; an angle
                  scale      ; a 2 component vector
                  skew       ; skew factor
          Returns false if the matrix cannot be decomposed, true if it can

          Supporting functions (point is a 2 component vector):
            float  length(point)                returns the length of the passed vector
            point  normalize(point)             normalizes the length of the passed point to 1
            float  dot(point, point)            returns the dot product of the passed points
            float  atan2(float y, float x)      returns the principal value of the arc tangent of 
                                                y/x, using the signs of both arguments to determine 
                                                the quadrant of the return value

          Decomposition also makes use of the following function:
            point combine(point a, point b, float ascl, float bscl)
                result[0] = (ascl * a[0]) + (bscl * b[0])
                result[1] = (ascl * a[1]) + (bscl * b[1])
                return result

          // Make sure the matrix is invertible
          if ((a * d - b * c) == 0)
            return false

          // Take care of translation
          translate[0] = tx
          translate[1] = matrix[3][1]

          // Put the components into a 2x2 matrix 'mat'
          mat[0][0] = a
          mat[0][1] = b
          mat[1][0] = c
          mat[1][1] = d

          // Compute X scale factor and normalize first row.
          scale[0] = length(row[0])
          row[0] = normalize(row[0])

          // Compute shear factor and make 2nd row orthogonal to 1st.
          skew = dot(row[0], row[1])
          row[1] = combine(row[1], row[0], 1.0, -skew)

          // Now, compute Y scale and normalize 2nd row.
          scale[1] = length(row[1])
          row[1] = normalize(row[1])
          skew /= scale[1];

          // Now, get the rotation out
          rotate = atan2(mat[0][1], mat[0][0])

          return true;</pre>

              <h3>Animating the components</h3>
              <p>
                  Once decomposed, each component of each returned value of the source matrix is linearly interpolated 
                  with the corresponding component of the destination matrix. For instance, the translate[0] and
                  translate[1] values are interpolated numerically, and the result is used to set the 
                  translation of the animating element. 
              </p>
              <h3>Recomposing the matrix</h3>
              <p><em>This section is not normative.</em></p>
              <p>
                  After interpolation the resulting values are used to position the element. One way to use these values
                  is to recompose them into a 3x2 matrix. This can be done using the Transformation Functions of the 
                  <em>transform</em> property. The following JavaScript example produces a string for this purpose. The
                  values passed in are the output of the Unmatrix function above:

              </p>
              <pre>
        function compose(translate, rotate, scale, skew, elementID)
        {
            var s = " translate(" + translate[0] + ", " + translate[1] + ")";
            s += " rotate(" + rotate + ")";
            s += " skewX(" + skew + ")";
            s += " scale(" + scale[0] + ", " + scale[1] + ")";
            document.getElementById(elementID).style.transform = s;
        }</pre>

              <h2 id="dom-interfaces">
                DOM Interfaces
              </h2>
              <p>
                This section describes the interfaces and functionality added to the DOM
                to support runtime access to the functionality described above.
              </p>

              <h3 id="cssmatrix-interface">
                CSSMatrix
              </h3>

              <div class="issue issue-marker">
                <p class="desc">We actually describe a 3x2 matrix here, similar to <a href="http://www.w3.org/TR/SVG/coords.html#InterfaceSVGMatrix">SVGMatrix</a>.</p>
              </div>
              <div class="issue issue-marker">
                <p class="desc">We need to resolve how SVGMatrix and CSSMatrix work together (<a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=15498">bug 15498</a>).</p>
              </div>

              <dl>
                <dt>
                  <b>Interface <i><a id="DOM-CSSMatrix" name='DOM-CSSMatrix'>CSSMatrix</a></i></b>
                </dt>
                <dd>
                  <p>
                    The <code>CSSMatrix</code> interface represents a 3x2 homogeneous matrix.
                  </p>
                  <dl>

                    <dt>
                      <b>IDL Definition</b>
                    </dt>
                    <dd>
                      <div class='idl-code'>
                        <pre>
          interface CSSMatrix {
              attribute float a;
              attribute float b;
              attribute float c;
              attribute float d;
              attribute float e;
              attribute float f;

              void        setMatrixValue(in DOMString string) raises(DOMException);
              CSSMatrix   multiply(in CSSMatrix secondMatrix);
              CSSMatrix   inverse() raises(DOMException);
              CSSMatrix   translate(in float x, in float y);
              CSSMatrix   scale(in float scaleX, in float scaleY);
              CSSMatrix   skewX(in float angle);
              CSSMatrix   skewY(in float angle);
              CSSMatrix   rotate(in float angle);
          };</pre>
                      </div><br>
                    </dd> <!-- IDL -->

                    <dt>
                      <b>Attributes</b>
                    </dt>
                    <dd>
                      <dl>
                        <dt>
                          <code class='attribute-name'><a id="DOM-CSSMatrix-matrix" name='DOM-CSSMatrix-matrix'>a-f</a></code> of type <code>float</code>
                        </dt>
                        <dd>
                          Each of these attributes represents one of the values in the 3x2 matrix.<br>
                        </dd>
                      </dl>
                    </dd> <!-- Attributes -->

                    <dt>
                      <b>Methods</b>
                    </dt>
                    <dd>
                      <dl>

                        <!-- ===================================================== -->
                        <dt>
                          <code class='method-name'><a id="DOM-CSSMatrix-setMatrixValue" name='DOM-CSSMatrix-setMatrixValue'>setMatrixValue</a></code>
                        </dt>
                        <dd>
                          <div class='method'>
                            The <code>setMatrixValue</code> method replaces the existing matrix with one computed from parsing the passed string
                            as though it had been assigned to the transform property in a CSS style rule.
                            <div class='parameters'>
                              <b>Parameters</b>
                              <div class='paramtable'>
                                <dl>
                                  <dt>
                                    <code class='parameter-name'>string</code> of type <code>DOMString</code>
                                  </dt>
                                  <dd>
                                    The string to parse.<br>
                                  </dd>
                                </dl>
                              </div>
                            </div><!-- parameters -->
                            <div class='return-value'>
                              <b>No Return Value</b>
                            </div>
                            <div>
                              <b>Exceptions</b>
                              <div class='returnvalue'>
                                <dl>
                                  <dt>
                                    <code>DOMException SYNTAX_ERR</code>
                                  </dt>
                                  <dd>
                                    Thrown when the provided string can not be
                                    parsed into a CSSMatrix.
                                  </dd>
                                </dl>
                              </div>
                            </div>
                          </div>
                        </dd> <!-- setMatrixValue -->

                        <!-- ===================================================== -->
                        <dt>
                          <code class='method-name'><a id="DOM-CSSMatrix-multiply" name='DOM-CSSMatrix-multiply'>multiply</a></code>
                        </dt>
                        <dd>
                          <div class='method'>
                            The <code>multiply</code> method returns a new CSSMatrix which is the result of this matrix multiplied by the passed matrix, with the passed matrix to the right. This matrix is not modified.
                            <div class='parameters'>
                              <b>Parameters</b>
                              <div class='paramtable'>
                                <dl>
                                  <dt>
                                    <code class='parameter-name'>secondMatrix</code> of type <code>CSSMatrix</code>
                                  </dt>
                                  <dd>
                                    The matrix to multiply.<br>
                                  </dd>
                                </dl>
                              </div>
                            </div><!-- parameters -->
                            <div class='return-value'>
                              <b>Return Value</b>
                              <div class='returnvalue'>
                                <dl>
                                  <dt>
                                    <code>CSSMatrix</code>
                                  </dt>
                                  <dd>
                                    The result matrix.<br>
                                  </dd>
                                </dl>
                              </div>
                            </div>
                            <div>
                              <b>No Exceptions</b>
                            </div>
                          </div>
                        </dd> <!-- multiply() -->

                        <!-- ===================================================== -->
                        <dt>
                          <code class='method-name'><a id="DOM-CSSMatrix-inverse" name='DOM-CSSMatrix-inverse'>inverse</a></code>
                        </dt>
                        <dd>
                          <div class='method'>
                            The <code>inverse</code> method returns a new matrix which is the inverse of this matrix. This matrix is not modified.
                            <div class='parameters'>
                              <b>No Parameters</b>
                            </div><!-- parameters -->
                            <div class='return-value'>
                              <b>Return Value</b>
                              <div class='returnvalue'>
                                <dl>
                                  <dt>
                                    <code>CSSMatrix</code>
                                  </dt>
                                  <dd>
                                    The inverted matrix.<br>
                                  </dd>
                                </dl>
                              </div>
                            </div>
                            <div>
                              <b>Exceptions</b>
                              <div class='returnvalue'>
                                <dl>
                                  <dt>
                                    <code>DOMException NOT_SUPPORTED_ERR</code>
                                  </dt>
                                  <dd>
                                    Thrown when the CSSMatrix can not be
                                    inverted.
                                  </dd>
                                </dl>
                              </div>
                            </div>
                          </div><!-- ======================================================================================================= -->
                        </dd> <!-- inverse() -->

                        <!-- ===================================================== -->
                        <dt>
                          <code class='method-name'><a id="DOM-CSSMatrix-translate" name='DOM-CSSMatrix-translate'>translate</a></code>
                        </dt>
                        <dd>
                          <div class='method'>
                            The <code>translate</code> method returns a new matrix which is this matrix multiplied by a translation matrix containing the passed values. This matrix is not modified.
                            <div class='parameters'>
                              <b>Parameters</b>
                              <div class='paramtable'>
                                <dl>
                                  <dt>
                                    <code class='parameter-name'>x</code> of type <code>float</code>
                                  </dt>
                                  <dd>
                                    The X component of the translation value.<br>
                                  </dd>
                                  <dt>
                                    <code class='parameter-name'>y</code> of type <code>float</code>
                                  </dt>
                                  <dd>
                                    The Y component of the translation value.<br>
                                  </dd>
                                </dl>
                              </div>
                            </div><!-- parameters -->
                            <div class='return-value'>
                              <b>Return Value</b>
                              <div class='returnvalue'>
                                <dl>
                                  <dt>
                                    <code>CSSMatrix</code>
                                  </dt>
                                  <dd>
                                    The result matrix.<br>
                                  </dd>
                                </dl>
                              </div>
                            </div>
                            <div>
                              <b>No Exceptions</b>
                            </div>
                          </div><!-- ======================================================================================================= -->
                        </dd> <!-- translate() -->

                        <!-- ===================================================== -->
                        <dt>
                          <code class='method-name'><a id="DOM-CSSMatrix-scale" name='DOM-CSSMatrix-scale'>scale</a></code>
                        </dt>
                        <dd>
                          <div class='method'>
                            The <code>scale</code> method returns a new matrix which is this matrix multiplied by a scale matrix containing the passed values. If the y component is undefined, the x component value is used in its place. This matrix is not modified.
                            <div class='parameters'>
                              <b>Parameters</b>
                              <div class='paramtable'>
                                <dl>
                                  <dt>
                                    <code class='parameter-name'>scaleX</code> of type <code>float</code>
                                  </dt>
                                  <dd>
                                    The X component of the scale value.<br>
                                  </dd>
                                  <dt>
                                    <code class='parameter-name'>scaleY</code> of type <code>float</code>
                                  </dt>
                                  <dd>
                                    The (optional) Y component of the scale value.<br>
                                  </dd>
                                </dl>
                              </div>
                            </div><!-- parameters -->
                            <div class='return-value'>
                              <b>Return Value</b>
                              <div class='returnvalue'>
                                <dl>
                                  <dt>
                                    <code>CSSMatrix</code>
                                  </dt>
                                  <dd>
                                    The result matrix.<br>
                                  </dd>
                                </dl>
                              </div>
                            </div>
                            <div>
                              <b>No Exceptions</b>
                            </div>
                          </div><!-- ======================================================================================================= -->
                        </dd> <!-- scale() -->

                        <!-- ===================================================== -->
                        <dt>
                          <code class='method-name'><a id="DOM-CSSMatrix-rotate" name='DOM-CSSMatrix-rotate'>rotate</a></code>
                        </dt>
                        <dd>
                          <div class='method'>
                            The <code>rotate</code> method returns a new matrix which is this matrix multiplied by a <a href="http://www.w3.org/TR/SVG/coords.html#RotationDefined">rotation matrix</a>. The rotation value is in degrees. This matrix is not modified.
                            <div class='parameters'>
                              <b>Parameters</b>
                              <div class='paramtable'>
                                <dl>
                                  <dt>
                                    <code class='parameter-name'>angle</code> of type <code>float</code>
                                  </dt>
                                  <dd>
                                    The angle of rotation.<br>
                                  </dd>
                                </dl>
                              </div>
                            </div><!-- parameters -->
                            <div class='return-value'>
                              <b>Return Value</b>
                              <div class='returnvalue'>
                                <dl>
                                  <dt>
                                    <code>CSSMatrix</code>
                                  </dt>
                                  <dd>
                                    The result matrix.<br>
                                  </dd>
                                </dl>
                              </div>
                            </div>
                            <div>
                              <b>No Exceptions</b>
                            </div>
                          </div>
                          <!-- ======================================================================================================= -->
                        </dd> <!-- rotate() -->

                        <!-- ===================================================== -->
                        <dt>
                          <code class='method-name'><a id="DOM-CSSMatrix-skew-x" name='DOM-CSSMatrix-skew-x'>skewX</a></code>
                        </dt>
                        <dd>
                          <div class='method'>
                            The <code>skewX</code> method returns a new matrix which is this matrix multiplied by a matrix representing a <a href="http://www.w3.org/TR/SVG/coords.html#SkewXDefined">skew along the x-axis</a>. The rotation value is in degrees. This matrix is not modified.
                            <div class='parameters'>
                              <b>Parameters</b>
                              <div class='paramtable'>
                                <dl>
                                  <dt>
                                    <code class='parameter-name'>angle</code> of type <code>float</code>
                                  </dt>
                                  <dd>
                                    The angle of skew along the X axis.<br>
                                  </dd>
                                </dl>
                              </div>
                            </div><!-- parameters -->
                            <div class='return-value'>
                              <b>Return Value</b>
                              <div class='returnvalue'>
                                <dl>
                                  <dt>
                                    <code>CSSMatrix</code>
                                  </dt>
                                  <dd>
                                    The result matrix.<br>
                                  </dd>
                                </dl>
                              </div>
                            </div>
                            <div>
                              <b>No Exceptions</b>
                            </div>
                          </div>
                          <!-- ======================================================================================================= -->
                        </dd> <!-- skewX() -->

                        <!-- ===================================================== -->
                        <dt>
                          <code class='method-name'><a id="DOM-CSSMatrix-skew-y" name='DOM-CSSMatrix-skew-y'>skewY</a></code>
                        </dt>
                        <dd>
                          <div class='method'>
                            The <code>skewX</code> method returns a new matrix which is this matrix multiplied by a matrix representing a <a href="http://www.w3.org/TR/SVG/coords.html#SkewYDefined">skew along the y-axis</a>. The rotation value is in degrees. This matrix is not modified.
                            <div class='parameters'>
                              <b>Parameters</b>
                              <div class='paramtable'>
                                <dl>
                                  <dt>
                                    <code class='parameter-name'>angle</code> of type <code>float</code>
                                  </dt>
                                  <dd>
                                    The angle of skew along the Y axis.<br>
                                  </dd>
                                </dl>
                              </div>
                            </div><!-- parameters -->
                            <div class='return-value'>
                              <b>Return Value</b>
                              <div class='returnvalue'>
                                <dl>
                                  <dt>
                                    <code>CSSMatrix</code>
                                  </dt>
                                  <dd>
                                    The result matrix.<br>
                                  </dd>
                                </dl>
                              </div>
                            </div>
                            <div>
                              <b>No Exceptions</b>
                            </div>
                          </div>
                          <!-- ======================================================================================================= -->
                        </dd> <!-- skewY() -->

                      </dl><!-- methods -->
                    </dd>

                  </dl>
                </dd> <!-- Interface CSSMatrix -->
              </dl>

        <h2>References</h2>

        <h3 class="no-num">Normative references</h3>
        <!--normative-->

        <h3 class="no-num">Other references</h3>
        <!--informative-->



        <h2 class="no-num">Property index</h2>
        <!-- properties -->



        <h2 class="no-num" id="index">Index</h2>
        <!--index-->

  </body>
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
 
