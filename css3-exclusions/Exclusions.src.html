<!DOCTYPE html public '-//W3C//DTD HTML 4.01//EN' 'http://www.w3.org/TR/html4/strict.dtd'>
<html lang="en">
<head profile="http://www.w3.org/2006/03/hcard">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>CSS Exclusions and Shapes Module Level 1</title>
  <link rel="stylesheet" type="text/css" href="default.css" />
  <link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/W3C-[STATUS].css" />


  <link id="st" href="alternate-spec-style.css" rel="alternate stylesheet" 
      type="text/css" disabled title="additional spec styles">             
        
        <script type="text/javascript" src="style-toggle.js"></script>

  <style type="text/css">
  
  /* Alternate stylesheet fonts are here because in some browsers (Opera 11.5) */
  /* The fonts are not applied if only loaded from the alternate stylesheet    */
  @import url(http://fonts.googleapis.com/css?family=Droid+Serif:700,400,400italic,700italic);
  @import url(http://fonts.googleapis.com/css?family=Droid+Sans+Mono);

    .singleImgExample {
    	display: block;
    	margin: auto;
    }
    
    .example-table {
    	table-layout: fixed; 
    	width: 100%; 
    }
    
    .example-table tr td img {
    	width: 90%;
    }
    
    a.toggle {
        position: fixed;
        top: 0.5em;
        right: 0.5em;
    	font-size: smaller;
    	color: gray;
    	opacity: 0.2;
    }

    a.toggle:hover {
        opacity: 1;
        color: #46A4E9;
    }
    
    

     div.issue-marker {
         position: absolute;
         width: 20ex;
         margin-left: -26ex;
         padding-right: 0.5em;
         font-weight: normal;
         font-size: 11px;
         text-align: right;
         background-color: white;
         font-size: 90%;
         padding-top: 0px;
         padding-bottom: 0px;
     }

     div.issue-marker a {
         color: red;
     }
     
     div.issue-marker .desc {
         font-size: 80%;
         line-height: 1.4em;
     }
     
     div.issue-marker .desc strong {
         font-weight: bold;
         font-size: 120%;
         color: red;
     }
  </style>

</head>
<body>
    <div id="div-head" class="head">
        <!--logo-->
        <h1 id="css-exclusions-module">CSS exclusions and shapes</h1>
        <h2 class="no-num no-toc">[LONGSTATUS] [DATE]</h2>
        <dl>
            <dt>This version:</dt>
            <dd><a href="[VERSION]">http://www.w3.org/csswg/css3-exclusions/</a></dd>
            <dt>Latest version:</dt>
            <dd><a href="http://www.w3.org/TR/[SHORTNAME]/">http://www.w3.org/csswg/[SHORTNAME]/</a></dd>
            <dt>Previous version:</dt>
            <dd>None</dd>
            <dt>Editors:</dt>
            <dd class="vcard"><span class="fn">Vincent Hardy</span>, <span class="org">Adobe Systems, Inc.</span>, <span class="email">vhardy@adobe.com</span></dd>
            <dd class="vcard"><span class="fn">Rossen Atanassov</span>, <span class="org">Microsoft Corporation</span>, <span class="email">ratan@microsoft.com</span></dd>
            <dt>Issues List</dt>
            <dd><a href="http://wiki.csswg.org/ideas/css3-exclusions">http://wiki.csswg.org/ideas/css3-exclusions</a></dd>
        </dl>
        <!--copyright-->
        <hr title="Separator for header">
    </div>

    <h2 class="no-num no-toc" id="abstract">Abstract</h2>
        
    <p>
        CSS exclusions define arbitrary areas around which inline content can flow.
        Unlike CSS floats, which they extend, CSS exclusions can be positioned with any 
        CSS positioning schemes.
    </p>
    <p>
        CSS Shapes control the geometric shapes used for wrapping inline
        flow content outside or inside an element. 
    
    </p>
    <p>
        Combining CSS Exclusions and CSS Shapes allows sophisticated layouts, 
        for example having content flow into and/or around
        circles or other, arbitrarily complex shapes.
    </p>
    <h2 class="no-num no-toc" id="status">Status of this document</h2>
    <!--status-->
    <!--<p>The following features are at risk: &hellip;</p>-->
   
    <h2 class="no-num no-toc" id="contents">Table of contents</h2>
    <!--toc-->

    <h2 id="intro">Introduction</h2>
    <p><em>This section is not normative.</em></p>
    <p>
        The exclusions section of this specification defines features that allow inline flow 
        content to wrap around outside the <span>exclusion area</span> of elements. 
    </p>
    <p>
        The shapes section of the specification defines properties to control the geometry of
        an element's <span>exclusion area</span> as well as the geometry used for wrapping 
        an element's inline flow content.
    </p>

    <h2 id="definitions">Definitions</h2>
    
    <dfn>Exclusion element</dfn>
    
    <p>
        An element that defines an <span>exclusion area</span> for other elements. The 'wrap-flow'
        property is used to make an element an exclusion element. An exclusion element contributes
        its <span>exclusion area</span> to its <a href="http://www.w3.org/TR/CSS2/visudet.html#containing-block-details">
        containing block's</a> <span>wrapping context</span>
    </p>
    
    <dfn>Exclusion area</dfn>
    <p>
        The area used for excluding inline flow content around an exclusion element. The
        exclusion area is equivalent to the <a href="http://www.w3.org/TR/CSS2/box.html#box-dimensions">
        border box</a> for elements with 'float' property computed to 'none' and the
        <a href="http://www.w3.org/TR/CSS2/box.html#box-dimensions">margin box</a> for elements
        with 'float' property computed to a value other than 'none'. This specification's
        'shape-outside' property can be used to define arbitrary, non-rectangular exclusion
        areas.
    </p>
    
    <dfn>Wrapping context</dfn>
    
    <p>
        The wrapping context of an element is a collection of 'exclusion areas'. The wrapping
        context is used to wrap around inline flow content during layout. An element will
        wrap its inline flow content in the area that corresponds to the subtraction of
        its wrapping context from its own <span>content area</span>.
    </p>
    
    <p>
        An element inherits its 
        <a href="http://www.w3.org/TR/CSS2/visudet.html#containing-block-details">containing block's</a> 
        wrapping context unless it specifically 
        resets it using the 'wrap-through' property.
    </p>
    
    <dfn>Content area</dfn>
    <p>
        The area used for layout of the inline flow content of an element. By default the
        area is equivalent to the <a href="http://www.w3.org/TR/CSS2/box.html#box-dimensions">content box</a>. 
        This specification's 'shape-inside' property can define arbitrary, non-rectangular content areas.
    </p>
    
    <dfn title="outside-inside">Outside and inside</dfn>
    
    <p>
        In this specification, 'outside' refers to DOM content that is not a descendant of an element 
        while 'inside' refers to the element's descendants.
    </p>
    
    <h2 id="exclusions">Exclusions</h2>
    <p>
        Exclusion elements define exclusion areas that contribute to their containing block's 
        wrapping context. As a consequence, exclusions impact the layout of their containing block's
        descendants.
    <p>
    <p>
        Elements layout their inline content in their <span>content area</span> and avoid the 
        areas in their associated wrapping context. If the element is itself an exclusion, it 
        does not wrap around its own exclusion shape and the impact of other exclusions on other 
        exclusions is controlled by the 'z-index' property as explained in the 
        <a href="#exclusions-order">exclusions order</a> section.
    </p>
        The shape properties can is used to change the shape of exclusions.
    </p>

    <h3 id="declaring-exclusions">Declaring exclusions</h3>
    <p>
        An element becomes an exclusion when its 'wrap-flow' property has a computed value other than 
        'auto'.
    </p>
    
    <h4 id="wrap-flow-property">The 'wrap-flow' property</h4>
    <table class="propdef">
        <tr>
            <th>Name:</th>
            <td><dfn title="'wrap-flow'">wrap-flow</dfn></td>
        </tr>
        <tr>
            <th>Value:</th>
            <td><var>auto</var> | <var>both</var> | <var>left</var> | <var>right</var> | <var>maximum</var> | <var>clear</var></td>
        </tr>
        <tr>
            <th>Initial:</th>
            <td>auto</td>
        </tr>
        <tr>
            <th>Applies to:</th>
            <td>block-level elements</td>
        </tr>
        <tr>
            <th>Inherited:</th>
            <td>no</td>
        </tr>
        <tr>
            <th>Percentages:</th>
            <td>N/A</td>
        </tr>
        <tr>
            <th>Media:</th>
            <td>visual</td>
        </tr>
        <tr>
            <th>Computed&nbsp;value:</th>
            <td>as specified, except for floats all values compute to 'auto'</td>
        </tr>
    </table>
    
    <p>The values of this property have the following meanings:</p>
    <dl>
        <dt><dfn title="'wrap-flow'!!'auto'">auto</dfn></dt>
        <dd>
            For floats an exclusion is created, for all other elements an exclusion is not created.
        </dd>
        <dt><dfn title="'wrap-flow'!!'both'">both</dfn></dt>
        <dd>
            Inline flow content can flow on all sides of the exclusion.
        </dd>
        <dt><dfn title="'wrap-flow'!!'left'">left</dfn></dt>
        <dd>
            Inline flow content can wrap on the left side of the exclusion but must leave
            the area to the right of the exclusion empty.
        </dd>
        <dt><dfn title="'wrap-flow'!!'right'">right</dfn></dt>
        <dd>
            Inline flow content can wrap on the right side of the exclusion but must leave
            the area to the left of the exclusion empty.
        </dd>
        <dt><dfn title="'wrap-flow'!!'maximum'">maximum</dfn></dt>
        <dd>
            Inline flow content can wrap on the side of the exclusion with the largest 
            available space for the given line, and must leave the other side of the exclusion
            empty..
        </dd>
        <dt><dfn title="'wrap-flow'!!'clear'">clear</dfn></dt>
        <dd>
            Inline flow content can only wrap on top and bottom of the exclusion and must leave
            the areas to the left and right of the exclusion empty.
        </dd>
    </dl>

    <p>
        Setting the 'wrap-flow' property to 'both', 'left', 'right', 'maximum' or 'clear' on an 
        element makes that element an <span>exclusion element</a>. It's <span>exclusion shape</span>
        is contributed to its containing block's wrapping context, causing the containing block's descendants 
        to wrap around its exclusion area.
    </p>
    <p>
        The initial value for this property is 'auto'.
    </p>
    <p>
        When the property's computed value is 'auto', the element does not become an 
        <span>exclusion element</span> unless its 'float'
        property computed value is not 'none'. In that case, the element contributes its
        'border box' to its containing block's <span>wrapping context</span> and content 
        flows around it according to the 'clear' property.
    </p>
    <p>
        The element will be considered as an exclusion for all inline flow content descendants
        of the exclusions' containing block.
    </p>

    <div class="figure">
        <img src="images/exclusions-illustration.png" width="70%" />
        <p class="caption">Combining exclusions</p>
    </div>
    
    <div>
        <p>The above figure illustrates how exclusions combine. The red box represents an element's 
        content box. The A, B, C and D darker gray boxes represent exclusions in the element's
        wrapping context. A, B, C and D have their respective 
        'wrap-flow' set to 'both', 'left', 'right' and 'clear' respectively. The lighter gray
        areas show the additional areas that are excluded for inline layout as a result of the 
        'wrap-flow' value. For example, the area to the right of 'B' cannot be used for inline
        layout because the 'wrap-flow' for 'B' is 'left'.</p>
        
        <p>The background 'blue' area shows what areas are available for inline content layout.
            All areas represented with a light or dark shade of gray are not available for inline
            content layout.</p>
    </div>
    
    <div class="example">
        <p>
            The 'wrap-flow' property values applied to an absolutely positioned element.
        </p>
<code class="html"><pre>
&lt;style type="text/css"&gt; 
    #exclusion {
    	position: absolute; 
    	background: lightblue; 
    	border: 3px solid blue; 
    } 
&lt;/style&gt; 

&lt;div style=”position: relative; border: 1px solid black;”&gt; 
    &lt;div id=”exclusion”&gt;Donec metus messa, mollis...&lt;/div&gt; 
    Lorem ipsum dolor sit amet... 
&lt;/div&gt;
</pre></code>
        <table class="example-table">
            <tr>
                <td><code class="html">#exclusion{ wrap-flow: auto; }</code></td>
                <td><code class="html">#exclusion{ wrap-flow: both; }</code></td>
            </tr>
            <tr>
                <td><img src="images/exclusion_wrap_side_auto.png" alt="Example rendering for wrap-side: auto" /></td>
                <td><img src="images/exclusion_wrap_side_both.png" alt="Example rendering for wrap-side: both" /></td>
            </tr>
            <tr>
                <td><code class="html">#exclusion{ wrap-flow: left; }</code></td>
                <td><code class="html">#exclusion{ wrap-flow: right; }</code></td>
            </tr>
            <tr>
                <td><img src="images/exclusion_wrap_side_left.png" alt="Example rendering for wrap-side: left" /></td>
                <td><img src="images/exclusion_wrap_side_right.png" alt="Example rendering for wrap-side: right" /></td>
            </tr>
            <tr>
                <td><code class="html">#exclusion{ wrap-flow: maximum; }</code></td>
                <td><code class="html">#exclusion{ wrap-flow: maximum; }</code></td>
            </tr>
            <tr>
                <td><img src="images/exclusion_wrap_side_maximum_L.png" alt="Example rendering for wrap-side: maximum" /></td>
                <td><img src="images/exclusion_wrap_side_maximum_R.png" alt="Example rendering for wrap-side: maximum" /></td>
            </tr>
            <tr>
                <td><code class="html">#exclusion{ wrap-flow: clear; }</code></td>
                <td><code class="html">&nbsp;</code></td>
            </tr>
            <tr>
                <td><img src="images/exclusion_wrap_side_clear.png" alt="Example rendering for wrap-side: clear" /></td>
                <td>&nbsp;</td>
            </tr>
        </table>
    </div>
    <!-- End section "wrap-flow Property" -->
    <!-- End section "Declaring Exclusions" -->
        
    <h3 id="scope-and-effect-of-exclusions">Scope and Effect of Exclusions</h3>
    <p>
        An exclusion affects the inline flow content descended from the exclusion's containing
        blocks (defined in <a href="http://www.w3.org/TR/CSS2/visudet.html#containing-block-details">
        CSS 2.1 10.1</a>) and that of all descendant elements of the same containing
        block. All inline flow content inside the containing block of the exclusions is
        affected. To stop the effect of exclusions defined outside any element, the 'wrap-through'
        property can be used (see definition of Propagation of Exclusions below).
    </p>

    <h4 id="wrap-margin-property">The 'wrap-margin' Property</h4>
    <p>
        The 'wrap-margin' property can be used to offset the inline flow content wrapping
        on the outside of exclusions. Offsets created by the 'wrap-margin' property are
        offset from the outside of the exclusion. This property takes on positive values
        only.
    </p>
    <table class="propdef">
        <tr>
            <th>Name:</th>
            <td><dfn title="'wrap-margin'">wrap-margin</dfn></td>
        </tr>
        <tr>
            <th>Value:</th>
            <td><var>&lt;length&gt;</var></td>
        </tr>
        <tr>
            <th>Initial:</th>
            <td>0</td>
        </tr>
        <tr>
            <th>Applies to:</th>
            <td>block-level elements</td>
        </tr>
        <tr>
            <th>Inherited:</th>
            <td>no</td>
        </tr>
        <tr>
            <th>Percentages:</th>
            <td>N/A</td>
        </tr>
        <tr>
            <th>Media:</th>
            <td>visual</td>
        </tr>
        <tr>
            <th>Computed&nbsp;value:</th>
            <td>the absolute length</td>
        </tr>
    </table>

    <!-- End secion "wrap-margin property" -->

    <h4 id="wrap-padding-property">The 'wrap-padding' Property</h4>
    <p>
        The 'wrap-padding' property can be used to offset to the inline flow content wrapping
        on the inside of elements. Offsets created by the 'wrap-padding' property are offset
        from the <span>content area</span> of the element. This property takes on positive values only.
    </p>
    <table class="propdef">
        <tr>
            <th>Name:</th>
            <td><dfn title="'wrap-padding'">wrap-padding</dfn></td>
        </tr>
        <tr>
            <th>Value:</th>
            <td><var>&lt;length&gt;</var></td>
        </tr>
        <tr>
            <th>Initial:</th>
            <td>0</td>
        </tr>
        <tr>
            <th>Applies to:</th>
            <td>block-level elements</td>
        </tr>
        <tr>
            <th>Inherited:</th>
            <td>no</td>
        </tr>
        <tr>
            <th>Percentages:</th>
            <td>N/A</td>
        </tr>
        <tr>
            <th>Media:</th>
            <td>visual</td>
        </tr>
        <tr>
            <th>Computed&nbsp;value:</th>
            <td>the absolute length</td>
        </tr>
    </table>
    <!-- End section "wrap-padding property" -->
    
    <div class="note">Note that the 'wrap-padding' property affects layout of content inside 
        the element it applies to while the 'wrap-margin' property affects layout of content 
        outside the element.</div>
        
    <!-- End section "Scope and Effect of Exclusions" -->
    
    <h3 id="propagation-of-exclusions">Propagation of Exclusions</h3>
    <p>
        By default, an element inherits its parent <span>wrapping context</span>. In other words
        it is subject to the exclusions defined <span title="outside-inside">outside</sapn> the element.
    </p>
    <p>Setting the 'wrap-through' property to 'none' prevents an element from inheriting its parent
        wrapping context. In other words, exclusions defined 'outside' the element, have not effect
        on the element's children layout.
    </p>
    <div class="note">
        Exclusions defined by an element's descendants still contribute to their containing block's
        <span>wrapping context</span>. If that containing block is a child of an element with 'wrap-through'
        set to none, or the element itself, then exclusion still have an effect on the children of that 
        containing block element.
    </div>

    <h4 id="wrap-through-property">The 'wrap-through' Property</h4>
    <table class="propdef">
        <tr>
            <th>Name:</th>
            <td><dfn title="'wrap-through'">wrap-through</dfn></td>
        </tr>
        <tr>
            <th>Value:</th>
            <td><var>wrap</var> | <var>none</var></td>
        </tr>
        <tr>
            <th>Initial:</th>
            <td>wrap</td>
        </tr>
        <tr>
            <th>Applies to:</th>
            <td>block-level elements</td>
        </tr>
        <tr>
            <th>Inherited:</th>
            <td>no</td>
        </tr>
        <tr>
            <th>Percentages:</th>
            <td>N/A</td>
        </tr>
        <tr>
            <th>Media:</th>
            <td>visual</td>
        </tr>
        <tr>
            <th>Computed&nbsp;value:</th>
            <td>as specified</td>
        </tr>
    </table>

    <p>The values of this property have the following meanings:</p>
    <dl>
        <dt><dfn title="'wrap-through'!!'wrap'">wrap</dfn></dt>
        <dd>
            The element inherits its parent node's <span>wrapping context</span>. Its descendant
            inline content wraps around exclusions defined <span title="outside-inside">outside</span>
            the element.
        </dd>
    </dl>
    <dl>
        <dt><dfn title="'wrap-through'!!'none'">none</dfn></dt>
        <dd>
            The element does not inherit its parent node's <span>wrapping context</span>. Its 
            descendants are only subject to exclusion shapes defined <span title="outside-inside">inside</span>
            the element.
        </dd>
    </dl>
    <div class="example">
        <p>
            Using the 'wrap-through' property to control the effect of exclusions.
        </p>
<pre><code class="html">
&lt;style type="text/css"&gt; 
    .exclusion  {
    	wrap-flow: both; 
    	position: absolute; 
    	background-color: rgba(220, 230, 242, 0.5); 
    } 
&lt;/style&gt; 

&lt;div style=”position: relative;”&gt; 
    &lt;div class=”exclusion”&gt;&lt;/div&gt; 
    &lt;div style=”wrap-through: wrap;”&gt; Lorem ipsum dolor sit amet...&lt;/div&gt; 
    &lt;div style=”wrap-through: none;”&gt; Lorem ipsum dolor sit amet...&lt;/div&gt; 
&lt;/div&gt;
</code></pre>

        <img class="singleImgExample" src="images/exclusion_wrap_through.png" alt="Example rendering of wrap-through: wrap | none" style="max-width:40%"/>
    </div>
    <!-- End section "wrap-through property" -->


    <h4 id="wrap-shorthand-property">The 'wrap' Shorthand Property</h4>
    <table class="propdef">
        <tr>
            <th>Name:</th>
            <td><dfn title="'wrap'">wrap</dfn></td>
        </tr>
        <tr>
            <th>Value:</th>
            <td><var>&lt;wrap-flow&gt;</var> || <var>&lt;wrap-margin&gt;</var> [ / <var>&lt;wrap-padding&gt;</var>]</td>
        </tr>
        <tr>
            <th>Initial:</th>
            <td>see individual properties</td>
        </tr>
        <tr>
            <th>Applies to:</th>
            <td>block-level elements</td>
        </tr>
        <tr>
            <th>Inherited:</th>
            <td>no</td>
        </tr>
        <tr>
            <th>Percentages:</th>
            <td>N/A</td>
        </tr>
        <tr>
            <th>Media:</th>
            <td>visual</td>
        </tr>
        <tr>
            <th>Computed&nbsp;value:</th>
            <td>see individual properties</td>
        </tr>
    </table>
    <p>
        The 'wrap' property is a shorthand property for setting the exclusions properties
        at the same place in the style sheet.
    </p>


    <!-- End section "wrap shorthand property" -->
    <!-- End section "Propagation of Exclusions" -->
    
    <h3 id="exclusions-order">Exclusions order</h3>
    <p>
        Exclusions follow the painting order (See [[!CSS21]] Appendix E). Exclusions are
        applied in reverse to the document order in which they are defined. The last exclusion
        appears on top of all other exclusion, thus it affects the inline flow content of
        all other preceding exclusions or elements descendant of the same containing block.
        To change the ordering of exclusions with 'position' property computed to a value
        other than 'static', 'z-index' can be used. Exclusions with 'position' property
        computed to 'static' are not affected by the 'z-index' property, thus follow the painting
        order.
    </p>
    
    <div class="example">
        <p>Ordering of exclusions.</p>
<pre><code class="html">
&lt;style type="text/css"&gt; 
    .exclusion  {
    	wrap-flow: both; 
    	position: absolute; 
    	width: 50%; 
    	height: 50%; 
    } 
&lt;/style&gt; 

&lt;div class=”exclusion” style=”top: 0px; left: 0px;”&gt; 
    Lorem ipsum dolor sit amet... 
&lt;/div&gt; 
&lt;div id="orderedExclusion" class=”exclusion” style=”top: 25%; left: 25%;”&gt; 
    Lorem ipsum dolor sit amet... 
&lt;/div&gt; 
&lt;div class=”exclusion” style=”top: 50%; left: 50%;”&gt; 
    Lorem ipsum dolor sit amet... 
&lt;/div&gt;
</code></pre>

    <table class="example-table">
        <tr>
            <td style="width:50%"><code class="html">#orderedExclusion{ z-index: auto; }</code></td>
            <td style="width:50%"><code class="html">#orderedExclusion{ z-index: 1; }</code></td>
        </tr>
        <tr>
            <td><img class="singleImgExample" src="images/exclusion_ordering.png" alt="Example rendering of default exclusion ordering." /></td>
            <td><img class="singleImgExample" src="images/exclusion_ordering_z_order.png" alt="Example rendering of default exclusion ordering." /></td>
        </tr>
    </table>

    </div>
    <!-- End section "Order of Exclusions" -->

    <h3 id="exclusions-implementation-note">Exclusions implementation note</h3>
    <p><em>This section is not normative.</em></p>
    <p>
        Exclusions can be specified on positioned elements and elements can be positioned
        from their <a href="http://www.w3.org/TR/CSS21/visudet.html#static-position">static
        position</a>. Since, the static position of such elements depends on the inline
        flow content affected by the exclusion itself; there is a circular dependency between
        the two layout tasks. To break this circular dependency a two-pass layout approach
        is recommended. The first layout pass computes the static positions of all auto-positioned
        exclusions by laying out all content besides exclusions. The second pass is layout
        of all elements including all exclusions. Exclusions that depend on their static
        position will use the position calculated during the first layout pass.
    </p>
    <p class="note">
        Note, this may cause exclusions to overlap or be distant from their static position
        (compared to non-exclusions auto-positioned elements).
    </p>
    <p>
        Similar dependency exists for exclusions whose size or position is specified in
        percentage and the containing block size is specified as 'auto'. In such cases the
        size or position of the exclusion is calculated based on the size of the containing
        block calculated in the first layout pass.
    </p>
    <p>
        Exclusions can be positioned on all levels of nested elements. If layout is
        restarted on every level of nesting, the time to complete layout will be exponential.
        To avoid multiple layout passes, the restart of the second layout pass
        should be scoped to the top-most containing block of exclusions. Similarly, restarting
        layout for the entire document is not necessary unless there are exclusions whose
        containing block is the initial containing block.
    </p>
    
    <!-- End section "Processing Model of Exclusions" -->
    <!-- End section "Exclusions" -->

    <h2 id="shapes">Shapes</h2>
    <p>
        Shapes define arbitrary geometric contours around which or into which inline flow
        content flows. There are two different types of shapes – 'outside' and 'inside'.
        The outside shape defines the <span>exclusion area</span> for an <span>exclusion element</span>. 
        The inside shape defines an element's <span>content shape</span> and the element's inline 
        content will flow within that shape.
    </p>

    <dfn>Flow Container</dfn>
    <p>
        A flow container is an element with a 'display' value that is computed as 'block',
        'table-cell' or 'inline-block'.
    </p>
    <p class="note">
        Note, while the boundaries used for wrapping inline flow content outside and inside
        an element can be defined using shapes, the actual box model does not change. If
        the element has specified margins, borders or paddings they will be computed and
        rendered according to the [[CSS3-Box]] module.
    </p>
    
    <div class="example">
        <p>CSS 'shape' and CSS box model relation.</p>
<pre><code class="html">
&lt;style type="text/css"&gt; 
    .exclusion  {
    	wrap-flow: both; 
    	position: absolute; 
    	shape-outside: circle(50%, 50%, 50%); 
    	border: 1px solid red; 
    } 
&lt;/style&gt; 

&lt;div style=”position: relative; border: 1px solid black;”&gt; 
    &lt;div class=”exclusion”&gt;&lt;/div&gt; 
    Lorem ipsum dolor sit amet... 
&lt;/div&gt;
</code></pre>
        <img class="singleImgExample" src="images/shapes_CSS2.1_MBP.png" alt="Example rendering of circle shape and box model."  style="max-width:40%"/>
    </div>
      
      <h3 id="shapes-from-svg-syntax">Shapes from SVG Syntax</h3>
      <p>
          Shapes can be specified using <a href="http://www.w3.org/TR/SVG/shapes.html">SVG basic shapes</a>.
      </p>
      
       
      <h4 id="supported-svg-shapes">Supported SVG Shapes</h4>
      The following SVG shapes are supported by the CSS shapes module.
      <dl>
          <dt>rectangle(x, y, width, height, [[rx], ry])</dt>
          <dd>
              <ul>
                  <li><strong>x, y, width and height</strong> - define the bounding box of the rectangle</li>
                  <li><strong>rx</strong> - For rounded rectangles, the x-axis radius of the ellipse used
                      to round off the corners of the rectangle</li>
                  <li><strong>ry</strong> - For rounded rectangles, the y-axis radius of the ellipse used
                      to round off the corners of the rectangle</li>
              </ul>
          </dd>
          <dt>circle(cx, cy, r)</dt>
          <dd>
              <ul>
                  <li><strong>cx</strong> - The x-axis coordinate of the center of the circle</li>
                  <li><strong>cy</strong> - The y-axis coordinate of the center of the circle</li>
                  <li><strong>r</strong> - The radius of the circle</li>
              </ul>
          </dd>
          <dt>ellipse(cx, cy, rx, ry)</dt>
          <dd>
              <ul>
                  <li><strong>cx</strong> - The x-axis coordinate of the center of the ellipse</li>
                  <li><strong>cy</strong> - The y-axis coordinate of the center of the ellipse</li>
                  <li><strong>rx</strong> - The x-axis radius of the ellipse</li>
                  <li><strong>ry</strong> - The y-axis radius of the ellipse</li>
              </ul>
          </dd>
          <dt>polygon([fillRule], x1, y1, x2, y2, x3, y3, … xn, yn)</dt>
          <dd>
              <ul>
                  <li><strong>fillRule</strong> - The filling rule used to determine the interior of the
                      polygon. See fill-rule property in SVG for details. Possible values are nonzero
                      or evenodd. Default value when omitted is nonzero.</li>
                  <li><strong>xi</strong> - The x-axis coordinate of the i-th vertex of the polygon</li>
                  <li><strong>yi</strong> - The y-axis coordinate of the i-th vertex of the polygon</li>
              </ul>
              <p>
                  If the polygon is not closed the user-agent will automatically add a new vertex
                  at the end.</p>
              <br>
          </dd>
      </dl>
      
      <h4 id='referencing-svg-shapes'>Referencing SVG shapes</h4>
      
      <p>An SVG shape can be referenced using the <code>url()</code> syntax. The shape can be 
          any of the <a href="http://www.w3.org/TR/SVG/shapes.html">SVG basic shapes</a> or a 
          <a href="http://www.w3.org/TR/SVG/paths.html">path element</a>.</p>
          
      <p>In all cases, percentages are resolved from the border box of the element.</p>
      
      <div class="example">
          <code class="html"><pre>
&lt;style&gt;
.in-a-circle {
    shape-inside: url(#circle_shape);
}

.in-a-path {
    shape-inside: url(#path-shape);
}

&lt;/style&gt;

&lt;svg ...&gt;
&lt;circle id="circle_shape" cx="50%x" cy="50%" r="50%" /&gt;
&lt;path id="path-shape" d="..." /&gt;
&lt;/svg&gt;

&lt;div class="in-a-circle"&gt;...&lt;/div&gt;
&lt;div class="in-a-path"&gt;...&lt;/div&gt;
          </pre></code>
      </div>
        <p>
            When using the SVG syntax or referencing SVG elements to define shapes, all the
            lengths expressed in percentages are resolved from the border box of the element.
            The coordinate system for the shape has its origin on the top-left corder of the
            border box with the x-axis running to the right and the y-axis running downwards.
            If the SVG element uses unitless coordinate values, they are equivalent to using
            'px' units. If the border box of the element is dependent on auto sizing (i.e.,
            the element's 'width' or 'height' property is 'auto'), then the percentage values
            are computed agains '0' and resolve to 0.
        </p>
        <!-- End section "Shapes from SVG Syntax -->
      
      <h3 id="shapes-from-image">Shapes from Image</h3>

      <div class="issue issue-marker"><p class="desc">Do we need to provide properties to repeat exclusion
          images as for the background-image property?</p></div>
      <p>
          Another way of defining shapes is by specifying a source image whose alpha channel
          is used to compute the inside or outside shape. The shape is computed to be the
          path that encloses the area where the opacity of the specified image is greater
          than the 'shape-image-threshold' value. If the 'shape-image-threshold' is not specified,
          the initial value to be considered is 0.5.
      </p>
      
      <p class="note">
          Note, images can define cavities and inline flow content should wrap inside
          them. In order to avoid that, another exclusion element can be overlaid.
      </p>
      
      
      <!-- End section "Shapes from image" -->

      <h3 id="declaring-shapes">Declaring Shapes</h3>
      <p>
          Shapes are declared with the 'shape-outside' or 'shape-inside' properties. 
          The 'shape-outside' property changes the geometry of an <span>exclusion element</span>'s
          <span>exclusion are</span>. If the element is not an <span>exclusion element</span>
          (see the 'wrap-flow' property), then the 'shape-outside' property has no effect.
      </p>
      <p>
          The 'shape-inside' property defines an element's <span>content area</span> and 
          the element's inline flow content wraps into that shape.
      </p>

      <h4 id="shape-outside-property">The 'shape-outside' Property</h4>

        <table class="propdef">
            <tr>
                <th>Name:</th>
                <td><dfn title="'shape-outside'">shape-outside</dfn></td>
            </tr>
            <tr>
                <th>Value:</th>
                <td><var>auto</var> | <var>&lt;shape&gt;</var> | <var>&lt;uri&gt;</var></td>
            </tr>
            <tr>
                <th>Initial:</th>
                <td>auto</td>
            </tr>
            <tr>
                <th>Applies to:</th>
                <td>block-level elements</td>
            </tr>
            <tr>
                <th>Inherited:</th>
                <td>no</td>
            </tr>
            <tr>
                <th>Percentages:</th>
                <td>N/A</td>
            </tr>
            <tr>
                <th>Media:</th>
                <td>visual</td>
            </tr>
            <tr>
                <th>Computed&nbsp;value:</th>
                <td>computed lengths for &lt;shape&gt;, the absolute URI for &lt;uri&gt;, otherwise as specified</td>
            </tr>
        </table>
      
      <p>The values of this property have the following meanings:</p>
      <dl>
          <dt><dfn title="'shape-outside'!!'auto'">auto</dfn></dt>
          <dd>The shape is computed based on the border box of the element.</dd>
      </dl>
      <dl>
          <dt><dfn title="'shape-outside'!!'&lt;shape&gt;'">&lt;shape&gt;</dfn></dt>
          <dd>
              The shape is computed based on the values of one of 'rectangle',' circle', 'ellipse'
              or 'polygon'.
          </dd>
      </dl>
      <dl>
          <dt><dfn title="'shape-outside'!!'&lt;uri&gt;'">&lt;uri&gt;</dfn></dt>
          <dd>
              If the &lt;uri&gt; references an SVG shape element, that element defines the shape.
              Otherwise, if the &lt;uri&gt; references an image, the shape is extracted and computed 
              based on the alpha channel of the specified image.
              
              If the &lt;uri&gt; does not reference an SVG shape element or an image, the 
              effect is as if the value 'auto' had been specified.
          </dd>
      </dl>
      
      <div class='figure'>
          <img src="images/shapes-exclusions.png" width="70%"/>
          <p class="caption">Arbitrary shapes for exclusions</p>
      </div>
      
      <div>
          <p>The above figure shows how 'shape-outside' shapes impact the exclusion areas.
              The red box represents an element's content box and 'A', 'B', 'C' and 'C'
              represent exclusions with a complex shape and their 'wrap-flow' property set
              to 'both', 'left', 'right' and 'clear', respectively.</p>
              
          <p>As illustrated in the picture, when an exclusion allows wrapping on all sides, 
              text can flow inside 'holes' in the exclusion (as for exclusion 'A'). Otherwise,
              the exclusion clears the area on the side(s) defined by wrap flow, as illustrated
              for 'B', 'C' and 'D' above.</p>
      </div>
      <!-- End section "The shape-outside Property" -->

      <h4 id="shape-inside-property">The 'shape-inside' Property</h4>
      <p>
          The 'shape-inside' modifies the shape of the inner inline flow content from rectangular
          content box to an arbitrary geometry.
      </p>

      <table class="propdef">
          <tr>
              <th>Name:</th>
              <td><dfn title="'shape-inside'">shape-inside</dfn></td>
          </tr>
          <tr>
              <th>Value:</th>
              <td><var>outside-shape</var> | <var>auto</var> | <var>&lt;shape&gt;</var> | <var>&lt;uri&gt;</var></td>
          </tr>
          <tr>
              <th>Initial:</th>
              <td>outside-shape</td>
          </tr>
          <tr>
              <th>Applies to:</th>
              <td>block-level elements</td>
          </tr>
          <tr>
              <th>Inherited:</th>
              <td>no</td>
          </tr>
          <tr>
              <th>Percentages:</th>
              <td>N/A</td>
          </tr>
          <tr>
              <th>Media:</th>
              <td>visual</td>
          </tr>
          <tr>
              <th>Computed&nbsp;value:</th>
              <td>computed lengths for &lt;shape&gt;, the absolute URI for &lt;uri&gt;, otherwise as specified</td>
          </tr>
      </table>
    <p>The values of this property have the following meanings:</p>
    <dl>
        <dt><dfn title="'shape-inside'!!'outside-shape'">outside-shape</dfn></dt>
        <dd>
            The shape is computed based on the computed value of the 'shape-outside' property.
        </dd>
    </dl>
    <dl>
        <dt><dfn title="'shape-inside'!!'auto'">auto</dfn></dt>
        <dd>
            The shape is computed based on the content box of the element.
        </dd>
    </dl>
    <dl>
        <dt><dfn title="'shape-inside'!!'&lt;shape&gt;'">&lt;shape&gt;</dfn></dt>
        <dd>
            The shape is computed based on the values of one of 'rectangle',' circle', 'ellipse'
            or 'polygon'.
        </dd>
    </dl>
    <dl>
        <dt><dfn title="'shape-inside'!!'&lt;uri&gt;'">&lt;uri&gt;</dfn></dt>
        <dd>
            If the &lt;uri&gt; references an SVG shape element, that element defines the shape.
              Otherwise, if the &lt;uri&gt; references an image, the shape is extracted and computed 
              based on the alpha channel of the specified image.
          
              If the &lt;uri&gt; does not reference an SVG shape element or an image, the 
              effect is as if the value 'auto' had been specified.
        </dd>
    </dl>
    <!-- End section "The shape-inside property" -->
    <h4 id="shape-image-threshold-property">The 'shape-image-threshold' Property</h4>
    <p>
        The 'shape-image-threshold' defines the alpha channel threshold used to extract
        the shape using an image. A value of 0.5 means that all the pixels that are more
        than 50% transparent define the path of the exclusion shape. The 'shape-image-threshold'
        applies to both 'shape-outside' and 'shape-inside'.
    </p>
    <p class="note">
        The specified value of 'shape-image-threshold' is applied to both images used for
        'shape-outside' and 'shape-inside'.
    </p>

    <table class="propdef">
        <tr>
            <th>Name:</th>
            <td><dfn title="'shape-image-threshold'">shape-image-threshold</dfn></td>
        </tr>
        <tr>
            <th>Value:</th>
            <td><var>&lt;alphavalue&gt;</var></td>
        </tr>
        <tr>
            <th>Initial:</th>
            <td>0.5</td>
        </tr>
        <tr>
            <th>Applies to:</th>
            <td>block-level elements</td>
        </tr>
        <tr>
            <th>Inherited:</th>
            <td>no</td>
        </tr>
        <tr>
            <th>Percentages:</th>
            <td>alpha channel of the image specified by &lt;uri&gt;</td>
        </tr>
        <tr>
            <th>Media:</th>
            <td>visual</td>
        </tr>
        <tr>
            <th>Computed&nbsp;value:</th>
            <td>The same as the specified value after clipping the &lt;alphavalue&gt; to the range [0.0,1.0].</td>
        </tr>
    </table>
    <p>The values of this property have the following meanings:</p>
    <dl>
        <dt><dfn title="'shape-image-threshold'!!'&lt;alphavalue&gt;'">&lt;alphavalue&gt;</dfn></dt>
        <dd>
            A &lt;number&gt; value used to set the threshold used for extracting a shape from
            an image. Any values outside the range 0.0 (fully transparent) to 1.0 (fully opaque)
            will be clamped to this range.
        </dd>
    </dl>
    <!-- End section "The shape-image-threshold property" -->
    <!--
    <h4 id="shape-shorthand-property">The 'shape' Shorthand Property</h4>

    <table class="propdef">
        <tr>
            <th>Name:</th>
            <td><dfn title="'shape'">shape</dfn></td>
        </tr>
        <tr>
            <th>Value:</th>
            <td><var>&lt;shape-outside&gt;</var> [ / <var>&lt;shape-inside&gt;</var> ] || <var>&lt;shape-image-threshold&gt;</var></td>
        </tr>
        <tr>
            <th>Initial:</th>
            <td>see individual properties</td>
        </tr>
        <tr>
            <th>Applies to:</th>
            <td>block-level elements</td>
        </tr>
        <tr>
            <th>Inherited:</th>
            <td>no</td>
        </tr>
        <tr>
            <th>Percentages:</th>
            <td>N/A</td>
        </tr>
        <tr>
            <th>Media:</th>
            <td>visual</td>
        </tr>
        <tr>
            <th>Computed&nbsp;value:</th>
            <td>see individual properties</td>
        </tr>
    </table>
    <p>
        The 'shape' property is a shorthand property for setting the individual shape properties
        at the same place in a style sheet.
    </p>

    <div class="example">
        <p>Style declaration using the 'shape' shorthand property.</p>
<pre><code class="html">
&lt;style type="text/css"&gt;
    .shape {
        shape: rectangle(50px, 50px, 200px, 100px) / url("shape_image.png")  0.7;
    }
&lt;/style&gt
</code></pre>
    </div>
    <p class="issue">The example above must be finished.</p>
    
    -->
    <!-- End section "Shape Shorthand property -->
    <!-- End section "Declaring Shapes" -->
    <!-- End section "Shapes" -->
    <h2 id="conformance">Conformance</h2>
    <h3 id="conventions">Document Conventions</h3>
    <p>
        Conformance requirements are expressed with a combination of descriptive assertions
        and RFC 2119 terminology. The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”,
        “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in the
        normative parts of this document are to be interpreted as described in RFC 2119.
        However, for readability, these words do not appear in all uppercase letters in
        this specification.
    </p>
    <p>
        All of the text of this specification is normative except sections explicitly marked
        as non-normative, examples, and notes. [[!RFC2119]]
    </p>
    <p>
        Examples in this specification are introduced with the words “for example” or are
        set apart from the normative text with <code>class="example"</code>, like this:
    </p>
    <div class="example">
        <p>This is an example of an informative example.</p>
    </div>
    <p>
        Informative notes begin with the word “Note” and are set apart from the normative
        text with <code>class="note"</code>, like this:
    </p>
    <p class="note">Note, this is an informative note.</p>
      <h3 id="conformance-classes">Conformance Classes</h3>
      <p>Conformance to CSS Exclusions and Shapes is defined for three conformance classes:</p>
      <dl>
          <dt><dfn title="style sheet!!as conformance class">style sheet</dfn></dt>
          <dd>
              A <a href="http://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS style sheet</a>.</dd>
          <dt><dfn>renderer</dfn></dt>
          <dd>
              A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a> that interprets
              the semantics of a style sheet and renders documents that use them.</dd>
          <dt><dfn id="authoring-tool">authoring tool</dfn></dt>
          <dd>
              A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a> that writes
              a style sheet.</dd>
      </dl>
      <p>
          A style sheet is conformant to CSS Exclusions and Shapes if all of its declarations
          that use properties defined in this module have values that are valid according
          to the generic CSS grammar and the individual grammars of each property as given
          in this module.
      </p>
      <p>
          A renderer is conformant to CSS Exclusions and Shapes if, in addition to interpreting
          the style sheet as defined by the appropriate specifications, it supports all the
          features defined by CSS Exclusions and Shapes by parsing them correctly and rendering
          the document accordingly. However, the inability of a UA to correctly render a document
          due to limitations of the device does not make the UA non-conformant. (For example,
          a UA is not required to render color on a monochrome monitor.)
      </p>
      <p>
          An authoring tool is conformant to CSS Exclusions and Shapes if it writes style
          sheets that are syntactically correct according to the generic CSS grammar and the
          individual grammars of each feature in this module, and meet all other conformance
          requirements of style sheets as described in this module.
      </p>
      <h3 id="partial">
          Partial Implementations</h3>
      <p>
          So that authors can exploit the forward-compatible parsing rules to assign fallback
          values, CSS renderers <strong>must</strong> treat as invalid (and <a href="http://www.w3.org/TR/CSS21/conform.html#ignore">
              ignore as appropriate</a>) any at-rules, properties, property values, keywords,
          and other syntactic constructs for which they have no usable level of support. In
          particular, user agents <strong>must not</strong> selectively ignore unsupported
          component values and honor supported values in a single multi-value property declaration:
          if any value is considered invalid (as unsupported values must be), CSS requires
          that the entire declaration be ignored.
      </p>
      <h3 id="experimental">
          Experimental Implementations</h3>
      <p>
          To avoid clashes with future CSS features, the CSS2.1 specification reserves a <a
              href="http://www.w3.org/TR/CSS21/syndata.html#vendor-keywords">prefixed syntax</a>
          for proprietary and experimental extensions to CSS.</p>
      <p>
          Prior to a specification reaching the Candidate Recommendation stage in the W3C
          process, all implementations of a CSS feature are considered experimental. The CSS
          Working Group recommends that implementations use a vendor-prefixed syntax for such
          features, including those in W3C Working Drafts. This avoids incompatibilities with
          future changes in the draft.
      </p>
      <h3 id="testing">
          Non-Experimental Implementations</h3>
      <p>
          Once a specification reaches the Candidate Recommendation stage, non-experimental
          implementations are possible, and implementors should release an unprefixed implementation
          of any CR-level feature they can demonstrate to be correctly implemented according
          to spec.
      </p>
      <p>
          To establish and maintain the interoperability of CSS across implementations, the
          CSS Working Group requests that non-experimental CSS renderers submit an implementation
          report (and, if necessary, the testcases used for that implementation report) to
          the W3C before releasing an unprefixed implementation of any CSS features. Testcases
          submitted to W3C are subject to review and correction by the CSS Working Group.
      </p>
      <p>
          Further information on submitting testcases and implementation reports can be found
          from on the CSS Working Group's website at <a href="http://www.w3.org/Style/CSS/Test/">
              http://www.w3.org/Style/CSS/Test/</a>. Questions should be directed to the <a href="http://lists.w3.org/Archives/Public/public-css-testsuite">
                  public-css-testsuite@w3.org</a> mailing list.
      </p>
      <h3 id="cr-exit-criteria">
          CR Exit Criteria</h3>
      <p>
          For this specification to be advanced to Proposed Recommendation, there must be
          at least two independent, interoperable implementations of each feature. Each feature
          may be implemented by a different set of products, there is no requirement that
          all features be implemented by a single product. For the purposes of this criterion,
          we define the following terms:
      </p>
      <dl>
          <dt>independent </dt>
          <dd>
              each implementation must be developed by a different party and cannot share, reuse,
              or derive from code used by another qualifying implementation. Sections of code
              that have no bearing on the implementation of this specification are exempt from
              this requirement.</dd>
          <dt>interoperable</dt>
          <dd>
              passing the respective test case(s) in the official CSS test suite, or, if the implementation
              is not a Web browser, an equivalent test. Every relevant test in the test suite
              should have an equivalent test created if such a user agent (UA) is to be used to
              claim interoperability. In addition if such a UA is to be used to claim interoperability,
              then there must one or more additional UAs which can also pass those equivalent
              tests in the same way for the purpose of interoperability. The equivalent tests
              must be made publicly available for the purposes of peer review.
          </dd>
          <dt>implementation</dt>
          <dd>
              a user agent which:
              <ol class="inline">
                  <li>implements the specification.</li>
                  <li>is available to the general public. The implementation may be a shipping product
                      or other publicly available version (i.e., beta version, preview release, or “nightly
                      build”). Non-shipping product releases must have implemented the feature(s) for
                      a period of at least one month in order to demonstrate stability.</li>
                  <li>is not experimental (i.e., a version specifically designed to pass the test suite
                      and is not intended for normal usage going forward).</li>
              </ol>
          </dd>
      </dl>
      <p>
          The specification will remain Candidate Recommendation for at least six months.
      </p>
      <h2 class="no-num" id="acknowledgments">Acknowledgments</h2>
      <p>
          This specification is made possible by input from Stephen Zilles, Alexandru Chiculita,
          Andrei Bucur, Mihnea Ovidenie, Peter Sorotokin, Virgil Palanciuc, Alan Stearns,
          Arno Gourdol, Eugene Veselov, Arron Eicholz, Alex Mogilevsky, Chris Jones, Marcus
          Mielke, and the CSS Working Group members.
      </p>
      <h2 class="no-num" id="references">References</h2>
      <h3 class="no-num" id="normative-references">Normative references</h3>
      <!--normative-->
      <h3 class="no-num" id="other-references">Other references</h3>
      <!--informative-->
      <h2 class="no-num" id="index">Index</h2>
      <!--index-->
      <h2 class="no-num" id="property-index">Property index</h2>
      <!-- properties -->
  </body>
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
 
