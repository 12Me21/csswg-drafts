<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html lang="en">
<!-- $Id: visudet.src,v 2.85 2003-12-01 16:11:33 bbos Exp $ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Visual formatting model details</title>
<!-- Changed by: Tantek Celik, 2003-08-27 -->
<style type="text/css">
.current,.proposed,span.delcurrent,div.delcurrent { background:#feb }
ins.proposed,span.insproposed,li.insproposed,div.insproposed { background:#bfb }
del.proposed,span.delproposed { background:#fbb }
span.insproposed,li.insproposed,div.insproposed { text-decoration:underline }
span.delproposed,span.delcurrent,div.delcurrent { text-decoration:line-through }
body>del,body>ins {display:block}
</style>
</head>
<body>
<h1>Visual formatting model details</h1>

<h2><a name="containing-block-details">Definition of "containing
block"</a></h2>

<p>The position and size of an element's box(es) are sometimes
calculated relative to a certain rectangle, called the <dfn><span
class="index-def" title="containing block">containing
block</span></dfn> of the element. The containing block of an element
is defined as follows:</p>

<ol>
<li>The containing block in which the <a href="conform.html#root">root
element</a> lives is chosen by the user agent. (It could be related to
the <a href="visuren.html#viewport">viewport</a>.) This containing
block is called the <dfn><span
class="index-def"
title="initial containing block|containing block::initial">initial
containing block</span></dfn>.
</li>
<li>For other elements, if the element's position is 'relative' or 'static',
the containing block is formed by the content edge of the nearest
<a href="visuren.html#block-level">block-level</a>, table cell or
inline-block ancestor box.
</li>
<li>If the element has 'position: fixed', the containing block is
established by the <a href="visuren.html#viewport">viewport</a>
in the case of continuous media or the <a
href="page.html#page-box">page box</a> in the case of paged media
</li>
<li>If the element has 'position: absolute', the containing block is
established by the nearest ancestor with a <span
class="propinst-position">'position'</span> of 'absolute', 'relative'
or 'fixed', in the following way:
<ol>
<li>In the case that the ancestor is <a
href="visuren.html#block-level">block-level</a>, the containing block
is formed by the <a href="box.html#padding-edge">padding edge</a> of
the ancestor.
</li>
<li>In the case that the ancestor is inline-level, the containing
block depends on the <span
class="propinst-direction">'direction'</span> property of the
ancestor:
<ol>
<li>If the <span class="propinst-direction">'direction'</span> is 'ltr', the top and left of the containing
block are the top and left content edges of the first box generated by
the ancestor, and the bottom and right are the bottom and right
content edges of the last box of the ancestor.
</li>
<li>If the <span class="propinst-direction">'direction'</span> is 'rtl', the top and right are the top and
right edges of the first box generated by the
ancestor, and the bottom and left
are the bottom and left content edges of the last box of the ancestor.
</li>
</ol>
</li>
</ol>

<p>If there is no such ancestor, the containing block is the initial
containing block.
</p>
</li>
</ol>

<p>In paged media, an absolutely positioned element is positioned
relative to its containing block ignoring any page breaks (as if the
document were continuous). The element may subsequently be broken over
several pages.
</p>
<p class="note">Note that a
block-level element that is split over several pages may have a different
width on each page and that there may be device-specific limits.
</p>

<div class="example">
<p>With no positioning, the containing blocks (C.B.) in the
following document:</p>

<pre class="html-example">
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;HTML&gt;
   &lt;HEAD&gt;
      &lt;TITLE&gt;Illustration of containing blocks&lt;/TITLE&gt;
   &lt;/HEAD&gt;
   &lt;BODY id="body"&gt;
      &lt;DIV id="div1"&gt;
      &lt;P id="p1"&gt;This is text in the first paragraph...&lt;/P&gt;
      &lt;P id="p2"&gt;This is text &lt;EM id="em1"&gt; in the 
      &lt;STRONG id="strong1"&gt;second&lt;/STRONG&gt; paragraph.&lt;/EM&gt;&lt;/P&gt;
      &lt;/DIV&gt;
   &lt;/BODY&gt;
&lt;/HTML&gt;
</pre>

<p>are established as follows:</p>

<table border="1">
<tr><th>For box generated by </th>
<td><strong>C.B. is established by</strong></td></tr>
<tr><td>html</td><td>initial C.B. (UA-dependent)</td></tr>
<tr><td>body</td><td>html</td></tr>
<tr><td>div1</td><td>body</td></tr>
<tr><td>p1</td><td>div1</td></tr>
<tr><td>p2</td><td>div1</td></tr>
<tr><td>em1</td><td>p2</td></tr>
<tr><td>strong1</td><td>p2</td></tr>
</table>

<p>If we position "div1":</p>

<pre class="example">
   #div1 { position: absolute; left: 50px; top: 50px }
</pre>

<p>its containing block is no longer "body"; it becomes
the initial containing block (since there are no
other positioned ancestor boxes).
</p>
<p>If we position "em1" as well:</p>

<pre class="example">
   #div1 { position: absolute; left: 50px; top: 50px }
   #em1  { position: absolute; left: 100px; top: 100px }
</pre>

<p>the table of containing blocks becomes:</p>

<table border="1">
<tr><th>For box generated by</th>
<td><strong>C.B. is established by</strong></td></tr>
<tr><td>html</td><td>initial C.B. (UA-dependent)</td></tr>
<tr><td>body</td><td>html</td></tr>
<tr><td>div1</td><td>initial C.B.</td></tr>
<tr><td>p1</td><td>div1</td></tr>
<tr><td>p2</td><td>div1</td></tr>
<tr><td>em1</td><td>div1</td></tr>
<tr><td>strong1</td><td>em1</td></tr>
</table>

<p>By positioning "em1", its containing block becomes
the nearest positioned ancestor box (i.e., that generated
by "div1"). 
</p>
</div>


<h2><a name="the-width-property">Content width</a>: the <span
class="propinst-width">'width'</span> property</h2>

<!-- #include src=properties/width.srb -->

<p> This property specifies the <a
href="box.html#content-width">content width</a> of boxes generated by
block-level and <a href="conform.html#replaced-element">replaced</a> elements.  
</p>
<p>This property does not apply to non-replaced <a
href="visuren.html#inline-level">inline-level</a> elements. The
content width
of a non-replaced inline element's boxes is that of the rendered
content within them (<em>before</em> any relative offset of
children). Recall that inline boxes flow into <a
href="visuren.html#line-box">line boxes</a>. The width of line boxes
is given by the their <a
href="visuren.html#containing-block">containing block</a>, but may be
shorted by the presence of <a href="visuren.html#floats">floats</a>.
</p>
<p>The width of a replaced element's box is <a
href="conform.html#intrinsic">intrinsic</a> and may be scaled by the
user agent if the value of this property is different than 'auto'.
</p>
<p>Values have the following meanings:</p>

<dl>
<dt><span class="index-inst" title="&lt;length&gt;"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></span>
</dt>
<dd>Specifies the width of the content area using a length unit.
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><span class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></span>
</dt>
<dd>Specifies a percentage width. The percentage is calculated
with respect to the width of the generated box's 
<a href="visuren.html#containing-block">containing block</a>.
If the containing block's width depends on this element's width, then the resulting layout is undefined in CSS 2.1.
<span class="note">
Note: For absolutely positioned elements whose containing block is based on a block-level element, the percentage is calculated with respect to the width of the <em>padding box</em> of that element.  This is a change from CSS1, where the percentage width was always calculated with respect to the <em>content box</em> of the parent element.
</span>
</dd>
<dt><strong>auto</strong>
</dt>
<dd>The width depends on the values of other properties. 
See the sections below.
</dd>
</dl>

<p>Negative values for <span class="propinst-width">'width'</span> are
illegal. 
</p>
<div class="example"><p>
For example, the following rule fixes the content width of paragraphs
at 100 pixels:</p>

<pre>
p { width: 100px }
</pre>
</div>

<h2><a name="Computing_widths_and_margins">Calculating widths and
margins</a></h2>

<p>The values of an element's <span
class="propinst-width">'width'</span>, <span
class="propinst-margin-left">'margin-left'</span>, <span
class="propinst-margin-right">'margin-right'</span>, <span
class="propinst-left">'left'</span> and <span
class="propinst-right">'right'</span> properties as used for layout
depend on the type of box generated and on each other. (The value used
for layout is sometimes referred to as the <dfn>used value</dfn>.) In
principle, the values used are the same as the computed values, with
'auto' replaced by some suitable value, and percentages calculated
based on the containing block, but there are exceptions. The following
situations need to be distinguished:</p>

    <ol>
      <li>inline, non-replaced elements</li>
      <li>inline, replaced elements</li>
      <li>block-level, non-replaced elements in normal flow</li>
      <li>block-level, replaced elements in normal flow</li>
      <li>floating, non-replaced elements</li>
      <li>floating, replaced elements</li>
      <li>absolutely positioned, non-replaced elements</li>
      <li>absolutely positioned, replaced elements</li>
      <li>'inline-block', non-replaced elements in normal flow</li>
      <li>'inline-block', replaced elements in normal flow</li>
    </ol>

<p>For Points 1-6 and 9-10, the values of 'left' and 'right' used for
layout are determined by the rules in <a
href="visuren.html#relative-positioning">section 9.4.3.</a>
</p>
<h3>Inline, non-replaced elements</h3>

<p>The <span class="propinst-width">'width'</span> property does not
apply. A computed value of 'auto' for <span
class="propinst-left">'left'</span>, <span
class="propinst-right">'right'</span>, <span
class="propinst-margin-left">'margin-left'</span> or <span
class="propinst-margin-right">'margin-right'</span> becomes a used
value of '0'.
</p>

<h3><a name="inline-replaced-width">Inline, replaced elements</a></h3>

<p>A computed value of 'auto' for <span
class="propinst-margin-left">'margin-left'</span> or <span
class="propinst-margin-right">'margin-right'</span> becomes a used
value of '0'. If <span class="propinst-width">'width'</span> has a
computed value of 'auto' and <span
class="propinst-height">'height'</span> also has a computed value of
'auto', the element's <a href="conform.html#intrinsic">intrinsic</a>
width is the used value of <span
class="propinst-width">'width'</span>. If <span
class="propinst-width">'width'</span> has a computed value of 'auto'
and <span class="propinst-height">'height'</span> has some other
computed value, then the used value of <span
class="propinst-width">'width'</span> is:
</p>
<pre>
 (intrinsic width) * ( (used height) / (intrinsic height) )

</pre>

<h3>Block-level, non-replaced elements in normal flow</h3>

<p>The following <a name="width-constraints">constraints</a> must hold
between the used values of the other properties:</p>
<blockquote>
<p><span class="propinst-margin-left">'margin-left'</span> + <span
class="propinst-border-left-width">'border-left-width'</span> + <span
class="propinst-padding-left">'padding-left'</span> + <span
class="propinst-width">'width'</span> + <span
class="propinst-padding-right">'padding-right'</span> + <span
class="propinst-border-right-width">'border-right-width'</span> +
<span class="propinst-margin-right">'margin-right'</span> = width of <a
href="#containing-block-details">containing block</a>
</p>
</blockquote>
<p>If
all of the above have a computed value other than 'auto', the values
are said to be "over-constrained" and one of the used values will
have to be different from its computed value. If the <span
class="propinst-direction">'direction'</span> 
property has the value 'ltr', the specified value of <span
class="propinst-margin-right">'margin-right'</span> is ignored and the
value is calculated so as to make the equality true. If the value of
<span class="propinst-direction">'direction'</span> is 'rtl', this
happens to <span class="propinst-margin-left">'margin-left'</span> instead.
</p>
<p>If there is exactly one value specified as 'auto', its used
value follows from the equality.
</p>
<p>If <span class="propinst-width">'width'</span> is set to 'auto',
any other 'auto' values become '0' and <span
class="propinst-width">'width'</span> follows from the resulting
equality.
</p>
<p>If both <span class="propinst-margin-left">'margin-left'</span> and
<span class="propinst-margin-right">'margin-right'</span> are 'auto',
their used values are equal. This horizontally centers the element
with respect to the edges of the containing block.
</p>
<h3>Block-level, replaced elements in normal flow</h3>

<p>The used value of 
<span class="propinst-width">'width'</span> is determined
as for <a href="#inline-replaced-width">inline replaced 
elements</a>.
If one of the margins is 'auto', its used value is given by the
<a href="#width-constraints">constraints</a> above. Furthermore, if
both margins are 'auto', their used values are equal.
</p>
<h3>Floating, non-replaced elements</h3>

<p>If <span
class="propinst-margin-left">'margin-left'</span>, or <span
class="propinst-margin-right">'margin-right'</span> are computed as
'auto', their used value is '0'.
</p>
<p>If <span class="propinst-width">'width'</span> is computed as
'auto', the used value is the "shrink-to-fit" width.
</p>
<p><a name="shrink-to-fit-float"></a> Calculation of the shrink-to-fit
width is similar to calculating the width of a table cell using the
automatic table layout algorithm. Roughly: calculate the preferred
width by formatting the content without breaking lines other than
where explicit line breaks occur, and also calculate the preferred
<em>minimum</em> width, e.g., by trying all possible line breaks.
CSS&nbsp;2.1 does not define the exact algorithm. Thirdly, find the
<em>available width</em>: in this case, this is the width of the
containing block minus <span
class="propinst-margin-left">'margin-left'</span> and <span
class="propinst-margin-right">'margin-right'</span>.
</p>
<p>Then the shrink-to-fit width is: min(max(preferred minimum width,
available width), preferred width).</p>

<h3>Floating, replaced elements</h3>

<p>If <span class="propinst-margin-left">'margin-left'</span> or <span
class="propinst-margin-right">'margin-right'</span> are computed as
'auto', their used value is '0'. The used value of <span
class="propinst-width">'width'</span> is determined as for <a
href="#inline-replaced-width">inline replaced elements</a>.
</p>
<h3><a name="abs-non-replaced-width">Absolutely positioned, non-replaced elements</a></h3>

<p>For the purposes of this section and the next, the term <a
name=static-position><span class=index>"static position"</span></a>
(of an element) refers, roughly,
to the position an element would have had in the normal flow. More
precisely:
</p>
<ul>
<li>The static position for 'left' is the distance from the left edge
of the containing block to the left margin edge of a hypothetical box
that would have been the first box of the element if its 'position'
property had been 'static'. The value is negative if the hypothetical
box is to the left of the containing block.
</li>
<li>The static position for 'right' is the distance from the right
edge of the containing block to the right margin edge of the same
hypothetical box as above. The value is positive if the hypothetical
box is to the left of the containing block's edge.
</li>
</ul>

<p>But rather than actually calculating the dimensions of that
hypothetical box, user agents are free to make a guess at its probable
position.
</p>
<p>For the purposes of calculating the static position, the containing
block of fixed positioned elements is the initial containing block
instead of the viewport.

<p>The constraint that determines the used values for these
elements is:</p>

  <blockquote> 
    <p>'left' + 'margin-left' + 'border-left-width' + 'padding-left' + 'width'
+ 'padding-right' + 'border-right-width' + 'margin-right' + 'right' = width
 of containing block </p>
  </blockquote>
  
<p>If all three of 'left', 'width', and 'right' are 'auto': First set
any 'auto' values for 'margin-left' and 'margin-right' to 0. Then, if
'direction' is 'ltr' set 'left' to the <a
href="#static-position">static position</a> and apply rule number
three below; otherwise, set 'right' to the <a
href="#static-position">static position</a> and apply rule number
one below.</p>

<p>If none of the three is 'auto': If both 'margin-left' and
'margin-right' are 'auto', solve the equation under the extra
constraint that the two margins get equal values. If one of
'margin-left' or 'margin-right' is 'auto', solve the equation for that
value. If the values are over-constrained, ignore the value for 'left'
(in case 'direction' is 'rtl') or 'right' (in case 'direction' is
'ltr') and solve for that value.</p>

<p>Otherwise, set 'auto' values for 'margin-left' and 'margin-right'
to 0, and pick the one of the following six rules that applies.</p>

<ol>

<li>'left' and 'width' are 'auto' and 'right' is not 'auto', then the
width is shrink-to-fit. Then solve for 'left'</li>

<li>'left' and 'right' are 'auto' and 'width' is not 'auto', then if
'direction' is 'ltr' set 'left' to the <a
href="#static-position">static position</a>, otherwise set 'right'
to the <a href="#static-position">static position</a>. Then solve
for 'left' (if 'direction is 'rtl') or 'right' (if 'direction' is
'ltr').</li>

<li>'width' and 'right' are 'auto' and 'left' is not 'auto', then the
width is shrink-to-fit . Then solve for 'right'</li>

<li>'left' is 'auto', 'width' and 'right' are not 'auto', then solve for
'left'</li>

<li>'width' is 'auto', 'left' and 'right' are not 'auto', then solve
for 'width'</li>

<li>'right' is 'auto', 'left' and 'width' are not 'auto', then solve
for 'right'</li>
</ol>
  
<p>Calculation of the shrink-to-fit width is similar to calculating
the width of a table cell using the automatic table layout algorithm.
Roughly: calculate the preferred width by formatting the content
without breaking lines other than where explicit line breaks occur,
and also calculate the preferred <em>minimum</em> width, e.g., by
trying all possible line breaks. CSS&nbsp;2.1 does not define the
exact algorithm. Thirdly, calculate the <em>available width</em>: this
is found by solving for 'width' after setting 'left' (in case 1) or
'right' (in case 3) to 0.</p>

<p>Then the shrink-to-fit width is: min(max(preferred minimum width, available
width), preferred width).</p>

<h3>Absolutely positioned, replaced elements</h3>

<p>This situation is similar to the previous one, except that the
element has an <a href="conform.html#intrinsic">intrinsic</a> width. The
sequence of substitutions is now:</p>

<ol>
<li>The used value of <span class="propinst-width">'width'</span> is
determined as for <a href="#inline-replaced-width">inline replaced
elements</a>.
</li>
<li>If <span class="propinst-left">'left'</span> 
has the value 'auto' while <span
class="propinst-direction">'direction'</span> is 'ltr', replace
'auto' with the <a href="#static-position">static position</a>.
</li>
<li>If <span class="propinst-right">'right'</span> has the
value 'auto' while
<span class="propinst-direction">'direction'</span> is 'rtl',
replace 'auto' with the <a href="#static-position">static
position</a>.
</li>
<li>If <span class="propinst-left">'left'</span> or <span
class="propinst-right">'right'</span> are 'auto', replace any 'auto'
on <span class="propinst-margin-left">'margin-left'</span> or <span
class="propinst-margin-right">'margin-right'</span> with '0'.
</li>
<li>If at this point both <span
class="propinst-margin-left">'margin-left'</span> and <span
class="propinst-margin-right">'margin-right'</span> are still 'auto',
solve the equation under the extra constraint that the two margins
must get equal values.
</li>
<li>If at this point there is only one 'auto' left, solve the equation 
for that value.
</li>
<li>If at this point the values are over-constrained, ignore the value
for either <span class="propinst-left">'left'</span> (in case <span
class="propinst-direction">'direction'</span> is 'rtl') or <span
class="propinst-right">'right'</span> (in case <span
class="propinst-direction">'direction'</span> is 'ltr') and solve for
that value.
</li>
</ol>


<h3>'Inline-block', non-replaced elements in normal flow</h3>

<p>If <span class="propinst-width">'width'</span> is 'auto', the
used value is the <a href="#shrink-to-fit-float">shrink-to-fit</a>
width as for floating elements.
</p>
<p>A computed value of 'auto' for <span
class="propinst-margin-left">'margin-left'</span> or <span
class="propinst-margin-right">'margin-right'</span> becomes a used
value of '0'.
</p>
<h3>'Inline-block', replaced elements in normal flow</h3>

<p>Exactly as <a href="#inline-replaced-width">inline replaced
elements.</a>
</p>

<h2><a name="min-max-widths">Minimum and maximum widths</a>: <span
class="propinst-min-width">'min-width'</span> and <span
class="propinst-max-width">'max-width'</span></h2>

<!-- #include src=properties/min-width.srb -->
<!-- #include src=properties/max-width.srb -->

<p>These two properties allow authors to constrain content widths to a
certain range. Values have the following meanings:</p>

<dl>
<dt><span class="index-inst" title="&lt;length&gt;"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></span>
</dt>
<dd>Specifies a fixed minimum or maximum used width.
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><span class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></span>
</dt>
<dd>Specifies a percentage for determining the used value. The
percentage is calculated with respect to the width of the generated
box's <a href="visuren.html#containing-block">containing block</a>.
</dd>
<dt><strong>none</strong>
</dt>
<dd>(Only on <span class="propinst-max-width">'max-width'</span>) No
limit on the width of the box.
</dd>
</dl>

<p>Negative values for <span
class="propinst-min-width">'min-width'</span> and <span
class="propinst-max-width">'max-width'</span> are illegal.
</p>
<p>The following algorithm describes how the two properties influence
the <a href="cascade.html#computed-value">used value</a>
of the <span class="propinst-width">'width'</span> property:</p>
<ol>

<li>The tentative used width is calculated (without <span
class="propinst-min-width">'min-width'</span> and <span
class="propinst-max-width">'max-width'</span>) following the rules
under <a href="#Computing_widths_and_margins">"Calculating widths and
margins"</a> above.
</li>
<li>If the tentative used width is greater than <span
class="propinst-max-width">'max-width'</span>, the rules <a
href="#Computing_widths_and_margins">above</a> are applied again, but
this time using the computed value of <span
class="propinst-max-width">'max-width'</span> as the computed value
for <span class="propinst-width">'width'</span>.
</li>
<li>If the resulting width is smaller than <span
class="propinst-min-width">'min-width'</span>, the rules <a
href="#Computing_widths_and_margins">above</a> are applied again, but
this time using the value of <span
class="propinst-min-width">'min-width'</span> as the computed value
for <span class="propinst-width">'width'</span>.
</li>
</ol>

<p>However, for replaced elements with both <span
class="propinst-width">'width'</span> and <span
class="propinst-height">'height'</span> specified as 'auto', the
algorithm is as follows:
</p>
<ol>
<li>Select from the following list of width-height pairs (a, b) the
first one that satisfies the two constraints min-width &#8804; a
&#8804; max(min-width, max-width) and min-height &#8804; b &#8804;
max(min-height, max-height). The resulting pair gives the used width
and height for the element. In this list, Wi and Hi stand for the
intrinsic width and height, respectively.
<ol>
<li>(Wi, Hi)</li>
<li>(max(Wi, min-width), max(Wi, min-width)*Hi/Wi)</li>
<li>(max(Hi, min-height)*Wi/Hi, max(Hi, min-height))</li>
<li>(min(Wi, max-width), min(Wi, max-width)*Hi/Wi)</li>
<li>(min(Hi, max-height)*Wi/Hi, min(Hi, max-height))</li>
<li>(max(Wi, min-width), min(Hi, max-height))</li>
<li>(min(Wi, max-width), max(Hi, min-height))</li>
<li>(max(Wi, min-width), max(Hi, min-height))</li>
<li>(min(Wi, max-width), min(Hi, max-height))</li>
</ol>
</li>
<li>Then apply the rules under <a
href="#Computing_widths_and_margins">"Calculating widths and
margins"</a> above, as if <span class="propinst-width">'width'</span>
were computed as this value.
</li>
</ol>

<h2><a name="the-height-property">Content height</a>: the <span
class="propinst-height">'height'</span> property</h2>

<!-- #include src=properties/height.srb -->

<p> This property specifies the <a
href="box.html#content-height">content height</a> of boxes generated
by block-level, inline-block and <a
href="conform.html#replaced-element">replaced</a> elements.
</p>
<p>This property does not apply to non-replaced <a
href="visuren.html#inline-level">inline-level</a> elements. See the <a
href="#inline-non-replaced">section on computing heights and margins
for non-replaced inline elements</a> for the rules used instead.
</p>
<p>Values have the following meanings:</p>

<dl>
<dt><span class="index-inst" title="&lt;length&gt;"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></span>
</dt>
<dd>Specifies the height of the content area using a length value.
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><span class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></span>
</dt>
<dd>Specifies a percentage height. The percentage is calculated with
respect to the height of the generated box's <a
href="visuren.html#containing-block">containing block</a>. If the
height of the containing block is not specified explicitly (i.e., it
depends on content height), and this element is not absolutely
positioned, the value is interpreted like 'auto'. A percentage height
on the <a href="conform.html#root">root element</a> is relative to the
<a href="visuren.html#viewport">viewport</a>.
</dd>
<dt><strong>auto</strong>
</dt>
<dd>The height depends on the values of other properties. 
See the prose below.
</dd>
</dl>

<p class="note">Note that the height of the containing block of an
absolutely positioned element is independent of the size of the
element itself, and thus a percentage height on such an element can
always be resolved. However, it may be that the height is not known
until elements that come later in the document have been processed.
</p>

<p>Negative values for <span class="propinst-height">'height'</span>
are illegal.
</p>
<div class="example"><p>
For example, the following rule sets the content height of paragraphs
to 100 pixels:</p>

<pre>
p { height: 100px }
</pre>

<p>Paragraphs of which the height of the contents exceeds 100 pixels
will <a href="visufx.html#overflow">overflow</a> according to the
<span class="propinst-overflow">'overflow'</span> property.
</p>
</div>

<h2><a name="Computing_heights_and_margins">Calculating heights and
margins</a></h2>

<p>For calculating the values of <span class="propinst-top">'top'</span>, <span class="propinst-margin-top">'margin-top'</span>, <span class="propinst-height">'height'</span>,
<span class="propinst-margin-bottom">'margin-bottom'</span>, and <span class="propinst-bottom">'bottom'</span> a distinction must be made between
various kinds of boxes:
</p>
    <ol>
      <li>inline, non-replaced elements</li>
      <li>inline, replaced elements</li>
      <li>block-level, non-replaced elements in normal flow</li>
      <li>block-level, replaced elements in normal flow</li>
      <li>floating, non-replaced elements</li>
      <li>floating, replaced elements</li>
      <li>absolutely positioned, non-replaced elements</li>
      <li>absolutely positioned, replaced elements</li>
      <li>'inline-block', non-replaced elements in normal flow</li>
      <li>'inline-block', replaced elements in normal flow</li>
    </ol>

<p>For Points 1-6 and 9-10, the used values of 'top' and
'bottom' are determined by the rules in section 9.4.3.
</p>
<h3><a name="inline-non-replaced">Inline, non-replaced elements</a></h3>

<p>The <span class="propinst-height">'height'</span> property doesn't
apply. The height of the content area should be based on the font, but
this specification does not specify how. A UA may, e.g., use the
em-box or the maximum ascender and descender of the font. (The latter
would ensure that glyphs with parts above or below the em-box still
fall within the content area, but leads to differently sized boxes for
different fonts; the formed would ensure authors can control
background styling relative to the 'line-height', but leads to glyphs
painting outside their content area.)
</p>
<p class=note>Note: level 3 of CSS will probably include a property to
select which measure of the font is used for the content height.
</p>
<p>The vertical padding, border and margin of an inline, non-replaced
box start at the top and bottom of the content area, not the <span
class="propinst-line-height">'line-height'</span>. But only the <span
class="propinst-line-height">'line-height'</span> is used to calculate
the height of the line box.
</p>
<p><a name="multi-font-inline-height"></a> If more than one font is
used (this could happen when glyphs are found in different fonts), the
height of the content area is not defined by this specification.
However, we suggest that the height is chosen such that the content
area is just high enough for either (1) the em-boxes, or (2) the
maximum ascenders and descenders, of <em>all</em> the fonts in the
element. Note that this may be larger than any of the font sizes
involved, depending on the baseline alignment of the fonts.
</p>

<h3><a name="inline-replaced-height">Inline replaced elements</a>,
block-level replaced elements in normal flow, 'inline-block' replaced
elements in normal flow and floating replaced elements</h3>

<p>If <span
class="propinst-margin-top">'margin-top'</span>, or <span
class="propinst-margin-bottom">'margin-bottom'</span> are 'auto',
their used value is 0. If <span
class="propinst-height">'height'</span> has a computed value of
'auto' and <span class="propinst-width">'width'</span> also has a
computed value of 'auto', the element's intrinsic height is the
used value of <span class="propinst-height">'height'</span>. If
<span class="propinst-height">'height'</span> has a computed value of
'auto' and <span class="propinst-width">'width'</span> has some other
computed value, then the used value of <span
class="propinst-height">'height'</span> is:
</p>
<pre>
    (intrinsic height) * ( (used width) / (intrinsic width) )
</pre>

<h3>Block-level non-replaced elements in normal
flow when 'overflow' computes to 'visible'</h3>

<p>If <span
class="propinst-margin-top">'margin-top'</span>, or <span
class="propinst-margin-bottom">'margin-bottom'</span> are 'auto',
their used value is 0. If <span
class="propinst-height">'height'</span> is 'auto', the height depends
on whether the element has any block-level children and whether it has
padding or borders:
</p>
<p>If it only has inline-level children, the height is the distance
between the top of the topmost line box and the bottom of the
bottommost line box.
</p>
If
it has block-level children, the height is the distance between the
top border-edge of the topmost block-level child box that doesn't have
<a href="box.html#collapsed-through">margins collapsed through it</a>
and the bottom border-edge of the bottommost block-level child box
that doesn't have margins collapsed through it. However, if the
element has a non-zero top padding and/or top border, then the content
starts at the top <em>margin</em> edge of the topmost child. (The
first case expresses the fact that the top and bottom margins of the
element <a href="box.html#collapsing-margins">collapse</a> with those
of the topmost and bottommost children, while in the second case the
presence of the padding/border prevents the top margins from <a
href="box.html#collapsing-margins">collapsing</a>.) Similarly, if the
element has a non-zero bottom padding and/or bottom border, then the
content ends at the bottom <em>margin</em> edge of the bottommost
child.

<p>Only children in the normal flow are taken into account (i.e.,
floating boxes and absolutely positioned boxes are ignored, and
relatively positioned boxes are considered without their offset). Note
that the child box may be an <a
href="visuren.html#anonymous-block-level">anonymous block box.</a>
</p>

<h3><a name="abs-non-replaced-height">Absolutely positioned, non-replaced elements</a></h3>

<p>For the purposes of this section and the next, the term "static
position" (of an element) refers, roughly, to the position an element
would have had in the normal flow. More precisely, the static position
for 'top' is the distance from the top edge of the containing block to
the top margin edge of a hypothetical box that would have been the
first box of the element if its 'position' property had been 'static'.
The value is negative if the hypothetical box is above the containing
block.
</p>
<p>But rather than actually calculating the dimensions of that
hypothetical box, user agents are free to make a guess at its probable
position.
</p>
<p>For the purposes of calculating the static position, the containing
block of fixed positioned elements is the initial containing block
instead of the viewport.

<p>For absolutely positioned elements, the used values of the vertical
dimensions must satisfy this constraint:</p>
 
  <blockquote>      
    <p>'top' + 'margin-top' + 'border-top-width' + 'padding-top' +      'height'
+ 'padding-bottom' + 'border-bottom-width' +      'margin-bottom' + 'bottom'
= height of containing block </p>
  </blockquote>
 
<p>If all three of 'top', 'height', and 'bottom' are auto, set 'top'
to the static position and apply rule number three below.</p>
  
<p>If none of the three are 'auto': If both 'margin-top' and
'margin-bottom' are 'auto', solve the equation under the extra
constraint that the two margins get equal values. If one of
'margin-top' or 'margin-bottom' is 'auto', solve the equation for that
value. If the values are over-constrained, ignore the value for
'bottom' and solve for that value.</p>
  
<p>Otherwise, pick the one of the following six rules that
applies.</p>

<ol>
<li>'top' and 'height' are 'auto' and 'bottom' is not 'auto', then the
height is based on the content, set 'auto' values for 'margin-top' and
'margin-bottom' to 0, and solve for 'top'</li>

<li>'top' and 'bottom' are 'auto' and 'height' is not 'auto', then
set 'top' to the static position, set 'auto' values for 'margin-top'
and 'margin-bottom' to 0, and solve for 'bottom'</li>

<li>'height' and 'bottom' are 'auto' and 'top' is not 'auto', then the
height is based on the content, set 'auto' values for 'margin-top' and
'margin-bottom' to 0, and solve for 'bottom'</li>

<li>'top' is 'auto', 'height' and 'bottom' are not 'auto', then set
'auto' values for 'margin-top' and 'margin-bottom' to 0, and solve for
'top'</li>

<li>'height' is 'auto', 'top' and 'bottom' are not 'auto', then 'auto'
values for 'margin-top' and 'margin-bottom' are set to 0 and solve for
'height'</li>

<li>'bottom' is 'auto', 'top' and 'height' are not 'auto', then set
'auto' values for 'margin-top' and 'margin-bottom' to 0 and solve for
'bottom'</li>
</ol>

<h3>Absolutely positioned, replaced elements</h3>

<p>This situation is similar to the previous one, except that the
element has an <a href="conform.html#intrinsic">intrinsic</a> height. The
sequence of substitutions is now:
</p>
<ol>

<li>The used value of <span
class="propinst-height">'height'</span> is determined as for <a
href="#inline-replaced-height">inline replaced elements</a>.
</li>
<li>If <span class="propinst-top">'top'</span> has the value 'auto',
replace it with the element's static position.
</li>
<li>If <span class="propinst-bottom">'bottom'</span> is 'auto',
replace any 'auto' on <span
class="propinst-margin-top">'margin-top'</span> or <span
class="propinst-margin-bottom">'margin-bottom'</span> with '0'.
</li>
<li>If at this point both <span
class="propinst-margin-top">'margin-top'</span> and <span
class="propinst-margin-bottom">'margin-bottom'</span> are still
'auto', solve the equation under the extra constraint that the two
margins must get equal values.
</li>
<li>If at this point there is only one 'auto' left, solve the equation 
for that value.
</li>
<li>If at this point the values are over-constrained, ignore the value
for <span class="propinst-bottom">'bottom'</span> and solve for that
value.
</li>
</ol>





<h3>Block-level, non-replaced elements in normal flow when 'overflow'
does not compute to 'visible'; 'inline-block', non-replaced elements;
and floating, non-replaced elements</h3>

<p>If <span class="propinst-margin-top">'margin-top'</span>, or <span
class="propinst-margin-bottom">'margin-bottom'</span> are 'auto',
their used value is 0. If <span
class="propinst-height">'height'</span> is 'auto', the height depends
on the element's descendants:
</p>
<p>If it only has inline-level children, the height is the distance
between the top of the topmost line box and the bottom of the
bottommost line box.
</p>
<p>If it has block-level children, the height is the distance between
the top margin-edge of the topmost block-level child box and the
bottom margin-edge of the bottommost block-level child box. (Note that
the margins of the float and its children do not collapse together.)
</p>
<p>Absolutely positioned children are ignored, and relatively
positioned boxes are considered without their offset. Note that the
child box may be an <a
href="visuren.html#anonymous-block-level">anonymous block box.</a>
</p>
<p>In addition, if the element has any floating descendants whose top
margin edge is above the top established above or whose bottom margin
edge is below the bottom, then the height is increased to include
those edges. Only floats that are children of the element itself or of
descendants in the normal flow are taken into account, i.e., floats
inside absolutely positioned descendants are not.
</p>

<h2><a name="min-max-heights">Minimum and maximum heights</a>: <span
class="propinst-min-height">'min-height'</span> and <span
class="propinst-max-height">'max-height'</span></h2>

<p>It is sometimes useful to constrain the height of elements to a
certain range. Two properties offer this functionality:
</p>

<!-- #include src=properties/min-height.srb -->
<!-- #include src=properties/max-height.srb -->

<p>These two properties allow authors to constrain box heights to a
certain range. Values have the following meanings:</p>

<dl>
<dt><span class="index-inst" title="&lt;length&gt;"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></span>
</dt>
<dd>Specifies a fixed minimum or maximum computed height.
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><span class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></span>
</dt>
<dd>Specifies a percentage for determining the used value.
The percentage is calculated with respect to the height of the
generated box's <a href="visuren.html#containing-block">containing block</a>.
If the height of the containing block is not 
specified explicitly (i.e., it depends on content height), the
percentage value is treated as '0' (for <span
class="propinst-min-height">'min-height'</span>) or 'none'
(for <span class="propinst-max-height">'max-height'</span>).
</dd>
<dt><strong>none</strong>
</dt>
<dd>(Only on <span class="propinst-max-height">'max-height'</span>) No limit on the height of the box. 
</dd>
</dl>

<p>Negative values for <span
class="propinst-min-height">'min-height'</span> and <span
class="propinst-max-height">'max-height'</span> are illegal.
</p>

<p>The following algorithm describes how the two properties influence
the <a href="cascade.html#computed-value">computed value</a>
of the <span class="propinst-height">'height'</span> property:</p>

<ol>

<li>The tentative used height is calculated (without <span
class="propinst-min-height">'min-height'</span> and <span
class="propinst-max-height">'max-height'</span>) following the rules
under <a href="#Computing_heights_and_margins">"Calculating heights and
margins"</a> above.
</li>
<li>If this tentative height is greater than <span
class="propinst-max-height">'max-height'</span>, the rules <a
href="#Computing_heights_and_margins">above</a> are applied again, but
this time using the value of <span
class="propinst-max-height">'max-height'</span> as the computed value
for <span class="propinst-height">'height'</span>.
</li>
<li>If the resulting height is smaller than <span
class="propinst-min-height">'min-height'</span>, the rules <a
href="#Computing_heights_and_margins">above</a> are applied again, but
this time using the value of <span
class="propinst-min-height">'min-height'</span> as the computed value
for <span class="propinst-height">'height'</span>.
</li>
</ol>

<p>However, for replaced elements with both <span
class="propinst-width">'width'</span> and <span
class="propinst-height">'height'</span> computed as 'auto', use the
algorithm under <a href="#min-max-widths">Minimum and maximum
widths</a> above to find the used width and height. Then apply the
rules under <a href="#Computing_heights_and_margins">"Computing
heights and margins"</a> above, using the resulting width and height as
if they were the computed values.
</p>
<h2><a name="line-height">Line height calculations</a>: the <span
class="propinst-line-height">'line-height'</span> and <span
class="propinst-vertical-align">'vertical-align'</span>
properties</h2>

<p>As described in the section on <a
href="visuren.html#inline-formatting">inline formatting contexts</a>,
user agents flow inline boxes into a vertical stack of <a
href="visuren.html#line-box">line boxes</a>. The height of a line box
is determined as follows:</p>

<ol>
<li>The height of each inline box in the line box is calculated (see
<a href="#Computing_heights_and_margins">"Calculating heights and
margins"</a> and the <span
class="propinst-line-height">'line-height'</span> property).
</li>
<li>The inline boxes are aligned vertically according
to their <span class="propinst-vertical-align">'vertical-align'</span>
property. <!-- If an element
has the values <span class="propinst-top">'top'</span> or <span class="propinst-bottom">'bottom'</span> for this property, only
the height of the generated boxes affects the line box
height calculation; the boxes cannot be aligned until the
line box has been fully constructed. -->
</li>
<li>The line box height is the distance between the uppermost
box top and the lowermost box bottom.
</li>
</ol>

<p>Empty inline elements generate empty inline boxes, but these boxes
still have margins, padding, borders and a line height, and thus
influence these calculations just like elements with content.
</p>
<h3>Leading and half-leading</h3>

<p>Since the value of <span
class="propinst-line-height">'line-height'</span> may be different
from the height of the content area there may be space above and below
rendered glyphs. The difference between the content height and the used
value of <span class="propinst-line-height">'line-height'</span> is
called the <span class="index-def"
title="leading"><em>leading</em></span>. Half the leading is called
the <span class="index-def"
title="half-leading"><em>half-leading</em></span>.
</p>
<p>User agents center glyphs vertically in an inline box, adding
half-leading on the top and bottom.  For example, if a piece of text
is '12px' high and the <span
class="propinst-line-height">'line-height'</span> value is '14px',
2pxs of extra space should be added: 1px above and 1px below the
letters. (This applies to empty boxes as well, as if the empty box
contained an infinitesimally narrow letter.)
</p>
<p>When the <span class="propinst-line-height">'line-height'</span>
value is less than the content height, the final inline box height will be
less than the font size and the rendered glyphs will "bleed" outside
the box. If such a box touches the edge of a line box, the rendered
glyphs will also "bleed" into the adjacent line box.
</p>
<p>Although margins, borders, and padding of non-replaced elements do
not enter into the line box calculation, they are still rendered
around inline boxes. This means that if the height specified by <span
class="propinst-line-height">'line-height'</span> is less than the
content height of contained boxes, backgrounds and colors of padding
and borders may "bleed" into adjacent line boxes. User agents should
render the boxes in document order. This will cause the borders on
subsequent lines to paint over the borders and text of previous lines.
</p>
<!-- #include src=properties/line-height.srb -->

<p>If the property is set on a <a
href="visuren.html#block-level">block-level</a> element whose content
is composed of <a href="visuren.html#inline-level">inline-level</a>
elements, it specifies the <em>minimal</em> height of line boxes
within the element. The minimum height consist of a minimum height above
the block's baseline and a minimum depth below it, exactly as if each
line box starts with a <a name="strut">zero-width inline box with the
block's font and line height properties (what T<sub>E</sub>X calls a
"strut").</a>
</p>
<p>If the property is set on an <a
href="visuren.html#inline-level">inline-level</a> element, it
specifies the height that is used in the calculation of the line box
height (except for inline <a
href="conform.html#replaced-element">replaced</a> elements, where the
height of the box is given by the <span
class="propinst-height">'height'</span> property).
</p>
<p>Values for this property have the following meanings:</p>

<dl>
<dt><strong>normal</strong> </dt>
<dd>Tells user agents to set the used
value to a "reasonable" value based on the font of the element. The
value has the same meaning as <span class="index-inst"
title="&lt;number&gt;"><span
class="value-inst-number">&lt;number&gt;</span></span>. We recommend a
used value for 'normal' between 1.0 to 1.2. The <a
href="cascade.html#computed-value">computed value</a> is 'normal'.
</dd>
<dt><span class="index-inst" title="&lt;length&gt;"><span
class="value-inst-length"><strong>&lt;length&gt;</strong></span></span>
</dt>
<dd>The specified length is used in the calculation of the line box
height. Negative values are illegal.
</dd>
<dt><span class="index-inst" title="&lt;number&gt;"><span
class="value-inst-number"><strong>&lt;number&gt;</strong></span></span>
</dt>
<dd>The used value of the property is this number multiplied by the
element's font size. Negative values are illegal. The <a
href="cascade.html#computed-value">computed value</a> is the same as
the specified value.
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><span
class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></span>
</dt>
<dd>The <a href="cascade.html#computed-value">computed value</a> of the
property is this percentage multiplied by the element's 
computed font size. Negative values are illegal.
</dd>
</dl>

<div class="example"><p>
The three rules in the example below have the same resultant line height:
</p>
<pre>
div { line-height: 1.2; font-size: 10pt }     /* number */
div { line-height: 1.2em; font-size: 10pt }   /* length */
div { line-height: 120%; font-size: 10pt }    /* percentage */
</pre>
</div>

<p>When an element contains text that is rendered
in more than one font, user agents may determine the <span
class="propinst-line-height">'line-height'</span> value according to
the largest font size.
</p>
<p>Generally, when there is only one value of <span
class="propinst-line-height">'line-height'</span> for all inline
boxes in a paragraph (and no tall images), the above will ensure that
baselines of successive lines are exactly <span
class="propinst-line-height">'line-height'</span> apart. This is
important when columns of text in different fonts have to be aligned,
for example in a table.
</p>
<!-- #include src=properties/vertical-align.srb -->

<p>This property affects the vertical positioning inside a line box of
the boxes generated by an inline-level element. The following values
only have meaning with respect to a parent inline-level element, or to
the <a href="#strut">strut</a> of a parent block-level element.</p>
 
<div class="note"><p>
<em><strong>Note.</strong> Values of this property have
slightly different meanings in the context of tables.
Please consult the section on <a href="tables.html#height-layout">
table height algorithms</a> for details.
</em>
</p>
</div>

<dl>
  <dt><strong>baseline</strong></dt>
  <dd>Align the baseline of the box with the baseline of
      the parent box. If the box doesn't have a baseline, align the
      bottom margin edge with the parent's baseline.</dd>
  <dt><strong>middle</strong></dt>
  <dd>Align the vertical midpoint of the box with the baseline
      of the parent box plus half the x-height of the parent.</dd>
  <dt><strong>sub</strong></dt>
  <dd>Lower the baseline of the box to the proper position for
      subscripts of the parent's box. (This value has no effect on the
      font size of the element's text.)</dd>
  <dt><strong>super</strong></dt>
  <dd>Raise the baseline of the box to the proper position for
      superscripts of the parent's box. (This value has no effect on the
      font size of the element's text.)</dd>
  <dt><strong>text-top</strong></dt>
  <dd>Align the top of the box with the top of the parent element's font.</dd>
  <!-- What is several fonts are used? (text-bottom as well) -IJ -->
  <dt><strong>text-bottom</strong></dt>
  <dd>Align the bottom of the box with the bottom of the parent 
      element's font.</dd>
  <dt><span class="index-inst" title="&lt;percentage&gt;"><span
  class="value-inst-percentage"><strong>&lt;percentage&gt;
  </strong></span></span></dt>
  <dd>Raise (positive value) or lower (negative value) the box
      by this distance (a percentage of the <span
      class="propinst-line-height">'line-height'</span> value).
      The value '0%' means the same as 'baseline'.</dd>
  <dt><span class="index-inst" title="&lt;length&gt;"><span
  class="value-inst-length"><strong>&lt;length&gt;
  </strong></span></span></dt>
  <dd>Raise (positive value) or lower (negative value) the box
      by this distance.
      The value '0cm' means the same as 'baseline'.
  </dd>
</dl>

<dl>
  <dt><strong>top</strong></dt>
  <dd>Align the top of the box with the top of the line box.</dd>
  <dt><strong>bottom</strong></dt>
  <dd>Align the bottom of the box with the bottom of the line box.</dd>
</dl>

<p>The baseline of an 'inline-table' is the baseline of the first row
of the table.
</p>
<p>A UA should use the baseline of the last line box in the normal
flow in the element as the baseline of an 'inline-block', or the
element's bottom margin edge, if there is none.
</p>
</body>
</html>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:nil
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
