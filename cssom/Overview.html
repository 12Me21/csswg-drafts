<!DOCTYPE html><html lang="en-US"><head>
  <meta charset="utf-8">
  <title>CSS Object Model (CSSOM)</title>
  <style>
   .idl { border:solid thin; background:#eee; color:#000; padding:0.5em }
   .idl :link, .idl :visited { color:inherit; background:transparent }
   dfn { font-weight:bold; font-style:normal }
   .example { margin-left:1em; padding-left:1em; border-left:double; color:#222; background:#fcfcfc }
   .example table code { color:inherit }
   td, th { padding:.1em }
   .note {  margin-left:2em; color:green; font-style:italic; font-weight:bold }
   p.note::before { content:"Note: " }
   .XXX { padding:.5em; border:solid red }
   p.XXX::before { content:"Issue: " }
   dl.switch { padding-left:2em }
   dl.switch > dt { text-indent:-1.5em }
   dl.switch > dt:before { content:'\21AA'; padding:0 0.5em 0 0; display:inline-block; width:1em; text-align:right; line-height:0.5em }
   code { color:orangered }
   code :link, code :visited { color:inherit }
   span:not(.secno) { border-bottom:solid red }
   .atrisk::before { position:absolute; left:30px; margin-top:-8px; width:25px; height:25px; padding:0 4px 8px; border:1px solid; content:'At risk'; 
   font-size:smaller; background:white; color:gray; border-radius:25px; text-align:center }
   td { vertical-align:baseline }
   td, th { border:solid }
   table { border:hidden; border-collapse:collapse }
   .propdef { font:inherit; line-height:2.3 }
  </style>
  <link href="https://www.w3.org/StyleSheets/TR/W3C-ED" rel="stylesheet">
 </head>
 <body class="draft">
 
<div class="head">
 
<!--begin-logo-->
<p><a href="http://www.w3.org/"><img alt="W3C" height="48" src="http://www.w3.org/Icons/w3c_home" width="72"></a></p>
<!--end-logo-->


 <h1>CSS Object Model (CSSOM)</h1>


 <h2 class="no-num no-toc" id="w3c-doctype">Editor's Draft 5 June 2013</h2>

 <dl>

  <dt>This Version:</dt>
  <dd class="dontpublish"><a href="http://dev.w3.org/csswg/cssom/">http://dev.w3.org/csswg/cssom/</a></dd>
  <dt class="dontpublish">Participate:</dt>
  <dd class="dontpublish"><a href="mailto:www-style@w3.org?subject=%5Bcssom%5D%20">www-style@w3.org</a>
  (<a href="http://lists.w3.org/Archives/Public/www-style/">archives</a>)</dd>
  <dd class="dontpublish"><a href="https://www.w3.org/Bugs/Public/enter_bug.cgi?product=CSS&amp;component=CSSOM">File a bug</a>
  (<a href="https://www.w3.org/Bugs/Public/buglist.cgi?component=CSSOM&amp;product=CSS&amp;resolution=---">open bugs</a>)
  <script async="" src="https://w3c-test.org/resources.whatwg.org/file-bug.js"></script></dd>
  <dd class="dontpublish"><a href="irc://irc.w3.org:6665/css">IRC: #css on W3C</a></dd>

  <dt class="dontpublish">Previous Version:</dt>
  <dd class="dontpublish"><a href="http://www.w3.org/TR/2011/WD-cssom-20110712/">http://www.w3.org/TR/2011/WD-cssom-20110712/</a></dd>
  <dd class="dontpublish"><a href="http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/">http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113/</a></dd>

  <dt>Editors:</dt>
  <dd><a>Simon Pieters</a>
  (<a href="http://www.opera.com/">Opera Software ASA</a>)
  &lt;<a href="mailto:simponp@opera.com">simonp@opera.com</a>&gt;</dd>
  <dd><a href="http://www.w3.org/wiki/User:Gadams">Glenn Adams</a>
  (<a href="http://www.cox.com/">Cox Communications, Inc.</a>)
  &lt;<a href="mailto:glenn.adams@cox.com">glenn.adams@cox.com</a>&gt;</dd>

  <dt>Previous Editor:</dt>
  <dd><a href="http://annevankesteren.nl/">Anne van Kesteren</a>
  (<a href="http://www.opera.com/">Opera Software ASA</a>)
  &lt;<a href="mailto:annevk@opera.com">annevk@opera.com</a>&gt;</dd>
 </dl>

 
<!--begin-copyright-->
<p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2013 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>), All Rights Reserved. W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p>
<!--end-copyright-->

</div>

<hr class="top">


<h2 class="no-num no-toc" id="abstract">Abstract</h2>

<p>CSSOM defines APIs (including generic parsing and serialization rules)
for Media Queries, Selectors, and of course CSS itself.</p>


<h2 class="no-num no-toc" id="sotd">Status of This Document</h2>

<p>This is a public copy of the editors' draft. It is provided for discussion only and may change at any moment.
Its publication here does not imply endorsement of its contents by W3C or by the CSS Working Group. Don't cite
this document other than as work in progress.</p>

<p class="note">Implementers should note well that this specification is an ongoing effort to sort out
what has been widely implemented and deployed from <a href="#refsDOM2STYLE">[DOM2STYLE]</a> as well as common extensions thereto, some details
of which are currently interoperable and others which are not currently interoperable. As this specification moves
forward, it is hoped that these differences will be resolved and an unambiguous and adequate consensus-based
specification will emerge.</p>

<p><em>This section describes the status of this document at the time of
its publication. Other documents may supersede this document. A list of
current W3C publications and the latest revision of this technical report
can be found in the
<a href="http://www.w3.org/TR/">W3C technical reports index at http://www.w3.org/TR/.</a></em>

<p class="dontpublish">This is the 5 June 2013 Editor's Draft of CSSOM. Please send comments to
<a href="mailto:www-style@w3.org?subject=%5Bcssom%5D%20">www-style@w3.org</a>
(<a href="http://lists.w3.org/Archives/Public/www-style/">archived</a>)
with <samp>[cssom]</samp> at the start of the subject line.

<p>This document was produced by a group operating under the
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
W3C maintains a
<a href="http://www.w3.org/2004/01/pp-impl/32061/status" rel="disclosure">public list of any patent disclosures</a>
made in connection with the deliverables of the group; that page also
includes instructions for disclosing a patent. An individual who has
actual knowledge of a patent which the individual believes contains
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a>
must disclose the information in accordance with
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>.</p>


<h2 class="no-num no-toc" id="toc">Table of Contents</h2>


<!--begin-toc-->
<ol class="toc">
 <li><a href="#introduction"><span class="secno">1 </span>Introduction</a></li>
 <li><a href="#conformance"><span class="secno">2 </span>Conformance</a></li>
 <li><a href="#terminology"><span class="secno">3 </span>Terminology</a>
  <ol class="toc">
   <li><a href="#common-serializing-idioms"><span class="secno">3.1 </span>Common Serializing Idioms</a></ol></li>
 <li><a href="#media-queries"><span class="secno">4 </span>Media Queries</a>
  <ol class="toc">
   <li><a href="#parsing-media-queries"><span class="secno">4.1 </span>Parsing Media Queries</a></li>
   <li><a href="#serializing-media-queries"><span class="secno">4.2 </span>Serializing Media Queries</a>
    <ol class="toc">
     <li><a href="#serializing-media-feature-values"><span class="secno">4.2.1 </span>Serializing Media Feature Values</a></ol></li>
   <li><a href="#comparing-media-queries"><span class="secno">4.3 </span>Comparing Media Queries</a></li>
   <li><a href="#the-medialist-interface"><span class="secno">4.4 </span>The <code title="">MediaList</code> Interface</a></ol></li>
 <li><a href="#selectors"><span class="secno">5 </span>Selectors</a>
  <ol class="toc">
   <li><a href="#parsing-selectors"><span class="secno">5.1 </span>Parsing Selectors</a></li>
   <li><a href="#serializing-selectors"><span class="secno">5.2 </span>Serializing Selectors</a></ol></li>
 <li><a href="#css"><span class="secno">6 </span>CSS</a>
  <ol class="toc">
   <li><a href="#css-style-sheets"><span class="secno">6.1 </span>CSS Style Sheets</a>
    <ol class="toc">
     <li><a href="#the-stylesheet-interface"><span class="secno">6.1.1 </span>The <code title="">StyleSheet</code> Interface</a></li>
     <li><a href="#the-cssstylesheet-interface"><span class="secno">6.1.2 </span>The <code title="">CSSStyleSheet</code> Interface</a></ol></li>
   <li><a href="#css-style-sheet-collections"><span class="secno">6.2 </span>CSS Style Sheet Collections</a>
    <ol class="toc">
     <li><a href="#the-http-default-style-header"><span class="secno">6.2.1 </span>The HTTP <code title="">Default-Style</code> Header</a></li>
     <li><a href="#the-stylesheetlist-interface"><span class="secno">6.2.2 </span>The <code title="">StyleSheetList</code> Interface</a></li>
     <li><a href="#extensions-to-the-document-interface"><span class="secno">6.2.3 </span>Extensions to the <code title="">Document</code> Interface</a></li>
     <li><a href="#interaction-with-the-user-interface"><span class="secno">6.2.4 </span>Interaction with the User Interface</a>
      <ol class="toc">
       <li><a href="#persisting-the-selected-css-style-sheet-set"><span class="secno">6.2.4.1 </span>Persisting the selected CSS style sheet set</a></ol></li>
     <li><a href="#examples"><span class="secno">6.2.5 </span>Examples</a></ol></li>
   <li><a href="#style-sheet-association"><span class="secno">6.3 </span>Style Sheet Association</a>
    <ol class="toc">
     <li><a href="#the-linkstyle-interface"><span class="secno">6.3.1 </span>The <code title="">LinkStyle</code> Interface</a></li>
     <li><a href="#requirements-on-specifications"><span class="secno">6.3.2 </span>Requirements on specifications</a></li>
     <li><a href="#requirements-on-user-agents-implementing-the-xml-stylesheet-processing-instruction"><span class="secno">6.3.3 </span>Requirements on User Agents Implementing the <code title="">xml-stylesheet</code> processing instruction</a></li>
     <li><a href="#requirements-on-user-agents-implementing-the-http-link-header"><span class="secno">6.3.4 </span>Requirements on User Agents Implementing the HTTP
<code title="">Link</code> Header</a></ol></li>
   <li><a href="#css-rules"><span class="secno">6.4 </span>CSS Rules</a>
    <ol class="toc">
     <li><a href="#the-cssrulelist-interface"><span class="secno">6.4.1 </span>The <code title="">CSSRuleList</code> Interface</a></li>
     <li><a href="#the-cssrule-interface"><span class="secno">6.4.2 </span>The <code title="">CSSRule</code> Interface</a></li>
     <li><a href="#the-cssstylerule-interface"><span class="secno">6.4.3 </span>The <code title="">CSSStyleRule</code> Interface</a></li>
     <li><a href="#the-csscharsetrule-interface"><span class="secno">6.4.4 </span>The <code title="">CSSCharsetRule</code> Interface</a></li>
     <li><a href="#the-cssimportrule-interface"><span class="secno">6.4.5 </span>The <code title="">CSSImportRule</code> Interface</a></li>
     <li><a href="#the-cssmediarule-interface"><span class="secno">6.4.6 </span>The <code title="">CSSMediaRule</code> Interface</a></li>
     <li><a href="#the-cssfontfacerule-interface"><span class="secno">6.4.7 </span>The <code title="">CSSFontFaceRule</code> Interface</a></li>
     <li><a href="#the-csspagerule-interface"><span class="secno">6.4.8 </span>The <code title="">CSSPageRule</code> Interface</a></li>
     <li><a href="#the-cssnamespacerule-interface"><span class="secno">6.4.9 </span>The <code title="">CSSNamespaceRule</code> Interface</a></ol></li>
   <li><a href="#css-declaration-blocks"><span class="secno">6.5 </span>CSS Declaration Blocks</a>
    <ol class="toc">
     <li><a href="#the-cssstyledeclaration-interface"><span class="secno">6.5.1 </span>The <code title="">CSSStyleDeclaration</code> Interface</a></ol></li>
   <li><a href="#css-values"><span class="secno">6.6 </span>CSS Values</a>
    <ol class="toc">
     <li><a href="#parsing-css-values"><span class="secno">6.6.1 </span>Parsing CSS Values</a></li>
     <li><a href="#serializing-css-values"><span class="secno">6.6.2 </span>Serializing CSS Values</a>
      <ol class="toc">
       <li><a href="#examples-0"><span class="secno">6.6.2.1 </span>Examples</a></ol></ol></ol></li>
 <li><a href="#dom-access-to-css-declaration-blocks"><span class="secno">7 </span>DOM Access to CSS Declaration Blocks</a>
  <ol class="toc">
   <li><a href="#the-elementcssinlinestyle-interface"><span class="secno">7.1 </span>The <code>ElementCSSInlineStyle</code> Interface</a></li>
   <li><a href="#extensions-to-the-window-interface"><span class="secno">7.2 </span>Extensions to the <code title="">Window</code> Interface</a></li>
   <li><a href="#the-getstyleutils-interface"><span class="secno">7.3 </span>The <code title="">GetStyleUtils</code> Interface</a></li>
   <li><a href="#extensions-to-the-element-interface"><span class="secno">7.4 </span>Extensions to the <code title="">Element</code> Interface</a></li>
   <li><a href="#the-pseudoelement-interface"><span class="secno">7.5 </span>The <code title="">PseudoElement</code> Interface</a></ol></li>
 <li><a href="#resolved-values"><span class="secno">8 </span>Resolved Values</a></li>
 <li><a href="#iana-considerations"><span class="secno">9 </span>IANA Considerations</a>
  <ol class="toc">
   <li><a href="#default-style"><span class="secno">9.1 </span><code>Default-Style</code></a></ol></li>
 <li><a class="no-num" href="#references">References</a></li>
 <li><a class="no-num" href="#change-history">Change History</a>
  <ol class="toc">
   <li><a class="no-num" href="#changes-from-dom-2-style">Changes From DOM-2 Style</a></ol></li>
 <li><a class="no-num" href="#acknowledgments">Acknowledgments</a></ol>
<!--end-toc-->


<h2 id="introduction"><span class="secno">1 </span>Introduction</h2>

<p>This document formally specifies the core features of the CSS Object Model (CSSOM). Other documents in the CSSOM family of specifications
as well as other CSS related specifications define extensions to these core features.</p>

<p>The core features of the CSSOM are oriented towards providing basic capabilities to author-defined scripts to permit access to
and manipulation of style related state information and processes.</p>

<p>The features defined below are fundamentally based on prior specifications of the W3C DOM Working Group, primarily
<a href="#refsDOM2STYLE">[DOM2STYLE]</a>. The purposes of the present document are (1) to improve on that prior work by providing
more technical specificity (so as to improve testability and interoperability), (2) to deprecate or remove certain less-widely implemented
features no longer considered to be essential in this context, and (3) to newly specify certain extensions that have been
or expected to be widely implemented.</p>

<p>A full list of the changes to API signatures can be found in <a href="#changes-from-dom2"><cite>Changes from DOM-2 Style</cite></a>.</p>


<h2 id="conformance"><span class="secno">2 </span>Conformance</h2>

<p>All diagrams, examples, and notes in this specification are
non-normative, as are all sections explicitly marked non-normative.
Everything else in this specification is normative.

<p>The key words "MUST", "MUST NOT", "REQUIRED", <!--"SHALL", "SHALL
NOT",--> "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
"OPTIONAL" in the normative parts of this document are to be
interpreted as described in RFC2119. For readability, these words do
not appear in all uppercase letters in this specification.
<a href="#refsRFC2119">[RFC2119]</a>

<p>Requirements phrased in the imperative as part of algorithms
(such as "strip any leading space characters" or "return false and
terminate these steps") are to be interpreted with the meaning of the
key word ("must", "should", "may", etc) used in introducing the
algorithm.

<p>Conformance requirements phrased as algorithms or specific steps
may be implemented in any manner, so long as the end result is
equivalent. (In particular, the algorithms defined in this
specification are intended to be easy to follow, and not intended to
be performant.)

<p id="hardwareLimitations">User agents may impose
implementation-specific limits on otherwise unconstrained inputs,
e.g. to prevent denial of service attacks, to guard against running
out of memory, or to work around platform-specific limitations.

<p>When a method or an attribute is said to call another method or attribute, the user agent must invoke its internal API for that attribute or method so that
e.g. the author can't change the behavior by overriding attributes or methods with custom properties or functions in ECMAScript.

<p>Unless otherwise stated, string comparisons are done in a
<a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> manner.


<h2 id="terminology"><span class="secno">3 </span>Terminology</h2>

<p>This specification employs certain terminology from the following documents:
<cite>DOM</cite>,
<cite>HTML</cite>,
<cite>URL</cite>,
<!--<cite>Fetch</cite>,-->
<cite>Associating Style Sheets with XML documents</cite>
and
<cite>XML</cite>.
<a href="#refsDOM">[DOM]</a>
<a href="#refsHTML">[HTML]</a>
<a href="#refsURL">[URL]</a>
<!--<span data-anolis-ref>CORS</span>-->
<a href="#refsXMLSS">[XMLSS]</a>
<a href="#refsXML">[XML]</a>

<p>When this specification talks about object
<code><var title="">A</var></code> where <code><var title="">A</var></code> is actually an interface, it generally means an object implementing interface
<code><var title="">A</var></code>.</p>

<p>The terms <dfn id="whitespace">whitespace</dfn>, <dfn id="ignored">ignored</dfn>, <dfn id="specified-value">specified value</dfn>, <dfn id="computed-value">computed value</dfn> and <dfn id="used-value">used value</dfn> are defined in CSS.
<a href="#refsCSS">[CSS]</a>

<p>The terms <dfn id="simple-selector">simple selector</dfn>, <dfn id="sequence-of-simple-selectors">sequence of simple selectors</dfn>, <dfn id="universal-selector">universal selector</dfn> and <dfn id="group-of-selectors">group of selectors</dfn> are defined in
Selectors. <a href="#refsSELECTORS">[SELECTORS]</a>

<p>The terms <dfn id="namespace-prefix">namespace prefix</dfn> and <dfn id="default-namespace">default namespace</dfn> are defined in CSS Namespaces Module. <a href="#refsCSSNAMESPACES">[CSSNAMESPACES]</a>

<p>The term <dfn id="list-of-css-page-selectors">list of CSS page selectors</dfn> refers to the comma-separated list of page selectors, as defined in CSS Paged Media Module.
<a href="#refsCSSPAGE">[CSSPAGE]</a>

<p>The terms <dfn id="set">set</dfn> and <dfn id="clear">clear</dfn> to refer to the true and
false values of binary flags or variables, respectively. These terms are also used as verbs in which case they refer to
mutating some value to make it true or false, respectively.</p>

<p>The term <dfn id="supported-styling-language">supported styling language</dfn> refers to CSS.

<p class="note">If another styling language becomes supported in user agents, this specification is expected to be updated as necessary.

<p>The terms <dfn id="x::before-pseudo-element">::before pseudo-element</dfn> and <dfn id="x::after-pseudo-element">::after pseudo-element</dfn> refer to the :before and :after pseudo-elements in CSS, except in this
specification the pseudo-elements are assumed to exist for all elements even if no box is generated for them. <a href="#refsCSS">[CSS]</a>

<h3 id="common-serializing-idioms"><span class="secno">3.1 </span>Common Serializing Idioms</h3>

<p>To <dfn id="escape-a-character">escape a character</dfn> means to create a string of
"<code title="">\</code>" (U+005C), followed by the character.</p>

<p>To <dfn id="escape-a-character-as-code-point">escape a character as code point</dfn> means to create a
string of "<code title="">\</code>" (U+005C), followed by the Unicode code point as
the smallest possible number of hexadecimal digits in the range 0-9 a-f
(U+0030 to U+0039 and U+0061 to U+0066) to represent the code point in
base 16, followed by a single SPACE (U+0020).</p>

<p>To <dfn id="serialize-an-identifier">serialize an identifier</dfn> means to create a string represented
by the concatenation of, for each character of the identifier:</p>

<ul>
 <li>If the character is NULL (U+0000), then <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 <code class="external"><a href="http://dom.spec.whatwg.org/#invalidcharactererror">InvalidCharacterError</a></code> exception and terminate these steps.</li>
 <li>If the character is in the range [\1-\1f] (U+0001 to U+001F) or
 [\7f-\9f] (U+007F to U+009F), then the character
 <a href="#escape-a-character-as-code-point" title="escape a character as code point">escaped as code point</a>.</li>
 <li>If the character is the first character and is in the range [0-9]
 (U+0030 to U+0039), then the character
 <a href="#escape-a-character-as-code-point" title="escape a character as code point">escaped as code point</a>.</li>
 <li>If the character is the second character and is in the range [0-9]
 (U+0030 to U+0039) and the first character is a "<code title="">-</code>"
 (U+002D), then the character
 <a href="#escape-a-character-as-code-point" title="escape a character as code point">escaped as code point</a>.</li>
 <li>If the character is the second character and is "<code title="">-</code>"
 (U+002D) and the first character is "<code title="">-</code>" as well, then the
 <a href="#escape-a-character" title="escape a character">escaped</a> character.</li>
 <li>If the character is not handled by one of the above rules and is
 greater than or equal to U+0080, is "<code title="">-</code>" (U+002D) or
 "<code title="">_</code>" (U+005F), or is in one of the ranges [0-9] (U+0030 to
 U+0039), [A-Z] (U+0041 to U+005A), or [a-z] (U+0061 to U+007A), then the character
 itself.</li>
 <li>Otherwise, the <a href="#escape-a-character" title="escape a character">escaped</a>
 character.</li>
</ul>

<p>To <dfn id="serialize-a-string">serialize a string</dfn> means to create a string represented
by '"' (U+0022), followed by the result of applying the rules
below to each character of the given string, followed by
'"' (U+0022):</p>

<ul>
 <li>If the character is NULL (U+0000), then <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 <code class="external"><a href="http://dom.spec.whatwg.org/#invalidcharactererror">InvalidCharacterError</a></code> exception and terminate these steps.</li>
 <li>If the character is in the range [\1-\1f] (U+0001 to U+001F) or [\7f-\9f] (U+007F to
 U+009F), the character <a href="#escape-a-character-as-code-point" title="escape a character as code point">escaped as code point</a>.</li>
 <li>If the character is '"' (U+0022) or "<code title="">\</code>"
 (U+005C), the <a href="#escape-a-character" title="escape a character">escaped</a> character.</li>
 <li>Otherwise, the character itself.</li>
</ul>

<p class="note">"<code title="">'</code>" (U+0027) is not escaped because strings
are always serialized with '"' (U+0022).</p>

<p>To <dfn id="serialize-a-url">serialize a URL</dfn> means to create a string represented by
"<code title="">url(</code>", followed by the
<a href="#serialize-a-string" title="serialize a string">string escaped</a> value of the given
string, followed by "<code title="">)</code>".</p>

<p>To <dfn id="serialize-a-comma-separated-list">serialize a comma-separated list</dfn> concatenate all items of
the list in list order while separating them by "<code title="">, </code>", i.e.,
COMMA (U+002C) followed by a single SPACE (U+0020).</p>

<p>To <dfn id="serialize-a-whitespace-separated-list">serialize a whitespace-separated list</dfn> concatenate all
items of the list in list order while separating them by "<code title=""> </code>", i.e.,
a single SPACE (U+0020).</p>

<p class="note">When serializing a list according to the above rules,
extraneous whitespace is not inserted prior to the first item or subsequent to
the last item. Unless otherwise specified, an empty list is serialized as the
empty string.</p>


<h2 id="media-queries"><span class="secno">4 </span>Media Queries</h2>

<p>Media queries are defined by the Media Queries specification. This
section defines various concepts around media queries, including their API
and serialization form.</p>

<!-- XXX ref -->


<h3 id="parsing-media-queries"><span class="secno">4.1 </span>Parsing Media Queries</h3>

<p>To
<dfn id="parse-a-media-query-list">parse a media query list</dfn> for a
given string <var title="">s</var> into a media query list is defined in
the Media Queries specification. Return the list of one or more media
queries that the algorithm defined there gives.</p> <!-- XXX ref -->

<p class="note">A media query that ends up being "ignored" will turn
into "<code title="">not all</code>".</p>

<p>To
<dfn id="parse-a-media-query">parse a media query</dfn> for a given string
<var title="">s</var> means to follow the
<a href="#parse-a-media-query-list">parse a media query list</a> steps and return null if more
than one media query is returned or a media query if a
single media query is returned.</p>

<p class="note">Again, a media query that ends up being "ignored" will
turn into "<code title="">not all</code>".</p>


<h3 id="serializing-media-queries"><span class="secno">4.2 </span>Serializing Media Queries</h3>

<p>To
<dfn id="serialize-a-media-query-list">serialize a media query list</dfn>
run these steps:</p>

<ol>
 <li><p>If the media query list is empty return the empty string and
 terminate these steps.</li>

 <li><p><a href="#serialize-a-media-query" title="serialize a media query">Serialize</a> each
 media query in the list of media queries, sort them in lexicographical
 order, and then
 <a href="#serialize-a-comma-separated-list" title="serialize a comma-separated list">serialize</a> the
 list.</li>
</ol>

<p>To
<dfn id="serialize-a-media-query">serialize a media query</dfn> let
<var title="">s</var> be the empty string, run the steps below, and
finally return <var title="">s</var>:</p>

<ol>
 <li><p>If the media query is negated append "<code title="">not</code>", followed
 by a single SPACE (U+0020), to <var title="">s</var>.</li>

 <li><p>Let <var title="">type</var> be the media type of the media query,
 <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a> and
 <a class="external" href="http://dom.spec.whatwg.org/#converted-to-ascii-lowercase">converted to ASCII lowercase</a>.</li>

 <li><p>If the media query does not contain media features append
 <var title="">type</var>, to <var title="">s</var>,
 then return <var title="">s</var> and terminate this algorithm.</li>

 <li><p>If <var title="">type</var> is not "<code title="">all</code>" or if the
 media query is negated append <var title="">type</var>, followed by a
 single SPACE (U+0020), followed by "<code title="">and</code>", followed by a single SPACE
 (U+0020), to <var title="">s</var>.</li>

 <li><p>Sort the media features in lexicographical order.</li>

 <li>
  <p>Then, for each media feature:</p>

  <ol>
   <li><p>Append a "<code title="">(</code>" (U+0028), followed by the media feature
   name, <a class="external" href="http://dom.spec.whatwg.org/#converted-to-ascii-lowercase">converted to ASCII lowercase</a>,
   to <var title="">s</var>.</li>

   <li><p>If a value is given append a "<code title="">:</code>" (U+003A), followed
   by a single SPACE (U+0020), followed by the
   <a href="#serialize-a-media-feature-value" title="serialize a media feature value">serialized media feature value</a>,
   to <var title="">s</var>.</li>

   <li><p>Append a "<code title="">)</code>" (U+0029) to
   <var title="">s</var>.</li>

   <li><p>If this is not the last media feature append a single SPACE (U+0020),
   followed by "<code title="">and</code>", followed by a single SPACE (U+0020), to
   <var title="">s</var>.</li>
  </ol>
 </li>
</ol>

<div class="example">
 <p>Here are some examples of input (first column) and output (second
 column):</p>

 <table>
  <thead>
   <tr><th>Input<th>Output
  <tbody>
   <tr>
    <td><pre>not screen and (min-WIDTH:5px) AND (max-width:40px)</pre>
    <td><pre>not screen and (max-width: 40px) and (min-width: 5px)</pre>
   <tr>
    <td><pre>all and (color) and (color)</pre>
    <td><pre>(color)</pre>
 </table>
</div>



<h4 id="serializing-media-feature-values"><span class="secno">4.2.1 </span>Serializing Media Feature Values</h4>

<p class="XXX">This should probably be done in terms of mapping it to
serializing CSS values as media features are defined in terms of CSS
values after all.</p>

<p>To <dfn id="serialize-a-media-feature-value">serialize a media feature value</dfn>
named <var title="">v</var> locate <var title="">v</var> in the first
column of the table below and use the serialization format described in
the second column:</p>

<table>
 <tr>
  <th>Media Feature
  <th>Serialization
 <tr>
  <td>'width'
  <td>...
 <tr>
  <td>'height'
  <td>...
 <tr>
  <td>'device-width'
  <td>...
 <tr>
  <td>'device-height'
  <td>...
 <tr>
  <td>'orientation'
  <td>
   <p>If the value is 'portrait': "<code title="">portrait</code>".</p>
   <p>If the value is 'landscape': "<code title="">landscape</code>".</p>
 <tr>
  <td>'aspect-ratio'
  <td>...
 <tr>
  <td>'device-aspect-ratio'
  <td>...
 <tr>
  <td>'color'
  <td>...
 <tr>
  <td>'color-index'
  <td>...
 <tr>
  <td>'monochrome'
  <td>...
 <tr>
  <td>'resolution'
  <td>...
 <tr>
  <td>'scan'
  <td>
   <p>If the value is 'progressive': "<code title="">progressive</code>".</p>
   <p>If the value is 'interlace': "<code title="">interlace</code>".</p>
 <tr>
  <td>'grid'
  <td>...
</table>

<p>Other specifications can extend this table and vendor-prefixed media
features can have custom serialization formats as well.</p>


<h3 id="comparing-media-queries"><span class="secno">4.3 </span>Comparing Media Queries</h3>

<p>To
<dfn id="compare-media-queries">compare media queries</dfn>
<var title="">m1</var> and <var title="">m2</var> means to
<a href="#serialize-a-media-query" title="serialize a media query">serialize</a> them both and
return true if they are a
<a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match and false if they
are not.</p>


<h3 id="the-medialist-interface"><span class="secno">4.4 </span>The <code title="">MediaList</code> Interface</h3>

<!--
//
// All members defined since DOM-2 Style. The only differences are:
//
//   1. addition of stringifier qualifier on mediaText
//   2. addition of getter qualifier on item
//   3. removal of raises(DOMException) from {append,delete}Medium
//
-->

<p>An object that implements the <code><a href="#medialist">MediaList</a></code> interface has an associated <dfn id="collection-of-media-queries">collection of media queries</dfn>.</p>

<pre class="idl">[<a href="#dom-medialist" title="dom-MediaList">Constructor</a>(DOMString text)]
interface <dfn id="medialist">MediaList</dfn> {
  stringifier attribute DOMString <a href="#dom-medialist-mediatext" title="dom-MediaList-mediaText">mediaText</a>;
  readonly attribute unsigned long <a href="#dom-medialist-length" title="dom-MediaList-length">length</a>;
  getter DOMString <a href="#dom-medialist-item" title="dom-MediaList-item">item</a>(unsigned long index);
  void <a href="#dom-medialist-appendmedium" title="dom-MediaList-appendMedium">appendMedium</a>(DOMString medium);
  void <a href="#dom-medialist-deletemedium" title="dom-MediaList-deleteMedium">deleteMedium</a>(DOMString medium);
};</pre>

<p>The object's <a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a> are the numbers in the range zero to one less than the number of media queries
in the <a href="#collection-of-media-queries">collection of media queries</a> represented by the collection. If there are no such media queries, then there are no
<a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a>.

<p>When the <dfn id="dom-medialist" title="dom-MediaList"><code>MediaList(<var title="">text</var>)</code></dfn> constructor is invoked, the <a href="#create-a-medialist-object">create a <code>MediaList</code>
object</a> steps must be run with the string <var title="">text</var>.</p>

<p>To <dfn id="create-a-medialist-object">create a <code>MediaList</code> object</dfn> with a string <var title="">text</var>, run the following steps:
<ol>
 <li><p>Create a new <code><a href="#medialist">MediaList</a></code> object.</li>
 <li><p>Set its <code title="dom-MediaList-mediaText"><a href="#dom-medialist-mediatext">mediaText</a></code> attribute to <var title="">text</var>.</li>
 <li><p>Return the newly created <code><a href="#medialist">MediaList</a></code> object.</li>
</ol>

<p>The <dfn id="dom-medialist-mediatext" title="dom-MediaList-mediaText"><code>mediaText</code></dfn> attribute, on getting, must return a
<a href="#serialize-a-media-query-list" title="serialize a media query list">serialization</a> of the <a href="#collection-of-media-queries">collection of media queries</a>.</p>
<p>Setting the <code title="dom-MediaList-mediaText"><a href="#dom-medialist-mediatext">mediaText</a></code> attribute must run these steps:
<ol>
 <li><p>Empty the <a href="#collection-of-media-queries">collection of media queries</a>.</li>
 <li><p>If the given value is the empty string terminate these steps.</li>
 <li><p>Append all the media queries as a result of <a href="#parse-a-media-query-list" title="parse a media query list">parsing</a> the given
 value to the <a href="#collection-of-media-queries">collection of media queries</a>.</li>
</ol>

<p>The <dfn id="dom-medialist-item" title="dom-MediaList-item"><code>item(<var title="">index</var>)</code></dfn> method must return the media query in the <a href="#collection-of-media-queries">collection of media
queries</a> given by <var title="">index</var>, or null, if <var title="">index</var> is greater than or equal to the number of media queries in the
<a href="#collection-of-media-queries">collection of media queries</a>.</p>

<p>The <dfn id="dom-medialist-length" title="dom-MediaList-length"><code>length</code></dfn> attribute must return the number of media queries in the <a href="#collection-of-media-queries">collection of media
queries</a>.</p>

<p>The <dfn id="dom-medialist-appendmedium" title="dom-MediaList-appendMedium"><code>appendMedium(<var title="">medium</var>)</code></dfn> method must run these steps:</p>
<ol>
 <li><p>Let <var title="">m</var> be the result of <a href="#parse-a-media-query" title="parse a media query">parsing</a> the given value.</li>
 <li><p>If <var title="">m</var> is null terminate these steps.</li>
 <li><p>If <a href="#compare-media-queries" title="compare media queries">comparing</a> <var title="">m</var> with any of the media queries in the
 <a href="#collection-of-media-queries">collection of media queries</a> returns true terminate these steps.</li>
 <li><p>Append <var title="">m</var> to the <a href="#collection-of-media-queries">collection of media queries</a>.</li>
</ol>

<p>The <dfn id="dom-medialist-deletemedium" title="dom-MediaList-deleteMedium"><code>deleteMedium(<var title="">medium</var>)</code></dfn> method must run these steps:</p>
<ol>
 <li><p>Let <var title="">m</var> be the result of <a href="#parse-a-media-query" title="parse a media query">parsing</a> the given value.</li>
 <li><p>If <var title="">m</var> is null terminate these steps.</li>
 <li><p>Remove any media query from the <a href="#collection-of-media-queries">collection of media queries</a> for which
 <a href="#compare-media-queries" title="compare media queries">comparing</a> the media query with <var title="">m</var> returns true.</li>
</ol>

<h2 id="selectors"><span class="secno">5 </span>Selectors</h2>

<p>Selectors are defined in the Selectors specification. This section
mainly defines how to serialize them.</p> <!-- XXX ref -->

<!-- XXX ref universal selector etc? some are in <span> some not -->


<h3 id="parsing-selectors"><span class="secno">5.1 </span>Parsing Selectors</h3>

<p>To
<dfn id="parse-a-group-of-selectors">parse a group of selectors</dfn>
means to parse the value using the <code title="">selectors_group</code>
production defined in the Selectors specification and return either a
group of selectors if parsing did not fail or null if parsing did
fail.</p> <!-- XXX ref -->


<h3 id="serializing-selectors"><span class="secno">5.2 </span>Serializing Selectors</h3>
<!-- http://dump.testsuite.org/2009/cssom/serializing-selectors.htm -->

<p>To
<dfn id="serialize-a-group-of-selectors">serialize a group of selectors</dfn>
<a href="#serialize-a-selector" title="serialize a selector">serialize</a> each selector in the
group of selectors and then
<a href="#serialize-a-comma-separated-list" title="serialize a comma-separated list">serialize</a> the
group.</p>

<p>To <dfn id="serialize-a-selector">serialize a selector</dfn> let
<var title="">s</var> be the empty string, run the steps below for each
part of the chain of the selector, and finally return
<var title="">s</var>:</p>

<ol>
 <li><p>If there is only one <a href="#simple-selector">simple selector</a> in the
 <a href="#sequence-of-simple-selectors">sequence of simple selectors</a> which is a
 <a href="#universal-selector">universal selector</a>, append the result of
 <a href="#serialize-a-simple-selector" title="serialize a simple selector">serializing</a> the
 <a href="#universal-selector">universal selector</a> to <var title="">s</var>.</li>

 <li><p>Otherwise, for each <a href="#simple-selector">simple selector</a> in the
 <a href="#sequence-of-simple-selectors">sequence of simple selectors</a> that is not a
 universal selector of which the <a href="#namespace-prefix">namespace prefix</a> maps to
 the null namespace (not in a namespace) or of which the
 <a href="#namespace-prefix">namespace prefix</a> maps to a namespace that is not the
 <a href="#default-namespace">default namespace</a>
 <a href="#serialize-a-simple-selector" title="serialize a simple selector">serialize</a> the
 <a href="#simple-selector">simple selector</a> and append the result to
 <var title="">s</var>.</li>

 <li><p>If this is not the last part of the chain of the selector append a
 single SPACE (U+0020), followed by the combinator
 "<code title="">&gt;</code>",
 "<code title="">+</code>", or
 "<code title="">~</code>"
 as appropriate, followed by another single SPACE (U+0020) if the combinator was
 not whitespace, to <var title="">s</var>.</li>

 <li><p>If this is the last part of the chain of the selector and there is
 a pseudo-element, append "<code title="">::</code>" followed by the name of the
 pseudo-class, to <var title="">s</var>.</li>
</ol>


<p>To
<dfn id="serialize-a-simple-selector">serialize a simple selector</dfn>
let <var title="">s</var> be the empty string, run the steps below, and
finally return <var title="">s</var>:</p>

<dl class="switch">
 <dt>type selector</dt>
 <dt>universal selector</dt>
 <dd>
  <ol>
   <li><p>If the <a href="#namespace-prefix">namespace prefix</a> maps to a namespace that is
   not the <a href="#default-namespace">default namespace</a> and is not the
   null namespace (not in a namespace) append the
   <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a>
   <a href="#namespace-prefix">namespace prefix</a>, followed by a "<code title="">|</code>" (U+007C)
   to <var title="">s</var>.</li>

   <li><p>If the <a href="#namespace-prefix">namespace prefix</a> maps to a namespace that is
   the null namespace (not in a namespace) append
   "<code title="">|</code>" (U+007C) to <var title="">s</var>.</li>
   <!-- This includes |* -->

   <li><p>If this is a type selector append the
   <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a> element name to
   <var title="">s</var>.</li>

   <li><p>If this is a universal selector append "<code title="">*</code>" (U+002A)
   to <var title="">s</var>.</li>
  </ol>
 </dd>

 <dt>attribute selector</dt>
 <dd>
  <ol>
   <li><p>Append "<code title="">[</code>" (U+005B) to
   <var title="">s</var>.</li>

   <li><p>If the <a href="#namespace-prefix">namespace prefix</a> maps to a namespace that is
   not the null namespace (not in a namespace) append the
   <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a>
   <a href="#namespace-prefix">namespace prefix</a>, followed by a "<code title="">|</code>" (U+007C)
   to <var title="">s</var>.</li>

   <li><p>If the <a href="#namespace-prefix">namespace prefix</a> maps to a namespace that is
   the null namespace (not in a namespace) append
   "<code title="">|</code>" (U+007C) to <var title="">s</var>.</li>
   <!-- This includes |* -->

   <li><p>Append the <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a>
   attribute name to <var title="">s</var>.</li>

   <li><p>If there is an attribute value specified, append
   "<code title="">=</code>",
   "<code title="">~=</code>",
   "<code title="">|=</code>",
   "<code title="">^=</code>",
   "<code title="">$=</code>", or
   "<code title="">*=</code>"
   as appropriate (depending on the type of attribute selector), followed
   by the <a href="#serialize-a-string" title="serialize a string">string escaped</a>
   attribute value, to <var title="">s</var>.</li>

   <li><p>Append "<code title="">]</code>" (U+005D) to
   <var title="">s</var>.</li>
  </ol>
 </dd>

 <dt>class selector</dt>
 <dd><p>Append a "<code title="">.</code>" (U+002E), followed by the
 <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a> class name to
 <var title="">s</var>.</dd>

 <dt>ID selector</dt>
 <dd><p>Append a "<code title="">#</code>" (U+0023), followed by the
 <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a> ID to
 <var title="">s</var>.</dd>

 <dt>pseudo-class</dt>
 <dd>
  <p>If the pseudo-class does not accept arguments append
  "<code title="">:</code>" (U+003A), followed by the name of the pseudo-class, to
  <var title="">s</var>.</p>

  <p>Otherwise, append "<code title="">:</code>" (U+003A), followed by the name of
  the pseudo-class, followed by "<code title="">(</code>" (U+0028), followed by the
  value of the pseudo-class argument determined as per below, followed by
  "<code title="">)</code>" (U+0029), to <var title="">s</var>.</p>

  <dl class="switch">
   <dt><code title="">:lang()</code></dt>
   <dd><p>The <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a>
   value.</dd>

   <dt><code title="">:nth-child()</code></dt>
   <dt><code title="">:nth-last-child()</code></dt>
   <dt><code title="">:nth-of-type()</code></dt>
   <dt><code title="">:nth-last-of-type()</code></dt>
   <dd>
    <ol>
     <li><p>If the value is odd let the value be
     "<code title="">2n+1</code>".</li>

     <li><p>If the value is even let the value be
     "<code title="">2n</code>".</li>

     <li><p>If <var title="">a</var> is zero let the value be
     <var title="">b</var>
     <a href="#serialize-a-css-component-value" title="serialize a CSS component value">serialized</a> as &lt;integer&gt;.</li>

     <li><p>If <var title="">a</var> is one or minus one and
     <var title="">b</var> is zero let the value be
     "<code title="">n</code>" (U+006E).</li>

     <li><p>If <var title="">a</var> is one or minus one let the value be
     "<code title="">n</code>" (U+006E), followed by
     "<code title="">+</code>" (U+002B) if <var title="">b</var> is positive,
     followed by <var title="">b</var>
     <a href="#serialize-a-css-component-value" title="serialize a CSS component value">serialized</a> as &lt;integer&gt;.</li>

     <li><p>If <var title="">b</var> is zero let the value be
     <var title="">a</var>
     <a href="#serialize-a-css-component-value" title="serialize a CSS component value">serialized</a> as &lt;integer&gt;,
     followed by "<code title="">n</code>" (U+006E).</li>

     <li><p>Otherwise let the value be
     <var title="">a</var>
     <a href="#serialize-a-css-component-value" title="serialize a CSS component value">serialized</a> as &lt;integer&gt;,
     followed by "<code title="">n</code>" (U+006E), followed by
     "<code title="">+</code>" (U+002B) if <var title="">b</var> is positive,
     followed by <var title="">b</var>
     <a href="#serialize-a-css-component-value" title="serialize a CSS component value">serialized</a> as &lt;integer&gt;.</li>
    </ol>
   </dd>

   <dt><code title="">:not()</code></dt>
   <dd><p>The result of serializing the value using the rules for
   <a href="#serialize-a-group-of-selectors" title="serialize a group of selectors">serializing a group of selectors</a>.</dd>
  </dl>
 </dd>
</dl>


<h2 id="css"><span class="secno">6 </span>CSS</h2>


<h3 id="css-style-sheets"><span class="secno">6.1 </span>CSS Style Sheets</h3>

<!-- XXX
 element inserted into the DOM, style sheet created, element removed from
 the DOM, what happens to StyleSheet?
-->

<p>A <dfn id="css-style-sheet">CSS style sheet</dfn> is an abstract concept that
represents a style sheet as defined by the CSS specification. In the CSSOM a
<a href="#css-style-sheet">CSS style sheet</a> is represented as a <code><a href="#cssstylesheet">CSSStyleSheet</a></code> object. A
<a href="#css-style-sheet">CSS style sheet</a> has a number of associated state items:</p>

<dl>
 <dt><dfn id="concept-css-style-sheet-type" title="concept-css-style-sheet-type">type</dfn></dt>
 <dd><p>The literal string "<code title="">text/css</code>".</dd>

 <dt><dfn id="concept-css-style-sheet-location" title="concept-css-style-sheet-location">location</dfn></dt>
 <dd><p>The <a class="external" href="http://url.spec.whatwg.org/#concept-url" title="concept-url">URL</a> of the
 <a href="#css-style-sheet">CSS style sheet</a> or null if the <a href="#css-style-sheet">CSS style sheet</a> was
 embedded.</dd>

 <dt><dfn id="concept-css-style-sheet-parent" title="concept-css-style-sheet-parent">parent</dfn></dt>
 <dd><p>The <a href="#css-style-sheet">CSS style sheet</a> that is the parent of the
 <a href="#css-style-sheet">CSS style sheet</a> or null if there is no associated parent.</dd>

 <dt><dfn id="concept-css-style-sheet-owner-node" title="concept-css-style-sheet-owner-node">owner node</dfn></dt>
 <dd><p>The DOM node associated with the <a href="#css-style-sheet">CSS style sheet</a> or
 null if there is no associated DOM node.</dd>

 <dt><dfn id="concept-css-style-sheet-owner-css-rule" title="concept-css-style-sheet-owner-css-rule">owner CSS rule</dfn></dt>
 <dd><p>The <a href="#css-rule">CSS rule</a> in the <a href="#concept-css-style-sheet-parent" title="concept-css-style-sheet-parent">parent</a>
 that caused the inclusion of the <a href="#css-style-sheet">CSS style sheet</a> or null if
 there is no associated rule.</dd>

 <dt><dfn id="concept-css-style-sheet-media" title="concept-css-style-sheet-media">media</dfn></dt>
 <dd>
  <p>The <code><a href="#medialist">MediaList</a></code> object associated with the
  <a href="#css-style-sheet">CSS style sheet</a>.</p>

  <p>If this property is set to a string run the
  <a href="#create-a-medialist-object">create a <code>MediaList</code> object</a> steps for that
  string and associate the returned object with the
  <a href="#css-style-sheet">CSS style sheet</a>.</p>
 </dd>

 <dt><dfn id="concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</dfn></dt>
 <dd>
  <p>The title of the <a href="#css-style-sheet">CSS style sheet</a> or null if no title
  is specified or is the empty string, in which case the title is referred to
  as an empty title.</p>

  <div class="example">
   <p>In the following, the <a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a> is non-empty
   for the first style sheet, but is empty for the second and third style sheets.</p>
   <pre>&lt;style title="papaya whip"&gt;
  body { background: #ffefd5; }
&lt;/style&gt;</pre>
     <pre>&lt;style title=""&gt;
  body { background: orange; }
&lt;/style&gt;</pre>
     <pre>&lt;style&gt;
  body { background: brown; }
&lt;/style&gt;</pre>
  </div>
 </dd>

 <dt><dfn id="concept-css-style-sheet-alternate-flag" title="concept-css-style-sheet-alternate-flag">alternate flag</dfn></dt>
 <dd>
  <p>Either set or clear. Clear by default.</p>

  <div class="example">
   <p>The following <a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a> have
   their <a href="#concept-css-style-sheet-alternate-flag" title="concept-css-style-sheet-alternate-flag">alternate flag</a> set:</p>

   <pre>&lt;?xml-stylesheet alternate="yes" title="x" href="data:text/css,…"?&gt;</pre>

   <pre>&lt;link rel="alternate stylesheet" title="x" href="data:text/css,…"&gt;</pre>
  </div>
 </dd>

 <dt><dfn id="concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</dfn></dt>
 <dd>
  <p>Either set or clear. Clear by default.</p>

  <p class="note">Even when clear it does not necessarily mean that the
  <a href="#css-style-sheet">CSS style sheet</a> is actually used for rendering.</p>
 </dd>


 <dt><dfn id="concept-css-style-sheet-css-rules" title="concept-css-style-sheet-css-rules">CSS rules</dfn></dt>
 <dd><p>The <a href="#css-rule" title="CSS rule">CSS rules</a> associated with the
 <a href="#css-style-sheet">CSS style sheet</a>.</dd>
</dl>

<p>When you are to <a href="#create-a-css-style-sheet">create a CSS style sheet</a> the above properties,
with the exception of <a href="#concept-css-style-sheet-type" title="concept-css-style-sheet-type">type</a> and
<a href="#concept-css-style-sheet-css-rules" title="concept-css-style-sheet-css-rules">CSS rules</a>, are to be set to
their proper values.</p>

<!-- same-origin restrictions -->


<h4 id="the-stylesheet-interface"><span class="secno">6.1.1 </span>The <code title="">StyleSheet</code> Interface</h4>

<!--
//
// All members defined since DOM-2 Style. Only difference
// is addition of [PutForwards=mediaText], which is presently
// not defined in CSSOM draft.
//
-->

<p>The <code><a href="#stylesheet">StyleSheet</a></code> interface represents an abstract, base style sheet.</p>

<pre class="idl">interface <dfn id="stylesheet">StyleSheet</dfn> {
  readonly attribute DOMString <a href="#dom-stylesheet-type" title="dom-StyleSheet-type">type</a>;
  readonly attribute DOMString? <a href="#dom-stylesheet-href" title="dom-StyleSheet-href">href</a>;
  readonly attribute (<a class="external" href="http://dom.spec.whatwg.org/#element">Element</a> or <a class="external" href="http://dom.spec.whatwg.org/#processinginstruction">ProcessingInstruction</a>)? <!--
  --><a href="#dom-stylesheet-ownernode" title="dom-StyleSheet-ownerNode">ownerNode</a>;
  readonly attribute <a href="#stylesheet">StyleSheet</a>? <a href="#dom-stylesheet-parentstylesheet" title="dom-StyleSheet-parentStyleSheet">parentStyleSheet</a>;
  readonly attribute DOMString? <a href="#dom-stylesheet-title" title="dom-StyleSheet-title">title</a>;
  readonly attribute <a href="#medialist">MediaList</a> <a href="#dom-stylesheet-media" title="dom-StyleSheet-media">media</a>;
  attribute boolean <a href="#dom-stylesheet-disabled" title="dom-StyleSheet-disabled">disabled</a>;
};</pre>

<p>The <dfn id="dom-stylesheet-type" title="dom-StyleSheet-type"><code>type</code></dfn> attribute must return the <a href="#concept-css-style-sheet-type" title="concept-css-style-sheet-type">type</a>.</p>

<p>The <dfn id="dom-stylesheet-href" title="dom-StyleSheet-href"><code>href</code></dfn> attribute must return the <a href="#concept-css-style-sheet-location" title="concept-css-style-sheet-location">location</a> or null if
none.</p>
<p class="XXX">What should the default value be if not known or specified upon creation? an empty string or null?</p>

<p>The <dfn id="dom-stylesheet-ownernode" title="dom-StyleSheet-ownerNode"><code>ownerNode</code></dfn> attribute must return the <a href="#concept-css-style-sheet-owner-node" title="concept-css-style-sheet-owner-node">owner
node</a> or null if there is none.</p>

<p>The <dfn id="dom-stylesheet-parentstylesheet" title="dom-StyleSheet-parentStyleSheet"><code>parentStyleSheet</code></dfn> attribute must return the
<a href="#concept-css-style-sheet-parent" title="concept-css-style-sheet-parent">parent</a> or null if there is none.</p>

<p>The <dfn id="dom-stylesheet-title" title="dom-StyleSheet-title"><code>title</code></dfn> attribute must return the <a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a> or null if
none.</p>
<p class="XXX">What should the default value be if not known or specified upon creation? an empty string or null?</p>

<p>The <dfn id="dom-stylesheet-media" title="dom-StyleSheet-media"><code>media</code></dfn> attribute must return the <a href="#concept-css-style-sheet-media" title="concept-css-style-sheet-media">media</a>.</p>
<p class="XXX">Should it be nullable?</p>
<p class="XXX">Need to define a setter that implements the semantics of setting this attribute to a string representing a MediaList.</p>

<p>The <dfn id="dom-stylesheet-disabled" title="dom-StyleSheet-disabled"><code>disabled</code></dfn> attribute, on getting, must return true if the
<a href="#concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</a>
is set, or false otherwise. On setting, the <code title="dom-StyleSheet-disabled"><a href="#dom-stylesheet-disabled">disabled</a></code> attribute must set the
<a href="#concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</a> if the new value is true, or unset the
<a href="#concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</a> otherwise.</p>


<h4 id="the-cssstylesheet-interface"><span class="secno">6.1.2 </span>The <code title="">CSSStyleSheet</code> Interface</h4>

<!--
//
// All members defined since DOM-2 Style. The only differences are:
//
//   1. removal of raises(DOMException) on {insert,delete}Rule operations.
//
-->

<p>The <code><a href="#cssstylesheet">CSSStyleSheet</a></code> interface represents a CSS <a href="#css-style-sheet">CSS style sheet</a> rule.</p>
<pre class="idl">interface <dfn id="cssstylesheet">CSSStyleSheet</dfn> : <a href="#stylesheet">StyleSheet</a> {
  readonly attribute <a href="#cssrule">CSSRule</a>? <a href="#dom-cssstylesheet-ownerrule" title="dom-CSSStyleSheet-ownerRule">ownerRule</a>;
  readonly attribute <a href="#cssrulelist">CSSRuleList</a> <a href="#dom-cssstylesheet-cssrules" title="dom-CSSStyleSheet-cssRules">cssRules</a>;
  unsigned long <a href="#dom-cssstylesheet-insertrule" title="dom-CSSStyleSheet-insertRule">insertRule</a>(DOMString rule, unsigned long index);
  void <a href="#dom-cssstylesheet-deleterule" title="dom-CSSStyleSheet-deleteRule">deleteRule</a>(unsigned long index);
};</pre>

<p>The <dfn id="dom-cssstylesheet-ownerrule" title="dom-CSSStyleSheet-ownerRule"><code>ownerRule</code></dfn> attribute must return the <a href="#concept-css-style-sheet-owner-css-rule" title="concept-css-style-sheet-owner-css-rule">owner
CSS rule</a> or null if none. If a value other than null is ever returned, than that same value must always be returned on each get access.</p>

<p>The <dfn id="dom-cssstylesheet-cssrules" title="dom-CSSStyleSheet-cssRules"><code>cssRules</code></dfn> attribute must return a read-only, live <code><a href="#cssrulelist">CSSRuleList</a></code> object representing
the <a href="#concept-css-style-sheet-css-rules" title="concept-css-style-sheet-css-rules">CSS rules</a>. The same object must be returned on each get access.</p>
<p class="note">Even though the returned <code><a href="#cssrulelist">CSSRuleList</a></code> object is read-only (from the perspective of
client-authored script), it can nevertheless change over time due to its liveness status. For example, invoking
the <code title="dom-CSSStyleSheet-insertRule"><a href="#dom-cssstylesheet-insertrule">insertRule()</a></code> or <code title="dom-CSSStyleSheet-deleteRule"><a href="#dom-cssstylesheet-deleterule">deleteRule()</a></code> methods can result in mutations
reflected in the returned object.</p>

<p>The <dfn id="dom-cssstylesheet-insertrule" title="dom-CSSStyleSheet-insertRule"><code>insertRule(<var title="">rule</var>, <var title="">index</var>)</code></dfn> method must <a href="#insert-a-css-rule">insert a CSS
rule</a> <var title="">rule</var> in the CSS rule list returned by <code title="dom-CSSStyleSheet-cssRules"><a href="#dom-cssstylesheet-cssrules">cssRules</a></code> at <var title="">index</var>, and return
<var title="">index</var>.

<p>The <dfn id="dom-cssstylesheet-deleterule" title="dom-CSSStyleSheet-deleteRule"><code>deleteRule(<var title="">index</var>)</code></dfn> method must <a href="#remove-a-css-rule">remove a CSS rule</a> in the CSS rule
list returned by <code title="dom-CSSStyleSheet-cssRules"><a href="#dom-cssstylesheet-cssrules">cssRules</a></code> at <var title="">index</var>.

<h3 id="css-style-sheet-collections"><span class="secno">6.2 </span>CSS Style Sheet Collections</h3>

<p>Below various new concepts are defined that are associated with each
<code class="external"><a href="http://dom.spec.whatwg.org/#document">Document</a></code> object.</p>

<p>Each <code class="external"><a href="http://dom.spec.whatwg.org/#document">Document</a></code> has an associated list of zero or more
<a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a>, named the
<dfn id="document-css-style-sheets">document CSS style sheets</dfn>. This is
an ordered list that contains all
<a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a> associated with the
<code class="external"><a href="http://dom.spec.whatwg.org/#document">Document</a></code>, in
<a class="external" href="http://dom.spec.whatwg.org/#concept-tree-order" title="concept-tree-order">tree order</a>, with
<a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a> created from HTTP
<code title="http-link">Link</code> headers first, if any, in header
order.</p>

<p>To <dfn id="create-a-css-style-sheet">create a CSS style sheet</dfn>, run these
steps:</p>

<ol>
 <li><p>Create a new <a href="#css-style-sheet">CSS style sheet</a> object and set its
 properties as specified.</li>

 <li><p>Then run the <a href="#add-a-css-style-sheet">add a CSS style sheet</a> steps for the newly
 created <a href="#css-style-sheet">CSS style sheet</a>.</li>
</ol>

<p>To <dfn id="add-a-css-style-sheet">add a CSS style sheet</dfn>, run these
steps:</p>

<ol>
 <li><p>Add the <a href="#css-style-sheet">CSS style sheet</a> to the list of
 <a href="#document-css-style-sheets">document CSS style sheets</a> at the appropriate location. The
 remainder of these steps deal with the
 <a href="#concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</a>.</li>

 <li><p>If the <a href="#concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</a> is set, terminate
 these steps.</li>

 <li><p>If the <a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a> is non-empty, the
 <a href="#concept-css-style-sheet-alternate-flag" title="concept-css-style-sheet-alternate-flag">alternate flag</a> is clear, and
 <a href="#preferred-css-style-sheet-set-name">preferred CSS style sheet set name</a> is the empty string
 <a href="#change-the-preferred-css-style-sheet-set-name">change the preferred CSS style sheet set name</a> to the
 <a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a>.</li>

 <li>
  <p>If any of the following is true clear the
  <a href="#concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</a> and terminate these steps:

  <ul>
   <li><p>The <a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a> is empty.</li>
   <li><p>The <a href="#last-css-style-sheet-set-name">last CSS style sheet set name</a> is null and the
   <a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a> is a
   <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match
   for the <a href="#preferred-css-style-sheet-set-name">preferred CSS style sheet set name</a>.</li>
   <li><p>The <a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a> is a
   <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match for the
   <a href="#last-css-style-sheet-set-name">last CSS style sheet set name</a>.</li>
  </ul>
 </li>

 <li><p>Set the <a href="#concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</a>.</li>
</ol>

<p>A <dfn id="persistent-css-style-sheet">persistent CSS style sheet</dfn> is a
<a href="#css-style-sheet">CSS style sheet</a> from the <a href="#document-css-style-sheets">document CSS style sheets</a>
whose <a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a> is the empty string and whose
<a href="#concept-css-style-sheet-alternate-flag" title="concept-css-style-sheet-alternate-flag">alternate flag</a> is clear.</p>

<p>A <dfn id="css-style-sheet-set">CSS style sheet set</dfn> is an ordered
collection of one or more <a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a>
from the <a href="#document-css-style-sheets">document CSS style sheets</a> which have an identical
<a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a> that is not the empty string.</p>

<p>A <dfn id="css-style-sheet-set-name">CSS style sheet set name</dfn> is the
<a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a> the <a href="#css-style-sheet-set">CSS style sheet set</a> has in
common.</p>

<p>An <dfn id="enabled-css-style-sheet-set">enabled CSS style sheet set</dfn> is a
<a href="#css-style-sheet-set">CSS style sheet set</a> of which each <a href="#css-style-sheet">CSS style sheet</a> has
its <a href="#concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</a> clear.</p>

<p>To <dfn id="enable-a-css-style-sheet-set">enable a CSS style sheet set</dfn>
with name <var title="">name</var>, run these steps:</p>

<ol>
 <li><p>If <var title="">name</var> is the empty string, set the
 <a href="#concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</a> for each <a href="#css-style-sheet">CSS style sheet</a>
 that is in a <a href="#css-style-sheet-set">CSS style sheet set</a> and terminate these steps.</li>

 <li><p>Clear the <a href="#concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</a> for each
 <a href="#css-style-sheet">CSS style sheet</a> in a <a href="#css-style-sheet-set">CSS style sheet set</a> whose
 <a href="#css-style-sheet-set-name">CSS style sheet set name</a> is a
 <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match for
 <var title="">name</var> and set it for all other
 <a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a> in a
 <a href="#css-style-sheet-set">CSS style sheet set</a>.</li>
</ol>

<p>To <dfn id="select-a-css-style-sheet-set">select a CSS style sheet set</dfn>
with name <var title="">name</var>, run these steps:</p>

<ol>
 <li><p><a href="#enable-a-css-style-sheet-set">enable a CSS style sheet set</a> with name
 <var title="">name</var>.</li>

 <li><p>Set <a href="#last-css-style-sheet-set-name">last CSS style sheet set name</a> to
 <var title="">name</var>.</li>
</ol>

<p>A <dfn id="last-css-style-sheet-set-name">last CSS style sheet set name</dfn>
is a concept to determine what <a href="#css-style-sheet-set">CSS style sheet set</a> was last
<a href="#select-a-css-style-sheet-set" title="select a CSS style sheet set">selected</a>. Initially its
value is null.</p>

<p>A
<dfn id="preferred-css-style-sheet-set-name">preferred CSS style sheet set name</dfn>
is a concept to determine which
<a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a> need to have their
<a href="#concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</a> clear. Initially its value
is the empty string.

<p>To
<dfn id="change-the-preferred-css-style-sheet-set-name">change the preferred CSS style sheet set name</dfn>
with name <var title="">name</var>, run these steps:</p>

<ol>
 <li><p>Let <var title="">current</var> be the <a href="#preferred-css-style-sheet-set-name">preferred CSS style sheet set name</a>.</li>

 <li><p>Set <a href="#preferred-css-style-sheet-set-name">preferred CSS style sheet set name</a> to
 <var title="">name</var>.</li>

 <li><p>If <var title="">name</var> is not a
 <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match for
 <var title="">current</var> and
 <a href="#last-css-style-sheet-set-name">last CSS style sheet set name</a> is null
 <a href="#enable-a-css-style-sheet-set">enable a CSS style sheet set</a> with name
 <var title="">name</var>.</li>
</ol>

<!-- XXX ought to define "applied"

thoughts:
  depends on disabled flag, alternate flag, media queries, sheesh
 -->


<h4 id="the-http-default-style-header"><span class="secno">6.2.1 </span>The HTTP <code title="">Default-Style</code> Header</h4>

<p>The HTTP <code title="http-default-style"><a href="#default-style">Default-Style</a></code> header
can be used to set the <a href="#preferred-css-style-sheet-set-name">preferred CSS style sheet set name</a>
influencing which <a href="#css-style-sheet-set">CSS style sheet set</a> is (initially) the
<a href="#enabled-css-style-sheet-set">enabled CSS style sheet set</a>.</p>

<p>For each HTTP <code title="http-default-style"><a href="#default-style">Default-Style</a></code>
header, in header order, the user agent must
<a href="#change-the-preferred-css-style-sheet-set-name">change the preferred CSS style sheet set name</a> with name being the
value of the header.</p>


<h4 id="the-stylesheetlist-interface"><span class="secno">6.2.2 </span>The <code title="">StyleSheetList</code> Interface</h4>

<p>The <code><a href="#stylesheetlist">StyleSheetList</a></code> interface represents an ordered collection of <a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a>.</p>

<pre class="idl">[ArrayClass]
interface <dfn id="stylesheetlist">StyleSheetList</dfn> {
  getter <a href="#stylesheet">StyleSheet</a>? <a href="#dom-stylesheetlist-item" title="dom-StyleSheetList-item">item</a>(unsigned long index);
  readonly attribute unsigned long <a href="#dom-stylesheetlist-length" title="dom-StyleSheetList-length">length</a>;
};</pre>

<p>The object's <a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a> are the numbers in the range zero to one less than the number of
<a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a> represented by the collection. If there are no such <a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a>,
then there are no <a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a>.

<p>The <dfn id="dom-stylesheetlist-item" title="dom-StyleSheetList-item"><code>item(<var title="">index</var>)</code></dfn> method must return the <var title="">index</var>th <a href="#css-style-sheet">CSS style
sheet</a> in the collection. If there is no <var title="">index</var>th object in the collection, then the method must return null.

<p>The <dfn id="dom-stylesheetlist-length" title="dom-StyleSheetList-length"><code>length</code></dfn> attribute must return the number of <a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a>
represented by the collection.

<h4 id="extensions-to-the-document-interface"><span class="secno">6.2.3 </span>Extensions to the <code title="">Document</code> Interface</h4>

<!--
//
// Significant changes since DOM-2 Style:
//
//   1. move styleSheets from separate interface (DocumentStyle) to Document
//   2. addition of selectedStyleSheetSet, lastStyleSheetSet, preferredStyleSheetSet, styleSheetSets, and enableStyleSheetsForSet members
//
// N.B. HTML4 Section 14.3 "External Style Sheets" introduces the concept of a "group [of] alternate style sheets ... under a single style [sheet set] name",
// but does not actually use the term "style sheet set". See http://www.w3.org/TR/html401/present/styles.html#h-14.3 for details.
//
// N.B. According to HTML4 Section 14.3, a "persistent style sheet ... must apply in addition to any alternate style sheet".
//
// N.B. HTML4 Section 14.3 distinguishes the three categories of style sheets as follows:
//
//   * persistent - @rel='stylesheet', @title is missing (or empty string?)
//   * preferred  - @rel='stylesheet', @title is present (and non-empty?)
//   * alternate  - @rel='alternate stylesheet', @title is present (and non-empty?)
//
// Also, HTML5 effectively defines:
//
//   * ignored    - @rel='alternate stylesheet', @title is missing (or is empty string?) - in this case, LinkStyle.style must evaluate to null
//
// N.B. HTML4 Section 4.3 allows author to specify the default preferred style sheet [set]... [presumably in the case that there are multiple preferred style
// sheet sets]:
//
//   * in content - <META http-equiv="Default-Style" content="compact">
//   * in http - e.g., using response header - "Default-Style: compact"
//   * if multiple of the above forms are present, then the LAST one [seen or parsed] takes precedence; HOWEVER, if two or more LINK elements specify preferred
//     style [sheet sets], the FIRST one present in the document takes precedence;
//   * preferred style sheets specified using the above (META or HTTP header equivalent) take precedence over those specified with LINK
//
// N.B. CSSOM Draft presently employs the term "Style Sheet Collection"
//
// Spec Issues:
//
//   1. need to specify which style sheets are included in styleSheets, and in which order:
//
//      * from Link HTTP header reference
//      * from <?xml-stylesheet ...?>
//      * from LINK element, @rel='stylesheet'|'alternate stylesheet'
//      * from STYLE element
//
//   2. for purpose of comparing two titled (named) style sheets, is title (name) compared on case-sensitive or case-insensitive basis
//
//   3. CSSOM 6.2 appears to imply that one can create a CSSStyleSheet (or StyleSheet) object and add it to a Document. However, that is not the case; rather
//      it is necessary to create an HTMLLinkElement or HTMLStyleElement element to indirectly create an empty StyleSheet, then this element can be added to the
//      Document.
//
-->

<pre class="idl">partial interface <a class="external" href="http://dom.spec.whatwg.org/#document">Document</a> {
  readonly attribute <a href="#stylesheetlist">StyleSheetList</a> <a href="#dom-document-stylesheets" title="dom-Document-styleSheets">styleSheets</a>;<!-- DOM-2 - defined on DocumentStyle interface -->
  attribute DOMString? <a href="#dom-document-selectedstylesheetset" title="dom-Document-selectedStyleSheetSet">selectedStyleSheetSet</a>;<!-- new -->
  readonly attribute DOMString? <a href="#dom-document-laststylesheetset" title="dom-Document-lastStyleSheetSet">lastStyleSheetSet</a>;<!-- new -->
  readonly attribute DOMString? <a href="#dom-document-preferredstylesheetset" title="dom-Document-preferredStyleSheetSet">preferredStyleSheetSet</a>;<!-- new -->
  readonly attribute DOMString[] <a href="#dom-document-stylesheetsets" title="dom-Document-styleSheetSets">styleSheetSets</a>;<!-- new -->
  void <a href="#dom-document-enablestylesheetsforset" title="dom-Document-enableStyleSheetsForSet">enableStyleSheetsForSet</a>(DOMString? name);<!-- new -->
};</pre>

<p>The <dfn id="dom-document-stylesheets" title="dom-Document-styleSheets"><code>styleSheets</code></dfn> attribute must return a <code><a href="#stylesheetlist">StyleSheetList</a></code> collection representing
the <a href="#document-css-style-sheets">document CSS style sheets</a>.</p>
<p class="note">Because of historical IDL limitations the <code title="dom-Document-styleSheets"><a href="#dom-document-stylesheets">styleSheets</a></code> attribute
used to be on a separate interface, <code>DocumentStyle</code>.</p>

<p>The <dfn id="dom-document-selectedstylesheetset" title="dom-Document-selectedStyleSheetSet"><code>selectedStyleSheetSet</code></dfn> attribute, on getting, must run these steps:</p>
<ol>
 <li><p>If there is a single <a href="#enabled-css-style-sheet-set">enabled CSS style sheet set</a> and no
 other <a href="#document-css-style-sheets">document CSS style sheets</a> with a non-empty
 <a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a> have the
 <a href="#concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</a> unset, return the
 <a href="#css-style-sheet-set-name">CSS style sheet set name</a> of the
 <a href="#enabled-css-style-sheet-set">enabled CSS style sheet set</a> and terminate these steps.</li>
 
 <li><p>Otherwise, if <a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a> from
 different <a href="#css-style-sheet-set" title="CSS style sheet set">CSS style sheet sets</a> have
 their <a href="#concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</a> unset, return
 null and terminate these steps.</li>
 
 <li>
  <p>Otherwise, return the empty string.</p>
 
  <p class="note">At this point either all
  <a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a> with a non-empty
  <a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a> have the
  <a href="#concept-css-style-sheet-disabled-flag" title="concept-css-style-sheet-disabled-flag">disabled flag</a> set, or there are no such
  <a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a>.</p>
 </li>
</ol>

<p>On setting the
<code title="dom-Document-selectedStyleSheetSet"><a href="#dom-document-selectedstylesheetset">selectedStyleSheetSet</a></code>
attribute these steps must be run:</p>

<ol>
 <li><p>If the value is null terminate this set of steps.</li>
 <li><p>Otherwise, <a href="#select-a-css-style-sheet-set">select a CSS style sheet set</a> with the name being the
 value passed.</li>
</ol>

<p>From the DOM's perspective, all views have the same
<code title="dom-Document-selectedStyleSheetSet"><a href="#dom-document-selectedstylesheetset">selectedStyleSheetSet</a></code>.
If a user agent supports multiple views with different selected
alternative style sheets, then this attribute (and the
<code><a href="#stylesheet">StyleSheet</a></code> interface's
<code title="dom-StyleSheet-disabled"><a href="#dom-stylesheet-disabled">disabled</a></code> attribute)
must return and set the value for the default
view.</p>

<p>The <dfn id="dom-document-laststylesheetset" title="dom-Document-lastStyleSheetSet"><code>lastStyleSheetSet</code></dfn> attribute must return the <a href="#last-css-style-sheet-set-name">last CSS style sheet set name</a>.</p>
<p class="note">This attribute is initially null.</p>

<p>The <dfn id="dom-document-preferredstylesheetset" title="dom-Document-preferredStyleSheetSet"><code>preferredStyleSheetSet</code></dfn> attribute must return the <a href="#preferred-css-style-sheet-set-name">preferred CSS style sheet set
name</a>.</p>
<p class="note">Unlike <code title="dom-Document-lastStyleSheetSet"><a href="#dom-document-laststylesheetset">lastStyleSheetSet</a></code>,
this attribute is initially the empty string.</p>

<p>The <dfn id="dom-document-stylesheetsets" title="dom-Document-styleSheetSets"><code>styleSheetSets</code></dfn> attribute must return a read only array of the
<a href="#css-style-sheet-set-name" title="CSS style sheet set name">CSS style sheet set names</a> of the
<a href="#css-style-sheet-set" title="CSS style sheet set">CSS style sheet sets</a>, in order of the <a href="#document-css-style-sheets">document CSS style sheets</a>.</p>

<p>The <dfn id="dom-document-enablestylesheetsforset" title="dom-Document-enableStyleSheetsForSet"><code>enableStyleSheetsForSet(<var title="">name</var>)</code></dfn> method must, when invoked, run these
steps:</p>
<ol>
 <li><p>If <var title="">name</var> is null terminate these steps.</li>
 <li><p><a href="#enable-a-css-style-sheet-set">enable a CSS style sheet set</a> with name <var title="">name</var>.</li>
</ol>
<p class="note"><a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a> with an
empty <a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a> are never affected by this method.
This method does not change the values of the
<code title="dom-Document-lastStyleSheetSet"><a href="#dom-document-laststylesheetset">lastStyleSheetSet</a></code> or
<code title="dom-Document-preferredStyleSheetSet"><a href="#dom-document-preferredstylesheetset">preferredStyleSheetSet</a></code> attributes.</p>


<h4 id="interaction-with-the-user-interface"><span class="secno">6.2.4 </span>Interaction with the User Interface</h4>

<p>The user interface of Web browsers that support style sheets
should list the style sheet titles given in the
<code title="dom-Document-styleSheetSets"><a href="#dom-document-stylesheetsets">styleSheetSets</a></code> list,
showing the
<code title="dom-Document-selectedStyleSheetSet"><a href="#dom-document-selectedstylesheetset">selectedStyleSheetSet</a></code>
as the selected style sheet set, leaving none selected if it is
null or the empty string, and selecting an extra option
"Basic Page Style" (or similar) if it is the empty string and the
<code title="dom-Document-preferredStyleSheetSet"><a href="#dom-document-preferredstylesheetset">preferredStyleSheetSet</a></code>
is the empty string as well.</p>

<p>Selecting a style sheet from this list should
use the <a href="#select-a-css-style-sheet-set">select a CSS style sheet set</a> set of steps. This
(by definition) affects the
<code title="dom-Document-lastStyleSheetSet"><a href="#dom-document-laststylesheetset">lastStyleSheetSet</a></code>
attribute.</p>

<h5 id="persisting-the-selected-css-style-sheet-set"><span class="secno">6.2.4.1 </span>Persisting the selected CSS style sheet set</h5>

<p>If a user agent persist the <a href="#select-a-css-style-sheet-set" title="select a CSS style sheet set">selected</a> <a href="#css-style-sheet-set">CSS style sheet set</a>, it should use
the value of the
<code title="dom-Document-selectedStyleSheetSet"><a href="#dom-document-selectedstylesheetset">selectedStyleSheetSet</a></code>
attribute, or if that is null, the
<code title="dom-Document-lastStyleSheetSet"><a href="#dom-document-laststylesheetset">lastStyleSheetSet</a></code>
attribute, when leaving the page (or at some other time) to determine the
set name to store. If that is null then the <a href="#css-style-sheet-set">CSS style sheet set</a> should not be
persisted.</p>

<p>When re-setting the <a href="#css-style-sheet-set">CSS style sheet set</a> to the persisted value (which can
happen at any time, typically at the first time the <a href="#css-style-sheet" title="CSS style sheet">CSS style sheets</a> are
needed for styling the document, after the <code title="">&lt;head&gt;</code> of
the document has been parsed, after any scripts that are not dependent on
computed style have executed), the <a href="#css-style-sheet-set">CSS style sheet set</a>
should be set by using the
<a href="#select-a-css-style-sheet-set">select a CSS style sheet set</a> set of steps as if the user had
selected the <a href="#css-style-sheet-set">CSS style sheet set</a> manually.</p>

<p class="note">This specification does not give any suggestions on
how user agents are to decide to persist the <a href="#css-style-sheet-set">CSS style sheet set</a> or whether or
how to persist the <a href="#select-a-css-style-sheet-set" title="select a CSS style sheet set">selected</a> <a href="#css-style-sheet-set">CSS style sheet set</a> across pages.</p>

<!-- XXX this UI section suggests we may want to introduce a few more
     idioms -->


<h4 id="examples"><span class="secno">6.2.5 </span>Examples</h4>

<div class="example">
 <p>Thus, in the following HTML snippet:</p>

 <pre>&lt;link rel="alternate stylesheet" title="foo" href="a"&gt;
&lt;link rel="alternate stylesheet" title="bar" href="b"&gt;
&lt;script&gt;
  document.selectedStyleSheetSet = 'foo';
  document.styleSheets[1].disabled = false;
&lt;/script&gt;
&lt;link rel="alternate stylesheet" title="foo" href="c"&gt;
&lt;link rel="alternate stylesheet" title="bar" href="d"&gt;</pre>

 <p>...the style sheets that end up enabled are style sheets "a", "b",
 and "c", the
 <code title="dom-Document-selectedStyleSheetSet"><a href="#dom-document-selectedstylesheetset">selectedStyleSheetSet</a></code>
 attribute would return null,
 <code title="dom-Document-lastStyleSheetSet"><a href="#dom-document-laststylesheetset">lastStyleSheetSet</a></code>
 would return "foo", and
 <code title="dom-Document-preferredStyleSheetSet"><a href="#dom-document-preferredstylesheetset">preferredStyleSheetSet</a></code>
 would return the empty string.</p>

 <p>Similarly, in the following HTML snippet:</p>

 <pre>&lt;link rel="alternate stylesheet" title="foo" href="a"&gt;
&lt;link rel="alternate stylesheet" title="bar" href="b"&gt;
&lt;script&gt;
  var before = document.preferredStyleSheetSet;
  document.styleSheets[1].disabled = false;
&lt;/script&gt;
&lt;link rel="stylesheet" title="foo" href="c"&gt;
&lt;link rel="alternate stylesheet" title="bar" href="d"&gt;
&lt;script&gt;
  var after = document.preferredStyleSheetSet;
&lt;/script&gt;</pre>

 <p>...the "before" variable will be equal to the empty string, the
 "after" variable will be equal to "foo", and style sheets "a" and "c"
 will be enabled. This is the case even though the first script block
 sets style sheet "b" to be enabled, because upon parsing the
 following <code title="">&lt;link&gt;</code> element, the
 <code title="dom-Document-preferredStyleSheetSet"><a href="#dom-document-preferredstylesheetset">preferredStyleSheetSet</a></code>
 is set and the
 <code title="dom-Document-enableStyleSheetsForSet"><a href="#dom-document-enablestylesheetsforset">enableStyleSheetsForSet()</a></code>
 method is called (since
 <code title="dom-Document-selectedStyleSheetSet"><a href="#dom-document-selectedstylesheetset">selectedStyleSheetSet</a></code>
 was never set
 explicitly, leaving
 <code title="dom-Document-lastStyleSheetSet"><a href="#dom-document-laststylesheetset">lastStyleSheetSet</a></code> at
 null throughout), which changes which style sheets are enabled and which
 are not.</p>
</div>


<h3 id="style-sheet-association"><span class="secno">6.3 </span>Style Sheet Association</h3>

<p>This section defines the interface a
<a href="#concept-css-style-sheet-owner-node" title="concept-css-style-sheet-owner-node">owner node</a> of a <a href="#css-style-sheet">CSS style sheet</a> has to
implement and defines the requirements for
<a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-xml-stylesheet" title="xml-stylesheet processing instruction">xml-stylesheet processing instructions</a>
and HTTP <code title="http-link">Link</code> headers when the link
relation type is an
<a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for
"<code title="">stylesheet</code>" since nobody else was interested in
defining this.</p>

<p class="note">The editor is in good hope that HTML and SVG will define the
appropriate processing in their respective specifications, in terms of
this specification, in due course.</p>



<h4 id="the-linkstyle-interface"><span class="secno">6.3.1 </span>The <code title="">LinkStyle</code> Interface</h4>

<p>The <dfn id="associated-css-style-sheet">associated CSS style sheet</dfn> of a node is the <a href="#css-style-sheet">CSS style sheet</a> in the list of
<a href="#document-css-style-sheets">document CSS style sheets</a> of which the <a href="#concept-css-style-sheet-owner-node" title="concept-css-style-sheet-owner-node">owner node</a> implements the <code><a href="#linkstyle">LinkStyle</a></code>
interface.</p>

<pre class="idl">[NoInterfaceObject]
interface <dfn id="linkstyle">LinkStyle</dfn> {
  readonly attribute <a href="#stylesheet">StyleSheet</a>? <a href="#dom-linkstyle-sheet" title="dom-LinkStyle-sheet">sheet</a>;
};</pre>

<p>The <dfn id="dom-linkstyle-sheet" title="dom-LinkStyle-sheet"><code>sheet</code></dfn> attribute must return the <a href="#associated-css-style-sheet">associated CSS style sheet</a> for the node or null
if there is no <a href="#associated-css-style-sheet">associated CSS style sheet</a>.</p>
  
<div class="example">
 <p>In the following fragment, the first <code title="">style</code>
 element has a <code title="dom-LinkStyle-sheet"><a href="#dom-linkstyle-sheet">sheet</a></code> attribute that returns a
 <code><a href="#stylesheet">StyleSheet</a></code> object representing the style sheet, but for
 the second <code title="">style</code> element, the <code title="dom-LinkStyle-sheet"><a href="#dom-linkstyle-sheet">sheet</a></code> attribute returns null,
 assuming the user agent supports CSS (<code title="">text/css</code>), but does
 not support the (hypothetical) ExampleSheets (<code title="">text/example-sheets</code>).</p>

 <pre>&lt;style type="text/css"&gt;
  body { background:lime }
&lt;/style&gt;</pre>
   <pre>&lt;style type="text/example-sheets"&gt;
  $(body).background := lime
&lt;/style&gt;</pre>
</div>

<p class="note">Whether or not the node refers to a style sheet is defined
by the specification that defines the semantics of said node.</p>


<h4 id="requirements-on-specifications"><span class="secno">6.3.2 </span>Requirements on specifications</h4>

<p>Specifications introducing new ways of associating style sheets through
the DOM should define which nodes implement the
<code><a href="#linkstyle">LinkStyle</a></code> interface. When doing so, they
must also define when a <a href="#css-style-sheet">CSS style sheet</a> is
<a href="#create-a-css-style-sheet" title="create a CSS style sheet">created</a>.</p>





<h4 id="requirements-on-user-agents-implementing-the-xml-stylesheet-processing-instruction"><span class="secno">6.3.3 </span>Requirements on User Agents Implementing the <code title="">xml-stylesheet</code> processing instruction</h4>

<!-- XXX load/error events, reparse -->

<pre class="idl"><a class="external" href="http://dom.spec.whatwg.org/#processinginstruction">ProcessingInstruction</a> implements <a href="#linkstyle">LinkStyle</a>;</pre>

<p>For each
<a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-xml-stylesheet"><code>xml-stylesheet</code> processing instruction</a>
that is not part of the
<a class="external" href="http://www.w3.org/TR/xml/#dt-doctype">document type declaration</a> and has an
<code title="">href</code>
<a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a> these steps must
(unless otherwise stated) be run:</p>

<ol>
 <li><p>Let <var title="">title</var> be the value of the
 <code title="">title</code> <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a> or the empty string if the
 <code title="">title</code> <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a> is not specified.</li>

 <li><p>If there is an <code title="">alternate</code> <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a>
 whose value is a <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match
 for "<code title="">yes</code>" and <var title="">title</var> is the
 empty string terminate these steps.</li>

 <li><p>If there is a <code title="">type</code> <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a> whose
 value is not a <a href="#supported-styling-language">supported styling language</a> the user agent
 may terminate these steps.</li>

 <li><p><a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/urls.html#resolve-a-url" title="Resolve a URL">Resolve</a>
 the <a class="external" href="http://url.spec.whatwg.org/#concept-url" title="concept-url">URL</a> specified by the
 <code title="">href</code> <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a> and then
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/fetching-resources.html#fetch">fetch</a> it.</li>

 <li>
  <p>When the resource is available, the document is in
  <a class="external" href="http://dom.spec.whatwg.org/#concept-document-quirks" title="concept-document-quirks">quirks mode</a>
  and the
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/fetching-resources.html#content-type">Content-Type metadata</a> of
  the resource is not a <a href="#supported-styling-language">supported styling language</a> change the
  <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/fetching-resources.html#content-type">Content-Type metadata</a> of the resource
  to <code title="">text/css</code>.</p>
 </li>

 <li><p>If the resource is not in a
 <a href="#supported-styling-language">supported styling language</a> terminate these steps.</li>

 <li>
  <p><a href="#create-a-css-style-sheet">Create a CSS style sheet</a> with the following properties:</p>

  <dl>
   <dt><a href="#concept-css-style-sheet-location" title="concept-css-style-sheet-location">location</a></dt>
   <dd><p>The <a class="external" href="http://url.spec.whatwg.org/#concept-absolute-url" title="concept-absolute-url">absolute URL</a> of the
   resource.</dd>

   <dt><a href="#concept-css-style-sheet-parent" title="concept-css-style-sheet-parent">parent</a></dt>
   <dd><p>null</dd>

   <dt><a href="#concept-css-style-sheet-owner-node" title="concept-css-style-sheet-owner-node">owner node</a></dt>
   <dd><p>The node.</dd>

   <dt><a href="#concept-css-style-sheet-owner-css-rule" title="concept-css-style-sheet-owner-css-rule">owner CSS rule</a></dt>
   <dd><p>null</dd>

   <dt><a href="#concept-css-style-sheet-media" title="concept-css-style-sheet-media">media</a></dt>
   <dd><p>The value of the <code title="">media</code> <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a>
   if any, or the empty string otherwise.</dd>

   <dt><a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a></dt>
   <dd><p><var title="">title</var></dd>

   <dt><a href="#concept-css-style-sheet-alternate-flag" title="concept-css-style-sheet-alternate-flag">alternate flag</a></dt>
   <dd><p>Set if the <code title="">alternate</code> <a class="external" href="http://www.w3.org/TR/xml-stylesheet/#dt-pseudo-attribute">pseudo-attribute</a>
   value is a <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match for
   "<code title="">yes</code>", or clear otherwise.
  </dl>
 </li>
</ol>




<h4 id="requirements-on-user-agents-implementing-the-http-link-header"><span class="secno">6.3.4 </span>Requirements on User Agents Implementing the HTTP
<code title="">Link</code> Header</h4>

<!-- XXX ref, one day -->

<!-- XXX deal with media param -->

<p>For each HTTP <code title="http-link">Link</code> header of which one
of the link relation types is an
<a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match
for "<code title="">stylesheet</code>" these steps
must be run:</p>

<ol>
 <li><p>Let <var title="">title</var> be the value of the first of all the
 <code title="">title</code> and <code title="">title*</code> parameters.
 If there are no such parameters it is the empty string.</li>

 <li><p>If one of the (other) link relation types is an
 <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for
 "<code title="">alternate</code>" and <var title="">title</var> is the
 empty string terminate these steps.</li>

 <li><p><a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/urls.html#resolve-a-url" title="Resolve a URL">Resolve</a>
 the specified <a class="external" href="http://url.spec.whatwg.org/#concept-url" title="concept-url">URL</a> and
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/fetching-resources.html#fetch">fetch</a> it.</li>

 <li><p>When the resource is available, the document is in
 <a class="external" href="http://dom.spec.whatwg.org/#concept-document-quirks" title="concept-document-quirks">quirks mode</a>
 and the <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/fetching-resources.html#content-type">Content-Type metadata</a> of
 the resource is not a <a href="#supported-styling-language">supported styling language</a> change the
 <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/fetching-resources.html#content-type">Content-Type metadata</a> of the resource
 to <code title="">text/css</code>.</li>

 <li><p>If the resource is not in a
 <a href="#supported-styling-language">supported styling language</a> terminate these steps.</li>

 <li>
  <p><a href="#create-a-css-style-sheet">Create a CSS style sheet</a> with the following properties:</p>

  <dl>
   <dt><a href="#concept-css-style-sheet-location" title="concept-css-style-sheet-location">location</a></dt>
   <dd><p>The <a class="external" href="http://url.spec.whatwg.org/#concept-absolute-url" title="concept-absolute-url">absolute URL</a> of the
   resource.</dd>

   <dt><a href="#concept-css-style-sheet-owner-node" title="concept-css-style-sheet-owner-node">owner node</a></dt>
   <dd><p>null</dd>

   <dt><a href="#concept-css-style-sheet-parent" title="concept-css-style-sheet-parent">parent</a></dt>
   <dd><p>null</dd>

   <dt><a href="#concept-css-style-sheet-owner-css-rule" title="concept-css-style-sheet-owner-css-rule">owner CSS rule</a></dt>
   <dd><p>null</dd>

   <dt><a href="#concept-css-style-sheet-media" title="concept-css-style-sheet-media">media</a></dt>
   <dd><p>The value of the first <code title="">media</code> parameter.</dd>
   <!-- XXX register media parameter? bah -->

   <dt><a href="#concept-css-style-sheet-title" title="concept-css-style-sheet-title">title</a></dt>
   <dd><p><var title="">title</var></dd>

   <dt><a href="#concept-css-style-sheet-alternate-flag" title="concept-css-style-sheet-alternate-flag">alternate flag</a></dt>
   <dd><p>Set if one of the specified link relation type for this HTTP
   <code title="http-link">Link</code> header is an
   <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for
   "<code title="">alternate</code>", or false otherwise.
  </dl>
 </li>
</ol>


<h3 id="css-rules"><span class="secno">6.4 </span>CSS Rules</h3>

<p>A <dfn id="css-rule">CSS rule</dfn> is an abstract concept that
denotes a rule as defined by the CSS specification. A
<a href="#css-rule">CSS rule</a> is represented as an object that implements a subclass of
the <code><a href="#cssrule">CSSRule</a></code> interface, and which has the following
associated state items:</p>

<dl>
<dt><dfn id="concept-css-rule-type" title="concept-css-rule-type">type</dfn></dt>
<dd><p>A non-negative integer associated with a particular type of rule.
This item is initialized when a rule is created and must never change.</dd>

<dt><dfn id="concept-css-rule-text" title="concept-css-rule-text">text</dfn></dt>
<dd><p>A text representation of the rule suitable for direct use in a style sheet.
This item is initialized when a rule is created, and may change over the lifetime of the rule.</dd>

<dt><dfn id="concept-css-rule-parent-css-rule" title="concept-css-rule-parent-css-rule">parent CSS rule</dfn></dt>
<dd><p>An optional reference to another, enclosing <a href="#css-rule">CSS rule</a>.
If the rule has an enclosing rule when it is created, then this item is initialized to the enclosing rule; otherwise it is null.
Subsequent to initialization, this item is reset to null if the rule becomes non-enclosed. Once reset to null, it must never change.</dd>

<dt><dfn id="concept-css-rule-parent-css-style-sheet" title="concept-css-rule-parent-css-style-sheet">parent CSS style sheet</dfn></dt>
<dd><p>An optional reference to an associated <a href="#css-style-sheet">CSS style sheet</a>.
This item is initialized to reference an associated style sheet when the rule is created. Subsequent to initialization, this item
is reset to null if the rule becomes disassociated from its initial style sheet. Once reset to null, it must never change.</dd>
</dl>

<p>In addition to the above state, each <a href="#css-rule">CSS rule</a> may be associated
with other state in accordance with its <a href="#concept-css-rule-type" title="concept-css-rule-type">type</a>.</p>

<p>To <dfn id="parse-a-css-rule">parse a CSS rule</dfn> ...</p>

<p class="XXX">Should a rule be instantiated in OM if there is a parse error? To
what extent should original (but non-valid) CSS text be captured in cssText?</p>

<p>To <dfn id="serialize-a-css-rule">serialize a CSS rule</dfn>, perform one of the following in accordance with the <a href="#css-rule">CSS rule</a>'s <a href="#concept-css-rule-type" title="concept-css-rule-type">type</a>:</p>

<dl class="switch">
 <dt><code><a href="#cssstylerule">CSSStyleRule</a></code></dt>
 <dd>
  <p>The result of concatenating the following:</p>
  <ol>
   <li>The result of performing <a href="#serialize-a-group-of-selectors">serialize a group of selectors</a> on the rule's associated selectors.</li>
   <li>The string "<code title=""> { </code>", i.e., a single SPACE (U+0020), followed by LEFT CURLY BRACKET (U+007B),
   followed by a single SPACE (U+0020).</li>
   <li>The result of performing <a href="#serialize-a-css-declaration-block">serialize a CSS declaration block</a> on the rule's associated declarations.</li>
   <li>If the rule is associated with one or more declarations, the string "<code title=""> </code>", i.e., a single SPACE (U+0020).</li>
   <li>The string "<code title="">}</code>", RIGHT CURLY BRACKET (U+007D).
  </ol>
 </dd>

 <dt><code><a href="#csscharsetrule">CSSCharsetRule</a></code></dt>
 <dd>
  <p>The result of concatenating the following:</p>
  <ol>
   <li>The string "<code title="">@charset</code>" followed by a single SPACE (U+0020).</li>
   <li>The result of performing <a href="#serialize-a-string">serialize a string</a> on the rule's character encoding.</li>
   <li>The string "<code title="">;</code>", i.e., SEMICOLON (U+003B).
  </ol>
  <div class="example">
  <pre>@charset "UTF-8";</pre>
  </div>
 </dd>

 <dt><code><a href="#cssimportrule">CSSImportRule</a></code></dt>
 <dd>
  <p>The result of concatenating the following:</p>
  <ol>
   <li>The string "<code title="">@import</code>" followed by a single SPACE (U+0020).</li>
   <li>The result of performing <a href="#serialize-a-url">serialize a URL</a> on the rule's location.</li>
   <li>If the rule's associated media list is not empty, a single SPACE (U+0020) followed by the
   result of performing <a href="#serialize-a-media-query-list">serialize a media query list</a> on the media list.
   <li>The string "<code title="">;</code>", i.e., SEMICOLON (U+003B).
  </ol>
  <div class="example">
  <pre>@import url("import.css");</pre>
  <pre>@import url("print.css") print;</pre>
  </div>
 </dd>

 <dt><code><a href="#cssmediarule">CSSMediaRule</a></code></dt>
 <dd><p class="XXX">...</dd>

 <dt><code><a href="#cssfontfacerule">CSSFontFaceRule</a></code></dt>
 <dd><p class="XXX">...</dd>

 <dt><code><a href="#csspagerule">CSSPageRule</a></code></dt>
 <dd><p class="XXX">...</dd>

 <dt><code><a href="#cssnamespacerule">CSSNamespaceRule</a></code></dt>
 <dd><p>The literal string "<code title="">@namespace</code>", followed by a single SPACE
 (U+0020), followed by the
 <a href="#serialize-an-identifier" title="serialize an identifier">identifier escaped</a> value of the
 <code title="dom-CSSNamespaceRule-prefix"><a href="#dom-cssnamespacerule-prefix">prefix</a></code> attribute (if
 any), followed by a single SPACE (U+0020) if there is a prefix, followed by the
 <a href="#serialize-a-url" title="serialize a URL">URL escaped</a> value of the
 <code title="dom-CSSNamespaceRule-namespaceURI"><a href="#dom-cssnamespacerule-namespaceuri">namespaceURI</a></code>
 attribute, followed the character "<code title="">;</code>" (U+003B).</dd>
</dl>

<p>To <dfn id="insert-a-css-rule">insert a CSS rule</dfn> <var title="">rule</var> in a CSS rule list <var title="">list</var> at index <var title="">index</var>, follow these steps:</p>
<ol>
 <li><p>Set <var title="">new rule</var> to the results of performing <a href="#parse-a-css-rule">parse a CSS rule</a>
 on argument <var title="">rule</var>, <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throwing</a>
 a <code class="external"><a href="http://dom.spec.whatwg.org/#syntaxerror">SyntaxError</a></code> exception if a parse error occurs.</li>
 <li><p>If <var title="">new rule</var> is an <code title="">@charset</code> at-rule, <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> a
 <code class="external"><a href="http://dom.spec.whatwg.org/#syntaxerror">SyntaxError</a></code> exception.
 <li><p>Set <var title="">length</var> to the number of items in <var title="">list</var>.</li>
 <li><p>If <var title="">index</var> is greater than <var title="">length</var>, then <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a>
 an <code class="external"><a href="http://dom.spec.whatwg.org/#indexsizeerror">IndexSizeError</a></code> exception.</li>
 <li><p>If <var title="">new rule</var> cannot be inserted into <var title="">list</var> at the zero-index position <var title="">index</var> due to constraints
 specified by CSS, then <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a>
 a <code class="external"><a href="http://dom.spec.whatwg.org/#hierarchyrequesterror">HierarchyRequestError</a></code> exception. <a href="#refsCSS">[CSS]</a></p>
 <p class="note">For example, a CSS style sheet cannot contain an <code title="">@import</code> at-rule after a rule set.</li>
 <li><p>If <var title="">new rule</var> is an <code title="">@namespace</code> at-rule, and <var title="">list</var> contains anything other than
 <code title="">@charset</code> at-rules, <code title="">@import</code> at-rules, and <code title="">@namespace</code> at-rules,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an <code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code> exception.
 <li><p>Insert <var title="">new rule</var> into <var title="">list</var> at the zero-indexed position <var title="">index</var>.<p></li>
</ol>
<p class="XXX">DOM-2 CSS specifies that a <code>NO_MODIFICATION_ALLOWED_ERR</code> exception is thrown
if the style sheet is read-only. Are there any read-only style sheets?</p>

<p>To <dfn id="remove-a-css-rule">remove a CSS rule</dfn> from a CSS rule list <var title="">list</var> at index <var title="">index</var>, follow these steps:</p>
<ol>
 <li><p>Set <var title="">length</var> to the number of items in <var title="">list</var>.</li>
 <li><p>If <var title="">index</var> is greater than or equal to <var title="">length</var>, then <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a>
 an <code class="external"><a href="http://dom.spec.whatwg.org/#indexsizeerror">IndexSizeError</a></code> exception.</li>
 <li><p>Set <var title="">old rule</var> to the <var title="">index</var>th item in <var title="">list</var>.</li>
 <li><p>If <var title="">old rule</var> is an <code title="">@namespace</code> at-rule, and <var title="">list</var> contains anything other than
 <code title="">@charset</code> at-rules, <code title="">@import</code> at-rules, and <code title="">@namespace</code> at-rules,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an <code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code> exception.
 <li><p>Remove rule <var title="">old rule</var> from <var title="">list</var> at the zero-indexed position <var title="">index</var>.<p></li>
</ol>


<h4 id="the-cssrulelist-interface"><span class="secno">6.4.1 </span>The <code title="">CSSRuleList</code> Interface</h4>

<p>The <code><a href="#cssrulelist">CSSRuleList</a></code> interface represents an ordered collection of CSS style rules.</p>

<pre class="idl">[ArrayClass]
interface <dfn id="cssrulelist">CSSRuleList</dfn> {
  getter <a href="#cssrule">CSSRule</a>? <a href="#dom-cssrulelist-item" title="dom-CSSRuleList-item">item</a>(unsigned long index);
  readonly attribute unsigned long <a href="#dom-cssrulelist-length" title="dom-CSSRuleList-length">length</a>;
};</pre>

<p>The object's <a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a> are the numbers in the range zero to one less than the number of
<code><a href="#cssrule">CSSRule</a></code> objects represented by the collection. If there are no such <code><a href="#cssrule">CSSRule</a></code> objects, then there are no
<a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a>.

<p>The <dfn id="dom-cssrulelist-item" title="dom-CSSRuleList-item"><code>item(<var title="">index</var>)</code></dfn> method must return the <var title="">index</var>th <code><a href="#cssrule">CSSRule</a></code>
object in the collection. If there is no <var title="">index</var>th object in the collection, then the method must return null.

<p>The <dfn id="dom-cssrulelist-length" title="dom-CSSRuleList-length"><code>length</code></dfn> attribute must return the number of <code><a href="#cssrule">CSSRule</a></code> objects represented by the
collection.

<h4 id="the-cssrule-interface"><span class="secno">6.4.2 </span>The <code title="">CSSRule</code> Interface</h4>

<!--
//
// All members defined since DOM-2 Style. The only differences are:
//
//   1. removal of UNKNOWN_RULE = 0 constant
//   2. addition of NAMESPACE_RULE = 10 constant
//   3. removal of commented raises(DOMException) on setting cssText
//
-->

<p>The <code><a href="#cssrule">CSSRule</a></code> interface represents an abstract, base CSS style rule. Each
distinct CSS style rule type is represented by a distinct interface that
inherits from this interface.</p>
  
<pre class="idl">interface <dfn id="cssrule">CSSRule</dfn> {
  const unsigned short <a href="#dom-cssrule-style_rule" title="dom-CSSRule-STYLE_RULE">STYLE_RULE</a> = 1;
  const unsigned short <a href="#dom-cssrule-charset_rule" title="dom-CSSRule-CHARSET_RULE">CHARSET_RULE</a> = 2;
  const unsigned short <a href="#dom-cssrule-import_rule" title="dom-CSSRule-IMPORT_RULE">IMPORT_RULE</a> = 3;
  const unsigned short <a href="#dom-cssrule-media_rule" title="dom-CSSRule-MEDIA_RULE">MEDIA_RULE</a> = 4;
  const unsigned short <a href="#dom-cssrule-font_face_rule" title="dom-CSSRule-FONT_FACE_RULE">FONT_FACE_RULE</a> = 5;
  const unsigned short <a href="#dom-cssrule-page_rule" title="dom-CSSRule-PAGE_RULE">PAGE_RULE</a> = 6;
  const unsigned short <a href="#dom-cssrule-namespace_rule" title="dom-CSSRule-NAMESPACE_RULE">NAMESPACE_RULE</a> = 10;
  readonly attribute unsigned short <a href="#dom-cssrule-type" title="dom-CSSRule-type">type</a>;
  attribute DOMString <a href="#dom-cssrule-csstext" title="dom-CSSRule-cssText">cssText</a>;
  readonly attribute <a href="#cssrule">CSSRule</a>? <a href="#dom-cssrule-parentrule" title="dom-CSSRule-parentRule">parentRule</a>;
  readonly attribute <a href="#cssstylesheet">CSSStyleSheet</a>? <a href="#dom-cssrule-parentstylesheet" title="dom-CSSRule-parentStyleSheet">parentStyleSheet</a>;
};</pre>

<p>The <dfn id="dom-cssrule-type" title="dom-CSSRule-type"><code>type</code></dfn> attribute must return the CSS rule type, as follows:

<dl class="switch">
 <dt>If the object is a <code><a href="#cssstylerule">CSSStyleRule</a></code>
 <dd><p>Return <dfn id="dom-cssrule-style_rule" title="dom-CSSRule-STYLE_RULE"><code>STYLE_RULE</code></dfn> (numeric value 1).
 <dt>If the object is a <code><a href="#csscharsetrule">CSSCharsetRule</a></code>
 <dd><p>Return <dfn id="dom-cssrule-charset_rule" title="dom-CSSRule-CHARSET_RULE"><code>CHARSET_RULE</code></dfn> (numberic value 2).
 <dt>If the object is a <code><a href="#cssimportrule">CSSImportRule</a></code>
 <dd><p>Return <dfn id="dom-cssrule-import_rule" title="dom-CSSRule-IMPORT_RULE"><code>IMPORT_RULE</code></dfn> (numberic value 3).
 <dt>If the object is a <code><a href="#cssmediarule">CSSMediaRule</a></code>
 <dd><p>Return <dfn id="dom-cssrule-media_rule" title="dom-CSSRule-MEDIA_RULE"><code>MEDIA_RULE</code></dfn> (numeric value 4).
 <dt>If the object is a <code><a href="#cssfontfacerule">CSSFontFaceRule</a></code>
 <dd><p>Return <dfn id="dom-cssrule-font_face_rule" title="dom-CSSRule-FONT_FACE_RULE"><code>FONT_FACE_RULE</code></dfn> (numeric value 5).
 <dt>If the object is a <code><a href="#csspagerule">CSSPageRule</a></code>
 <dd><p>Return <dfn id="dom-cssrule-page_rule" title="dom-CSSRule-PAGE_RULE"><code>PAGE_RULE</code></dfn> (numeric value 6).
 <dt>If the object is a <code><a href="#cssnamespacerule">CSSNamespaceRule</a></code>
 <dd><p>Return <dfn id="dom-cssrule-namespace_rule" title="dom-CSSRule-NAMESPACE_RULE"><code>NAMESPACE_RULE</code></dfn> (numeric value 10).
 <dt>Otherwise
 <dd><p>Return a value defined on the <a href="http://wiki.csswg.org/spec/cssom-constants">CSSOM Constants</a> wiki page.
</dl>

<p class="note">The value 0, formerly known as <code title="">UNKNOWN_RULE</code>, is made
obsolete by this specification. This value will not be re-allocated in the future and will remain reserved.</p>

<p>The <dfn id="dom-cssrule-csstext" title="dom-CSSRule-cssText"><code>cssText</code></dfn> attribute must return a <a href="#serialize-a-css-rule" title="serialize a CSS rule">serialization</a> of the
<a href="#css-rule">CSS rule</a>.</p>
<p>On setting the <code title="dom-CSSRule-cssText"><a href="#dom-cssrule-csstext">cssText</a></code> attribute these steps must be run:</p>
<ol>
 <li><p><a href="#parse-a-css-rule" title="Parse a CSS rule">Parse</a> the value.</li>
 <li><p>If parsing failed terminate this algorithm.</li>
 <li><p>If the <code title="dom-CSSRule-type"><a href="#dom-cssrule-type">type</a></code> of the new
 object does not match the <code title="dom-CSSRule-type"><a href="#dom-cssrule-type">type</a></code> of
 the current object
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an
 <code class="external"><a href="http://dom.spec.whatwg.org/#invalidmodificationerror">InvalidModificationError</a></code> exception.</li>
 <li><p>Replace the current object with the new object.</li>
</ol>

<p>The <dfn id="dom-cssrule-parentrule" title="dom-CSSRule-parentRule"><code>parentRule</code></dfn> attribute must return the nearest enclosing rule of the current rule or null if
there is none. If a value other than null is ever returned, than that same value must always be returned on each get access.</p>
<p class="note">For example, <code title="">@media</code> can enclose a rule, in which case <code title="dom-CSSRule-parentRule"><a href="#dom-cssrule-parentrule">parentRule</a></code> would
be non-null; in cases where there is no enclosing rule, <code title="dom-CSSRule-parentRule"><a href="#dom-cssrule-parentrule">ownerRule</a></code> will be null.</p>

<p>The <dfn id="dom-cssrule-parentstylesheet" title="dom-CSSRule-parentStyleSheet"><code>parentStyleSheet</code></dfn> attribute must return the <code><a href="#cssstylesheet">CSSStyleSheet</a></code> object that contains the
current rule or null if there is none.</p>
<p class="note">The only circumstance where null is returned when a rule has been <a href="#remove-a-css-rule" title="remove a CSS rule">removed</a>.</p>
<p class="note">Removing a <code class="external"><a href="http://dom.spec.whatwg.org/#node">Node</a></code> that implements the <code><a href="#linkstyle">LinkStyle</a></code> interface from a
<code class="external"><a href="http://dom.spec.whatwg.org/#document">Document</a></code> instance does not (by itself) cause the <code><a href="#cssstylesheet">CSSStyleSheet</a></code> referenced by a <code><a href="#cssrule">CSSRule</a></code> to be
unreachable.</p>


<h4 id="the-cssstylerule-interface"><span class="secno">6.4.3 </span>The <code title="">CSSStyleRule</code> Interface</h4>

<!--
//
// All members defined since DOM-2 Style. The only differences are:
//
//   1. removal of commented raises(DOMException) on setting selectorText
//
-->

<p>The <code><a href="#cssstylerule">CSSStyleRule</a></code> interface represents a rule set.</p>

<pre class="idl">interface <dfn id="cssstylerule">CSSStyleRule</dfn> : <a href="#cssrule">CSSRule</a> {
  attribute DOMString <a href="#dom-cssstylerule-selectortext" title="dom-CSSStyleRule-selectorText">selectorText</a>;
  [PutForwards=<a href="#dom-cssstyledeclaration-csstext" title="dom-CSSStyleDeclaration-cssText">cssText</a>] readonly attribute <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#dom-cssstylerule-style" title="dom-CSSStyleRule-style">style</a>;
};</pre>

<p>The <dfn id="dom-cssstylerule-selectortext" title="dom-CSSStyleRule-selectorText"><code>selectorText</code></dfn> attribute, on getting, must return the result of
<a href="#serialize-a-group-of-selectors" title="serialize a group of selectors">serializing</a> the associated <a href="#group-of-selectors">group of selectors</a>.</p>
<p>On setting the <code title="dom-CSSStyleRule-selectorText"><a href="#dom-cssstylerule-selectortext">selectorText</a></code> attribute these steps must be run:</p>
<ol>
 <li><p>Run the <a href="#parse-a-group-of-selectors">parse a group of selectors</a> algorithm on the given value.</li>
 <li><p>If the algorithm returns a non-null value replace the associated <a href="#group-of-selectors">group of selectors</a> with the returned value.</li>
 <li><p>Otherwise, if the algorithm returns a null value, do nothing.</li>
</ol>

<p>The <dfn id="dom-cssstylerule-style" title="dom-CSSStyleRule-style"><code>style</code></dfn> attribute must return a <code><a href="#cssstyledeclaration">CSSStyleDeclaration</a></code> object for the rule set.</p>


<h4 id="the-csscharsetrule-interface"><span class="secno">6.4.4 </span>The <code title="">CSSCharsetRule</code> Interface</h4>

<p>The <code><a href="#csscharsetrule">CSSCharsetRule</a></code> interface represents an <code title="">@charset</code> at-rule.</p>

<pre class="idl">interface <dfn id="csscharsetrule">CSSCharsetRule</dfn> : <a href="#cssrule">CSSRule</a> {
  attribute DOMString <a href="#dom-csscharsetrule-encoding" title="dom-CSSCharsetRule-encoding">encoding</a>;
};</pre>

<p>The <dfn id="dom-csscharsetrule-encoding" title="dom-CSSCharsetRule-encoding"><code>encoding</code></dfn> attribute must return the encoding information specified by the
<code title="">@charset</code> at-rule.</p>


<h4 id="the-cssimportrule-interface"><span class="secno">6.4.5 </span>The <code title="">CSSImportRule</code> Interface</h4>

<p>The <code><a href="#cssimportrule">CSSImportRule</a></code> interface represents an <code title="">@import</code> at-rule.</p>

<pre class="idl">interface <dfn id="cssimportrule">CSSImportRule</dfn> : <a href="#cssrule">CSSRule</a> {
  readonly attribute DOMString <a href="#dom-cssimportrule-href" title="dom-CSSImportRule-href">href</a>;
  [PutForwards=<a href="#dom-medialist-mediatext" title="dom-MediaList-mediaText">mediaText</a>] readonly attribute <a href="#medialist">MediaList</a> <a href="#dom-cssimportrule-media" title="dom-CSSImportRule-media">media</a>;
  readonly attribute <a href="#cssstylesheet">CSSStyleSheet</a> <a href="#dom-cssimportrule-stylesheet" title="dom-CSSImportRule-styleSheet">styleSheet</a>;
};</pre>

<p>The <dfn id="dom-cssimportrule-href" title="dom-CSSImportRule-href"><code>href</code></dfn> attribute must return the <a class="external" href="http://url.spec.whatwg.org/#concept-url" title="concept-url">URL</a> specified by
the <code title="">@import</code> at-rule.</p>
<p class="note">To get the resolved <a class="external" href="http://url.spec.whatwg.org/#concept-url" title="concept-url">URL</a> use the <code title="dom-StyleSheet-href"><a href="#dom-stylesheet-href">href</a></code>
attribute of the associated <a href="#css-style-sheet">CSS style sheet</a>.</p>

<p>The <dfn id="dom-cssimportrule-media" title="dom-CSSImportRule-media"><code>media</code></dfn> attribute must return the value of the <code title="dom-StyleSheet-media"><a href="#dom-stylesheet-media">media</a></code>
attribute of the associated <a href="#css-style-sheet">CSS style sheet</a>.</p>

<p>The <dfn id="dom-cssimportrule-stylesheet" title="dom-CSSImportRule-styleSheet"><code>styleSheet</code></dfn> attribute must return the associated <a href="#css-style-sheet">CSS style sheet</a>.</p>
<p class="note">If loading of the style sheet fails its <code title="dom-CSSStyleSheet-cssRules"><a href="#dom-cssstylesheet-cssrules">cssRules</a></code>
list is simply empty, i.e., an <code title="">@import</code> at-rule always has an associated <a href="#css-style-sheet">CSS style sheet</a>.</p>


<h4 id="the-cssmediarule-interface"><span class="secno">6.4.6 </span>The <code title="">CSSMediaRule</code> Interface</h4>

<p>The <code><a href="#cssmediarule">CSSMediaRule</a></code> interface represents an <code title="">@media</code> at-rule.</p>

<pre class="idl">interface <dfn id="cssmediarule">CSSMediaRule</dfn> : <a href="#cssrule">CSSRule</a> {
  [PutForwards=<a href="#dom-medialist-mediatext" title="dom-MediaList-mediaText">mediaText</a>] readonly attribute <a href="#medialist">MediaList</a> <a href="#dom-cssmediarule-media" title="dom-CSSMediaRule-media">media</a>;
  readonly attribute <a href="#cssrulelist">CSSRuleList</a> <a href="#dom-cssmediarule-cssrules" title="dom-CSSMediaRule-cssRules">cssRules</a>;
  unsigned long <a href="#dom-cssmediarule-insertrule" title="dom-CSSMediaRule-insertRule">insertRule</a>(DOMString rule, unsigned long index);
  void <a href="#dom-cssmediarule-deleterule" title="dom-CSSMediaRule-deleteRule">deleteRule</a>(unsigned long index);
};</pre>

<p>The <dfn id="dom-cssmediarule-media" title="dom-CSSMediaRule-media"><code>media</code></dfn> attribute must return a <code><a href="#medialist">MediaList</a></code> object for the list of media queries specified
with the <code title="">@media</code> at-rule.</p>

<p>The <dfn id="dom-cssmediarule-cssrules" title="dom-CSSMediaRule-cssRules"><code>cssRules</code></dfn> attribute must return a <code><a href="#cssrulelist">CSSRuleList</a></code> object for the list of CSS rules 
specified with the <code title="">@media</code> at-rule.</p>

<p>The <dfn id="dom-cssmediarule-insertrule" title="dom-CSSMediaRule-insertRule"><code>insertRule(<var title="">rule</var>, <var title="">index</var>)</code></dfn> method must <a href="#insert-a-css-rule">insert a CSS
rule</a> <var title="">rule</var> into the CSS rule list returned by <code title="dom-CSSMediaRule-cssRules"><a href="#dom-cssmediarule-cssrules">cssRules</a></code> at <var title="">index</var>, and
return <var title="">index</var>.</p>

<p>The <dfn id="dom-cssmediarule-deleterule" title="dom-CSSMediaRule-deleteRule"><code>deleteRule(<var title="">index</var>)</code></dfn> method must <a href="#remove-a-css-rule">remove a CSS rule</a> from the CSS rule
list returned by <code title="dom-CSSMediaRule-cssRules"><a href="#dom-cssmediarule-cssrules">cssRules</a></code> at <var title="">index</var>.</p>


<h4 id="the-cssfontfacerule-interface"><span class="secno">6.4.7 </span>The <code title="">CSSFontFaceRule</code> Interface</h4>

<p>The <code><a href="#cssfontfacerule">CSSFontFaceRule</a></code> interface represents an <code title="">@font-face</code> at-rule.</p>

<pre class="idl">interface <dfn id="cssfontfacerule">CSSFontFaceRule</dfn> : <a href="#cssrule">CSSRule</a> {
  [PutForwards=<a href="#dom-cssstyledeclaration-csstext" title="dom-CSSStyleDeclaration-cssText">cssText</a>] readonly attribute <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#dom-cssfontfacerule-style" title="dom-CSSFontFaceRule-style">style</a>;
};</pre>

<p>The <dfn id="dom-cssfontfacerule-style" title="dom-CSSFontFaceRule-style"><code>style</code></dfn> attribute must return a <code><a href="#cssstyledeclaration">CSSStyleDeclaration</a></code> block that contains the property
declarations specified within the <code title="">@font-face</code> at-rule.</p>


<h4 id="the-csspagerule-interface"><span class="secno">6.4.8 </span>The <code title="">CSSPageRule</code> Interface</h4>
 
<p>The <code><a href="#csspagerule">CSSPageRule</a></code> interface represents an <code title="">@page</code> at-rule.</p>
<p class="XXX">Need to define the rules for
<dfn id="parse-a-list-of-css-page-selectors">parse a list of CSS page selectors</dfn> and
<dfn id="serialize-a-list-of-css-page-selectors">serialize a list of CSS page selectors</dfn>.</p>

<pre class="idl">interface <dfn id="csspagerule">CSSPageRule</dfn> : <a href="#cssrule">CSSRule</a> {
  attribute DOMString <a href="#dom-csspagerule-selectortext" title="dom-CSSPageRule-selectorText">selectorText</a>;
  [PutForwards=<a href="#dom-cssstyledeclaration-csstext" title="dom-CSSStyleDeclaration-cssText">cssText</a>] readonly attribute <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#dom-csspagerule-style" title="dom-CSSPageRule-style">style</a>;
};</pre>

<p>The <dfn id="dom-csspagerule-selectortext" title="dom-CSSPageRule-selectorText"><code>selectorText</code></dfn> attribute, on getting, must return the result of
<a href="#serialize-a-list-of-css-page-selectors" title="serialize a list of CSS page selectors">serializing</a> the associated <a href="#list-of-css-page-selectors">list of CSS page selectors</a>.</p>
<p>On setting the <code title="dom-CSSPageRule-selectorText"><a href="#dom-csspagerule-selectortext">selectorText</a></code> attribute  these steps must be run:</p>
<ol>
 <li><p>Run the <a href="#parse-a-list-of-css-page-selectors">parse a list of CSS page selectors</a> algorithm on the given value.</li>
 <li><p>If the algorithm returns a non-null value replace the associated <a href="#list-of-css-page-selectors">list of CSS page selectors</a> with the returned value.</li>
 <li><p>Otherwise, if the algorithm returns a null value, do nothing.</li>
</ol>

<p>The <dfn id="dom-csspagerule-style" title="dom-CSSPageRule-style"><code>style</code></dfn> attribute  must return a <code><a href="#cssstyledeclaration">CSSStyleDeclaration</a></code> for the <code title="">@page</code>
at-rule.</p>


<h4 id="the-cssnamespacerule-interface"><span class="secno">6.4.9 </span>The <code title="">CSSNamespaceRule</code> Interface</h4>

<p>The <code><a href="#cssnamespacerule">CSSNamespaceRule</a></code> interface represents an <code title="">@namespace</code> at-rule.</p>

<pre class="idl">interface <dfn id="cssnamespacerule">CSSNamespaceRule</dfn> : <a href="#cssrule">CSSRule</a> {
  [TreatNullAs=EmptyString] attribute DOMString <a href="#dom-cssnamespacerule-namespaceuri" title="dom-CSSNamespaceRule-namespaceURI">namespaceURI</a>;
  [TreatNullAs=EmptyString] attribute DOMString <a href="#dom-cssnamespacerule-prefix" title="dom-CSSNamespaceRule-prefix">prefix</a>;
};</pre>

<p>The <dfn id="dom-cssnamespacerule-namespaceuri" title="dom-CSSNamespaceRule-namespaceURI"><code>namespaceURI</code></dfn> attribute, on getting, must return the namespace of the
<code title="">@namespace</code> at-rule.

<p>On setting, the <code title="dom-CSSNamespaceRule-namespaceURI"><a href="#dom-cssnamespacerule-namespaceuri">namespaceURI</a></code> attribute must run the following steps:</p>

<ol>
 <li><p>Let <var title="">CSS style sheet</var> be the value returned by <code title="dom-CSSRule-parentStyleSheet"><a href="#dom-cssrule-parentstylesheet">parentStyleSheet</a></code>.
 <li><p>Let <var title="">list</var> be the value returned by <code title="dom-CSSStyleSheet-cssRules"><a href="#dom-cssstylesheet-cssrules">cssRules</a></code> of <var title="">CSS style sheet</var>, or
 null if <var title="">CSS style sheet</var> is null.
 <li><p>If <var title="">list</var> is not null and contains anything other than
 <code title="">@charset</code> at-rules, <code title="">@import</code> at-rules, and <code title="">@namespace</code> at-rules,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an <code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code> exception.
 <li><p>Set the namespace of the <code title="">@namespace</code> at-rule to the given value.
</ol>

<p>The <dfn id="dom-cssnamespacerule-prefix" title="dom-CSSNamespaceRule-prefix"><code>prefix</code></dfn> attribute must return the prefix of the <code title="">@namespace</code> at-rule or the
empty string if there is no prefix.

<p>On setting, the <code title="dom-CSSNamespaceRule-prefix"><a href="#dom-cssnamespacerule-prefix">prefix</a></code> attribute must run the following steps:</p>

<ol>
 <li><p>Let <var title="">CSS style sheet</var> be the value returned by <code title="dom-CSSRule-parentStyleSheet"><a href="#dom-cssrule-parentstylesheet">parentStyleSheet</a></code>.
 <li><p>Let <var title="">list</var> be the value returned by <code title="dom-CSSStyleSheet-cssRules"><a href="#dom-cssstylesheet-cssrules">cssRules</a></code> of <var title="">CSS style sheet</var>, or
 null if <var title="">CSS style sheet</var> is null.
 <li><p>If <var title="">list</var> is not null and contains anything other than
 <code title="">@charset</code> at-rules, <code title="">@import</code> at-rules, and <code title="">@namespace</code> at-rules,
 <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a> an <code class="external"><a href="http://dom.spec.whatwg.org/#invalidstateerror">InvalidStateError</a></code> exception.
 <li><p>Set the prefix of the <code title="">@namespace</code> at-rule to the given value.
</ol>


<h3 id="css-declaration-blocks"><span class="secno">6.5 </span>CSS Declaration Blocks</h3>

<p>A <dfn id="css-declaration-block">CSS declaration block</dfn> is an ordered collection of CSS
properties with their associated values, also named CSS declarations. In
the DOM a <a href="#css-declaration-block">CSS declaration block</a> is a
<code><a href="#cssstyledeclaration">CSSStyleDeclaration</a></code> object. A
<a href="#css-declaration-block">CSS declaration block</a> has two associated properties:</p>

<dl>
 <dt><dfn id="concept-css-declaration-block-readonly-flag" title="concept-css-declaration-block-readonly-flag">readonly flag</dfn></dt>
 <dd><p>Clear if the object can be manipulated. Set if it can not be
 manipulated. Unless otherwise stated it is clear.</dd>

 <dt><dfn id="concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</dfn></dt>
 <dd><p>The CSS declarations associated with the object.</dd>
</dl>

<p class="note">The <a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a> are
ordered. This matters for the
<code title="dom-CSSStyleDeclaration-item"><a href="#dom-cssstyledeclaration-item">item()</a></code> method.</p>

<p>To <dfn id="parse-a-css-declaration-block">parse a CSS declaration block</dfn> ...</p>

<p class="XXX">What should be captured in the cssText of a declaration block which fails
to parse?</p>

<p>To <dfn id="serialize-a-css-declaration-block">serialize a CSS declaration block</dfn>
represented by a <code>CSSStyleDeclarations</code> instance named <var title="">d</var>,
let <var title="">s</var> be the empty string, then run the steps below:</p>

<ol>
 <li><p>If <code title=""><var title="">d</var>.length</code> is zero (0), then return <var title="">s</var>.</li>
 <li><p>For each <var title="">i</var> from zero (0) through <code title=""><var title="">d</var>.length</code> - 1 (inclusive), perform the following sub-steps:</p>
 <ol>
  <li><p>Let <var title="">n</var> be the value returned by <code title=""><var title="">d</var>.item(<var title="">i</var>)</code>.</li>
  <li><p>Let <var title="">v</var> be the value returned by <code title=""><var title="">d</var>.getPropertyValue(<var title="">n</var>)</code>.</li>
  <li><p>If <var title="">v</var> is the empty string, then continue.</li>
  <li>
   <p>Otherwise (<var title="">v</var> is non-empty), perform the following sub-steps:</p>
   <ol>
     <li><p>If <var title="">s</var> is not empty, then append a single SPACE (U+0020) to <var title="">s</var>.</li>
     <li><p>Append <var title="">n</var> to <var title="">s</var>.</li>
     <li><p>Append COLON (U+003A) followed by a single SPACE (U+0020), i.e., "<code title="">: </code>", to <var title="">s</var>.</li>
     <li><p>Append <var title="">v</var> to <var title="">s</var>.</li>
   </ol>
   </li>
   <li><p>Let <var title="">p</var> be the value returned by <code title=""><var title="">d</var>.getPropertyPriority(<var title="">n</var>)</code>.</li>
   <li>
    <p>If <var title="">p</var> is not the empty string, then perform the following sub-steps:</p>
    <ol>
      <li><p>Append a single SPACE (U+0020) followed by EXCLAMATION MARK (U+0021), i.e., "<code title=""> !</code>", to <var title="">s</var>.</li>
      <li><p>Append <var title="">p</var> to <var title="">s</var>.</li>
    </ol>
   </li>
   <li><p>Append SEMICOLON (U+003B), i.e., "<code title="">;</code>", to <var title="">s</var>.</li>
 </ol>
 </li>
 <li><p>Return <var title="">s</var>.</li>
</ol>

<p class="note">The serialization of an empty CSS declaration block is the empty string.</p>

<p class="note">The serialization of a non-empty CSS declaration block does not include any surrounding whitespace, i.e., no whitepsace appears
before the first property name and no whitespace appears after the final semicolon delimiter that follows the last property value.</p>


<h4 id="the-cssstyledeclaration-interface"><span class="secno">6.5.1 </span>The <code title="">CSSStyleDeclaration</code> Interface</h4>

<!--
//
// All members defined since DOM-2 Style. The only differences are:
//
//   1. removal of commented raises(DOMException) on setting cssText
//   2. removal of raises(DOMException) on {set,remove}Property
//   3. removal of getPropertyCSSValue() method
//
-->

<p>The <code><a href="#cssstyledeclaration">CSSStyleDeclaration</a></code> interface represents a <a href="#css-declaration-block">CSS declaration block</a>, including its underlying state, where this
underlying state depends upon the source of the <code><a href="#cssstyledeclaration">CSSStyleDeclaration</a></code> instance.</p>

<pre class="idl">interface <dfn id="cssstyledeclaration">CSSStyleDeclaration</dfn> {
  attribute DOMString <a href="#dom-cssstyledeclaration-csstext" title="dom-CSSStyleDeclaration-cssText">cssText</a>;
  readonly attribute unsigned long <a href="#dom-cssstyledeclaration-length" title="dom-CSSStyleDeclaration-length">length</a>;
  getter DOMString <a href="#dom-cssstyledeclaration-item" title="dom-CSSStyleDeclaration-item">item</a>(unsigned long index);
  DOMString <a href="#dom-cssstyledeclaration-getpropertyvalue" title="dom-CSSStyleDeclaration-getPropertyValue">getPropertyValue</a>(DOMString property);
  DOMString <a href="#dom-cssstyledeclaration-getpropertypriority" title="dom-CSSStyleDeclaration-getPropertyPriority">getPropertyPriority</a>(DOMString property);
  void <a href="#dom-cssstyledeclaration-setproperty" title="dom-CSSStyleDeclaration-setProperty">setProperty</a>(DOMString property, [TreatNullAs=EmptyString] DOMString value, <!--
  -->[TreatNullAs=EmptyString] optional DOMString priority = "");
  DOMString <a href="#dom-cssstyledeclaration-removeproperty" title="dom-CSSStyleDeclaration-removeProperty">removeProperty</a>(DOMString property);
  readonly attribute <a href="#cssrule">CSSRule</a>? <a href="#dom-cssstyledeclaration-length" title="dom-CSSStyleDeclaration-length">parentRule</a>;
           attribute DOMString <a href="#dom-cssstyledeclaration-cssfloat" title="dom-CSSStyleDeclaration-cssFloat">cssFloat</a>;<!-- setProperty's value arg has [TreatNullAs=EmptyString] -->
};</pre>

<p>The object's <a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a> are the numbers in the range zero to one less than the number of declarations in
the <a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a>. If there are no such declarations, then there are no
<a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a>.

<p>The <dfn id="dom-cssstyledeclaration-csstext" title="dom-CSSStyleDeclaration-cssText"><code>cssText</code></dfn> attribute must return the result of
<a href="#serialize-a-css-declaration-block" title="serialize a CSS declaration block">serializing</a> the <a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a>.</p>
<p>Setting the <code title="dom-CSSStyleDeclaration-cssText"><a href="#dom-cssstyledeclaration-csstext">cssText</a></code> attribute must run these steps:
<ol>
 <li><p>If the <a href="#concept-css-declaration-block-readonly-flag" title="concept-css-declaration-block-readonly-flag">readonly flag</a> is set, <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a>
 a <code class="external"><a href="http://dom.spec.whatwg.org/#nomodificationallowederror">NoModificationAllowedError</a></code> exception and terminate these steps.</li>
 <li><p>Empty the <a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a>.</li>
 <li><p><a href="#parse-a-css-declaration-block" title="Parse a CSS declaration block">Parse</a> the given value and, if the return value is not null, insert it into the
 <a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a>.</li>
</ol>

<p>The <dfn id="dom-cssstyledeclaration-length" title="dom-CSSStyleDeclaration-length"><code>length</code></dfn> attribute must return the number of declarations in the
<a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a>.</p>

<p>The <dfn id="dom-cssstyledeclaration-item" title="dom-CSSStyleDeclaration-item"><code>item(<var title="">index</var>)</code></dfn> method must return the name of the property at position
<var title="">index</var>.</p>

<p>The <dfn id="dom-cssstyledeclaration-getpropertyvalue" title="dom-CSSStyleDeclaration-getPropertyValue"><code>getPropertyValue(<var title="">property</var>)</code></dfn> method must run these steps:</p>
<ol>
 <li><p>If <var title="">property</var> is an <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII
 case-insensitive</a> match for a property of a declaration in the
 <a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a>, and that declaration's property
 is defined to be case-insensitive, return the
 <a href="#serialize-a-css-value" title="serialize a CSS value">serialization</a> of that declaration's
 value.
 <li><p>If <var title="">property</var> is a <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a>
 match for a property of a declaration in the
 <a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a>, and that declaration's property
 is defined to be case-sensitive, return the
 <a href="#serialize-a-css-value" title="serialize a CSS value">serialization</a> of that declaration's
 value.
 <li><p>Return the empty string.
</ol>

<p>The <dfn id="dom-cssstyledeclaration-getpropertypriority" title="dom-CSSStyleDeclaration-getPropertyPriority"><code>getPropertyPriority(<var title="">property</var>)</code></dfn> method must run these steps:
<ol>
 <li><p>If <var title="">property</var> is an <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII
 case-insensitive</a> match for a property of a declaration in the <a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a> that has the
 <i title="">important</i> flag set, and that declaration's
 property is defined to be case-insensitive, return the string "<code title="">important</code>".</p>
 <li><p>If <var title="">property</var> is a
 <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match for a property of a
 declaration in the <a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a> that has the
 <i title="">important</i> flag set, and that declaration's property is defined to be case-sensitive, return
 the string "<code title="">important</code>".</p>
 <li><p>Return the empty string.
</ol>
<p class="example">E.g. for <code title="">background-color:lime !IMPORTANT</code> the return
value would be "<code title="">important</code>".</p>

<p>The <dfn id="dom-cssstyledeclaration-setproperty" title="dom-CSSStyleDeclaration-setProperty"><code>setProperty(<var title="">property</var>, <var title="">value</var>,
<var title="">priority</var>)</code></dfn> method must run these steps:</p>
<ol>
 <li><p>If the <a href="#concept-css-declaration-block-readonly-flag" title="concept-css-declaration-block-readonly-flag">readonly flag</a> is set, <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a>
 an <code class="external"><a href="http://dom.spec.whatwg.org/#nomodificationallowederror">NoModificationAllowedError</a></code> exception and terminate these steps.</li>
 <li><p>If <var title="">property</var> is not an <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for a supported property that is defined to be
 case-insensitive, or if <var title="">property</var> is not a <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match for a supported property that is defined to
 be case-sensitive, terminate this algorithm.</li>
 <li><p>If <var title="">value</var> is the empty string, invoke <code title="dom-CSSStyleDeclaration-removeProperty"><a href="#dom-cssstyledeclaration-removeproperty">removeProperty()</a></code>
 with <var title="">property</var> as argument and terminate this algorithm.</li>
 <li><p>If <var title="">priority</var> is neither an <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for the string "<code title="">important</code>"
 nor the empty string terminate this algorithm.</li>
 <li>
 <p>If <a href="#parse-a-css-value" title="parse a CSS value">parsing the <var title="">value</var></a> returns null terminate this algorithm.
 <p class="note"><var title="">value</var> can not include "<code title="">!important</code>".</p>
 </li>
 <li><p>Finally, set <var title="">property</var> to <var title="">value</var> with the <i title="">important</i> flag set if <var title="">priority</var> is not the empty
 string, and unset otherwise.</li>
</ol>

<p>The <dfn id="dom-cssstyledeclaration-removeproperty" title="dom-CSSStyleDeclaration-removeProperty"><code>removeProperty(<var title="">property</var>)</code></dfn> method must run these steps:</p>
<ol>
 <li><p>If the <a href="#concept-css-declaration-block-readonly-flag" title="concept-css-declaration-block-readonly-flag">readonly flag</a> is set, <a class="external" href="http://dom.spec.whatwg.org/#concept-throw" title="concept-throw">throw</a>
 a <code class="external"><a href="http://dom.spec.whatwg.org/#nomodificationallowederror">NoModificationAllowedError</a></code> exception and terminate these steps.</li>
 <li><p>Let <var title="">value</var> be the return value of invoking <code title="dom-CSSStyleDeclaration-getPropertyValue"><a href="#dom-cssstyledeclaration-getpropertyvalue">getPropertyValue()</a></code>
 with <var title="">property</var> as argument.
 <li><p>If <var title="">property</var> is an <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for a property of a declaration in the
 <a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a>, and that property is defined to be a case-insensitive property, remove the
 declaration.</li>
 <li><p>If <var title="">property</var> is a <a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match for a property of a declaration in the
 <a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a>, and that property is defined to be a case-sensitive property, remove the
 declaration.</li>
 <li><p>Return <var title="">value</var>.
</ol>

<p>The <dfn id="dom-cssstyledeclaration-parentrule" title="dom-CSSStyleDeclaration-parentRule"><code>parentRule</code></dfn> attribute must return the <code><a href="#cssrule">CSSrule</a></code> object the
<code><a href="#cssstyledeclaration">CSSStyleDeclaration</a></code> is object is associated with or null if it is not associated with a <code><a href="#cssrule">CSSrule</a></code> object.</p>

<p>The <dfn id="dom-cssstyledeclaration-cssfloat" title="dom-CSSStyleDeclaration-cssFloat"><code>cssFloat</code></dfn>
attribute, on getting, must return the result of invoking
<code title="dom-CSSStyleDeclaration-getPropertyValue"><a href="#dom-cssstyledeclaration-getpropertyvalue">getPropertyValue()</a></code> with
<code title="">float</code> as argument. On setting, the attribute must invoke
<code title="dom-CSSStyleDeclaration-setProperty"><a href="#dom-cssstyledeclaration-setproperty">setProperty()</a></code> with
<code title="">float</code> as first argument, as second argument the given value, and no third argument.
Any exceptions thrown must be re-thrown.

<p>For each CSS property <var title="">property</var> that the user agent supports,
the following partial interface applies where <var title="">camel-cased attribute</var>
is obtained by running the <a href="#css-property-to-idl-attribute">CSS property to IDL attribute</a> algorithm for
<var>property</var>.</p>

<pre class="idl extract">partial interface <a href="#cssstyledeclaration">CSSStyleDeclaration</a> {
           attribute DOMString _<a href="#dom-cssstyledeclaration-camel-cased-attribute" title="dom-CSSStyleDeclaration-camel-cased-attribute"><var title="">camel-cased attribute</var></a>;
};</pre>

<p>The <dfn id="dom-cssstyledeclaration-camel-cased-attribute" title="dom-CSSStyleDeclaration-camel-cased-attribute"><code><var title="">camel-cased attribute</var></code></dfn> attribute, on getting, must return the
result of invoking <code title="dom-CSSStyleDeclaration-getPropertyValue"><a href="#dom-cssstyledeclaration-getpropertyvalue">getPropertyValue()</a></code> with the
argument being the result of running the <a href="#idl-attribute-to-css-property">IDL attribute to CSS property</a>
algorithm for <var title="">camel-cased attribute</var>.</p>

<p>Setting the <code title="dom-CSSStyleDeclaration-camel-cased-attribute"><a href="#dom-cssstyledeclaration-camel-cased-attribute"><var title="">camel-cased attribute</var></a></code> attribute must invoke
<code title="dom-CSSStyleDeclaration-setProperty"><a href="#dom-cssstyledeclaration-setproperty">setProperty()</a></code> with the
first argument being the result of running the <a href="#idl-attribute-to-css-property">IDL attribute to CSS property</a>
algorithm for <var title="">camel-cased attribute</var>, as second argument the given value, and no third argument. Any
exceptions thrown must be re-thrown.</p>

<p class="example">For example, for the 'font-size' property there would be a <code title="">fontSize</code> IDL attribute.

<!-- [GA] Remove spec text for so called "dashed-attribute" until consensus obtains on whether to include in spec.

<p>For each CSS property <var title>property</var> that the user agent supports, except for properties that have no "<code title>-</code>" (U+002D) in the
property name, user agents must act as if there was a WebIDL <span data-anolis-spec=webidl>regular attribute</span> member as part of the
<code>CSSStyleDeclaration</code> interface with the type being <code title>DOMString</code> and the <span data-anolis-spec=webidl>identifier</span> being
<var title>property</var>, and let <var title>dashed attribute</var> be <var title>property</var>.

<p>The <dfn title=dom-CSSStyleDeclaration-dashed-attribute><code><var title>dashed attribute</var></code></dfn> attribute, on getting, must return the
result of invoking <code title=dom-CSSStyleDeclaration-getPropertyValue>getPropertyValue()</code> with the
argument being <var title>dashed attribute</var>.</p>

<p>Setting the <code title=dom-CSSStyleDeclaration-dashed-attribute><var title>dashed attribute</var></code> attribute must invoke
<code title=dom-CSSStyleDeclaration-setProperty>setProperty()</code> with the
first argument being <var title>dashed attribute</var>, as second argument the given value, and no third argument. Any
exceptions thrown must be re-thrown.</p>

<div class=example>
 <p>For example, for the 'font-size' property there would be a <code title>font-size</code> IDL attribute. In JavaScript, the property can be accessed as
 follows, assuming <var title>element</var> is an <span data-anolis-spec=html title="HTML elements">HTML element</span>:
 <pre><var title>element</var>.style['font-size'];</pre>
</div>

<p class=note>WebIDL does not allow dashes in identifiers in its syntax.

<p class=XXX>The <code title=dom-CSSStyleDeclaration-dashed-attribute><var title>dashed attribute</var></code> attributes will be removed from the specification
if implementations remove support. User agents that currently support them are urged to experiment with removing support.

-->

<p>The <dfn id="css-property-to-idl-attribute">CSS property to IDL attribute</dfn> algorithm for <var title="">property</var> is as
follows:</p>

<ol>
 <li><p>Let <var title="">output</var> be the empty string.
 
 <li><p>Let <var title="">uppercase next</var> be unset.
 
 <li><p>For each character <var title="">c</var> in <var title="">property</var>:

  <ol>
   <li><p>If <var title="">c</var> is "<code title="">-</code>" (U+002D), let <var title="">uppercase next</var> be set.
   
   <li><p>Otherwise, if <var title="">uppercase next</var> is set, let <var title="">uppercase next</var> be unset and append <var title="">c</var>
   <a class="external" href="http://dom.spec.whatwg.org/#converted-to-ascii-uppercase">converted to ASCII uppercase</a> to <var title="">output</var>.
   
   <li><p>Otherwise, append <var title="">c</var> to <var title="">output</var>.
  </ol>

 <li><p>Return <var title="">output</var>.
</ol>

<p>The <dfn id="idl-attribute-to-css-property">IDL attribute to CSS property</dfn> algorithm for <var title="">attribute</var> is as
follows:</p>

<ol>
 <li><p>Let <var title="">output</var> be the empty string.
     
 <li><p>For each character <var title="">c</var> in <var title="">attribute</var>:
 
  <ol>
   <li><p>If <var title="">c</var> is in the range U+0041 to U+005A (ASCII uppercase), append "<code title="">-</code>" (U+002D) followed by <var title="">c</var>
   <a class="external" href="http://dom.spec.whatwg.org/#converted-to-ascii-lowercase">converted to ASCII lowercase</a> to <var title="">output</var>.
           
   <li><p>Otherwise, append <var title="">c</var> to <var title="">output</var>.
  </ol>
 
 <li><p>Return <var title="">output</var>.
</ol>


<h3 id="css-values"><span class="secno">6.6 </span>CSS Values</h3>


<h4 id="parsing-css-values"><span class="secno">6.6.1 </span>Parsing CSS Values</h4>

<p>To <dfn id="parse-a-css-value">parse a CSS value</dfn> for a given
<var title="">property</var> means to a parse the given value according to
the definition of the property that is an
<a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for
<var title="">property</var> in the CSS specification, if <var title="">property</var> is defined to be
case-insensitive, or otherwise that is a
<a class="external" href="http://dom.spec.whatwg.org/#case-sensitive">case-sensitive</a> match for <var title="">property</var> in the
CSS specification. If the given value is <a href="#ignored">ignored</a> return null.
Otherwise return the CSS value for the given <var title="">property</var>.</p>

<p class="note">"<code title="">!important</code>" declarations are not
part of the property value space and will therefore cause
<a href="#parse-a-css-value">parse a CSS value</a> to return null.</p>



<h4 id="serializing-css-values"><span class="secno">6.6.2 </span>Serializing CSS Values</h4>

<!-- based on http://damowmow.com/playground/canon.txt -->

<p>To <dfn id="serialize-a-css-value">serialize a CSS value</dfn> follow
these rules:</p>

<ul>
 <li><p><a href="#serialize-a-css-component-value" title="Serialize a CSS component value">Serialize</a> any
 CSS component values in the value.</li>

 <li><p>Where multiple CSS component values can appear in any order
 without changing the meaning of the value (typically represented by a
 double bar <code title="">||</code> in the value syntax), use the order as given
 in the syntax.</li>
 <!-- <code title>&lt;border-width> &lt;border-style> &lt;color></code>
 for <code title>border</code> -->

 <li>
  <p>Where CSS component values of the value can be omitted without
  changing the meaning of the value (e.g. initial values in shorthand
  properties), omit them. If this would remove all the values, then
  include the first allowed value.</p>

  <p class="example">E.g. <code title="">margin: 20px 20px</code> becomes
  <code title="">margin: 20px</code>.</p>

  <p class="example">E.g. the value <code title="">0</code> for the
  'border' property.</p>
 </li>

 <li><p>If the value of a shorthand property is requested and it cannot be
 computed because the properties associated with the shorthand have values
 that cannot be represented by the shorthand the serialization is the
 empty string.</li>

 <li><p>If a value has a <a href="#whitespace">whitespace</a>-separated list of
 CSS component values,
 <a href="#serialize-a-whitespace-separated-list" title="serialize a whitespace-separated list">serialize</a> the
 value as a whitespace-separated list.</li>

 <li><p>If a value has a comma-separated list of
 CSS component values,
 <a href="#serialize-a-comma-separated-list" title="serialize a comma-separated list">serialize</a> the
 value as a comma-separated list.</li>
</ul>


<p>To
<dfn id="serialize-a-css-component-value">serialize a CSS component value</dfn>
depends on the component, as follows:</p>

<dl class="switch">
 <dt>keyword</dt>
 <dd><p>The keyword
 <a class="external" href="http://dom.spec.whatwg.org/#converted-to-ascii-lowercase">converted to ASCII lowercase</a>.</dd>

 <dt>&lt;angle&gt;</dt>
 <dd><p>The number of degrees serialized as per &lt;number&gt; followed by
 the literal string "<code title="">deg</code>".</dd>

 <dt>&lt;color&gt;</dt>
 <dd>
 <p>If &lt;color&gt; is a component of a resolved or computed value, then
 return the color using the <code title="">rgb()</code> or <code title="">rgba()</code> functional
 notation as follows:</p>
 <ol>
 <li>If the alpha component of the color is equal to one, then return the serialization of the
 <code title="">rgb()</code> functional equivalent of the opaque color.</li>
 <li>If the alpha component of the color is not equal to one, then return the serialization of the
 <code title="">rgba()</code> functional equivalent of the non-opaque color.</li>
 </ol>
 <p>The serialization of the <code title="">rgb()</code> functional equivalent is the concatenation of the following:</p>
 <ol>
 <li>The string "<code title="">rgb(</code>".</li>
 <li>The shortest base-ten integer serialization of the color's red component.</li>
 <li>The string "<code title="">, </code>".</li>
 <li>The shortest base-ten serialization of the color's green component.</li>
 <li>The string "<code title="">, </code>".</li>
 <li>The shortest base-ten serialization of the color's blue component.</li>
 <li>The string "<code title="">)</code>".</li>
 </ol>
 <p>The serialization of the <code title="">rgba()</code> functional equivalent is the concatenation of the following:</p>
 <ol>
 <li>The string "<code title="">rgba(</code>".</li>
 <li>The shortest base-ten serialization of the color's red component.</li>
 <li>The string "<code title="">, </code>".</li>
 <li>The shortest base-ten serialization of the color's green component.</li>
 <li>The string "<code title="">, </code>".</li>
 <li>The shortest base-ten serialization of the color's blue component.</li>
 <li>The string "<code title="">, </code>".</li>
 <li>The shortest serialization of the &lt;number&gt; that denotes the color's alpha component.</li>
 <li>The string "<code title="">)</code>".</li>
 </ol>

 <p>In the above rules, the string "<code title="">, </code>" denotes a COMMA (U+002C) followed by a single SPACE (U+0020).</p>

 <p>If &lt;color&gt; is a component of a specified value, then
 return the color as follows:</p>
 <ol>
 <li>If the color was explicitly specified by the author, then return the original, author specified color value.</li>
 <li>Otherwise, return the value that would be returned if the color were a component of a computed value.</li>
 </ol>
 <p class="XXX">Should author specified values be normalized for case? Or should original case be preserved?</p>
 </dd>
 <!--
   <dt>It is a system color</dt>

   <dd>See below (you use the representation given in the specification that
   defines the keyword).</dd>

   <dt>Alpha component is equal to 1.0</dt>

   <dd>The color is an uppercase six-digit hexadecimal value, prefixed with a
   <code title>#</code> character (U+0023 NUMBER SIGN), with the first two digits
   representing the red component, the next two digits representing the green
   component, and the last two digits representing the blue component, the
   digits being in the range 0-9 A-F (U+0030 to U+0039 and U+0041 to
   U+0046).</dd>

   <dt>Alpha component is less than 1.0</dt>

   <dd>The color is in the CSS <code title>rgba()</code> functional-notation format:
   the literal string <code title>rgba</code> (U+0072 U+0067 U+0062 U+0061) followed
   by a U+0028 LEFT PARENTHESIS, a <span>color component integer</span>
   representing the red component, a <span>color component separator</span>, a
   <span>color component integer</span> for the green component, a <span>color
   component separator</span>, a <span>color component integer</span> for the
   blue component, another <span>color component separator</span> a U+0030
   DIGIT ZERO, a U+002E FULL STOP (representing the decimal point), one or
   more digits in the range 0-9 (U+0030 to U+0039) representing the fractional
   part of the alpha value, and finally a U+0029 RIGHT PARENTHESIS.</dd>

   <dt>The keyword <code title>transparent</code> is used</dt>

   <dd>The color is <code title>rgba(0, 0, 0, 0)</code>.</dd>
 -->

 <dt>&lt;counter&gt;</dt>
 <dd>
  <p>The concatenation of:</p>
  <ol>
   <li><p>If &lt;counter&gt; has three CSS component values the string
   "<code title="">counters(</code>".</li>
   <li><p>If &lt;counter&gt; has two CSS component values the string
   "<code title="">counter(</code>".</li>
   <li><p>The result of
   <a href="#serialize-a-comma-separated-list" title="serialize a comma-separated list">serializing</a> the
   <a href="#serialize-a-css-component-value" title="serialize a CSS component value">serialized</a>
   CSS component values belonging to &lt;counter&gt; as list while omitting
   the last CSS component value if it is 'decimal'.</li>
   <li><p>"<code title="">)</code>" (U+0029).</li>
  </ol>
 </dd>

 <dt>&lt;frequency&gt;</dt>
 <dd><p>The frequency in hertz serialized as per &lt;number&gt; followed by
 the literal string "<code title="">hz</code>".</dd>

 <dt>&lt;identifier&gt;</dt>
 <dd><p>The identifier
 <a href="#serialize-an-identifier" title="serialize an identifier">escaped</a>.</dd>

 <dt>&lt;integer&gt;</dt>
 <dd><p>A base-ten integer using digits 0-9 (U+0030 to U+0039) in the
 shortest form possible, preceded by "<code title="">-</code>" (U+002D) if it is
 negative.</dd>

 <dt>&lt;length&gt;</dt>
 <dd>
  <p>A length of zero is represented by the literal string
  "<code title="">0px</code>".</p>

  <p>Absolute lengths: the number of millimeters serialized as per
  &lt;number&gt; followed by the literal string "<code title="">mm</code>".</p>
  <p class="XXX">Rumor has it absolute lengths will become relative
  lengths. Centimeters would be compatible with &lt;resolution&gt;...</p>

  <p>Relative lengths: the &lt;number&gt; component serialized as per
  &lt;number&gt; followed by the unit in its canonical form as defined in its
  respective specification.</p>
 </dd>

 <dt>&lt;number&gt;</dt>
 <dd><p class="XXX">Browsers seem to use ToString(), but that might give a
 significand which according to some is teh evil (and also currently does
 not parse correctly).</dd>

 <dt>&lt;percentage&gt;</dt>
 <dd><p>The &lt;number&gt; component serialized as per &lt;number&gt; followed
 by the literal string "<code title="">%</code>" (U+0025).</dd>

 <dt>&lt;resolution&gt;</dt>
 <dd><p>The resolution in dots per centimeter serialized as per
 &lt;number&gt; followed by the literal string "<code title="">dpcm</code>".</dd>

 <dt>&lt;shape&gt;</dt>
 <dd><p>The string "<code title="">rect(</code>", followed by the result
 of <a href="#serialize-a-comma-separated-list" title="serialize a comma-separated list">serializing</a> the
 <a href="#serialize-a-css-component-value" title="serialize a CSS component value">serialized</a>
 CSS component values belonging to &lt;shape&gt; as list, followed by
 "<code title="">)</code>" (U+0029).</dd>

 <dt>&lt;string&gt;</dt>
 <dt>&lt;family-name&gt;</dt>
 <dt>&lt;specific-voice&gt;</dt>
 <dd><p>The string
 <a href="#serialize-a-string" title="serialize a string">string escaped</a>.</dd>

 <dt>&lt;time&gt;</dt>
 <dd><p>The time in seconds serialized as per &lt;number&gt; followed by
 the literal string "<code title="">s</code>".</dd>

 <dt>&lt;uri&gt;</dt>
 <dd><p>The <a class="external" href="http://url.spec.whatwg.org/#concept-absolute-url" title="concept-absolute-url">absolute URL</a>
 <a href="#serialize-a-url" title="serialize a URL">URL escaped</a>.</dd>
</dl>

<p>
 &lt;absolute-size&gt;,
 &lt;border-width&gt;,
 &lt;border-style&gt;,
 &lt;bottom&gt;,
 &lt;generic-family&gt;,
 &lt;generic-voice&gt;,
 &lt;left&gt;,
 &lt;margin-width&gt;,
 &lt;padding-width&gt;,
 &lt;relative-size&gt;,
 &lt;right&gt;, and
 &lt;top&gt;,
 are considered macros by this specification. They all represent instances
 of components outlined above.</p>

<p class="XXX">One idea is that we can remove this section somewhere in
the CSS3/CSS4 timeline by moving the above definitions to the drafts that
define the CSS components.</p>


<h5 id="examples-0"><span class="secno">6.6.2.1 </span>Examples</h5>

<p>Here are some examples of before and after results on specified values.
The before column could be what the author wrote in a style sheet, while
the after column shows what querying the DOM would return.</p>

<div class="example">
 <table>
  <thead>
   <tr><th>Before<th>After
  <tbody>
   <tr><td><code title="">background: none</code><td><code title="">background: rgba(0, 0, 0, 0)</code>
   <tr><td><code title="">outline: none</code><td><code title="">outline: invert</code>
   <tr><td><code title="">border: none</code><td><code title="">border: medium</code>
   <tr><td><code title="">list-style: none</code><td><code title="">list-style: disc</code>
   <tr><td><code title="">margin: 0 1px 1px 1px</code><td><code title="">margin: 0px 1px 1px</code>
   <tr><td><code title="">azimuth: behind left</code><td><code title="">azimuth: 220deg</code>
   <tr><td><code title="">font-family: a, 'b"', serif</code><td><code title="">font-family: "a", "b\"", serif</code>
   <tr><td><code title="">content: url('h)i') '\[\]'</code><td><code title="">content: url("h)i") "[]"</code>
   <tr><td><code title="">azimuth: leftwards</code><td><code title="">azimuth: leftwards</code>
   <tr><td><code title="">color: rgb(18, 52, 86)</code><td><code title="">color: #123456</code>
   <tr><td><code title="">color: rgba(000001, 0, 0, 1)</code><td><code title="">color: #000000</code>
 </table>

 <p class="XXX">Some of these need to be updated per the new rules.</p>
</div>


<h2 id="dom-access-to-css-declaration-blocks"><span class="secno">7 </span>DOM Access to CSS Declaration Blocks</h2>


<h3 id="the-elementcssinlinestyle-interface"><span class="secno">7.1 </span>The <code><a href="#elementcssinlinestyle">ElementCSSInlineStyle</a></code> Interface</h3>

<p>The <code><a href="#elementcssinlinestyle">ElementCSSInlineStyle</a></code> interface provides access to inline style properties of an element.</p>

<pre class="idl">[NoInterfaceObject]
interface <dfn id="elementcssinlinestyle">ElementCSSInlineStyle</dfn> {
  [PutForwards=<a href="#dom-cssstyledeclaration-csstext" title="dom-CSSStyleDeclaration-cssText">cssText</a>] readonly attribute <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#dom-elementcssinlinestyle-style" title="dom-ElementCSSInlineStyle-style">style</a>;
};</pre>

<p>The <dfn id="dom-elementcssinlinestyle-style" title="dom-ElementCSSInlineStyle-style"><code>style</code></dfn> attribute must return a <a href="#css-declaration-block">CSS declaration block</a> with the
<a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a> being set to the declarations
specified in the element's <code title="">style</code> content attribute. If the
<code title="">style</code> content attribute is absent, the object represents an empty
declaration. Mutating the <code><a href="#cssstyledeclaration">CSSStyleDeclaration</a></code> object must set the
<code title="">style</code> content attribute on the element to the
<a href="#serialize-a-css-declaration-block" title="serialize a CSS declaration block">serialization</a> of the
<code><a href="#cssstyledeclaration">CSSStyleDeclaration</a></code>'s <a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a>.
The same object must be returned each time. The object is live; if the
<code title="">style</code> content attribute is set, changed or removed, the <a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a> must be
updated as appropriate.</p>



<h3 id="extensions-to-the-window-interface"><span class="secno">7.2 </span>Extensions to the <code title="">Window</code> Interface</h3>

<pre class="idl">partial interface <a class="external" href="http://www.whatwg.org/specs/web-apps/current-work/multipage/browsers.html#window">Window</a> {
  <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#dom-window-getcomputedstyle" title="dom-Window-getComputedStyle">getComputedStyle</a>(<a class="external" href="http://dom.spec.whatwg.org/#element">Element</a> elt, <!--
  -->optional DOMString pseudoElt);
};</pre>

<p>The <dfn id="dom-window-getcomputedstyle" title="dom-Window-getComputedStyle"><code>getComputedStyle(<var title="">elt</var>, <var title="">pseudoElt</var>)</code></dfn> method must run these
steps:</p>
<ol>
 <li><p>Let <var title="">doc</var> be the
 <code class="external"><a href="http://dom.spec.whatwg.org/#document">Document</a></code>
 associated with the <code class="external"><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/browsers.html#window">Window</a></code> object on
 which the method was invoked.</li>
 <li><p>Let <var title="">obj</var> be <var title="">elt</var>.</li>
 <li><p>If <var title="">pseudoElt</var> is as an
 <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for
 either ':before' or '::before' let
 <var title="">obj</var> be the <a href="#x::before-pseudo-element">::before pseudo-element</a> of
 <var title="">elt</var>.</li>
 <li><p>If <var title="">pseudoElt</var> is as an
 <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for
 either ':after' or '::after' let
 <var title="">obj</var> be the <a href="#x::after-pseudo-element">::after pseudo-element</a> of
 <var title="">elt</var>.</li>
 <li>
  <p>Return a <a href="#css-declaration-block">CSS declaration block</a> with the
  <a href="#concept-css-declaration-block-readonly-flag" title="concept-css-declaration-block-readonly-flag">readonly flag</a> set and the
  <a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a> set to all properties
  the user agent supports with the value being the <a href="#resolved-value">resolved value</a>
  computed for <var title="">obj</var> using the style rules associated
  with <var title="">doc</var>.</p>
  <p class="note">This means that even if <var title="">obj</var> is in a
  different document (e.g. one fetched via <code title="">XMLHttpRequest</code>) it
  will still use the style rules associated with the document that is
  associated with the global object on which
  <code title="dom-Window-getComputedStyle"><a href="#dom-window-getcomputedstyle">getComputedStyle()</a></code> was
  invoked to compute the <a href="#css-declaration-block">CSS declaration block</a>.</p>
 </li>
</ol>
<p class="note">Because of historical IDL limitations the <code title="dom-Window-getComputedStyle"><a href="#dom-window-getcomputedstyle">getComputedStyle()</a></code> method used to be on
a separate interface, <code title="">ViewCSS</code>.</p>



<h3 id="the-getstyleutils-interface"><span class="secno">7.3 </span>The <code title="">GetStyleUtils</code> Interface</h3>

<p>The <dfn id="associated-document">associated document</dfn> of an object <var title="">obj</var> is <var title="">obj</var>'s <a class="external" href="http://dom.spec.whatwg.org/#concept-node-document" title="concept-node-document">node
document</a> if <var title="">obj</var> is an <code class="external"><a href="http://dom.spec.whatwg.org/#element">Element</a></code> object, or <var title="">obj</var>'s associated
<code class="external"><a href="http://dom.spec.whatwg.org/#element">Element</a></code> object's <a class="external" href="http://dom.spec.whatwg.org/#concept-node-document" title="concept-node-document">node document</a> if <var title="">obj</var> is a
<code><a href="#pseudoelement">PseudoElement</a></code> object.</p>

<pre class="idl">[NoInterfaceObject]
interface <dfn id="getstyleutils">GetStyleUtils</dfn> {
  readonly attribute <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#dom-getstyleutils-specifiedstyle" title="dom-GetStyleUtils-specifiedStyle">specifiedStyle</a>;
  readonly attribute <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#dom-getstyleutils-defaultstyle" title="dom-GetStyleUtils-defaultStyle">defaultStyle</a>;
  readonly attribute <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#dom-getstyleutils-computedstyle" title="dom-GetStyleUtils-computedStyle">computedStyle</a>;
  readonly attribute <a href="#cssstyledeclaration">CSSStyleDeclaration</a> <a href="#dom-getstyleutils-usedstyle" title="dom-GetStyleUtils-usedStyle">usedStyle</a>;
};</pre>

<p class="atrisk">The <dfn id="dom-getstyleutils-specifiedstyle" title="dom-GetStyleUtils-specifiedStyle"><code>specifiedStyle</code></dfn> attribute must return a <a href="#css-declaration-block">CSS declaration block</a>
with the <a href="#concept-css-declaration-block-readonly-flag" title="concept-css-declaration-block-readonly-flag">readonly flag</a> set and the
<a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a> set to all properties
the user agent supports with the value being the <a href="#specified-value">specified value</a>
computed for the <a class="external" href="http://dom.spec.whatwg.org/#context-object">context object</a> using the style rules associated
with the <a class="external" href="http://dom.spec.whatwg.org/#context-object">context object</a>'s <a href="#associated-document">associated document</a>.</p>

<p class="atrisk">The <dfn id="dom-getstyleutils-defaultstyle" title="dom-GetStyleUtils-defaultStyle"><code>defaultStyle</code></dfn> attribute must return a <a href="#css-declaration-block">CSS declaration block</a> with
the <a href="#concept-css-declaration-block-readonly-flag" title="concept-css-declaration-block-readonly-flag">readonly flag</a> set and the
<a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a> set to all properties the user agent supports with the value being the <a href="#computed-value">computed
value</a> computed for the <a class="external" href="http://dom.spec.whatwg.org/#context-object">context object</a> using the user agent-level style rules and user-level style rules associated with
the <a class="external" href="http://dom.spec.whatwg.org/#context-object">context object</a>'s <a href="#associated-document">associated document</a>, ignoring transitions, animations, author-level style
rules, author-level presentational hints and override-level style rules.</p>

<p class="atrisk">The <dfn id="dom-getstyleutils-computedstyle" title="dom-GetStyleUtils-computedStyle"><code>computedStyle</code></dfn> attribute must return a <a href="#css-declaration-block">CSS declaration block</a> with
the <a href="#concept-css-declaration-block-readonly-flag" title="concept-css-declaration-block-readonly-flag">readonly flag</a> set and the
<a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a> set to all properties
the user agent supports with the value being the <a href="#computed-value">computed value</a>
computed for the <a class="external" href="http://dom.spec.whatwg.org/#context-object">context object</a> using the style rules associated
with the <a class="external" href="http://dom.spec.whatwg.org/#context-object">context object</a>'s <a href="#associated-document">associated document</a>.</p>

<p class="atrisk">The <dfn id="dom-getstyleutils-usedstyle" title="dom-GetStyleUtils-usedStyle"><code>usedStyle</code></dfn> attribute must return a <a href="#css-declaration-block">CSS declaration block</a> with the
<a href="#concept-css-declaration-block-readonly-flag" title="concept-css-declaration-block-readonly-flag">readonly flag</a> set and the
<a href="#concept-css-declaration-block-declarations" title="concept-css-declaration-block-declarations">declarations</a> set to all properties
the user agent supports with the value being the <a href="#used-value">used value</a>
computed for the <a class="external" href="http://dom.spec.whatwg.org/#context-object">context object</a> using the style rules associated
with the <a class="external" href="http://dom.spec.whatwg.org/#context-object">context object</a>'s <a href="#associated-document">associated document</a>.</p>



<h3 id="extensions-to-the-element-interface"><span class="secno">7.4 </span>Extensions to the <code title="">Element</code> Interface</h3>

<pre class="idl">partial interface <a class="external" href="http://dom.spec.whatwg.org/#element">Element</a> {
  <a href="#pseudoelement">PseudoElement</a>? <a href="#dom-element-pseudo" title="dom-Element-pseudo">pseudo</a>(DOMString pseudoElt);
};

<a class="external" href="http://dom.spec.whatwg.org/#element">Element</a> implements <a href="#getstyleutils">GetStyleUtils</a>;</pre>

<p class="atrisk">The <dfn id="dom-element-pseudo" title="dom-Element-pseudo"><code>pseudo(<var title="">pseudoElt</var>)</code></dfn> method, when invoked, must run the following steps:
<ol>
 <li><p>If <var title="">pseudoElt</var> is as an <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for either ':before' or
 '::before' return the <code><a href="#pseudoelement">PseudoElement</a></code> representing the <a href="#x::before-pseudo-element">::before pseudo-element</a> of the
 <a class="external" href="http://dom.spec.whatwg.org/#context-object">context object</a>.</li>
 <li><p>If <var title="">pseudoElt</var> is as an <a class="external" href="http://dom.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for either ':after' or
 '::after' return the <code><a href="#pseudoelement">PseudoElement</a></code> representing the <a href="#x::after-pseudo-element">::after pseudo-element</a> of the
 <a class="external" href="http://dom.spec.whatwg.org/#context-object">context object</a>.</li>
 <li><p>Return null.</li>
</ol>
<p>When invoked with an argument that returns a <code><a href="#pseudoelement">PseudoElement</a></code> object representing a particular pseudo-element, the same object must be
returned as returned by an earlier call that represent the same pseudo-element.</p>



<h3 id="the-pseudoelement-interface"><span class="secno">7.5 </span>The <code title="">PseudoElement</code> Interface</h3>
  
<p class="atrisk">The <code><a href="#pseudoelement">PseudoElement</a></code> interface is used for representing CSS pseudo-elements. A <code><a href="#pseudoelement">PseudoElement</a></code> object is associated with an
<code class="external"><a href="http://dom.spec.whatwg.org/#element">Element</a></code> object.</p>

<pre class="idl">interface <dfn id="pseudoelement">PseudoElement</dfn> {
};

<a href="#pseudoelement">PseudoElement</a> implements <a href="#getstyleutils">GetStyleUtils</a>;</pre>


<h2 id="resolved-values"><span class="secno">8 </span>Resolved Values</h2>

<p><code title="dom-Window-getComputedStyle"><a href="#dom-window-getcomputedstyle">getComputedStyle()</a></code> was
historically defined to return the "computed value" of an element or
pseudo-element. However, the concept of "computed value" changed between
revisions of CSS while the implementation of
<code title="dom-Window-getComputedStyle"><a href="#dom-window-getcomputedstyle">getComputedStyle()</a></code> had to
remain the same for compatibility with deployed scripts. To address this
issue this specification introduces the concept of a
<dfn id="resolved-value">resolved value</dfn>.</p>

<p>The <a href="#resolved-value">resolved value</a> for a given property can be determined
as follows:</p>

<dl class="switch">
 <!--
 We want to treat shorthand properties like any other value basically.

 <dt>'background'
 <dt>'border'
 <dt>'border-collapse'
 <dt>'border-color'
 <dt>'border-spacing'
 <dt>'border-style'
 <dt>'border-top'
 <dt>'border-right'
 <dt>'border-bottom'
 <dt>'border-left'
 <dt>'border-width'
 <dt>'font'
 <dt>'list-style'
 <dt>'margin'
 <dt>'outline'
 <!- - overflow is not - ->
 <dt>'padding'
 <dt>'pause'
 <dd>
  <p>There is no <span>resolved value</span>.</p>
 </dd>
 -->

 <dt>'line-height'</dt>
 <dd><p>The <a href="#resolved-value">resolved value</a> is the <a href="#used-value">used value</a>.</dd>

 <dt>'height'</dt>
 <dt>'margin'</dt>
 <dt>'margin-bottom'</dt>
 <dt>'margin-left'</dt>
 <dt>'margin-right'</dt>
 <dt>'margin-top'</dt>
 <dt>'padding'</dt>
 <dt>'padding-bottom'</dt>
 <dt>'padding-left'</dt>
 <dt>'padding-right'</dt>
 <dt>'padding-top'</dt>
 <dt>'width'</dt>
 <dd><p>If the property applies to the element or pseudo-element and the
 <a href="#resolved-value">resolved value</a> of the 'display' property is not
 'none', the <a href="#resolved-value">resolved value</a> is the
 <a href="#used-value">used value</a>. Otherwise the <a href="#resolved-value">resolved value</a> is the
 <a href="#computed-value">computed value</a>.</dd>

 <dt>'bottom'</dt>
 <dt>'left'</dt>
 <dt>'right'</dt>
 <dt>'top'</dt>
 <dd><p>If the property applies to a positioned element and the
 <a href="#resolved-value">resolved value</a> of the 'display' property is not
 'none', the <a href="#resolved-value">resolved value</a> is the
 <a href="#used-value">used value</a>. Otherwise the <a href="#resolved-value">resolved value</a> is the
 computed value.</dd>

 <dt>Any other property</dt>
 <dd><p>The <a href="#resolved-value">resolved value</a> is the <a href="#computed-value">computed value</a>.</dd>
</dl>


<h2 id="iana-considerations"><span class="secno">9 </span>IANA Considerations</h2>


<h3 id="default-style"><span class="secno">9.1 </span><dfn title="http-default-style"><code>Default-Style</code></dfn></h3>

<p>This section describes a header field for registration in the Permanent
Message Header Field Registry.
<!--<a href="XXX">[RFC3864]</a>--></p>

<dl>
 <dt>Header field name</dt>
 <dd>Default-Style</dd>
 <dt>Applicable protocol</dt>
 <dd>http</dd>
 <dt>Status</dt>
 <dd>standard</dd>
 <dt>Author/Change controller</dt>
 <dd>W3C</dd>
 <dt>Specification document(s)</dt>
 <dd>This document is the relevant specification.</dd>
 <dt>Related information</dt>
 <dd>None.</dd>
</dl>


<h2 class="no-num" id="references">References</h2>

<div id="anolis-references"><dl><dt id="refsCSS">[CSS]
<dd><cite><a href="http://www.w3.org/TR/CSS2/">CSS</a></cite>, Bert Bos, Tantek Çelik, Ian Hickson et al.. W3C.

<dt id="refsCSSNAMESPACES">[CSSNAMESPACES]
<dd><cite><a href="http://dev.w3.org/csswg/css-namespaces/">CSS Namespaces Module</a></cite>, Elika J. Etemad and Anne van Kesteren. W3C.

<dt id="refsCSSPAGE">[CSSPAGE]
<dd><cite><a href="http://dev.w3.org/csswg/css-page/">CSS Paged Media Module</a></cite>, Melinda Grant, Håkon Wium Lie, Elika J. Etemad et al.. W3C.

<dt id="refsDOM">[DOM]
<dd><cite><a href="http://dom.spec.whatwg.org/">DOM</a></cite>, Anne van Kesteren, Aryeh Gregor and Ms2ger. WHATWG.

<dt id="refsDOM2STYLE">[DOM2STYLE]
<dd><cite><a href="http://www.w3.org/TR/DOM-Level-2-Style/">Document Object Model (DOM) Level 2 Style Specification</a></cite>, Chris Wilson, Philippe Le Hégaret and Vidur Apparao. W3C.

<dt id="refsHTML">[HTML]
<dd><cite><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/">HTML</a></cite>, Ian Hickson. WHATWG.

<dt id="refsRFC2119">[RFC2119]
<dd><cite><a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a></cite>, Scott Bradner. IETF.

<dt id="refsSELECTORS">[SELECTORS]
<dd><cite><a href="http://dev.w3.org/csswg/selectors4/">Selectors Level 4</a></cite>, Elika J. Etemad. W3C.

<dt id="refsURL">[URL]
<dd><cite><a href="http://url.spec.whatwg.org/">URL</a></cite>, Anne van Kesteren. WHATWG.

<dt id="refsXML">[XML]
<dd><cite><a href="http://www.w3.org/TR/xml/">Extensible Markup Language</a></cite>, Tim Bray, Jean Paoli, C. M. Sperberg-McQueen et al.. W3C.

<dt id="refsXMLSS">[XMLSS]
<dd><cite><a href="http://www.w3.org/TR/xml-stylesheet/">Associating Style Sheets with XML documents 1.0 (Second Edition)</a></cite>, James Clark, Simon Pieters and Henry S. Thompson. W3C.

</dl></div>


<h2 class="no-num" id="change-history">Change History</h2>

<p>This section documents the primary technical changes of CSSOM related functionality, with a focus on changes to API signatures.</p>

<h3 class="no-num" id="changes-from-dom-2-style">Changes From DOM-2 Style</h3>

<ul>
<li><p>Remove definition of <code title="">CSSRule.UNKNOWN_RULE</code>, reserving its value (0) to prevent future reuse.</li>
<li><p>Remove definition of <code title="">DOMImplementationCSS</code> interface.</li>
</ul>


<h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

<p>The editors would like to thank

Alexey Feldgendler,
Björn Höhrmann,
Boris Zbasky,
Brian Kardell,
Christian Krebs,
Daniel Glazman,
David Baron,
<i>fantasai</i>,
Hallvord R. M. Steen,
Ian Hickson,
John Daggett,
Lachlan Hunt,
Morten Stenshorne,
Philip Taylor,
Robert O'Callahan,
Sjoerd Visscher,
<!--Simon Pieters,-->
Sylvain Galineau,
Tarquin Wilton-Jones, and
Zack Weinberg

for contributing to this specification.</p>

<p>Additional thanks to Ian Hickson for writing the
initial version of the alternative style sheets API and canonicalization
(now serialization) rules for CSS values.</p>

<!-- XXX NOTES

<style type=text/css;charset=utf-8> does create a StyleSheet in Firefox
and Opera, but does not create a StyleSheet in IE. I prefer IE.

<style type=TEXT/CSS> sets the style sheet type to text/css in Firefox and
TEXT/CSS in Opera and IE. I prefer Firefox.

<style> sets the style sheet location to the document location Firefox,
the empty string in IE, and null in Opera. I prefer Opera

<style media="x"> invokes .sheet.media.mediaText = "x"

<style> does not "have" a title

.cascadedStyle that returns less keywords than currentStyle, no inherit,
etc.

Markup style: http://krijnhoetmer.nl/irc-logs/whatwg/20100204#l-529
-->
 


