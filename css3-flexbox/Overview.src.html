<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>CSS Flexible Box Layout Module</title>
	<link rel="stylesheet" type="text/css" href="http://dev.w3.org/csswg/default.css">
	<link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/W3C-ED">
	<style>
	code.one-line { white-space: pre; }
	.code-and-figure {
		display: table;
		margin: 0 auto;
		border-spacing: 1em;
	}
	.code-and-figure > div {
		display: table-cell;
		vertical-align: middle;
	}
    :not(code) var { font-style: normal; color: #005A9C; }

    i { font-style: normal; }

    ol[start="0"] { counter-reset: list -1; }
    ol[start="0"],
    ol.continue { list-style: none; }
    ol[start="0"] > li,
    ol.continue > li { position: relative; counter-increment: list; }
    ol[start="0"] > li::before,
    ol.continue > li::before { content: counter(list) "."; position: absolute; left: -4.5em; width: 4em; text-align: right; }
	</style>
</head><body>

<div class="head">
	<!--logo-->

	<h1 id="head-box-flexible">CSS Flexible Box Layout Module</h1>
	<h2 class="no-num no-toc" id="w3c-working">[LONGSTATUS], [DATE]</h2>

	<dl>
		<dt>This version:
		<dd><a href="[VERSION]">http://www.w3.org/TR/[YEAR]/WD-css3-flexbox-[CDATE]/</a>
		<!--<dd><a href="http://dev.w3.org/csswg/[SHORTNAME]/">http://dev.w3.org/csswg/[SHORTNAME]/</a>-->

		<dt>Latest version:
		<!--<dd><a href="[LATEST]">[LATEST]</a>-->
		<dd><a href="http://www.w3.org/TR/css3-flexbox/">http://www.w3.org/TR/css3-flexbox/</a>

		<dt>Editor's Draft:
		<dd><a href="http://dev.w3.org/csswg/css3-flexbox/">http://dev.w3.org/csswg/css3-flexbox/</a>

		<dt>Previous versions:
		<dd><a href="http://www.w3.org/TR/2012/WD-css3-flexbox-20120322/">http://www.w3.org/TR/2012/WD-css3-flexbox-20120322/</a>
		<dd><a href="http://www.w3.org/TR/2011/WD-css3-flexbox-20111129/">http://www.w3.org/TR/2011/WD-css3-flexbox-20111129/</a>
		<dd><a href="http://www.w3.org/TR/2011/WD-css3-flexbox-20110322/">http://www.w3.org/TR/2011/WD-css3-flexbox-20110322/</a>
		<dd><a href="http://www.w3.org/TR/2009/WD-css3-flexbox-20090723/">http://www.w3.org/TR/2009/WD-css3-flexbox-20090723/</a>

		<dt>Issues List:
        <dd><a href="https://www.w3.org/Bugs/Public/buglist.cgi?product=CSS&amp;component=Flexbox&amp;resolution=---">Bugzilla Bugs for Flexbox</a>

		<dt>Discussion:
		<dd><a href="http://lists.w3.org/Archives/Public/www-style/">www-style@w3.org</a> with subject line "<code>[css3-flexbox] …message topic…</code>"

		<dt>Editors:
		<dd><a href="http://www.xanthir.com/contact">Tab Atkins Jr.</a>, Google Inc.
		<dd><a href="http://fantasai.inkedblade.net/contact">Elika J. Etemad</a>, Mozilla
		<dd>Alex Mogilevsky, Microsoft Corporation, <a href="mailto:alexmog@microsoft.com">alexmog@microsoft.com</a>

		<dt>Authors and former editors:
		<dd>L. David Baron, Mozilla Corporation, <a href="mailto:dbaron@dbaron.org">dbaron@dbaron.org</a>
		<dd>Neil Deakin, Mozilla Corporation, <a href="mailto:enndeakin@gmail.com">enndeakin@gmail.com</a>
		<dd>Ian Hickson, formerly of Opera Software, <a href="mailto:ian@hixie.ch">ian@hixie.ch</a>
		<dd>David Hyatt, formerly of Netscape Corporation, <a href="mailto:hyatt@apple.com">hyatt@apple.com</a>
	</dl>
	<!--copyright-->

	<hr title="Separator for header">
</div>

<h2 class="no-num no-toc" id="abstract">
Abstract</h2>

	<p>
		The specification describes a CSS box model optimized for user interface design. 
		In the flex layout model, 
		the children of a flex container can be laid out in any direction, 
		and can "flex" their sizes, 
		either growing to fill unused space 
		or shrinking to avoid overflowing the parent.  
		Both horizontal and vertical alignment of the children can be easily manipulated. 
		Nesting of these boxes (horizontal inside vertical, or vertical inside horizontal) can be used to build layouts in two dimensions.

<h2 class="no-num no-toc" id="status">Status of this document</h2>
<!--status-->

	<p>
		This specification is a <strong>Last Call Working Draft</strong>.
		All persons are encouraged to review this document and
		<strong>send comments to the <a href="http://lists.w3.org/Archives/Public/www-style/">www-style</a> mailing list</strong> as described above.
		The <strong>deadline for comments</strong> is <strong>3 July 2012</strong>.

<h2 class="no-num no-toc" id="table">Table of contents</h2>
<!--toc-->


<h2 id="intro">
Introduction</h2>

	<p><em>This section is not normative.</em>

	<p>CSS 2.1 defined four layout modes &mdash; algorithms which determine the size and position of boxes based on their relationships with their sibling and ancestor boxes: block layout, designed for laying out documents; inline layout, designed for laying out text; table layout, designed for laying out information in a tabular format; and positioned layout, designed for very explicit positioning without much regard for other elements in the document. This module introduces a new layout mode, flex layout, which is designed for laying out more complex applications and webpages.

	<p>Flex layout is superficially similar to block layout.  It lacks many of the more complex text or document-formatting properties that can be used in block layout, such as 'float' and 'columns', but in return it gains more simple and powerful tools for aligning its contents in ways that webapps and complex web pages often need.  

    <p>The contents of a flex container can be laid out in any direction (left, right, down, or even up!), can have their order swapped around dynamically (i.e., display order is independent of source order), and can "flex" their sizes and positions to respond to the available space.  If a flex container is <i>multi-line</i>, the flex items flow in two dimensions, wrapping into separate lines in a fashion similar to how text is wrapped into multiple lines.

	<div class="example">
		<p>For example, the following HTML snippet uses a flex container to create a toolbar with icons.  The flex container is horizontal, and the children's widths don't fill the flex container's width, so the additional space is distributed around and between the children.  As the flex container grows (perhaps because the user is viewing the page on a wider screen), the children spread out evenly and automatically:

		<pre>
&lt;ul>
  &lt;li>&lt;button>&lt;img src='new.svg' alt="New">&lt;/button>&lt;/li>
  &lt;li>&lt;button>&lt;img src='upload.svg' alt="Upload">&lt;/button>&lt;/li>
  &lt;li>&lt;button>&lt;img src='save.svg' alt="Save">&lt;/button>&lt;/li>
  &lt;li>&lt;button>&lt;img src='trash.svg' alt="trash">&lt;/button>&lt;/li>
&lt;/ul>
&lt;style>
ul { display: flex; justify-content: space-around; }
/* Irrelevant styling for this example removed. */
&lt;/style></pre>

		<div class='figure'>
			<img src="images/toolbar-example.svg" width=400 height=140 alt>
			<p class='caption'>Example rendering of the above code snippet, at two different flex container widths.
		</div>
	</div>

<h3 id="placement">
Module interactions</h3>

	<p>This module extends the definition of the 'display' property.

<h3 id="values">
Values</h3>

	<p>This specification follows the <a href="http://www.w3.org/TR/CSS21/about.html#property-defs">CSS property definition conventions</a> from [[!CSS21]]. Value types not defined in this specification are defined in CSS Level 2 Revision 1 [[!CSS21]]. Other CSS modules may expand the definitions of these value types: for example [[CSS3VALUES]], when combined with this module, expands the definition of the &lt;length&gt; value type as used in this specification.

	<p>In addition to the property-specific values listed in their definitions, all properties defined in this specification also accept the <a href="http://www.w3.org/TR/CSS21/cascade.html#value-def-inherit">''inherit''</a> keyword as their property value. For readability it has not been repeated explicitly.

<h2 id='box-model'>
Flex Layout Box Model</h2>

	<p>
		An element with ''display:flex'' or ''display:inline-flex'' is a <i>flex container</i>.
		Children of a flex container are called <i>flex items</i> and are laid out using the flex layout model.

	<p>Unlike block layout, which is normally biased towards laying things out vertically, and inline layout, which is normally biased toward laying things out horizontally, the flex layout algorithm is agnostic as to the direction the flex container happens to be laid out in.  To make it easier to talk about flex layout in a general way, we will define several direction-agnostic terms here to make the rest of the spec easier to read and understand.

	<div class='figure'>
		<img src='images/flex-direction-terms.svg' width=510 height=300 alt>
		<p class='caption'>An illustration of the various directions and sizing terms used in this specification, respectively for ''row'' and ''column'' flex containers.
	</div>

	<p>
		The <dfn>main axis</dfn> of a flex container is the axis along which <i>flex items</i> are laid out.  
		The <i>flex items</i> are ordered 
		such that they start on the <dfn>main-start</dfn> side of the flex container, 
		and go toward the <dfn>main-end</dfn> side.  
		A <i>flex item's</i> width or height, 
		whichever is in the <i>main dimension</i>, 
		is the item's <dfn>main size</dfn>.  
		The <i>flex item's</i> <dfn>main size property</dfn> is 
		either the 'width' or 'height' property, 
		whichever is in the <i>main dimension</i>.

	<p>
		The axis perpendicular to the <i>main axis</i> is called the <dfn>cross axis</dfn>, 
		and similarly has <dfn>cross-start</dfn> and <dfn>cross-end</dfn> sides defined.  
		The width or height of a <i>flex item</i>, 
		whichever is in the <i>cross dimension</i>, 
		is the item's <dfn>cross size</dfn>, 
		and similarly the <dfn>cross size property</dfn> is 
		whichever of 'width' or 'height' that is in the <i>cross dimension</i>.

	<p>
		The contents of a flex container can be easily and powerfully manipulated with a handful of properties.  
		Most significantly, 
		<i>flex items</i> can "flex" their <i>main size</i> by using the 'flex' property.  
		This "flexing" allows the items to get bigger or smaller based on the available space in the page.  
		If there is leftover space in the flex container after all of the <i>flex items</i> have finished flexing, 
		the items can be aligned, centered, or distributed with the 'justify-content' property.  
		<i>Flex items</i> can also be completely rearranged within the flex container with the 'order' property.

	<p>
		In the <i>cross axis</i>, 
		<i>flex items</i> can either "stretch" to fill the available space 
		or be aligned within the space with the 'align-items' property.  
		If a flex container is <i>multi-line</i>, 
		new lines are added in the <i>cross-end</i> direction, 
		and can similarly be aligned, centered, or distributed 
		within the flex container with the 'align-content' property.


<h2 id='flex-containers'>
Flex Containers: the ''flex'' and ''inline-flex'' 'display' values</h2>

	<table class="propdef">
		<tr>
			<th>Name:
			<td>display
		<tr>
			<th><a href="#values">New value</a>:
			<td><dfn id='display-flex'>flex</dfn> | <dfn id='display-inline-flex'>inline-flex</dfn>
	</table>

	<p>
		An element whose computed 'display' is either ''flex'' or ''inline-flex''
		is a <dfn>flex container</dfn>,
		and establishes a new <dfn>flex formatting context</dfn> for its contents.  
		This is the same as establishing a block formatting context,
		except that flex layout is used instead of block layout: 
		floats do not intrude into the flex container, 
		and the flex container's margins do not collapse with the margins of its contents.  
		Additionally, 
		each of the <i>flex items</i> establishes a new formatting context for its contents.

	<p>
		The ''flex'' value makes the flex container a block-level element.  
		The ''inline-flex'' value makes the flex container an atomic inline-level element.

	<p>
		Flex containers are not block containers, 
		and so some properties that were designed with the assumption of block layout don't apply in the context of flex layout.  
		In particular:

	<ul>
		<li>
			all of the 'column-*' properties in the Multicol module have no effect on a flex container.

		<li>
			'float' and 'clear' have no effect on a <i>flex item</i>.
			Using 'float' on an element still causes that element's 'display' property to compute to ''block'', 
			and thus 'float' may affect whether an element becomes a flex item
			or is wrapped in one.
			(See <a href="http://www.w3.org/TR/CSS2/visuren.html#dis-pos-flo">CSS 2.1 Chapter 9.7</a>.)

		<li>
			'vertical-align' has no effect on a flex item.
	</ul>

	<p>
		If an element's specified value for 'display' is ''inline-flex'' 
		and the element is floated or absolutely positioned, 
		the computed value of 'display' is ''flex''.
		The table in <a href="http://www.w3.org/TR/CSS2/visuren.html#dis-pos-flo">CSS 2.1 Chapter 9.7</a> is thus amended 
		to contain an additional row, 
		with ''inline-flex'' in the "Specified Value" column 
		and ''flex'' in the "Computed Value" column.

	<p>
		The baseline of a flex container is determined as follows:

	<ul>
		<li>
			If any of the <i>flex items</i> on the flex container's first line 
			(after reordering with 'order')
			have a computed value of ''baseline'' for 'align-self', 
			the flex container's baseline is the baseline of those <i>flex items</i>.

		<li>
			Otherwise, if the flex container has at least one <i>flex item</i>,
			and the baseline of its first <i>flex item</i>
			(after reordering with 'order')
			is parallel to the flex container's <i>main-axis</i>,
			the flex container's baseline is the baseline of its first <i>flex item</i>.

		<li>
			Otherwise, the flex container's baseline is the "after" edge of its content box.
	</ul>

<h2 id='flex-items'>
Flex Items</h2>

	<p>
		The flex layout algorithm operates on boxes generated by <dfn title="flex item|flex item's" id="flex-item">flex items</dfn>.  
		Each of the following becomes a <i>flex item</i>:

	<ol>
		<li>
			A block-level child of a flex container

		<li>
			An atomic inline-level child of a flex container

		<li>
			An HTML 
			<code>&lt;img></code>, 
			<code>&lt;canvas></code>,
			<code>&lt;svg></code>,
			<code>&lt;math></code>,
			<code>&lt;audio></code>, 
			<code>&lt;video></code>, 
			<code>&lt;iframe></code>, 
			<code>&lt;object></code>,
			<code>&lt;embed></code>,
			<code>&lt;applet></code>,
			<code>&lt;progress></code>,
			<code>&lt;meter></code>,
			<code>&lt;input></code>,
			<code>&lt;button></code>,
			<code>&lt;select></code>,
			or <code>&lt;textarea></code> element.
			<span class='note'>Note: In other words, any element that is "intended to be" a replaced element, even if it becomes non-replaced (like an <code>&lt;object></code> that doesn't load and is replaced by its contents).</span>

		<li>
			An anonymous block wrapped around a contiguous run of non-replaced inline child elements.  
			However, if the anonymous block would contain solely an anonymous inline containing only whitespace, 
			the box is not generated, 
			as if it had ''display:none''.
	</ol>

	<p>
		Some values of 'display' trigger the generation of anonymous boxes.  
		For example, a ''table-cell'' child of a block container is fixed up by generating ''table'' and ''table-row'' elements around it.  
		This fixup must occur <em>before</em> a flex container's contents are checked to see if it's necessary to generate anonymous flex items.

	<p>
		The computed value for 'display' for elements that are <i>flex items</i> 
		must be determined by applying the table in <a href="http://www.w3.org/TR/CSS2/visuren.html#dis-pos-flo">CSS 2.1 Chapter 9.7</a>.
		<span class='note'>This is expected to be superseded by a future specification that defines a new 'display' value for flex items.</span>

	<div class="example">
		<p>Examples of flex items:
		<pre>
&lt;div style="display:flex">

    &lt;!-- flex item: block-level child -->
    &lt;div id="item1">block&lt;/div>

    &lt;!-- not a flex item, because it's out-of-flow -->
    &lt;!-- however, the placeholder it leaves behind is -->
    &lt;div id="not-an-item-A" style="position: absolute;">block&lt;/div>
    
    &lt;!-- flex item: block-level child -->
    &lt;div id="item3" style="display:table">table&lt;/div>
    
    &lt;!-- flex item: anonymous table wrapped around table-cell -->
    &lt;div id="item4" style="display:table-cell">table-cell&lt;/div> 

    &lt;!-- flex item: anonymous block box around inline content -->
    anonymous item 5

    &lt;!-- flex item: block-level child -->
    &lt;div id="item6">block&lt;/div>

    &lt;!-- flex item: anonymous block around inline content -->
    item 7
    &lt;span>
        item 7
        &lt;div id="not-an-item-B">item 7&lt;/div>
        item 7
    &lt;/span>

    &lt;!-- flex item: block-level replaced element -->
    &lt;iframe id="item8" style="display:block;">&lt;/iframe>

    &lt;!-- flex item: inline-level replaced element -->
    &lt;img id="item9">

    &lt;!-- flex item: atomic inline-level element -->
    &lt;button id="item10">button&lt;/button>

    &lt;!-- flex item: inline-table -->
    &lt;div id="item11" style="display:inline-table">table&lt;/div>

    &lt;!-- flex item: floated inline, which changes to a block -->
    &lt;span id="item12" style="float: left;">span&lt;/span>
&lt;/div></pre>

		<p>
			Notice that block element "not-an-item-B" is not a flex item, 
			because it's not a child element of the flex container,
			even though the inline &lt;span> is eventually broken around it by Block Layout.
			Similarly, 
			the block element "not-an-item-A" is not a flex item, 
			because absolutely positioned children have special treatment.
	</div>

	<p class='note'>
		Future display types may generate anonymous containers (e.g. ruby) or otherwise mangle the box tree (e.g. run-ins).
		It is intended that flex item determination run after these operations.

<h3 id='flex-item-margins'>
Flex Item Margins</h3>

	<p>
		The margins of adjacent <i>flex items</i> do not collapse.
		Auto margins absorb extra space in that dimension and can be used for alignment
		and to push adjacent flex items apart;
		see <a href="#auto-margins">Aligning with ''auto'' margins</a>.

<h3 id='abspos-flex-items'>
Out-of-flow Items</h3>

	<p>
		Absolutely positioned children of a flex container are not themselves <i>flex items</i>, 
		but they leave behind "placeholders" in their normal position in the box tree. 
		These placeholders are anonymous inline boxes with a width, height, and line-height of ''0'', 
		and they interact normally with the flexbox layout algorithm. 
		In particular, they'll trigger the creation of anonymous flex items, 
		or join neighboring inline elements in their anonymous flex items.

	<p>
		The <i>static position</i> of an absolutely positioned child of a flex container 
		(the position when the 'top'/'right'/'bottom'/'left' properties are ''auto''), then, 
		is the final position of its corresponding placeholder, after flex layout has been performed.

	<p class='note'>
		Note: In most cases, 
		this means that absolutely-positioned items have no effect on flex layout.
		However, when the flex container has ''justify-content: space-between'' or ''justify-content: space-around'', 
		the anonymous flex items wrapping a placeholder will cause there to be two packing spaces
		where there would otherwise be only one, 
		possibly resulting in increased space between two "real" items.

	<p class='note'>
		Note that any lineboxes generated solely due to placeholders
		will be <a href="http://www.w3.org/TR/CSS21/visuren.html#phantom-line-box">phantom line boxes</a>.

<h3 id='visibility-collapse'>
Collapsed Items</h3>

	<p>
		Specifying ''visibility:collapse'' on a flex item
		causes it to become a <dfn title="collapsed flex item|collapsed">collapsed flex item</dfn>,
		producing an effect similar to ''visibility:collapse'' on a table-row or table-column:
		the collapsed element is removed from rendering entirely,
		but leaves behind a "strut" that keeps the flex line's cross-size stable.
		Thus, if a flex container has only one flex line,
		dynamically collapsing or uncollapsing items
		is guaranteed to have no effect on the flex container's <i>cross size</i>
		and won't cause the rest of the page's layout to "wobble".
		Flex line wrapping <em>is</em> re-done after collapsing, however,
		so the cross-size of a flex container with multiple lines might or might not change.

	<p>
		Though collapsed flex items aren't rendered,
		they do appear in the <a href="http://www.w3.org/TR/CSS21/intro.html#formatting-structure">formatting struture</a>.
		Therefore, unlike on ''display:none'' items [[!CSS21]],
		effects that depend on an element appearing in the formatting structure
		(like incrementing counters or running animations and transitions)
		still operate on collapsed items.

	<p>
		To compute the size of the strut, flex layout is first performed with all items uncollapsed,
		and then re-run with each collapsed item replaced by a strut that maintains
		the original cross-size of the item's original line.
		See the <a href="#layout-algorithm">Flex Layout Algorithm</a>
		for the normative definition of how ''visibility:collapse''
		interacts with flex layout.

	<p class='note'>
		Note that using ''visibility:collapse'' on any flex items
		will cause the flex layout algorithm to repeat partway through,
		re-running the most expensive steps.
		It's recommended that authors continue to use ''display:none'' to hide items
		if the items will not be dynamically collapsed and uncollapsed,
		as that is more efficient for the layout engine.

<h3 id='min-size-auto'>
Implied Minimum Size of Flex Items</h3>

	<p>
		To provide a more reasonable default minimum size for flex containers,
		this specification introduces a new <a href="#min-auto">''auto''</a> value as the initial value
		of the 'min-width' and 'min-height' properties
		defined in CSS 2.1. [[!CSS21]]

	<table class="propdef">
		<tr>
			<th>Name:
			<td>min-width, min-height
		<tr>
			<th><a href="#values">New value</a>:
			<td>auto
		<tr>
			<th>New Initial Value:
			<td><strong title="min-width/height:auto">auto</strong>
		<tr>
			<th>New Computed Value:
			<td>the percentage as specified or the absolute length or a keyword
	</table>

	<dl>
		<dt><dfn title="min-width/height:auto" id='min-auto'>auto</dfn>
		<dd>
			On a flex item,
			this keyword indicates a minimum size of the min-content size.
			<p class='note'>
				It is intended that this will compute to the ''min-content'' keyword
				when the specification defining it (<a href="http://www.w3.org/TR/css3-writing-modes/#intrinsic-sizing">Writing Modes Appendix D</a>) is sufficiently mature.
			<p>
				On any other element,
				this keyword computes to ''0''
				(unless otherwise defined by a future specification).
	</dl>



<h2>
Ordering and Orientation</h2>

	<p>
		The contents of a flex container can be laid out in any direction and in any order. 
		This allows an author to trivially achieve effects that would previously have required complex or fragile methods, 
		such as hacks using the 'float' and 'clear' properties.
		This functionality is exposed through the 'flex-direction', 'flex-wrap', and 'order' properties.

<h3 id='flex-direction-property'>
Flex Flow Direction: the 'flex-direction' property</h3>

	<table class=propdef>
		<tr>
			<th>Name:</th>
			<td><dfn>flex-direction</dfn>
		<tr>
			<th><a href="#values">Value</a>:
			<td>row | row-reverse | column | column-reverse
		<tr>
			<th>Initial:
			<td>row
		<tr>
			<th>Applies To:
			<td>flex containers
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed Value:
			<td>specified value
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Animatable:
			<td>no
		<tr>
			<th>Canonical Order:
			<td><abbr title="follows order of property value definition">per grammar</abbr>
	</table>

	<p>
		The 'flex-direction' property specifies how <i>flex items</i> are placed in the flex container, 
		by setting the direction of the flex container's <i>main axis</i>.  
		This determines the direction that flex items are laid out in.

	<dl>
		<dt><dfn id='flex-flow-row'>''row''</dfn>
		<dd>
			The flex container's <i>main axis</i> has the same orientation as the inline axis of the current <a href="http://www.w3.org/TR/css3-writing-modes/#writing-mode">writing mode</a> 
			(the primary direction that text is laid out in).  
			The <i>main-start</i> and <i>main-end</i> directions are equivalent to the <a href="http://www.w3.org/TR/css3-writing-modes/#start">start</a> and <a href="http://www.w3.org/TR/css3-writing-modes/#end">end</a> directions, respectively, 
			of the current <a href="http://www.w3.org/TR/css3-writing-modes/#writing-mode">writing mode</a>.

		<dt><dfn id='flex-flow-row-reverse'>''row-reverse''</dfn>
		<dd>
			Same as ''row'', 
			except the <i>main-start</i> and <i>main-end</i> directions are swapped.

		<dt><dfn id='flex-flow-column'>''column''</dfn>
		<dd>
			The flex container's <i>main axis</i> has the same orientation as the block axis of the current <a href="http://www.w3.org/TR/css3-writing-modes/#writing-mode">writing mode</a> 
			(the primary direction that blocks are laid out in).  
			The <i>main-start</i> and <i>main-end</i> directions are equivalent to the <a href="http://www.w3.org/TR/css3-writing-modes/#before">before</a> and <a href="http://www.w3.org/TR/css3-writing-modes/#after">after</a> directions, respectively, 
			of the current <a href="http://www.w3.org/TR/css3-writing-modes/#writing-mode">writing mode</a>.

		<dt><dfn id='flex-flow-column-reverse'>''column-reverse''</dfn>
		<dd>
			Same as ''column'', 
			except the <i>main-start</i> and <i>main-end</i> directions are swapped.
	</dl>

<h3 id='flex-wrap-property'>
Flex Line Wrapping: the 'flex-wrap' property</h3>

	<table class=propdef>
		<tr>
			<th>Name:</th>
			<td><dfn>flex-wrap</dfn>
		<tr>
			<th><a href="#values">Value</a>:
			<td>nowrap | wrap | wrap-reverse
		<tr>
			<th>Initial:
			<td>nowrap
		<tr>
			<th>Applies To:
			<td>flex containers
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed Value:
			<td>specified value
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Animatable:
			<td>no
		<tr>
			<th>Canonical Order:
			<td><abbr title="follows order of property value definition">per grammar</abbr>
	</table>

	<p>
		The 'flex-wrap' property controls whether the flex container is <i>single-line</i> or <i>multi-line</i>, 
		and the direction of the <i>cross-axis</i>, 
		which determines the direction new lines are stacked in.

	<dl>
		<dt><dfn id='flex-flow-nowrap'>''nowrap''</dfn>
		<dd>
			The flex container is <i>single-line</i>.  
			The <i>cross-start</i> direction is equivalent to either 
			the <a href="http://www.w3.org/TR/css3-writing-modes/#start">start</a> 
			or <a href="http://www.w3.org/TR/css3-writing-modes/#before">before</a> 
			direction of the current <a href="http://dev.w3.org/csswg/css3-writing-modes/#writing-mode">writing mode</a>, 
			whichever is in the <i>cross axis</i>, 
			and the <i>cross-end</i> direction is the opposite direction of <i>cross-start</i>.
			

		<dt><dfn id='flex-flow-wrap'>''wrap''</dfn>
		<dd>
			The flex container is <i>multi-line</i>.  
			The <i>cross-start</i> direction is equivalent to either
			the <a href="http://www.w3.org/TR/css3-writing-modes/#start">start</a> 
			or <a href="http://www.w3.org/TR/css3-writing-modes/#before">before</a> 
			direction of the current <a href="http://dev.w3.org/csswg/css3-writing-modes/#writing-mode">writing mode</a>, 
			whichever is in the <i>cross axis</i>, 
			and the <i>cross-end</i> direction is the opposite direction of <i>cross-start</i>.

		<dt><dfn id='flex-flow-wrap-reverse'>''wrap-reverse''</dfn>
		<dd>
			Same as ''wrap'', 
			except the <i>cross-start</i> and <i>cross-end</i> directions are swapped.
	</dl>

<h3 id='flex-flow-property'>
Flex Direction and Wrap: the 'flex-flow' shorthand</h3>

	<table class=propdef>
		<tr>
			<th>Name:</th>
			<td><dfn>flex-flow</dfn>
		<tr>
			<th><a href="#values">Value</a>:
			<td>&lt;&apos;flex-direction&apos;> || &lt;&apos;flex-wrap&apos;>
		<tr>
			<th>Initial:
			<td>see individual properties
		<tr>
			<th>Applies To:
			<td>flex containers
		<tr>
			<th>Inherited:
			<td>see individual properties
		<tr>
			<th>Computed Value:
			<td>see individual properties
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Animatable:
			<td>no
		<tr>
			<th>Canonical Order:
			<td><abbr title="follows order of property value definition">per grammar</abbr>
	</table>

	<p>The 'flex-flow' property is a shorthand for setting the 'flex-direction' and 'flex-wrap' properties together.

	<div class="example">
		<p>Some examples of valid flows:

		<table style="margin: 0 auto; vertical-align: middle; border-spacing: 2em 1em;">
			<tr>
				<td><pre>
div { flex-flow: row; }
/* Initial value. Main-axis is 
   inline, no wrap. */</pre>
				<td><img src='images/flex-flow1.svg' width=240 height=80 alt>
			<tr>
				<td><pre>
div { flex-flow: column wrap; }
/* Main-axis is block-direction and lines
   wrap in the inline direction.  For an 
   English page, the main-axis is top-to-bottom
   and lines wrap to the right. */</pre>
				<td><img src='images/flex-flow2.svg' width=170 height=200 alt>
			<tr>
				<td><pre>
div { writing-mode: vertical-rl;
      flex-flow: column wrap-reverse; }
/* Main-axis is block direction (right to 
   left). New lines wrap upwards. */</pre>
				<td><img src='images/flex-flow3.svg' width=200 height=170 alt>
		</table>
	</div>


<h3 id='order-property'>
Display Order: the 'order' property</h3>

	<p><i>Flex items</i> are, by default, displayed and laid out in the same order as they appear in the source document.  The 'order' property may be used to change this ordering.

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>order</dfn>
		<tr>
			<th><a href="#values">Value</a>:
			<td>&lt;number>
		<tr>
			<th>Initial:
			<td>0
		<tr>
			<th>Applies to:
			<td>all elements
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed value:
			<td>specified value
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Animatable:
			<td>yes
		<tr>
			<th>Canonical Order:
			<td><abbr title="follows order of property value definition">per grammar</abbr>
	</table>

	<p>
		The 'order' property controls the order in which elements appear,
		by assigning them to ordinal groups.
		Within flex layout, it controls the order of <i>flex items</i> in their flex container.

	<p>
		A flex container will lay out its content starting from the lowest numbered ordinal group and going up.  
		Items with the same ordinal group are laid out in the order they appear in the source document.  
		'order' has no effect on stacking/layering; 
		elements must still be drawn over/under each other based on document order, 'z-index', and other relevant means.

	<p>
		Unless otherwise specified, 
		this property has no effect on elements that are not <i>flex items</i>.

	<div class='example'>
		<p>The following figure shows a simple tabbed interface, where the tab for the active pane is always in front:

		<div class='figure'><img src="images/flex-order-example.png" alt></div>

		<p>This could be implemented with the following CSS (showing only the relevant code):

		<pre>
.tabs {
	display: flex;
}
.tabs > .current {
	order: -1; /* Lower than the default of 0 */
}</pre>

	</div>

	<div class='example'>
		<p>
			Many web pages have a similar shape in the markup, 
			with a header on top, 
			a footer on bottom, 
			and then a content area and one or two additional columns in the middle.  
			Generally, 
			it's desirable that the content come first in the page's source code, 
			before the additional columns.  
			However, this makes many common designs, 
			such as simply having the additional columns on the left and the content area on the right, 
			difficult to achieve.  
			This has been addressed in many ways over the years, 
			often going by the name "Holy Grail Layout" when there are two additional columns.  
			'order' makes this trivial.  
			For example, take the following sketch of a page's code and desired layout:

		<div class='code-and-figure'>
			<div><pre>
&lt;!DOCTYPE html>
&lt;header>...&lt;/header>
&lt;div id='main'>
   &lt;article>...&lt;/article>
   &lt;nav>...&lt;/nav>
   &lt;aside>...&lt;/aside>
&lt;/div>
&lt;footer>...&lt;/footer></pre></div>
			<div><img src="images/flex-order-page.svg" width=400 height=360 alt="In this page the header is at the top and the footer at the bottom, but the article is in the center, flanked by the nav on the right and the aside on the left."></div>
		</div>

		<p>
			This layout can be easily achieved with flex layout:

		<pre>
#main { display: flex; }
#main > article { flex:1;         order: 2; }
#main > nav     { width: 200px;   order: 1; }
#main > aside   { width: 200px;   order: 3; }</pre>
		
		<p>
			As an added bonus, 
			the columns will all be <a href="#align-items-stretch">equal-height</a> by default, 
			and the main content will be as wide as necessary to fill the screen.  
			Additionally, 
			this can then be combined with media queries to switch to an all-vertical layout on narrow screens:

		<pre>
@media all and (max-width: 600px) {
	/* Too narrow to support three columns */
	#main { flex-flow: column; }
	#main > article, #main > nav, #main > aside {
		/* Return them to document order */
		order: 0; width: auto;
	}
}</pre>

		<p><small>(Further use of multiline flex containers to achieve even more intelligent wrapping left as an exercise for the reader.)</small>
	</div>

	<p class='note'>
		It is expected that future layout modes like Grid Layout
		will also use 'order' for similar purposes.


<h2 id='flex-lines'>
Flex Lines</h2>

	<p>
		A flex container can be either <i>single-line</i> or <i>multi-line</i>, 
		depending on the 'flex-wrap' property:
	<ul> 
		<li>
			A <dfn>single-line</dfn> flex container lays out all of its children in a single line, 
			even if that would cause its contents to overflow.

		<li>
			A <dfn>multi-line</dfn> flex container breaks its <i>flex items</i> across multiple lines to avoid overflowing, 
			similar to how text is broken onto a new line when it gets too wide to fit on the existing line.  
			When additional lines are created, 
			they are stacked in the flex container along the <i>cross axis</i>
			according to the 'flex-wrap' property.
			Every line contains at least one <i>flex item</i>, 
			unless the flex container itself is completely empty.
	</ul>

	<p>
		Once content is broken into lines,
		each line is laid out independently;
		flexible lengths and the 'justify-content' and 'align-self' properties only consider the items on a single line at a time.  

	<p>
		When a flex container has multiple lines, the <i>cross size</i> of each line
		is the minimum size necessary to contain the <i>flex items</i> on the line
		(after aligment due to 'align-self'),
		and the lines are aligned within the flex container with the 'align-content' property.
		When a flex container (even a <i>multi-line</i> one) has only one line,
		the <i>cross size</i> of the line is the <i>cross size</i> of the flex container,
		and 'align-content' has no effect.
		The <i>main size</i> of a line is always the same as the <i>main size</i> of the flex container's content box.  

	<div class=example>
		<p>
			This example shows four buttons that do not fit horizontally.

		<pre>&lt;style>
#div1 {
	display: flex;
	flex-flow: row wrap;
	width: 300px;
}
button {
	flex:80px 1;
}
&lt;style>

&lt;div id="div1">
	&lt;button id="button1">Elephant&lt;/button>
	&lt;button id="button2">Tiger&lt;/button>
	&lt;button id="button3">Antelope&lt;/button>
	&lt;button id="button4">Wildebeest&lt;/button>
&lt;/div></pre>

		<p>
			The buttons are first set to their preferred widths, 
			in this case 80 pixels. 
			This will allow the first three buttons to fit in 240 pixels with 60 pixels left over of remaining space. 
			Because the 'flex-flow' property specifies a multi-line flex container 
			(due to the ''wrap'' keyword appearing in its value), 
			the flex container will create an additional line to contain the last button.

		<p>
			Flexibility is applied to each element, 
			separately for each line. 
			The first line has 60 pixels of remaining space 
			and all of the buttons have the same flexibility, 
			so each of the three buttons on that line will receive 20 pixels of extra width, 
			ending up 100px wide. 
			The remaining button is on a line of its own 
			and will stretch to the entire width of the line, or 300 pixels.

		<div style="width:300px; border:medium solid green; overflow: hidden;">
			<button style="width:100px; float: left;">Elephant</button>
			<button style="width:100px; float: left;">Tiger</button>
			<button style="width:100px; float: left;">Antelope</button>
			<button style="width:300px; float: left;">Wildebeest</button>
		</div>

		<p>
			If the box were resized, the buttons would rearrange onto different lines as necessary.
		
		<p>
			If the style rules in the example above were changed to the following:

		<pre>
#div1 {
	display: flex;
	flex-flow: row wrap;
	justify-content: center;
	width: 300px;
}
button {
	flex:80px 1;
	max-width: 90px;
}</pre>

		<p>
			Similar to the previous example, 
			the first three buttons will fit on the first line, 
			and the last button will wrap onto a new line.  
			However, when the buttons attempt to flex they can only grow to 90px each, 
			due to their 'max-width' property.  
			This leaves 30px of free space on the first line 
			and 210px of free space on the second line.  
			Because 'justify-content' is set to ''center'', 
			the buttons will be centered on each line, 
			with the free space split equally on either side.

		<div style="width:300px; border:medium solid green; text-align:center;">
			<button style="width:90px; float: left; margin-left: 15px;">Elephant</button>
			<button style="width:90px; float: left;">Tiger</button>
			<button style="width:90px; float: left;">Antelope</button>
			<button style="width:90px">Wildebeest</button>
		</div>
	</div>



<h2 id='flexibility'>
Flexibility</h2>

	<p>
		The defining aspect of flex layout is the ability to make the <i>flex items</i> "flex", 
		altering their width or height to fill the available space. 
		This is done with the 'flex' property. 
		A flex container distributes free space to its items proportional to their <i>flex grow ratio</i>, 
		or shrinks them to prevent overflow proportional to their <i>flex shrink ratio</i>.


<h3 id='flex-property'>
The 'flex' Shorthand</h3>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>flex</dfn>
		<tr>
			<th><a href="#values">Value</a>:
			<td>none | [ &lt;&apos;flex-grow&apos;> &lt;&apos;flex-shrink&apos;>? || &lt;&apos;flex-basis&apos;> ] 
		<tr>
			<th>Initial:
			<td>see individual properties
		<tr>
			<th>Applies to:
			<td>flex items
		<tr>
			<th>Inherited:
			<td>see individual properties
		<tr>
			<th>Computed Value:
			<td>see individual properties
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Animatable:
			<td>see individual properties
		<tr>
			<th>Canonical Order:
			<td>per grammar
	</table>

	<p>
		The 'flex' property specifies the components of a <dfn title="flexible length|flexible length's">flexible length</dfn>: 
		the <i>flex grow ratio</i> 
		and <i>flex shrink ratio</i>, 
		and the <i>flex basis</i>.  
		When an element is a <i>flex item</i>, 
		'flex' is consulted <em>instead of</em> the <i>main size property</i> 
		to determine the <i>main size</i> of the element.  
		If an element is not a <i>flex item</i>, 
		'flex' has no effect.

	<p>
		The <var>&lt;&apos;flex-basis&apos;></var> component sets the <dfn>flex basis</dfn>,
		which is the initial <i>main size</i> of the <i>flex item</i>,
		before free space is distributed according to the flex ratios.
		If omitted, the <i>flex basis</i> defaults to ''0%''. 
		<span class='note'>Note that this is different from the initial value of 'flex-basis', which is ''auto''.</span>
		Zero values for the <var>&lt;&apos;flex-basis&apos;></var> component must be specified with a unit.
		Unitless zero will either be interpreted as one of the flex ratios, 
		or will make the declaration invalid.

	<p>
		The <var>&lt;&apos;flex-grow&apos;></var> and <var>&lt;&apos;flex-shrink&apos;></var> components
		set the <dfn>flex grow ratio</dfn> and <dfn>flex shrink ratio</dfn>,
		which determine how much the <i>flex item</i> will grow or shrink
		relative to the rest of the <i>flex items</i> in the flex container
		when free space is distributed.
		When omitted, they are set to ''1''.
		<span class='note'>Note that this is different from the initial value of 'flex-grow', which is ''0''.</span>

	<p>
		The keyword 'none' computes to ''0 0 auto''. 


<h3 id='flex-examples'>
Common Values of 'flex'</h3>

	<p><em>This section is informative.</em>

	<p>
		The list below summarizes the effects of the most common 'flex' values:

	<dl>
		<dt>''flex: initial''
		<dd>
			Equivalent to ''flex: 0 1 auto''.
			The value sets the size of the item according to the 'width'/'height' properties
			and  makes the flex item inflexible when there is positive free space,
			but allows it to shrink to its <a href="#min-size-auto">minimum</a> when there is insufficient space.
			(If the 'width'/'height' used as the <i>flex basis</i> computes to ''auto'', 
			this will size the flex item based on its contents.)
			The alignment properties or ''auto'' margins may be used to align flex items within the flex container.

		<dt>''flex: auto''
		<dd>
			Equivalent to ''flex: 1 1 auto''.
			This value makes the flex item flexible,
			and sets the <i>flex basis</i> according to the 'width'/'height' properties. 
			If all items are either ''flex: auto'' or ''flex: none'',
			any free space after the items have been sized will be distributed evenly to the items with ''flex: auto''.

		<dt>''flex: none''
		<dd>
			Equivalent to ''flex: 0 0 auto''.
			This value makes the flex item inflexible,
			and sets the size of the item according to the 'width'/'height' properties.
			To size things normally but still use the <a href="#alignment">alignment abilities</a> of flex layout,
			set all the flex items to ''flex: none''
			and then use ''auto'' margins or the alignment properties.
			This is similar to ''initial'',
			except that flex items are not allowed to shrink,
			even in overflow situations.

		<dt>''flex: &lt;positive-number>''
		<dd>
			Equivalent to ''flex: &lt;positive-number> 1 0%''.
			This value makes the flex item flexible,
			and sets the <i>flex basis</i> to zero, resulting in an item that receives the specified proportion of the free space in the flex container.
			If all items in the flex container use this pattern,
			their sizes will be proportional to the specified flex ratio.
	</dl>

	<div class='example'>
		<p>
			Flexibility allows elements to respond directly to the available space, 
			optionally taking into account size of content:

		<pre>
&lt;!DOCTYPE html>
&lt;style>
	div { display:flex; outline:1px solid silver; }
	p { flex:auto; margin:1em; background:gold; }
&lt;/style&gt;
&lt;div&gt;
	&lt;p&gt;&quot;flexing&quot;&lt;/p&gt;
	&lt;p&gt;allows the items to get bigger&lt;/p&gt;
	&lt;p&gt;or&lt;/p&gt;
	&lt;p&gt;smaller&lt;/p&gt;
&lt;/div&gt;
</pre>

		<p>
			Here, all four paragraphs have a <i>flex basis</i> equal to the length of their text.  
			The leftover space 
			(after subtracting their flex basises and margins from the width of the flex container) 
			is distributed evenly to the four paragraphs,
			because they all have have <i>flex grow ratio</i> of ''1''.  
			This shows how elements with the same flexibility may still end up different sizes, 
			if their flex basises are different.

		<img src="images/wp7zxxyu.gif" alt="">

	</div> 

	<p>
		By default, flex items won't shrink below their minimum content size
		(the length of the longest word or fixed-size element).
		To change this, set the 'min-width' or 'min-height' property.

<h3 id='flex-components'>
Components of Flexibility</h3>

	<p>
		Individual components of flexibility can be controlled by separate properties.

	<p class='note'>
		Authors are encouraged to control flexibility using the 'flex' shorthand 
		rather than with component properties,
		as the shorthand correctly resets any unspecified components
		to accommodate common uses.

<h4 id='flex-grow-property'>
The 'flex-grow' property</h4>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>flex-grow</dfn>
		<tr>
			<th><a href="#values">Value</a>:
			<td>&lt;number>
		<tr>
			<th>Initial:
			<td>''0''
		<tr>
			<th>Applies to:
			<td>flex items
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed Value:
			<td>specified value
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Animatable:
			<td>yes, except between ''0'' and other values
		<tr>
			<th>Canonical Order:
			<td><abbr title="follows order of property value definition">per grammar</abbr>
	</table>

	<p>
		The 'flex-grow' property sets the <i>flex grow ratio</i>.  
		Negative numbers are invalid.

<h4 id='flex-shrink-property'>
The 'flex-shrink' property</h4>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>flex-shrink</dfn>
		<tr>
			<th><a href="#values">Value</a>:
			<td>&lt;number>
		<tr>
			<th>Initial:
			<td>''1''
		<tr>
			<th>Applies to:
			<td>flex items
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed Value:
			<td>specified value
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Animatable:
			<td>yes, except between ''0'' and other values
		<tr>
			<th>Canonical Order:
			<td><abbr title="follows order of property value definition">per grammar</abbr>
	</table>

	<p>
		The 'flex-shrink' property sets the <i>flex shrink ratio</i>.  
		Negative numbers are invalid.

<h4 id='flex-basis-property'>
The 'flex-basis' property</h4>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>flex-basis</dfn>
		<tr>
			<th><a href="#values">Value</a>:
			<td><var>&lt;&apos;width&apos;></var>
		<tr>
			<th>Initial:
			<td>auto
		<tr>
			<th>Applies to:
			<td>flex items
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed Value:
			<td>as specified, with lengths made absolute
		<tr>
			<th>Percentages:
			<td>relative to the flex container's inner <i>main size</i>
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Animatable:
			<td>yes, insofar as 'width' is animatable
		<tr>
			<th>Canonical Order:
			<td><abbr title="follows order of property value definition">per grammar</abbr>
	</table>

	<p>
		The 'flex-basis' property sets the <i>flex basis</i>.
		Negative lengths are invalid.
		
	<p>
		If the computed value is ''auto'' on a <i>flex item</i>, 
		the used value of 'flex-basis' is the used value of the element's <i>main size property</i>.
		Otherwise,
		the used value of 'flex-basis' is resolved the same way as the <i>main size property</i>.

	<p>
		Like the 'width' and 'height' properties, 
		'flex-basis' determines the size of the content box,
		unless otherwise specified
		such as by 'box-sizing' [[CSS3UI]].
	
<h2 id='alignment'>
Alignment</h2>

	<p>
		After a flex container's contents have finished their flexing 
		and the dimensions of all flex items are finalized, 
		they can then be aligned within the flex container.

	<p>
		The 'margin' properties can be used to align items in a manner similar to, but more powerful than, what margins can do in block layout.
		<i>Flex items</i> also respect the alignment properties from the Box Alignment spec,
		which allow easy keyword-based alignment of items in both the <i>main axis</i> and <i>cross axis</i>.
		These properties make many common types of alignment trivial, 
		including some things that were very difficult in CSS 2.1, 
		like horizontal and vertical centering.

	<p class='note'>
		While the alignment properties are defined in the Box Alignment spec,
		Flexbox reproduces the definitions of the relevant ones here
		so as to not create a normative dependency that may slow down advancement of the spec.
		These properties apply only to flex layout
		until Box Alignment is finished
		and defines their effect for other layout modes.


<h3 id='auto-margins'>
Aligning with ''auto'' margins</h3>

	<p>
		<em>This section is non-normative.  
			The normative definition of how margins affect flex items is in the <a href="#layout-algorithm">Flex Layout Algorithm</a> section.</em>

	<p>
		Margins on flex items that are ''auto'' have an effect very similar to auto margins in normal flow:

	<ul>
		<li>
			During calculations of flex basises and flexible lengths, auto margins are treated as ''0''.

		<li>
			Prior to alignment via 'justify-content' and 'align-self',
			any positive free space is distributed to auto margins in that dimension.

		<li>
			Margin-based alignment has no effect on overflowing elements.
	</ul>

	<p class='note'>
		Note that, if free space is distributed to auto margins, 
		the alignment properties will have no effect in that dimension
		because the margins will have stolen all the free space
		left over after flexing.

	<div class="example">
		<p>Auto margins can be used for simple alignment or for fine control.

		<p>Note that auto margins work consistently in both dimensions, so a simple markup like this

		<pre>
div { 
	display: flex;
	width: 4em; 
	height: 4em; 
	background:silver;
}
p { margin:auto; }
&lt;div&gt;&lt;p&gt;OK&lt;/p&gt;&lt;/div&gt;</pre>

		<p>will center the single child:
	
		<img alt="image of square OK button" height="82" src="images/OK.png" width="82">
		
		<p>And this

		<pre>
div {
	display: flex;
	width: calc(100% - 4em); 
	height:calc(100% - 4em);
	border: 1em solid blue; 
	border-radius:50%;
	margin: auto;
}
div#demo { width:9em; height:9em; }

&lt;div id="demo">&lt;div>&lt;div>&lt;/div>&lt;/div>&lt;/div></pre>

		<p>
			will produce nested centered boxes:
			<img alt="concentric blue circles" height="191" src="images/target.png" width="210">
	</div>


<h3 id='justify-content-property'>
Axis Alignment: the 'justify-content' property</h3>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>justify-content</dfn>
		<tr>
			<th><a href="#values">Value</a>:
			<td>flex-start | flex-end | center | space-between | space-around
		<tr>
			<th>Initial:
			<td>start
		<tr>
			<th>Applies to:
			<td>flex containers
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed Value:
			<td>specified value
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Animatable:
			<td>no
		<tr>
			<th>Canonical Order:
			<td><abbr title="follows order of property value definition">per grammar</abbr>
	</table>

	<p>
		The 'justify-content' property aligns <i>flex items</i> along the <i>main axis</i> of the current line of the flex container.  
		This is done <em title=''>after</em> any flexible lengths and any <a href="#auto-margins">auto margins</a> have been resolved.  
		Typically it helps distribute extra free space leftover when either 
		all the <i>flex items</i> on a line are inflexible, 
		or are flexible but have reached their maximum size.
		It also exerts some control over the alignment of items when they overflow the line.

	<dl>
		<dt><dfn id='justify-content-flex-start'>''flex-start''</dfn>
		<dd>
			<i>Flex items</i> are packed toward the start of the line.  
			The <i>main-start</i> margin edge of the first <i>flex item</i> on the line 
			is placed flush with the <i>main-start</i> edge of the line, 
			and each subsequent <i>flex item</i> is placed flush with the preceding item.

		<dt><dfn id='justify-content-flex-end'>''flex-end''</dfn>
		<dd>
			<i>Flex items</i> are packed toward the end of the line.  
			The <i>main-end</i> margin edge of the last <i>flex item</i> 
			is placed flush with the <i>main-end</i> edge of the line, 
			and each preceding <i>flex item</i> is placed flush with the subsequent item.

		<dt><dfn id='justify-content-center'>''center''</dfn>
		<dd>
			<i>Flex items</i> are packed toward the center of the line.  
			The <i>flex items</i> on the line are placed flush with each other 
			and aligned in the center of the line, 
			with equal amounts of empty space between the <i>main-start</i> edge of the line and the first item on the line
			and between the <i>main-end</i> edge of the line and the last item on the line.  
			(If the leftover free-space is negative, 
			the <i>flex items</i> will overflow equally in both directions.)

		<dt><dfn id='justify-content-space-between'>''space-between''</dfn>
		<dd>
			<i>Flex items</i> are evenly distributed in the line.  
			If the leftover free-space is negative 
			or there is only a single <i>flex item</i> on the line, 
			this value is identical to ''flex-start''.  
			Otherwise, 
			the <i>main-start</i> margin edge of the first <i>flex item</i> on the line 
			is placed flush with the <i>main-start</i> edge of the line,
			the <i>main-end</i> margin edge of the last <i>flex item</i> on the line 
			is placed flush with the <i>main-end</i> edge of the line, 
			and the remaining <i>flex items</i> on the line are distributed 
			so that the empty space between any two adjacent items is the same.

		<dt><dfn id='justify-content-space-around'>''space-around''</dfn>
		<dd>
			<i>Flex items</i> are evenly distributed in the line, 
			with half-size spaces on either end.  
			If the leftover free-space is negative o
			r there is only a single <i>flex item</i> on the line, 
			this value is identical to ''center''.  
			Otherwise, the <i>flex items</i> on the line are distributed 
			such that the empty space between any two adjacent <i>flex items</i> on the line is the same, 
			and the empty space before the first and after the last <i>flex items</i> on the line are half the size of the other empty spaces.
	</dl>

	<div class="figure">
		<img src="images/flex-pack.svg" width=504 height=270 alt>
		<p class='caption'>An illustration of the five 'justify-content' keywords and their effects on a flex container with three colored items.
	</div>


<h3 id='align-items-property'>
Cross-axis Alignment: the 'align-items' and 'align-self' properties</h3>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>align-items</dfn>
		<tr>
			<th><a href="#values">Value</a>:
			<td>flex-start | flex-end | center | baseline | stretch
		<tr>
			<th>Initial:
			<td>stretch
		<tr>
			<th>Applies to:
			<td>flex containers
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed Value:
			<td>specified value
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Animatable:
			<td>no
		<tr>
			<th>Canonical Order:
			<td><abbr title="follows order of property value definition">per grammar</abbr>
	</table>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>align-self</dfn>
		<tr>
			<th><a href="#values">Value</a>:
			<td>auto | flex-start | flex-end | center | baseline | stretch
		<tr>
			<th>Initial:
			<td>auto
		<tr>
			<th>Applies to:
			<td><i>flex items</i>
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed Value:
			<td>''auto'' computes to parent's 'align-items'; otherwise as specified
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Animatable:
			<td>no
		<tr>
			<th>Canonical Order:
			<td><abbr title="follows order of property value definition">per grammar</abbr>
	</table>

	<p>
		<i>Flex items</i> can be aligned in the <i>cross axis</i> of the current line of the flex container, 
		similar to 'justify-content' but in the perpendicular direction.  
		'align-items' sets the default alignment for all of the flex container's <i title="flex items">items</i>, 
		including anonymous <i>flex items</i>.  
		'align-self' allows this default alignment to be overridden for individual <i>flex items</i>.
		(For anonymous flex items, 
		'align-self' always matches the value of 'align-items' on their associated flex container.)

	<p>
		A value of <dfn id="align-self-auto">''auto''</dfn> for 'align-self' 
		computes to the value of 'align-items' on the element's parent,
		or <a href='#align-items-stretch'>''stretch''</a> if the element has no parent.
		The alignments are defined as:

	<dl>
		<dt><dfn id="align-items-flex-start">''flex-start''</dfn>
		<dd>
			The <i>cross-start</i> margin edge of the <i>flex item</i> 
			is placed flush with the <i>cross-start</i> edge of the line.

		<dt><dfn id="align-items-flex-end">''flex-end''</dfn>
		<dd>
			The <i>cross-end</i> margin edge of the <i>flex item</i> 
			is placed flush with the <i>cross-end</i> edge of the line.

		<dt><dfn id="align-items-center">''center''</dfn>
		<dd>
			The <i>flex item's</i> margin box is centered in the <i>cross axis</i> within the line.  
			(If the <i>cross size</i> of the flex line is less than that of the <i>flex item</i>, 
			it will overflow equally in both directions.)

		<dt><dfn id="align-items-baseline">''baseline''</dfn>
		<dd>
			<p>
				If the <i>flex item's</i> inline axis is the same as the <i>cross axis</i>, 
				this value is identical to ''flex-start''.

			<p>
				Otherwise, 
				it participates in baseline alignment:
				all participating <i>flex items</i> on the line
				are aligned such that their baselines align, 
				and the item with the largest distance between its baseline and its <i>cross-start</i> margin edge 
				is placed flush against the <i>cross-start</i> edge of the line.
		
			  
		<dt><dfn id="align-items-stretch">''stretch''</dfn>
		<dd>
			<p>
				If the <i>cross size property</i> of the <i>flex item</i> is ''auto'', 
				its used value is the length necessary to make the <i>cross size</i> of the item's margin box as close to the same size as the line as possible, 
				while still respecting the constraints imposed by 'min/max-width/height'.

			<p class='note'>
				Note that if the flex container's height is constrained
				this value may cause the contents of the <i>flex item</i>
				to overflow the item.

			<p>
				The <i>cross-start</i> margin edge of the <i>flex item</i> 
				is placed flush with the <i>cross-start</i> edge of the line.
		
	</dl>

	<div class='figure'>
		<img src="images/flex-align.svg" width=508 height=377 alt>
		<p class='caption'>An illustration of the five 'align-items' keywords and their effects on a flex container with four colored items.
	</div>

	<div class=example>   
		<p>By using a vertical flex container and 'align-items', we can achieve behavior very close to HTML's <code>&lt;center></code> element:
		
		<div class='code-and-figure'>
			<div><pre>
&lt;div>
  &lt;p>foo foo foo foo&lt;/p>
  &lt;p>bar bar&lt;br>bar bar&lt;/p>
  &lt;p>foo foo foo foo foo foo foo
     foo foo foo foo foo&lt;/p>
&lt;/div>
&lt;style>
  div {
    display: flex;
    flex-flow: column;
    align-items: center;
    width: 200px;
  }
&lt;/style></pre></div>
			<div><p><img alt="" src="images/basic-vertical-flexbox.png"></div>
		</div>
	</div>

<h3 id='align-content-property'>
The 'align-content' property</h3>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>align-content</dfn>
		<tr>
			<th><a href="#values">Value</a>:
			<td>flex-start | flex-end | center | space-between | space-around | stretch
		<tr>
			<th>Initial:
			<td>stretch
		<tr>
			<th>Applies to:
			<td><i>multi-line</i> flex containers
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed Value:
			<td>specified value
		<tr>
			<th>Media:
			<td>visual
		<tr>
			<th>Animatable:
			<td>no
		<tr>
			<th>Canonical Order:
			<td><abbr title="follows order of property value definition">per grammar</abbr>
	</table>

	<p>
		The 'align-content' property aligns a flex container's lines within the flex container 
		when there is extra space in the <i>cross-axis</i>,
		similar to how 'justify-content' aligns individual items within the <i>main-axis</i>:

	<dl>
		<dt><dfn id='align-content-flex-start'>''flex-start''</dfn>
		<dd>
			Lines are packed toward the start of the flex container.  
			The <i>cross-start</i> edge of the first line in the flex container 
			is placed flush with the <i>cross-start</i> edge of the flex container, 
			and each subsequent line is placed flush with the preceding line.

		<dt><dfn id='align-content-flex-end'>''flex-end''</dfn>
		<dd>
			Lines are packed toward the end of the flex container.  
			The <i>cross-end</i> edge of the last line 
			is placed flush with the <i>cross-end</i> edge of the flex container, 
			and each preceding line is placed flush with the subsequent line.

		<dt><dfn id='align-content-center'>''center''</dfn>
		<dd>
			Lines are packed toward the center of the flex container.  
			The lines in the flex container are placed flush with each other 
			and aligned in the center of the flex container, 
			with equal amounts of empty space 
			between the <i>cross-start</i> content edge of the flex container 
			and the first line in the flex container,
			and between the <i>cross-end</i> content edge of the flex container 
			and the last line in the flex container.  
			(If the leftover free-space is negative, 
			the lines will overflow equally in both directions.)

		<dt><dfn id='align-content-space-between'>''space-between''</dfn>
		<dd>
			Lines are evenly distributed in the flex container.  
			If the leftover free-space is negative 
			or there is only a single line in the flex container, 
			this value is identical to ''flex-start''.  
			Otherwise, 
			the <i>cross-start</i> edge of the first line in the flex container 
			is placed flush with the <i>cross-start</i> content edge of the flex container, 
			the <i>cross-end</i> edge of the last line in the flex container 
			is placed flush with the <i>cross-end</i> content edge of the flex container, 
			and the remaining lines in the flex container are distributed 
			so that the empty space between any two adjacent lines is the same.

		<dt><dfn id='align-content-space-around'>''space-around''</dfn>
		<dd>
			Lines are evenly distributed in the flex container, 
			with half-size spaces on either end.  
			If the leftover free-space is negative 
			or there is only a single line in the flex container, 
			this value is identical to ''center''.  
			Otherwise, the lines in the flex container are distributed 
			such that the empty space between any two adjacent lines is the same, 
			and the empty space before the first and after the last lines in the flex container 
			are half the size of the other empty spaces.

		<dt><dfn id='align-content-stretch'>''stretch''</dfn>
		<dd>
			Lines stretch to take up the remaining space.  
			If the leftover free-space is negative, 
			this value is identical to ''flex-start''.  
			Otherwise, 
			the free-space is split equally between all of the lines, 
			increasing their cross size.
	</dl>

	<p class='note'>
		Note: Only flex containers with multiple lines 
		ever have free space in the <i>cross-axis</i> for lines to be aligned in, 
		because in a flex container with a single line
		the sole line automatically stretches to fill the space.

	<div class="figure">
		<img src="images/align-content-example.svg" width=612 height=508 alt>
		<p class='caption'>
			An illustration of the 'align-content' keywords and their effects on a multi-line flex container.
	</div>


<h2 id='layout-algorithm'>
Flex Layout Algorithm</h2>

	<p>
		This section contains normative algorithms 
		detailing the exact layout behavior of a flex container and its contents.  
		The algorithms here are written to optimize readability and theoretical simplicity, 
		and may not necessarily be the most efficient.  
		Implementations may use whatever actual algorithms they wish, 
		but must produce the same results as the algorithms described here.

	<p class='note'>
		This section is mainly intended for implementors.  
		Authors writing web pages should generally be served well by the individual property descriptions, 
		and do not need to read this section unless they have a deep-seated urge to understand arcane details of CSS layout.

	<!--
<dfn>min size</dfn>
* each layout mode defines this for both dimensions:
	* for inline:
		* min-measure is largest word length or size of atomic inline in the inline-axis
		* min-extent is the extent after layout
	* for block containers:
		* min-measure is largest min size contribution of its children boxes
		* min-extent is the extent after layout
	* for tables:
		* ?
	* min-extent is always the extent after layout

<dfn>min-size contribution</dfn>
* each layout mode defines this for both dimensions:
	* for inline:
		* min-measure is largest word length or size of atomic inline in the inline-axis + margin/border/padding (attached to first/last words)
	* for block containers:
		* if measure is ''min-content'' or ''max-content'' or definite size, that value.
		* Otherwise, your min measure + margin/border/padding
	* for tables:
		* ?
	* min-extent is always the extent after layout

<dfn>max size</dfn>
* each layout mode defines this for both dimensions:
	* for inline:
		* max-measure is the largest line length when only forced breaks are taken
	* for block containers
		* max-measure is the largest max size contribution of its children boxes
	* for tables
		* ?
	* max-extent is always the extent after layout

<dfn>max-size contribution</dfn>
* each layout mode defines this for both dimensions:
	* for inline:
		* max-measure is largest line length when only forced breaks are taken + margin/border/padding (attached to first/last words)
	* for block containers:
		* if measure is ''min-content'' or ''max-content'' or definite size, that value.
		* Otherwise, your max measure + margin/border/padding
	* for tables:
		* ?
	* min-extent is always the extent after layout
	-->

	<p>
		For the purposes of these definitions, 
		a <dfn title="definite|definite size">definite size</dfn> is one that can be determined without measuring content, 
		i.e. is a &lt;length>, 
		a size of the initial containing block, 
		or a &lt;percentage> that is resolved against a definite size. 
		An <dfn title="indefinite|indefinite size">indefinite size</dfn> is one that is not <i>definite</i>.

	<p>
		The following sections define the algorithm for laying out a flex container and its contents.

<h3 id='box-manip'>
Initial Setup</h3>

	<ol start=0>
		<li id='algo-anon-box'>
			<strong>Generate anonymous flex items</strong> around runs of contiguous inline content in the flex container, 
			as described in the <a href="#flex-items">Flex Items</a> section.

		<li id='algo-flex-order'>
			<strong>Re-order the flex items according to their 'order'.</strong>
			The items with the lowest (most negative) 'order' values are first in the ordering.  
			If multiple items share a 'order' value, 
			they're ordered by document order.  
			This affects the order in which the flex items generate boxes in the box-tree, 
			and how the rest of this algorithm deals with the items.
	</ol>

<h3 id='line-sizing'>
Line Length Determination</h3>
	
	<ol class=continue>
		<li id='algo-available'>
			<strong>Determine the available main and cross space for the flex items.</strong>
			For each dimension,
			if that dimension of the flex container is a <i>definite size</i>, use that;
			otherwise, subtract the flex container's margin, border, and padding
			from the space available to the flex container in that dimension
			and use that value.
			<span class='note'>This might result in an infinite value.</span>

		<li id='algo-main-item'>
			<strong>Determine the <dfn>flex base size</dfn> and <dfn>hypothetical main size</dfn> of each item:</strong>

			<ul>
				<li>
					If the item has a <i>definite</i> flex basis,
					that's the <i>flex base size</i>.

				<li>
					Otherwise,
					if the flex container's main-axis is parallel to the item's inline-axis,
					lay out the item using the available space
					and its flex basis if the item is inflexible, 
					or ''auto'' otherwise,
					treating ''auto'' as ''max-content''
					unless the item's writing mode is perpendicular to the flex container's writing mode
					(in which case <a href="http://www.w3.org/TR/css3-writing-modes/#orthogonal-flows">the rules for a box in an orthogonal flow</a> [[!CSS3-WRITING-MODES]] are in effect).
					If the flex basis is ''fill-available'', or ''fit-content'',
					and the flex container is being sized under a min-content or max-content main-size constraint,
					size the item under that constraint instead.
					The <i>flex base size</i> is the item's resulting measure.

				<li>
					Otherwise,
					lay out the item using the available space
					and its flex basis if the item is inflexible, 
					or ''auto'' otherwise,
					treating ''auto'' as ''max-content'' 
					unless the item's writing mode is perpendicular to the flex container's writing mode
					(in which case <a href="http://www.w3.org/TR/css3-writing-modes/#orthogonal-flows">the rules for a box in an orthogonal flow</a> [[!CSS3-WRITING-MODES]] are in effect).
					If the flex basis is ''auto'', ''fill-available'', or ''fit-content'',
					and the flex container is being sized under a min-content or max-content cross-size constraint,
					size the item under that constraint instead.
					The <i>flex base size</i> is the item's resulting max-content extent.

				<li>
					The <i>hypothetical main size</i> is the item's <i>flex base size</i>
					clamped according to its min and max main size properties.
			</ul>

		<li id='algo-main-container'>
			<strong>Determine the main size of the flex container</strong> using its <i>main size property</i>.
			In this calculation, the <i>min content main size</i> of the flex container
			is the maximum of the flex container's items' <i>min-content size contributions</i>,
			and the <i>max content main size</i> of the flex container
			is the sum of the flex container's items' <i>max-content size contributions</i>.
			The min-content/max-content main size contribution of an item is
			its outer <i>hypothetical main size</i>
			when sized under a min-content/max-content constraint (respectively).
			For this computation, ''auto'' margins are treated as ''0''.
	</ol>

<h3 id='main-sizing'>
Main Size Determination</h3>

	<ol class=continue>
		<li id='algo-line-break'>
			<strong>Collect flex items into flex lines:</strong>

			<ul>
				<li>
					If the flex container is single-line, 
					collect all the flex items into a single flex line.

				<li>
					Otherwise,
					starting from the first uncollected item, 
					collect as many consecutive flex items as will fit
					or until a forced break is encountered
					(but collect at least one)
					into the flex container's inner main size into a flex line.
					A break is forced wherever 
					the CSS2.1 'page-break-before/after' [[CSS21]]
					or the CSS3 'break-before/after' [[CSS3-BREAK]] properties 
					specify a fragmentation break.

					<p>
						For this step,
						the size of a flex item is its outer <i>hypothetical main size</i>.

					<p>
						Repeat until all flex items have been collected into flex lines.

					<p class='note'>
						Note that items with zero main size will never start a line
						unless they're the very first items in the flex container,
						or they're preceded by a forced break.
						The "collect as many" line will collect them
						onto the end of the previous line
						even if the last non-zero item exactly "filled up" the line.
			</ul>

		<li id='algo-flex'>
			<strong><a href='#resolve-flexible-lengths'>Resolve the flexible lengths</a></strong> of all the flex items to find their used main size,
			and <strong>determine their <dfn>hypothetical cross size</dfn></strong> from this main size.
	</ol>

<h3 id='cross-sizing'>
Cross size determination</h3>

	<ol class=continue>
		<li id='algo-cross-line'>
			<strong>Calculate the cross size of each flex line.</strong>

			<p>
				If the flex container has only a single line
				(even if it's a <i>multi-line</i> flex container),
				the cross size of the flex line
				is the flex container's inner cross size.

			<p>
				Otherwise,
				for each flex line:

			<ol>
				<li>
					Collect all the flex items whose inline-axis is parallel to the main-axis,
					whose 'align-self' is ''baseline'',
					and whose cross-axis margins are both non-''auto''.
					Find the largest of the distances between each item's baseline and its hypothetical outer cross-start edge,
					and the largest of the distances between each item's baseline and its hypothetical outer cross-end edge,
					and sum these two values.

				<li>
					Among all the items not collected by the previous step,
					find the largest outer <i>hypothetical cross size</i>.

				<li>
					The used cross-size of the flex line is the larger of the numbers found in the previous two steps.
			</ol>

		<li id='algo-line-stretch'>
			<strong>Handle 'align-content: stretch'.</strong>
			If the flex container has a <i>definite</i> cross size,
			'align-content' is <a href='#align-content-stretch'>''stretch''</a>,
			and the sum of the flex lines' cross sizes is less than the flex container's inner cross size,
			increase the cross size of each flex line by equal amounts
			such that the sum of their cross sizes exactly equals the flex container's inner cross size.

		<li id='algo-visibility'>
			<strong>Collapse ''visibility:collapse'' items.</strong>
			If any flex items have ''visibility: collapse'',
			note the cross size of the line they're in as the item's <dfn>strut size</dfn>,
			and restart layout from the beginning.

			<p>
				In this second layout round,
				when <a href="#algo-line-break">collecting items into lines</a>,
				treat the collapsed items as having zero main size.
				For the rest of the algorithm following that step,
				ignore the collapsed items entirely
				(as if they were ''display:none'')
				except that after <a href="#algo-cross-line">calculating the cross size of the lines</a>,
				if any line's cross size is less than
				the largest <var>strut size</var>
				among all the collapsed items in the line,
				set its cross size to that <var>strut size</var>.

			<p>
				Skip this step in the second layout round.

		<li id='algo-cross-item'>
			<strong>Determine the used cross size of each flex item.</strong>
			If a flex item has ''align-self: stretch'',
			its cross size property is ''auto'',
			and neither of its cross-axis margins are ''auto'',
			the used outer cross size is the used cross size of its flex line,
			clamped according to the item's min and max cross size properties.
			Otherwise,
			the used cross size is the item's <i>hypothetical cross size</i>.
	</ol>

<h3 id='main-alignment'>
Main-Axis Alignment</h3>

	<ol class=continue>
		<li id='algo-main-align'>
			<strong>Distribute any remaining free space.</strong>
			For each flex line:

			<ol>
				<li>
					If the remaining free space is positive 
					and at least one main-axis margin on this line is ''auto'',
					distribute the free space equally among these margins.
					Otherwise, set all ''auto'' margins to zero.

				<li>
					Align the items along the main-axis per 'justify-content'.
			</ol>
	</ol>

<h3 id='cross-alignment'>
Cross-Axis Alignment</h3>

	<ol class=continue>
		<li id='algo-cross-margins'>
			<strong>Resolve cross-axis ''auto'' margins.</strong>
			If a flex item has ''auto'' cross-axis margins,
			and its outer cross size
			(treating those ''auto'' margins as zero)
			is less than the cross size of its flex line,
			distribute the difference in those sizes equally
			to the ''auto'' margins.

		<li id='algo-cross-align'>
			<strong>Align all flex items along the cross-axis</strong> per 'align-self',
			if neither of the item's cross-axis margins are ''auto''.

		<li id='algo-cross-container'>
			<strong>Determine the flex container's used cross size:</strong>

			<ul>
				<li>
					If the cross size property is a <i>definite</i> size,
					use that.

				<li>
					Otherwise,
					use the sum of the flex lines' cross sizes.
			</ul>

		<li id='algo-line-align'>
			<strong>Align all flex lines</strong> per 'align-content'.
	</ol>

<h3 id='resolve-flexible-lengths'>
Resolving Flexible Lengths</h3>

	<p>
		To resolve the flexible lengths of the items within a flex line:

	<ol>	
		<li>
			<strong>Determine the used flex ratio.</strong>
			Sum the outer <i>hypothetical main sizes</i> of all items on the line.
			If the sum is less than the flex container's inner main size,
			use the <i>flex grow ratio</i> for the rest of this algorithm;
			otherwise, use the <i>flex shrink ratio</i>.

		<li>
			<strong>Check that you can distribute any space.</strong>
			If all the flex items on the line are either frozen
			or have a flex ratio of zero,
			exit the algorithm.

		<li>
			<strong>Calculate free space.</strong>
			Sum the outer <i>flex base sizes</i> of all items on the line,
			and subtract this from the flex container's inner main size.
			This is the free space.

		<li>
			<strong>Distribute free space proportional to the flex ratios.</strong>
			If the sign of the free space matches the sign choosing the flex ratio,
			distribute the free space to each flexible item's main size 
			in proportion to the item's flex ratio:

			<dl>
				<dt>If the free space is positive</dt>
				<dd>
					Find the ratio of the item's <i>flex grow ratio</i>
					to the sum of the <i>flex grow ratios</i> of all items on the line.
					Set the item's main size
					to its <i>flex base size</i>
					plus a fraction of the free space
					proportional to the ratio.

				<dt>If the free space is negative</dt>
				<dd>
					For every item on the line,
					multiply its <i>flex shrink ratio</i>
					by its outer <i>flex base size</i>,
					and note this as its <dfn>scaled flex shrink ratio</dfn>.
					Find the ratio of the item's <i>scaled flex shrink ratio</i>
					to the sum of the <i>scaled flex shrink ratios</i> of all items on the line.
					Set the item's main size
					to its <i>flex base size</i>
					minus a fraction of the free space
					proportional to the ratio.
					<span class="note">Note this may result in a negative inner main size;
					it will be corrected in the next step.</span>
			</dl>

		<li>
			<strong>Fix min/max violations.</strong>
			Clamp each item's main size by its min and max main size properties.
			If the item's main size was made smaller by this, it's a max violation.
			If the item's main size was made larger by this, it's a min violation.

		<li>
			The total violation is the sum of the adjustments from the previous step
			(<code><var>clamped size</var> - <var>unclamped size</var></code>).
			If the total violation is:
			
			<dl>
				<dt>Zero
				<dd>
					Exit the algorithm.

				<dt>Positive
				<dd>
					Freeze all the items with min violations,
					reset all other items to their size upon entering this algorithm,
					and return to step 2 of this algorithm.

				<dt>Negative
				<dd>
					Freeze all the items with max violations,
					reset all other items to their size upon entering this algorithm,
					and return to step 2 of this algorithm.
			</dl>
	</ol>
	
<h2 id="pagination">
Fragmenting Flex Layout</h2>

	<p>
		Flex containers can break across pages
		between items, 
		between lines of items (in multi-line mode),
		and inside items.
		The 'break-*' properties apply to flex containers as normal for block-level or inline-level boxes.
		This section defines how they apply to flex items
		and elements inside flex items.

	<p>
		The following breaking rules refer to the fragmentation container as the “page”. 
		The same rules apply to any other fragmenters.
		(Substitute “page” with the appropriate fragmenter type as needed.)
		See the CSS3 Fragmentation Module [[!CSS3-BREAK]].
		For readability, in this section the terms "row" and "column" refer to the relative orientation
		of the flex container with respect to the block flow direction of the fragmentation context,
		rather than to the writing mode of the flex container itself.

	<p>
		The exact layout of a fragmented flex container is not defined in this level of Flexible Box Layout.
		However, breaks inside a flex container are subject to the following rules:

	<ul>
		<li>
			In a row flex container,
			the 'break-before' and 'break-after' properties on flex items
			are propagated to the flex line.
			The 'break-before' property on the first line
			and the 'break-after' property on the last line
			are propagated to the flex container.

		<li>
			In a column flex container,
			the 'break-before' property on the first item
			and the 'break-after' property on the last item
			are propagated to the flex container.
			Forced breaks on other items are applied to the item itself.

		<li>
			A forced break inside a flex item effectively increases the size of its contents;
			it does not trigger a forced break inside sibling items.

		<li>
			In a row flex container, 
			<a href="http://www.w3.org/TR/css3-break/#btw-blocks">Class 1 break opportunities</a> occur between sibling flex lines,
			and <a href="http://www.w3.org/TR/css3-break/#end-block">Class 3 break opportunities</a> occur between the first/last flex line and the flex container's content edges.
			In a column flex container, 
			<a href="http://www.w3.org/TR/css3-break/#btw-blocks">Class 1 break opportunities</a> occur between sibling flex items,
			and <a href="http://www.w3.org/TR/css3-break/#end-block">Class 3 break opportunities</a> occur between the first/last flex items on a line and the flex container's content edges.
			[[!CSS3-BREAK]]
		
		<li>
			When a flex container is continued after a break, 
			the space available to its <i>flex items</i> 
			(in the block flow direction of the fragmentation context)
			is reduced by the space consumed by flex container fragments on previous pages. 
			The space consumed by a flex container fragment is
			the size of its content box on that page.
			If as a result of this adjustment the available space becomes negative, 
			it is set to zero.

		<li>
			If the first fragment of the flex container is not at the top of the page,
			and some of its flex items don't fit in the remaining space on the page,
			the entire fragment is moved to the next page.

		<li>
			When a <i>multi-line</i> colum flex container breaks,
			each fragment has its own "stack" of flex lines,
			just like each fragment of a multi-column element
			has its own row of column boxes.

		<li>
			Aside from the rearrangement of items imposed by the previous point,
			UAs should attempt to minimize distortation of the flex container
			with respect to unfragmented flow.
	</ul>


<h3 id='pagination-algo'>
Sample Flex Fragmentation Algorithm</h3>

	<p>
		This informative section presents a possible fragmentation algorithm for flex containers.
		UAs are encouraged to improve on this algorithm and <a href='#status'>provide feedback to the CSS Working Group</a>.

<div class='example'>

	<p class='note'>
		This algorithm assumes that pagination always proceeds only in the forward direction;
		therefore, in the algorithms below, alignment is mostly ignored prior to pagination.
		Advanced layout engines may be able to honor alignment across fragments.

	<dl>
		<dt>Single-line column flex container
		<dd>
			<ol>
				<li>
					Run the flex layout algorithm (without regards to pagination)
					through <a href="#cross-sizing">Cross Sizing Determination</a>.

				<li>
					Lay out as many consecutive flex items or item fragments as possible 
					(but at least one or a fragment thereof), 
					starting from the first, 
					until there is no more room on the page
					or a forced break is encountered.

				<li>
					If the previous step ran out of room 
					and the free space is positive,
					the UA may reduce the distributed free space on this page 
					(down to, but not past, zero) 
					in order to make room for the next unbreakable flex item or fragment. 
					Otherwise, 
					the item or fragment that does not fit is pushed to the next page. 
					The UA should pull up if more than 50% of the fragment would have fit in the remaining space 
					and should push otherwise.

				<li>
					If there are any flex items or fragments not laid out by the previous steps,
					rerun the flex layout algorithm 
					from <a href="#line-sizing">Line Length Determination</a>
					through <a href="#cross-sizing">Cross Sizing Determination</a>
					with the next page's size
					and <em>all</em> the contents (including those already laid out),
					and return to the previous step,
					but starting from the first item or fragment not already laid out.

				<li>
					For each fragment of the flex container,
					continue the flex layout algorithm
					from <a href="#main-alignment">Main-Axis Alignment</a>
					to its finish.
			</ol>

			<p class="note">
				It is the intent of this algorithm that column-direction single-line flex containers
				paginate very similarly to block flow. 
				As a test of the intent, 
				a flex container with ''justify-content:start''
				and no flexible items 
				should paginate identically to 
				a block with in-flow children with same content, 
				same used size and same used margins. 

		<dt>Multi-line column flex container
		<dd>
			<ol>
				<li>
					Run the flex layout algorithm
					<em>with</em> regards to pagination
					(limiting the flex container's maximum line length to the space left on the page)
					through <a href="#cross-sizing">Cross Sizing Determination</a>.

				<li>
					Lay out as many flex lines as possible
					(but at least one)
					until there is no more room in the flex container
					in the cross dimension
					or a forced break is encountered:

					<ol>
						<li>
							Lay out as many consecutive flex items as possible 
							(but at least one), 
							starting from the first, 
							until there is no more room on the page
							or a forced break is encountered.
							Forced breaks <em>within</em> flex items are ignored.

						<li>
							If this is the first flex container fragment,
							this line contains only a single flex item
							that is larger than the space left on the page,
							and the flex container is not at the top of the page already,
							move the flex container to the next page
							and restart flex container layout entirely.

						<li>
							If there are any flex items not laid out by the first step,
							rerun the flex layout algorithm 
							from <a href="#main-sizing">Main Sizing Determination</a>
							through <a href="#cross-sizing">Cross Sizing Determination</a>
							using only the items not laid out on a previous line,
							and return to the previous step,
							starting from the first item not already laid out.
					</ol>

				<li>
					If there are any flex items not laid out by the previous step,
					rerun the flex layout algorithm
					from <a href="#line-sizing">Line Sizing Determination</a>
					through <a href="#cross-sizing">Cross Sizing Determination</a>
					with the next page's size 
					and only the items not already laid out,
					and return to the previous step,
					but starting from the first item not already laid out.

				<li>
					For each fragment of the flex container,
					continue the flex layout algorithm
					from <a href="#main-alignment">Main-Axis Alignment</a>
					to its finish.
			</ol>

			<p class='note'>
				If a flex item does not entirely fit on a single page,
				it will <em>not</em> be paginated in multi-line column flex containers.

		<dt>Single-line row flex container
		<dd>
			<ol>
				<li>
					Run the entire flex layout algorithm (without regards to pagination),
					except treat any 'align-self' other than ''start'' or ''baseline'' as ''start''.

				<li>
					If an unbreakable item doesn't fit within the space left on the page,
					and the flex container is not at the top of the page,
					move the flex container to the next page
					and restart flex container layout entirely.

				<li>
					For each item,
					lay out as much of its contents as will fit in the space left on the page,
					and fragment the remaining content onto the next page,
					rerunning the flex layout algorithm
					from <a href="#line-sizing">Line Length Determination</a>
					through <a href="#main-alignment">Main-Axis Alignment</a>
					into the new page size
					using <em>all</em> the contents (including items completed on previous pages).					

					<p class='note'>
						Any flex items that fit entirely into previous fragments
						still take up space in the main axis in later fragments.

				<li>
					For each fragment of the flex container,
					rerun the flex layout algorithm
					from <a href="#cross-alignment">Cross-Axis Alignment</a>
					to its finish.
					For all fragments besides the first,
					treat 'align-self' and 'align-content' as being ''start'' for all item fragments and lines.

				<li>
					If any item, 
					when aligned according to its original 'align-self' value
					into the combined cross size of all the flex container fragments,
					would fit entirely within a single flex container fragment,
					it may be shifted into that fragment
					and aligned appropriately.
			</ol>

		<dt>Multi-line row flex container
		<dd>
			<ol>
				<li>
					Run the flex layout algorithm (without regards to pagination),
					through <a href="#cross-sizing">Cross Sizing Determination</a>.

				<li>
					Lay out as many flex lines as possible
					(but at least one),
					starting from the first,
					until there is no more room on the page
					or a forced break is encountered.

					<p>
						If a line doesn't fit on the page,
						and the line is not at the top of the page,
						move the line to the next page
						and restart the flex layout algorithm entirely,
						using only the items in and following this line.

					<p>
						If a flex item itself causes a forced break,
						rerun the flex layout algorithm
						from <a href="#main-sizing">Main Sizing Determination</a>
						through <a href="#main-alignment">Main-Axis Alignment</a>,
						using only the items on this and following lines,
						but with the item causing the break automatically starting a new line
						in the <a href="#algo-line-break">line breaking step</a>,
						then continue with this step.
						Forced breaks <em>within</em> flex items are ignored.

				<li>
					If there are any flex items not laid out by the previous step,
					rerun the flex layout algorithm
					from <a href="#line-sizing">Line Length Determination</a>
					through <a href="#main-alignment">Main-Axis Alignment</a>
					with the next page's size
					and only the items not already laid out.
					Return to the previous step,
					but starting from the first line not already laid out.

				<li>
					For each fragment of the flex container,
					continue the flex layout algorithm
					from <a href="#cross-alignment">Cross Axis Alignment</a>
					to its finish.
			</ol>
	</dl>
</div>

<h2 id="conformance">
Conformance</h2>

<h3 id="conventions">
Document conventions</h3>

  <p>Conformance requirements are expressed with a combination of
  descriptive assertions and RFC 2119 terminology. The key words “MUST”,
  “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
  “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
  document are to be interpreted as described in RFC 2119.
  However, for readability, these words do not appear in all uppercase
  letters in this specification.
  
  <p>All of the text of this specification is normative except sections
  explicitly marked as non-normative, examples, and notes. [[!RFC2119]]
  
  <p>Examples in this specification are introduced with the words “for example”
  or are set apart from the normative text with <code>class="example"</code>,
  like this:
  
  <div class="example">
    <p>This is an example of an informative example.
  </div>
  
  <p>Informative notes begin with the word “Note” and are set apart from the
  normative text with <code>class="note"</code>, like this:
  
  <p class="note">Note, this is an informative note.

<h3 id="conformance-classes">
Conformance classes</h3>

  <p>Conformance to CSS Flexible Box Layout Module
  is defined for three conformance classes:
  <dl>
    <dt><dfn title="style sheet!!as conformance class">style sheet</dfn>
      <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
      style sheet</a>.
    <dt><dfn>renderer</dfn>
      <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
      that interprets the semantics of a style sheet and renders
      documents that use them.
    <dt><dfn id="authoring-tool">authoring tool</dfn>
      <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
      that writes a style sheet.
  </dl>
  
  <p>A style sheet is conformant to CSS Flexible Box Layout Module
  if all of its statements that use syntax defined in this module are valid
  according to the generic CSS grammar and the individual grammars of each
  feature defined in this module.
  
  <p>A renderer is conformant to CSS Flexible Box Layout Module
  if, in addition to interpreting the style sheet as defined by the
  appropriate specifications, it supports all the features defined
  by CSS Flexible Box Layout Module by parsing them correctly
  and rendering the document accordingly. However, the inability of a
  UA to correctly render a document due to limitations of the device
  does not make the UA non-conformant. (For example, a UA is not
  required to render color on a monochrome monitor.)
  
  <p>An authoring tool is conformant to CSS Flexible Box Layout Module
  if it writes style sheets that are syntactically correct according to the
  generic CSS grammar and the individual grammars of each feature in
  this module, and meet all other conformance requirements of style sheets
  as described in this module.

<h3 id="partial">
Partial implementations</h3>

  <p>So that authors can exploit the forward-compatible parsing rules to
  assign fallback values, CSS renderers <strong>must</strong>
  treat as invalid (and <a href="http://www.w3.org/TR/CSS21/conform.html#ignore">ignore
  as appropriate</a>) any at-rules, properties, property values, keywords,
  and other syntactic constructs for which they have no usable level of
  support. In particular, user agents <strong>must not</strong> selectively
  ignore unsupported component values and honor supported values in a single
  multi-value property declaration: if any value is considered invalid
  (as unsupported values must be), CSS requires that the entire declaration
  be ignored.
  
<h3 id="experimental">
Experimental implementations</h3>

  <p>To avoid clashes with future CSS features, the CSS2.1 specification
  reserves a <a href="http://www.w3.org/TR/CSS21/syndata.html#vendor-keywords">prefixed
  syntax</a> for proprietary and experimental extensions to CSS.
  
  <p>Prior to a specification reaching the Candidate Recommendation stage
  in the W3C process, all implementations of a CSS feature are considered
  experimental. The CSS Working Group recommends that implementations
  use a vendor-prefixed syntax for such features, including those in
  W3C Working Drafts. This avoids incompatibilities with future changes
  in the draft.
  
 
<h3 id="testing">
Non-experimental implementations</h3>

  <p>Once a specification reaches the Candidate Recommendation stage,
  non-experimental implementations are possible, and implementers should
  release an unprefixed implementation of any CR-level feature they
  can demonstrate to be correctly implemented according to spec.
  
  <p>To establish and maintain the interoperability of CSS across
  implementations, the CSS Working Group requests that non-experimental
  CSS renderers submit an implementation report (and, if necessary, the
  testcases used for that implementation report) to the W3C before
  releasing an unprefixed implementation of any CSS features. Testcases
  submitted to W3C are subject to review and correction by the CSS
  Working Group.
  
  <p>Further information on submitting testcases and implementation reports
  can be found from on the CSS Working Group's website at
  <a href="http://www.w3.org/Style/CSS/Test/">http://www.w3.org/Style/CSS/Test/</a>.
  Questions should be directed to the
  <a href="http://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a>
  mailing list.

<h3 id="cr-exit-criteria">
CR exit criteria</h3>

  <p>
  For this specification to be advanced to Proposed Recommendation,
  there must be at least two independent, interoperable implementations
  of each feature. Each feature may be implemented by a different set of
  products, there is no requirement that all features be implemented by
  a single product. For the purposes of this criterion, we define the
  following terms:
  
  <dl>
    <dt>independent <dd>each implementation must be developed by a
    different party and cannot share, reuse, or derive from code
    used by another qualifying implementation. Sections of code that
    have no bearing on the implementation of this specification are
    exempt from this requirement.
  
    <dt>interoperable <dd>passing the respective test case(s) in the
    official CSS test suite, or, if the implementation is not a Web
    browser, an equivalent test. Every relevant test in the test
    suite should have an equivalent test created if such a user
    agent (UA) is to be used to claim interoperability. In addition
    if such a UA is to be used to claim interoperability, then there
    must one or more additional UAs which can also pass those
    equivalent tests in the same way for the purpose of
    interoperability. The equivalent tests must be made publicly
    available for the purposes of peer review.
  
    <dt>implementation <dd>a user agent which:
  
    <ol class=inline>
      <li>implements the specification.
  
      <li>is available to the general public. The implementation may
      be a shipping product or other publicly available version
      (i.e., beta version, preview release, or “nightly build”). 
      Non-shipping product releases must have implemented the
      feature(s) for a period of at least one month in order to
      demonstrate stability.
  
      <li>is not experimental (i.e., a version specifically designed
      to pass the test suite and is not intended for normal usage
      going forward).
    </ol>
  </dl>
  
  <p>The specification will remain Candidate Recommendation for at least
  six months.


<hr title="Separator from footer">

<h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

	<p>Thanks for feedback and contributions to 	
	
Andrew Fedoniouk,
Arron Eicholz, 
James Elmore,
Ben Horst,
Boris Zbarsky,
Brad Kemper,
Brian Heuston,
Christian Stockwell,
Christoph Päper,
Daniel Holbert,
Erik Anderson,
Eugene Veselov, 
Fantasai,
John Jansen, 
Markus Mielke, 
Ning Rogers,
Ojan Vafai,
Peter Salas,
Phil Cupp, 
Robert O'Callahan,
Rossen Atanassov, 
Shinichiro Hamaji,
Tony Chang.

	


<h2 class="no-num" id="references">References</h2>

<h3 class="no-num" id="normative">Normative references</h3>
<!--normative-->

<h3 class="no-num" id="informative">Other references</h3>
<!--informative-->

<h2 id="property" class="no-num">Property index</h2>
<!--properties-->

<h2 class="no-num" id="index">Index</h2>
<!--index-->

</body></html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
