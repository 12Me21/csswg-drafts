<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>CSS Flexible Box Layout Module</title>
	<link rel="stylesheet" type="text/css" href="http://dev.w3.org/csswg/css-module/default.css">
	<link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/W3C-ED">
</head><body>

<div class="head">
	<!--logo-->

	<h1 id="head-box-flexible">CSS Flexible Box Layout Module</h1>
	<h2 class="no-num no-toc" id="w3c-working">[LONGSTATUS], [DATE]</h2>

	<dl>
		<dt>This version:
		<dd><!-- <a href="http://www.w3.org/TR/[YEAR]/WD-[SHORTNAME]-[CDATE]/">http://www.w3.org/TR/[YEAR]/WD-[SHORTNAME]-[CDATE]/</a></dd> -->
		<a href="http://dev.w3.org/csswg/[SHORTNAME]/">http://dev.w3.org/csswg/[SHORTNAME]/</a>

		<dt>Latest version:
		<dd><a href="http://www.w3.org/TR/css3-flexbox/">http://www.w3.org/TR/css3-flexbox/</a>

		<dt>Previous version:
		<dd><a href="http://www.w3.org/TR/2009/WD-css3-flexbox-20090723/">http://www.w3.org/TR/2009/WD-css3-flexbox-20090723/</a>

		<dt>Editors:
		<dd><a href="http://www.xanthir.com/contact">Tab Atkins Jr.</a>, Google Inc.</dd>
		<dd>Alex Mogilevsky, Microsoft Corporation, <a href="mailto:alexmog@microsoft.com">alexmog@microsoft.com</a>
		<dd>L. David Baron, Mozilla Corporation, <a href="mailto:dbaron@dbaron.org">dbaron@dbaron.org</a>

		<dt>Authors and former editors:
		<dd>Neil Deakin, Mozilla Corporation, <a href="mailto:enndeakin@gmail.com">enndeakin@gmail.com</a>
		<dd>Ian Hickson, formerly of Opera Software, <a href="mailto:ian@hixie.ch">ian@hixie.ch</a>
		<dd>David Hyatt, formerly of Netscape Corporation, <a href="mailto:hyatt@apple.com">hyatt@apple.com</a>
	</dl>
	<!--copyright-->

	<hr title="Separator for header">
</div>

<h2 class="no-num no-toc" id="abstract">
Abstract</h2>

	<p>The specification describes a CSS box model optimized for user interface design. In flexbox layout model, the children of a box are laid out either horizontally or vertically, and unused space can be assigned to a particular child or distributed among the children by assignment of "flex" to the children that should expand. Nesting of these boxes (horizontal inside vertical, or vertical inside horizontal) can be used to build layouts in two dimensions.</p>

<h2 class="no-num no-toc" id="status">Status of this document</h2>
<!--status-->

<h2 class="no-num no-toc" id="table">Table of contents</h2>
<!--toc-->


<h2 id="intro">
Introduction</h2>

	<p>CSS 2.1 defined four layout modes &mdash; algorithms which determine the size and position of boxes based on their relationships with their sibling and ancestor boxes: block layout, designed for laying out documents and simple applications; inline layout, designed for laying out text; table layout, designed for laying out information in a tabular format; and positioned layout, designed for very explicit positioning without much regard for other elements in the document. This module introduces a new layout mode, flexbox layout, which is designed for laying out more complex applications and webpages.</p>

	<p>Flexbox layout is superficially similar to block layout.  It lacks many of the more complex text or document-formatting properties that can be used in block layout, such as 'float' and 'columns', but in return it gains more simple and powerful tools for aligning its contents in ways that webapps and complex web pages often need.  </p>

    <p>The contents of a flexbox can be laid out in any direction, can have their order swapped around dynamically, and can "flex" their sizes and positions to respond to the available space.  If a flexbox is <i>multi-line</i>, the flexbox items flow in two dimensions, wrapping into separate lines in a fashion similar to how text is wrapped into multiple lines.  The direction that these lines are stacked in can also be controlled explicitly, relative either to the current writing mode (logical directions) or explicit physical directions.</p>

<h2 id='box-model'>
The Flexbox Box Model</h2>

	<p>An element with ''display:flexbox'' or ''display:inline-flexbox'' is a <dfn>flexbox</dfn>.  Block-level children of a flexbox, and some other types of children, are called <dfn title="flexbox item|flexbox items|flexbox item's" id="flexbox-item">flexbox items</dfn> and are laid out using the flexbox box model. <span class='note'>(See the <a href="#flex-items">Flexbox Items</a> chapter, below, for specifics on which children are <i>flexbox items</i> directly and which children are instead wrapped in anonymous boxes which are then <i>flexbox items</i>)</span></p>

	<p>The flexbox layout algorithm is agnostic as to the physical direction the flexbox happens to be laid out in, so we will define several direction-agnostic terms here to make the rest of the spec easier to read and understand.  The <dfn>main axis</dfn> of a flexbox is the axis on which <i>flexbox items</i> are laid out along.  The <i>flexbox items</i> are ordered such that they start on the <dfn>main-start</dfn> side of the flexbox, and go toward the <dfn>main-end</dfn> side.  A <i>flexbox item's</i> width or height, whichever is in the <i>main axis</i>, is the item's <dfn>main size</dfn>.  The <i>flexbox item's</i> 'width' or 'height' property, specifically, that is in the <i>main axis</i> is the item's <dfn>main size property</dfn>.  These terms are mapped to physical directions based on the first keyword in the 'flex-flow' property.</p>

	<p>The axis perpendicular to the <i>main axis</i> is called the <dfn>cross axis</dfn>, and similarly has <dfn>cross-start</dfn> and <dfn>cross-end</dfn> directions and sides defined.  The width or height of a <i>flexbox item</i>, whichever is in the <i>cross axis</i>, is the item's <dfn>cross size</dfn>, and similarly the actual 'width' or 'height' property, whichever is in the <i>cross axis</i>, is the item's <dfn>cross size property</dfn>.  These terms are mapped to physical directions based on the orientation of the <i>main axis</i> and the second keyword in the 'flex-flow' property.</p>

	<p>The contents of a flexbox can be easily and powerfully manipulated with a handful of properties.  Most significantly, <i>flexbox items</i> can "flex" their <i>main size</i> by using the ''flex()'' function in the 'width' or 'height' property.  This "flexing" allows the items to get bigger or smaller based on the available space in the page.  If there is leftover space in the flexbox after all of the <i>flexbox items</i> have finished flexing, the items can be aligned, centered, or distributed with the 'flex-pack' property.  <i>Flexbox items</i> can also be completely rearranged within the flexbox with the 'flex-order' property.</p>

	<p>In the <i>cross axis</i>, <i>flexbox items</i> can either "flex" to fill the available space or be aligned within the space with the 'flex-align' property.  If a flexbox is <i>multi-line</i>, new lines are added in the <i>cross-end</i> direction, and can similarly be aligned, centered, or distributed within the flexbox with the 'flex-line-pack' property.</p>

	<p>Similar to other layout modes such as table layout, a flexbox acts like a block when placed into elements using other layout modes.  Inline flexboxes act like inline-blocks.</p>

	<div class="example">
		<p>For example, the following HTML snippet declares a flexbox with a few children.  The flexbox is horizontal, and the children's widths don't fill the flexbox's width, so the additional space is distributed between the children.  The flexbox's height isn't explicitly specified, so it shrinks to the height of its tallest child and centers the other children within it:</p>

		<pre>
&lt;p style="width: 500px; padding: 5px; display: flexbox; flex-pack: distribute; flex-align: middle;">
	&lt;button style="width: 200px;">Child 1&lt;br>Another Line&lt;/button>
	&lt;button style="width: 100px;">Child 2&lt;/button>
	&lt;button style="width: 100px;">Child 3&lt;/button>
&lt;/p></pre>

		<p>This will render approximately like the following:</p>

		<p style="border: thin solid black; background: white; width: 500px; padding: 5px; overflow: hidden;">
			<button style="float: left; width: 200px; height: 40px; margin-right: 50px;">Child 1<br>Another Line</button>
			<button style="float: left; width: 100px; height: 22px; margin-top: 9px;">Child 2</button>
			<button style="float: right; width: 100px; height: 22px; margin-top: 9px;">Child 3</button>
		</p>
	</div>


<h3 id='display-flexbox'>
New values for 'display' property</h3>

	<table class="propdef">
		<tr>
			<th>Name:
			<td>display
		<tr>
			<th>New value:
			<td>flexbox | inline-flexbox
	</table>

	<p>You can declare that an element is a flexbox, and thus should use flexbox layout for its contents, by setting the 'display' property on the element to the value 'flexbox' or 'inline-flexbox'.</p>

	<p>The ''flexbox'' value makes the flexbox act like a block in other layout modes.  The ''inline-flexbox'' value makes the flexbox act like an inline-block in other layout modes.</p>

	<p>Flexboxes use a new layout algorithm, and so some properties that were designed with the assumption of block layout don't make sense in a flexbox context.  In particular:</p>

	<ul>
		<li>all of the 'column-*' properties in the Multicol module compute to their initial values on a flexbox ('break-before', 'break-inside', and 'break-after' are still valid on a flexbox).</li>

		<li>'float' and 'clear' compute to their initial values on a flexbox item</li>

		<li>'vertical-align' has no effect on a flexbox item</li>
	</ul>

	<p>A flexbox creates a new flexbox formatting context for its contents.  This is similar to a block formatting context: floats must not intrude into the flexbox, and the flexbox's margins do not collapse with the margins of its contents.  Additionally, all of the <i>flexbox items</i> establish new block formatting contexts for their contents.</p>

	<p class='issue'>Figure out the right terms to use here.</p>



<h3 id='flex-items'>
Flexbox Items</h3>

	<p>Flexbox layout algorithm operates on <i>flexbox items</i>, which are boxes that satisfy at least one of the following criteria:</p>

	<ol>
		<li>Immediate block-level children of flexbox</li>

		<li>Atomic inline-level children of flexbox</li>

		<li>Contiguous run of non-replaced inline children, wrapped into an anonymous block</li>
	</ol>

	<div class="example">
		<p>Examples of flexbox items:</p>
		<pre>
&lt;div style="display:flexbox">

    &lt;!-- flexbox item: block-level child -->
    &lt;div id="item1">block&lt;/div>

    &lt;!-- not a flexbox item, because it's out-of-flow -->
    &lt;div id="not-an-item1.5" style="position: absolute;">block&lt;/div>
    
    &lt;!-- flexbox item: block-level child -->
    &lt;div id="item2" style="display:table">table&lt;/div>
    
    &lt;!-- flexbox item: anonymous table wrapped around table-cell -->
    &lt;div id="item3" style="display:table-cell">table-cell&lt;/div> 

    &lt;!-- flexbox item: anonymous block around inline content -->
    anonymous item 4

    &lt;!-- flexbox item: block-level child -->
    &lt;div id="item5">block&lt;/div>

    &lt;!-- flexbox item: anonymous block around inline content -->
    anonymous item 6.1
    &lt;span id="item6.1">
        text 6.2
        &lt;div id="not-an-item6.3">block&lt;/div>
        text 6.4
    &lt;/span>

    &lt;!-- flexbox item: block-level replaced element -->
    &lt;iframe id="item7"></iframe>

    &lt;!-- flexbox item: inline-level replaced element -->
    &lt;img id="item7" style="display:inline">

    &lt;!-- flexbox item: inline-level replaced element -->
    &lt;button id="item8">button&lt;/button>

    &lt;!-- flexbox item: inline-table -->
    &lt;div id="item9" style="display:inline-table">table&lt;/div>
&lt;/div></pre>

		<p>Notice that block element "not-an-item6.3" is not a separate flexbox item, because it is contained inside an inline element which is being wrapped into an anonymous flex item.  Similarly, the block element "not-an-item1.5" is not a flexbox item, because it's absolutely positioned and thus out of flow.</p>
	</div>

	<p>Absolutely positioned children of a flexbox are not <i>flexbox items</i>, but their "static position" (their position when the 'top'/'right'/'bottom'/'left' properties are ''auto'') responds somewhat to the flexbox's various properties.  The element's static position in the flexbox's <i>cross axis</i> is on the <i>cross-start</i> edge of the flexbox's content box.  The static position in the flexbox's <i>main axis</i> is slightly more complex to compute:</p>

	<p>First, find the element's <dfn>hypothetical neighbors</dfn> by assuming that the element is a normal <i>flexbox item</i> with ''flex-order:0'', and reorder the flexbox's contents as mandated by 'flex-order'.  The <i>flexbox items</i> immediately preceding and following the element in the flexbox's direction (if any) are the element's <i>hypothetical neighbors</i>.</p>

	<p>If the element has two neighbors, its static position in the <i>main axis</i> is exactly in the center of the packing space between them when the flexbox is actually laid out.  If the element has only a preceding neighbor, its static position in the <i>main axis</i> is flush with the <i>main-end</i> edge of the margin box of the neighbor.  If the element has only a following neighbor, its static position in the <i>main axis</i> is flush with the <i>main-start</i> edge of the margin box of the neighbor.  Finally, if the element has no neighbors (the flexbox has no in-flow children at all), the static position in the <i>main axis</i> is based on the value of 'flex-pack': if the value is ''start'' or ''distribute'', it's flush with the <i>main-start</i> edge of the flexbox's content box; if the value is ''end'', it's flush with the <i>main-end</i> edge of the flexbox's content box; if the value is ''center'', it's centered within the flexbox's content box.</p>

<h2 id='ordering-orientation'>
Ordering and Orientation</h2>

	<p>The first level of flexbox functionality is the ability to lay out a flexbox's contents in any direction and in any order.  This allows an author to trivially achieve effects that would previously have required complex or fragile methods, such as using the 'float' property to lay out a horizontal navigation bar (which then requires further effort with the 'clear' property or others to make the elements interact nicely with the rest of the page).  This functionality is exposed through the 'flex-flow' and 'flex-order' properties.</p>

<h3 id='flex-flow'>
Flexbox Flow Direction: the 'flex-flow' property</h3>

	<table class=propdef>
		<tbody>
			<tr>
				<th>Name:</th>
				<td><dfn>flex-flow</dfn></td>
			<tr>
				<th>Values:
				<td><pre>  [ row | row-reverse | column | column-reverse ]
  [ wrap | wrap-reverse ]?
|
  [ horizontal | horizontal-reverse | horizontal-ltr | horizontal-rtl ] 
  [ wrap | wrap-reverse | wrap-down | wrap-up ]?
|
  [ vertical | vertical-reverse | vertical-ttb | vertical-btt ] 
  [ wrap | wrap-reverse | wrap-left | wrap-right ]?</pre></td>
			<tr>
				<th>Initial:
				<td>row</td>
	        </tr>
			<tr>
				<th>Applies To:
				<td>flexboxes</td>
	        </tr>
			<tr>
				<th>Inherited:
				<td>no</td>
	        </tr>
			<tr>
				<th>Computed Value:
				<td>specified value</td>
	        </tr>
			<tr>
				<th>Media:
				<td>visual</td>
	        </tr>
		</tbody>
	</table>

	<p>The 'flexbox-flow' property specifies how <i>flexbox items</i> are placed in the flexbox. The value consists of one or two keywords: the first sets the orientation and direction of the flexbox's <i>main axis</i>, while the second, if specified, marks the flexbox as being multiline and sets the direction in which new lines are stacked.</p>

	<p>The main directions affect how <i>flexbox items</i> are arranged, and how they respond to the 'flex-pack' property.  They can be set with either logical directions (relative to the writing mode) or physical directions:</p>

	<dl>
		<dt>Logical Directions</dt>
		<dd>
			<dl>
				<dt><dfn id='flex-flow-row'>row</dfn></dt>
				<dd>The flexbox's <i>main axis</i> has the same orientation as the inline axis of the current writing mode (the direction that text is laid out in).  The <i>main-start</i> and <i>main-end</i> directions are equivalent to the "start" and "end" directions, respectively, of the current writing mode.</dd>

				<dt><dfn id='flex-flow-row-reverse'>row-reverse</dfn></dt>
				<dd>Same as <i>row</i>, except the <i>main-start</i> and <i>main-end</i> directions are swapped.</dd>

				<dt><dfn id='flex-flow-column'>column</dfn></dt>
				<dd>The flexbox's <i>main axis</i> has the same orientation as the block axis of the current writing mode (the direction that blocks are laid out in).  The <i>main-start</i> and <i>main-end</i> directions are equivalent to the "before" and "after" directions, respectively, of the current writing mode.</dd>

				<dt><dfn id='flex-flow-column-reverse'>column-reverse</dfn></dt>
				<dd>Same as <i>column</i>, except the <i>main-start</i> and <i>main-end</i> directions are swapped.</dd>
			</dl>
		</dd>

		<dt>Physical Directions</dt>
		<dd>
			<dl>
				<dt><dfn id='flex-flow-horizontal'>horizontal</dfn></dt>
				<dd>The flexbox's <i>main axis</i> is horizontal.  The <i>main-start</i> direction is equivalent to either the "start" or "before" direction of the current writing mode, whichever is vertical, and the <i>main-end</i> direction is the opposite direction of <i>main-start</i>.</dd>

				<dt><dfn id='flex-flow-horizontal-reverse'>horizontal-reverse</dfn></dt>
				<dd>Same as <i>horizontal</i>, except the <i>main-start</i> and <i>main-end</i> directions are swapped.</dd>

				<dt><dfn id='flex-flow-horizontal-ltr'>horizontal-ltr</dfn></dt>
				<dd>Same as <i>horizontal</i>, except the <i>main-start</i> direction is to the left and the <i>main-end</i> direction is to the right.</dd>

				<dt><dfn id='flex-flow-horizontal-rtl'>horizontal-rtl</dfn></dt>
				<dd>Same as <i>horizontal</i>, except the <i>main-start</i> direction is to the right and the <i>main-end</i> direction is to the left.</dd>

				<dt><dfn id='flex-flow-vertical'>vertical</dfn></dt>
				<dd>The flexbox's <i>main axis</i> is vertical.  The <i>main-start</i> direction is equivalent to either the "start" or "before" direction of the current writing mode, whichever is horizontal, and the <i>main-end</i> direction is the opposite direction of <i>main-start</i>.</dd>

				<dt><dfn id='flex-flow-vertical-reverse'>vertical-reverse</dfn></dt>
				<dd>Same as <i>vertical</i>, except the <i>main-start</i> and <i>main-end</i> directions are swapped.</dd>

				<dt><dfn id='flex-flow-vertical-ttb'>vertical-ttb</dfn></dt>
				<dd>Same as <i>vertical</i>, except the <i>main-start</i> direction is upwards and the <i>main-end</i> direction is downwards.</dd>

				<dt><dfn id='flex-flow-row-vertical-btt'>vertical-btt</dfn></dt>
				<dd>Same as <i>vertical</i>, except the <i>main-start</i> direction is downwards and the <i>main-end</i> direction is upwards.</dd>
			</dl>
		</dd>
	</dl>

	<p class='note'>Usually, the logical keywords are sufficient, which is why their names are purposely short.  For example, if the page's writing mode is lr-tb, like it is when the primary language is English, the ''row'' value makes the flexbox horizontal and going from left to right, while the ''column'' value makes the flexbox vertical and going from top to bottom.  If this were specified as part of a page template, and the page as a whole was switched to a tb-rl writing-mode like what Japanese uses, the flexboxes would automatically shift to vertical and horizontal, respectively, which is often what is desired.</p>

	<p>The <i>cross axis</i> is always perpendicular to the <i>main axis</i>.  The second keyword, or the lack of it, sets the cross directions (<i>cross-start</i> and <i>cross-end</i>), and dictates whether the flexbox is single-line or multi-line.  The cross directions affect how individual <i>flexbox items</i> respond to the 'flex-align' property, and the direction in which multiple lines are stacked and aligned by the 'flex-line-pack' property.</p>

	<p>If the second keyword is omitted, the flexbox is <i>single-line</i>, the <i>cross-start</i> direction is equivalent to either the "start" or "before" direction of the current writing mode, whichever is in the <i>cross-axis</i>, and the <i>cross-end</i> direction is the opposite direction of <i>cross-start</i>.</p>

	<p>If the second keyword is provided, the flexbox is <i>multi-line</i>.  The <i>cross-start</i> and <i>cross-end</i> directions are set as follows:</p>

	<dl>
		<dt><dfn id='flex-flow-wrap'>wrap</dfn></dt>
		<dd>The <i>cross-start</i> direction is equivalent to either the "start" or "before" direction of the current writing mode, whichever is in the <i>cross-axis</i>, and the <i>cross-end</i> direction is the opposite direction of <i>cross-start</i>.</dd>

		<dt><dfn id='flex-flow-wrap-reverse'>wrap-reverse</dfn></dt>
		<dd>Same as <i>wrap</i>, except the <i>cross-start</i> and <i>cross-end</i> directions are swapped.</dd>

		<dt><dfn id='flex-flow-wrap-up'>wrap-up</dfn></dt>
		<dd>The <i>cross-start</i> direction is downwards and the <i>cross-end</i> direction is upwards.</dd>

		<dt><dfn id='flex-flow-wrap-right'>wrap-right</dfn></dt>
		<dd>The <i>cross-start</i> direction is to the left and the <i>cross-end</i> direction is to the right.</dd>

		<dt><dfn id='flex-flow-wrap-down'>wrap-down</dfn></dt>
		<dd>The <i>cross-start</i> direction is upwards and the <i>cross-end</i> direction is downwards.</dd>

		<dt><dfn id='flex-flow-wrap-left'>wrap-left</dfn></dt>
		<dd>The <i>cross-start</i> direction is to the right and the <i>cross-end</i> direction is to the left.</dd>
	</dl>

	<p class='note'>Note that not all combinations of first and second keyword are allowed by the property's syntax, as they don't all make sense.  For example, ''flex-flow: horizontal wrap-right'' is an invalid declaration.</p>

	<div class="example">
		<p>Some examples of valid flows:</p>

		<pre>
div { flex-flow:row }                      /* initial value. Main axis is inline,
                                              no wrap. */
div { flex-flow:horizontal-ltr wrap-down } /* main axis is horizontal, flow left-to-right, 
                                              wrap down */
div { writing-mode:tb-rl;                  /* main axis is vertical top-to-bottom (as line direction),
      flex-flow:vertical wrap-reverse }    /* cross axis is left-to-right (opposite to block direction) */</pre>
	</div>

	<div class='issue'>
		<p>Are all these values necessary?  I suspect we could get away with just:</p>

		<pre>
  [ row | row-reverse | column | column-reverse ]
  [ wrap | wrap-reverse ]?
|
  to [ top | bottom ]
  [ wrap-right | wrap-left ]?
|
  to [ right | left ]
  [ wrap-up | wrap-down ]?</pre>

		<p>In other words, just provide a pure-logical or pure-physical variant, rather than mixing physical and logical like with "horizontal wrap".</p>
	</div>

	<p class='issue'>Is there a good, shorter way to refer to the reversed physical directions than the 8-character "-reverse" suffix?</p>


<h3 id='flex-order'>
Display Order: the 'flex-order' property</h3>

	<p><i>Flexbox items</i> are, by default, displayed and laid out in the same order as they appear in the source document.  The 'flex-order' property may be used to change this ordering.</p>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>flex-order</dfn>
		<tr>
			<th>Value:
			<td>&lt;number>
		<tr>
			<th>Initial:
			<td>0
		<tr>
			<th>Applies to:
			<td><i>flexbox items</i></td>
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed value:
			<td>specified value
		<tr>
			<th>Media:
			<td>visual
	</table>

	<p>The 'flex-order' property assigns <i>flexbox items</i> to ordinal groups.</p>

	<p>Ordinal groups control the order in which <i>flexbox items</i> appear.  A flexbox will lay out its content starting from the lowest numbered ordinal group and going up.  Items with the same ordinal group are laid out in the order they appear in the source document.

	<div class=example>
		<p>This example shows how ordinal groups might be used.</p>

		<pre>
div { display: flexbox; }
#item1, #item3 { flex-order: 1; }
#item4 { flex-order: 0; }

&lt;div>
	&lt;button id="item1">One&lt;/button>
	&lt;button id="item2">Two&lt;/button>
	&lt;button id="item3">Three&lt;/button>
	&lt;button id="item4">Four&lt;/button>
&lt;/div></pre>

		<p>Items 2 and 4 are both in ordinal group 0 (item 2 defaults to ''0'' because it doesn't specify one explicitly).  This is the lowest ordinal group, so they'll be displayed first, and in document order, with Item 2 displayed before Item 4.  The remaining items are both in ordinal group 1, so the resulting display order will be:</p>

		<div style="border: medium solid green; display: inline-block;">
			<button>Two</button>
			<button>Four</button>
			<button>One</button>
			<button>Three</button>
		</div>
	</div>

	<p class='issue'>Add a realistic example of tab reordering.</p>

	<p class='issue'>Add an example of reordering columns in a page.</p>


<h2 id='flexibility'>
Flexibility</h2>

	<p>The defining aspect of flexbox layout is the ability to make the <i>flexbox items</i> "flex", altering their width or height to fill the available space.  This is done by declaring a <dfn>flexible length</dfn> with the ''flex()'' function, defined below.</p>


<h3 id='flex-function'>
The ''flex()'' function</h3>
 
	<p>The ''flex()'' function is used to specify the parameters of a <dfn title="flexible length|flexible lengths|flexible length's">flexible length</dfn>: the <dfn id="positive-flexibility" title="positive flexibility">positive</dfn> and <dfn>negative flexibility</dfn>, and the <dfn>preferred size</dfn>.  The syntax of the ''flex()'' function is:</p>

	<pre class=prod>flex( [ &lt;pos-flex> &lt;neg-flex>? ]? || &lt;preferred-size>? )</pre>

	<p><code>&lt;pos-flex></code> and <code>&lt;neg-flex></code> are non-negative <code>&lt;numbers>s</code>, while <code>&lt;preferred-size></code> is any value (other than another ''flex()'' function) that would be valid in the 'width' or 'height' property in which the function is used, except that zero lengths must not omit their unit.</p>

	<p>The <code>&lt;pos-flex></code> component sets the length's <i>positive flexibility</i>; if omitted, the <i>positive flexibility</i> defaults to ''1''.  The <code>&lt;neg-flex></code> component sets the length's <i>negative flexibility</i>; if omitted, it defaults to ''0''.  The <code>&lt;preferred-size></code> component sets the length's <i>preferred size</i>; if omitted, it defaults to ''0px''.</p>

	<p class='issue'>Examples!</p>


<h3 id='resolving-flexible-lengths'>
Resolving Flexible Lengths</h3>

	<p class='note'>Note: This section is non-normative.</p>

	<p><i>Flexible lengths</i> are resolved into normal, inflexible lengths by figuring out how large all of the <i>flexible lengths</i> in the flexbox <em>want</em> to be, then either growing or shrinking that <i>preferred size</i> so that the <i>flexbox items</i> exactly fill the flexbox, neither overflowing nor leaving extra unfilled space.</p>
	
	<p><i>Flexible lengths</i> are resolved into normal inflexible lengths based on their <i>preferred size</i>, their flexibility, and the amount of free space in the flexbox.  The exact algorithm is described in <a href="#layout-algorithm">a later section of this spec</a>, but in general, it works like this:</p>

	<ol>
		<li>First, set all the <i>flexible lengths</i> to their <i>preferred size</i>.</li>

		<li>Then, lay out the flexbox, and see if there is free space left, or if the flexbox is overflowing.</li>

		<li>If there's free space, distribute it among the <i>flexible lengths</i> in proportion to their <i>positive flexibility</i>.  If the flexbox is overflowing, shrink the <i>flexible lengths</i> in proportion to their <i>negative flexibility</i>.</li>

		<li>If any <i>flexible length</i> is violating a min or max width or height constraint, change it into an inflexible length that's not violating the constraint, then go back to the previous step.  Keep repeating this until either there are no <i>flexible lengths</i> left, or every <i>flexible length</i> has successfully resolved without violating any constraints.</li>
	</ol>

	<p class='issue'>Examples!</p>


<h2 id='alignment'>
Alignment</h2>

	<p>After a flexbox's contents have finished their flexing, they can be aligned in both the <i>main axis</i> with 'flex-pack' and the <i>cross axis</i> with 'flex-align'.  These properties make many common types of alignment trivial, including some things that were very difficult in CSS 2.1, like horizontal and vertical centering.</p>


<h3 id='flex-pack'>
Main Axis Alignment: the 'flex-pack' property</h3>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>flex-pack</dfn>
		<tr>
			<th>Value:
			<td>start | end | center | distribute
		<tr>
			<th>Initial:
			<td>start
		<tr>
			<th>Applies to:
			<td>flexboxes
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed Value:
			<td>specified value
		<tr>
			<th>Media:
			<td>visual
	</table>

	<p>The 'flex-pack' property aligns <i>flexbox items</i> in the <i>main axis</i> of the current line of the flexbox.  This is done <em title=''>after</em> any flexible lengths have been resolved.  Typically it helps distribute extra free space leftover when either all the <i>flexbox items</i> on a line are inflexible, or are flexible but have reach their maximum size, but it also exerts some control over the alignment of items when they overflow the line.</p>

	<dl>
		<dt><dfn id='flex-pack-start'>start</dfn></dt>
		<dd><i>Flexbox items</i> are packed toward the start of the line.  The <i>main-start</i> margin edge of the first <i>flexbox item</i> on the line is placed flush with the <i>main-start</i> edge of the line, and each subsequent <i>flexbox item</i> is placed flush with the preceding item.</dd>

		<dt><dfn id='flex-pack-end'>end</dfn></dt>
		<dd><i>Flexbox items</i> are packed toward the end of the line.  The <i>main-end</i> margin edge of the last <i>flexbox item</i> is placed flush with the <i>main-end</i> edge of the line, and each preceding <i>flexbox item</i> is placed flush with the subsequent item.</dd>

		<dt><dfn id='flex-pack-center'>center</dfn></dt>
		<dd><i>Flexbox items</i> are packed toward the center of the line.  If the leftover free-space is negative, this value is identical to ''start''.  Otherwise, the <i>flexbox items</i> on the line are placed flush with each other and aligned in the center of the line, with equal amounts of empty space between the <i>main-start</i> edge of the line and the first item on the line and between the <i>main-end</i> edge of the line and the last item on the line.</dd>

		<dt><dfn id='flex-pack-distribute'>distribute</dfn></dt>
		<dd><i>Flexbox items</i> are evenly distributed in the line.  If the leftover free-space is negative or there is only a single <i>flexbox item</i> on the line, this value is identical to ''start''.  Otherwise, the <i>main-start</i> margin edge of the first <i>flexbox item</i> on the line is placed flush with the <i>main-start</i> edge of the line, the <i>main-end</i> margin edge of the last <i>flexbox item</i> on the line is placed flush with the <i>main-end</i> edge of the line, and the remaining <i>flexbox items</i> on the line are distributed so that the empty space between any two adjacent items is the same.</dd>
	</dl>

	<div class=example>
		<p class=issue>TODO: Examples showing the four values.</p>
	</div>


<h3 id='flex-align'>
Cross Axis Alignment: the 'flex-align' property</h3>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>flex-align</dfn>
		<tr>
			<th>Value:
			<td>start | end | center | baseline | stretch
		<tr>
			<th>Initial:
			<td>stretch
		<tr>
			<th>Applies to:
			<td><i>flexbox items</i>
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed Value:
			<td>specified value
		<tr>
			<th>Media:
			<td>visual
	</table>

	<p>The 'flex-align' property aligns <i>flexbox items</i> in the <i>cross axis</i> of the current line of the flexbox, similar to 'flex-pack' but in the perpendicular axis.  Note that 'flex-align' applies to individual <i>flexbox items</i>, while 'flex-pack' applies to the flexbox itself.</p>

	<dl>
		<dt><dfn id="flex-align-start">start</dfn></dt>
		<dd>The <i>cross-start</i> margin edge of the <i>flexbox item</i> is placed flush with the <i>cross-start</i> edge of the line.</dd>

		<dt><dfn id="flex-align-end">end</dfn></dt>
		<dd>The <i>cross-end</i> margin edge of the <i>flexbox item</i> is placed flush with the <i>cross-end</i> edge of the line.</dd>

		<dt><dfn id="flex-align-center">center</dfn></dt>
		<dd>The <i>flexbox item's</i> margin box is centered in the <i>cross axis</i> within the line.</dd>

		<dt><dfn id="flex-align-baseline">baseline</dfn></dt>
		<dd>
			<p>If the <i>flexbox item's</i> inline axis is the same as the <i>cross axis</i>, this value is identical to ''start''.</p>

			<p>Otherwise, all <i>flexbox items</i> on the line with ''flex-align:baseline'' that don't run afoul of the previous paragraph are aligned such that their baselines align, and the item with the largest distance between its baseline and its <i>cross-start</i> margin edge is placed flush against the <i>cross-start</i> edge of the line.</p>
		</dd>
			  
		<dt><dfn id="flex-align-stretch">stretch</dfn></dt>
		<dd>
			<p>If the <i>cross size property</i> of the <i>flexbox item</i> is anything other than ''auto'', this value is identical to ''start''.</p>

			<p>Otherwise, this value causes the <i>cross size property</i> of the <i>flexbox item</i> to resolve to the length necessary to make the <i>cross size</i> of the item's margin box the same size as the line.</p>
		</dd>
	</dl>

	<div class=example>   
		<p>By using a vertical flexbox and 'flex-align', we can emulate the functionality of HTML's <code>&lt;center></code> element:</p>

		<pre>&lt;div>
	&lt;div>foo foo foo foo&lt;/div>
	&lt;div>bar bar&lt;br>bar bar&lt;/div>
	&lt;div>foo foo foo foo foo foo foo foo foo foo foo foo&lt;/div>
&lt;/div>
&lt;style>
	div {
		display: flexbox;
		flex-flow: column;
		width: 200px;
	}
	div > div {
		flex-align: center;
	}
&lt;/style></pre>

		<p><img alt="" src="images/basic-vertical-flexbox.png"></p>
	</div>

	<p class='issue'>More examples for the other alignment values!</p>

	<p>The precise effects of this property are articulated in the <a href="#layout-algorithm">Layout Algorithm</a> section.</p>


<h2 id='multiline'>
Multi-line Flexbox</h2>

	<p>A flexbox can be either single-line or multi-line, depending on the 'flex-flow' property.  A <dfn>single-line</dfn> flexbox lays out all of its children in a single line, even if that would cause the flexbox to overflow its bounds.  A <dfn>multi-line</dfn> flexbox breaks its <i>flexbox items</i> across multiple lines to avoid overflowing, similar to how text is broken onto a new line when it gets too wide to fit on the existing line.  Every line contains at least one <i>flexbox item</i>, unless the flexbox itself is completely empty.</p>

	<p>When additional lines are created, they are stacked in the flexbox in the <i>cross axis</i>.  Each line is completely independent; flexible lengths and the 'flex-pack' and 'flex-align' properties only pay attention to the items on a single line at a time.  The <i>main size</i> of a line is the same as the <i>main size</i> of the flexbox's content box.  The <i>cross size</i> of a line depends on whether the flexbox is <i>single-line</i> or <i>multi-line</i>: the <i>cross size</i> of the sole line in a <i>single-line</i> flexbox is the same as the <i>cross size</i> of the flexbox's content box, while the <i>cross size</i> of a line in a <i>multi-line</i> flexbox is the minimum size necessary to contain the <i>flexbox items</i> on the line, after aligning them with 'flex-align'.  The lines themselves are then aligned within a flexbox with the 'flex-line-pack' property.</p>

	<div class=example>
		<p>This example shows four buttons that do not fit horizontally.</p>

		<pre>&lt;style>
#div1 {
	display: flexbox;
	flex-flow: row wrap;
	width: 300px;
}
button {
	width: flex(80px 1);
}
&lt;style>

&lt;div id="div1">
	&lt;button id="button1">Elephant&lt;/button>
	&lt;button id="button2">Tiger&lt;/button>
	&lt;button id="button3">Antelope&lt;/button>
	&lt;button id="button4">Wildebeest&lt;/button>
&lt;/div></pre>

		<p>The buttons are first set to their preferred widths, in this case 80 pixels. This will allow the first three buttons to fit in 240 pixels with 60 pixels left over of remaining space. Because the 'flex-flow' property specifies a multiline flexbox (due to the ''wrap'' keyword appearing in its value), the flexbox will create an additional line to contain the last button.</p>

		<p>Flexibility is applied to each element, separately for each line. The first line has 60 pixels of remaining space and all of the buttons have the same flexibility, so each of the three buttons on that line will receive 20 pixels of extra width, ending up 100px wide. The remaining button is on a line of its own and will stretch to the entire width of the line, or 300 pixels.</p>

		<div style="width:300px; border:medium solid green; overflow: hidden;">
			<button style="width:100px; float: left;">Elephant</button>
			<button style="width:100px; float: left;">Tiger</button>
			<button style="width:100px; float: left;">Antelope</button>
			<button style="width:300px; float: left;">Wildebeest</button>
		</div>

		<p>If the box was resized, the buttons may rearrange onto different lines as necessary.</p>
		
		<p>If the style rules in the example above were changed to the following:</p>

		<pre>
#div1 {
	display: flexbox;
	flex-flow: row wrap;
	flex-pack: center;
	width: 300px;
}
button {
	width: flex(80px 1);
	max-width: 90px;
}</pre>

		<p>Similar to the previous example, the first three buttons will fit on the first line, and the last button will wrap onto a new line.  However, when the buttons attempt to flex they can only grow to 90px each, due to their 'max-width' property.  This leaves 30px of free space on the first line and 210px of free space on the second line.  Because 'flex-pack' is set to ''center'', the buttons will be centered on each line, with the free space split equally on either side.</p>

		<div style="width:300px; border:medium solid green; text-align:center;">
			<button style="width:90px; float: left; margin-left: 15px;">Elephant</button>
			<button style="width:90px; float: left;">Tiger</button>
			<button style="width:90px; float: left;">Antelope</button>
			<button style="width:90px">Wildebeest</button>
		</div>
	</div>


<h3 id='flex-line-pack'>
'flex-line-pack' property</h3>

	<table class=propdef>
		<tr>
			<th>Name:
			<td><dfn>flex-line-pack</dfn>
		<tr>
			<th>Value:
			<td>start | end | center | distribute
		<tr>
			<th>Initial:
			<td>before
		<tr>
			<th>Applies to:
			<td><i>multi-line</i> flexboxes
		<tr>
			<th>Inherited:
			<td>no
		<tr>
			<th>Computed Value:
			<td>specified value
		<tr>
			<th>Media:
			<td>visual
	</table>

	<p>The 'flex-line-pack' property aligns a flexbox's lines within the flexbox when there is extra space in the <i>cross axis</i>, similar to how 'flex-pack' aligns individual items within the <i>main axis</i>:</p>

	<dl>
		<dt><dfn id='flex-line-pack-start'>start</dfn></dt>
		<dd>Lines are packed toward the start of the flexbox.  The <i>cross-start</i> edge of the first line in the flexbox is placed flush with the <i>cross-start</i> edge of the flexbox, and each subsequent line is placed flush with the preceding line.</dd>

		<dt><dfn id='flex-line-pack-end'>end</dfn></dt>
		<dd>Lines are packed toward the end of the flexbox.  The <i>cross-end</i> edge of the last line is placed flush with the <i>cross-end</i> edge of the flexbox, and each preceding line is placed flush with the subsequent line.</dd>

		<dt><dfn id='flex-line-pack-center'>center</dfn></dt>
		<dd>Lines are packed toward the center of the flexbox.  If the leftover free-space is negative, this value is identical to ''start''.  Otherwise, the lines in the flexbox are placed flush with each other and aligned in the center of the flexbox, with equal amounts of empty space between the <i>cross-start</i> content edge of the flexbox and the first line in the flexbox and between the <i>cross-end</i> content edge of the flexbox and the last line in the flexbox.</dd>

		<dt><dfn id='flex-line-pack-distribute'>distribute</dfn></dt>
		<dd>Lines are evenly distributed in the flexbox.  If the leftover free-space is negative or there is only a single line in the flexbox, this value is identical to ''start''.  Otherwise, the <i>cross-start</i> edge of the first line in the flexbox is placed flush with the <i>cross-start</i> content edge of the flexbox, the <i>cross-end</i> edge of the last line in the flexbox is placed flush with the <i>cross-end</i> content edge of the flexbox, and the remaining lines in the flexbox are distributed so that the empty space between any two adjacent lines is the same.</dd>
	</dl>

	<p class='note'>Note: Only <i>multi-line</i> flexboxes ever have free space in the <i>cross axis</i> for lines to be aligned in, because in a <i>single-line</i> flexbox the sole line automatically stretches to fill the space.</p>

	<p class="issue">TODO: examples</p>


<h2 id='layout-algorithm'>
Flexbox Layout Algorithm</h2>

	<p>This section contains normative algorithms detailing the exact layout behavior of a flexbox and its contents.  The algorithms here were designed to optimize readability and theoretical simplicity, and may not necessarily be the most efficient.  Implementations may use whatever actual algorithms they wish, but must produce the same results as the algorithms described here.</p>

	<div class=issue>
		<p>Here I'll outline the general structure of the layout algorithm, before I go into the ugly details below.</p>

		<ol>
			<li>Reorder flexbox items according to 'flex-order'.</li>

			<li>Find the "hypothetical size" of every flexbox item by treating them like a normal element of their display type and the flexbox like a display:block element, and both the flexbox and the item establish BFCs.  Resolve flexible widths/heights by treating them like their preferred size.  Resolve 'auto' widths/heights by shrinkwrapping them.</li>

			<li>Based on the hypothetical sizes of the items, find the real main size of the flexbox and the hypothetical cross size.</li>

			<li>Based on both of these, linebreak the flexbox if it's multiline.  (Or does the possibility of linebreaking affect the main size of the flexbox, in a shrinkwrapping way?)</li>

			<li>Resolve any flexible lengths.  All items now have a real main size.</li>

			<li>Align in the main axis, per 'flex-pack'.</li>

			<li>Based on 'flex-align', find the real cross size of the flexbox, its lines, and the items.</li>

			<li>Align in the cross axis, per 'flex-align'.</li>

			<li>Align the lines, per 'flex-line-pack'.</li>
		</ol>

		<p>Note that if any "hypothetical" size is a definite length or percentage, it's actually a real size immediately and won't change (well, aside from flexing).  The hypothetical calculations are meant to give intermediate results in the presence of ''auto'' values (and others?), so I can do other calculations that depend on those lengths.</p>
	</div>


<h2 id="pagination">
Page breaks in flexbox</h2>

	<p class="issue">TODO: define how flexbox should break on pages, columns, etc. This may or may not be normative until there is more than one implementation.</p>

	<p>Very roughly:</p>

	<ul>
		<li>Flexboxes can beak across pages between items, between rows of items (in multi-line mode) and inside items, as long as 'break-' property allow that. All 'break-' properties are supported on flexbox, on flexbox items and inside flexbox items.</li>

		<li>Breaking behavior of a single-line vertical flexbox should be identical to a block in normal flow where children have same sizes and positions (e.g. explicitly set to match computed values in flexbox), same content and same breaking properties. <span class="issue">This is good goal or guidance, but not necessarily good normative definition. Get specific.</span> </li>

		<li>Breaking behavior of a horizontal single-line flexbox should be similar (not necessarily identical) to that of a single-row table with same sizing.</li>

		<li>In horizontal flexbox, a forced break within an items causes subsequent content of that item to go to next container, but it doesn't affect sibling items or their content.</li>

		<li>In horizontal multi-line flexbox, values of 'break-before' and 'break-after' for each line are computed from combinatoin of properties on children that fit in that line (or would have fit, given available width and infinite height)</li>
	</ul>

	<p class="issue">TODO: define breaking of vertical multi-line flexbox</p>

	<p class="issue">TODO: add more detail: how breaking affect sizing (for broken boxes and boxes after the break) and alignment</p>


<h2 id="layout-interface">
Box Properties and Sizing</h2>

	<p class='issue'>Define how flexboxes are sized, paying attention to width/height keywords on both the flexbox and flexbox items, the writing modes of both the flexbox and flexbox items, and the flexbox direction.</p>


<hr title="Separator from footer">

<h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

	<p>[This section will contain further acknowledgments.]</p>

	<p>Thanks for feedback from James Elmore and Shinichiro Hamaji.</p>

<h2 class="no-num" id="references">References</h2>

<h3 class="no-num" id="normative">Normative references</h3>
<!--normative-->

<h3 class="no-num" id="informative">Other references</h3>
<!--informative-->

<h2 id="property" class="no-num">Property index</h2>
<!--properties-->

<h2 class="no-num" id="index">Index</h2>
<!--index-->

</body></html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->