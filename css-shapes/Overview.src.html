<!DOCTYPE html public '-//W3C//DTD HTML 4.01//EN' 'http://www.w3.org/TR/html4/strict.dtd'>
<html lang="en">
<head profile="http://www.w3.org/2006/03/hcard">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
  <title>CSS Shapes Module Level 1</title>
  <script src='http://test.csswg.org/harness/annotate.js#css-shapes-1_dev' type='text/javascript' defer></script>
  <link rel="stylesheet" type="text/css" href="../shared/style/default.css" >


  <style type="text/css">
    .singleImgExample {
    	display: block;
    	margin: auto;
    }
    
    .example-table {
    	table-layout: fixed; 
    	width: 100%; 
    }
    
    .example-table tr td img {
    	width: 90%;
    }
  </style>  
       
        <link rel="stylesheet" type="text/css"
         href="issues.css">
       <link rel="stylesheet" type="text/css"
        href="http://www.w3.org/StyleSheets/TR/W3C-ED.css">
        

       <link id="st" href="../shared/style/alternate-spec-style.css" rel="stylesheet" 
              type="text/css" title="alternate spec style">     


</head>
<body>
    <div id="div-head" class="head">
        <!--begin-logo-->
        <p><a href="http://www.w3.org/"><img id="mobile-logo" alt="W3C" height="53" src=
        "http://www.w3.org/2008/site/images/logo-w3c-mobile-lg" width="90"></a> 
        
        

        <p><a href="http://www.w3.org/"><img id="logo" alt="W3C" height="48" src=
        "http://www.w3.org/Icons/w3c_home" width="72"></a> <!--end-logo--></p>
        <h1 id="css-shapes-module">CSS Shapes Module Level 1</h1>
        <h2 class="no-num no-toc">[LONGSTATUS] [DATE]</h2>
        <dl>
            <dt>This version:</dt>
            <dd><a href="[VERSION]">[VERSION]</a></dd>

            <dt>Latest version:</dt>
            <dd><a href="http://www.w3.org/TR/[SHORTNAME]/">http://www.w3.org/TR/css-shapes/</a></dd>

            <dt>Editor's Draft:</dt>
            <dd><a href="http://dev.w3.org/csswg/[SHORTNAME]/">http://dev.w3.org/csswg/[SHORTNAME]/</a>

            <dt>Previous version:</dt>
            <dd>None</dd>

            <dt>Editors:</dt>
            <dd class="vcard"><span class="fn">Vincent Hardy</span>, <span class="org">Adobe Systems, Inc.</span>, <span class="email">vhardy@adobe.com</span></dd>
            <dd class="vcard"><span class="fn">Rossen Atanassov</span>, <span class="org">Microsoft Corporation</span>, <span class="email">ratan@microsoft.com</span></dd>
            <dd class="vcard"><span class="fn">Alan Stearns</span>, <span class="org">Adobe Systems, Inc.</span>, <span class="email">stearns@adobe.com</span></dd>

            <dt>Issues List:</dt>
            <dd><a href="https://www.w3.org/Bugs/Public/buglist.cgi?query_format=advanced&amp;product=CSS&amp;component=Shapes&amp;resolution=---&amp;cmdtype=doit">in Bugzilla</a></dd>
            
  <dt>Feedback:</dt>
    <dd><a href="mailto:www-style@w3.org?subject=%5B[css-shapes]%5D%20feedback"
         >www-style@w3.org</a> 
         with subject line &ldquo;<kbd>[css-shapes] 
         <var>&hellip; message topic &hellip;</var></kbd>&rdquo;
         (<a rel="discussion" href="http://lists.w3.org/Archives/Public/www-style/"
           >archives</a>)
    
    <dt>Test Suite:</dt>
    <dd><a href="http://test.csswg.org/suites/css3-shapes/nightly-unstable/">http://test.csswg.org/suites/css3-regions/nightly-unstable/</a></dd>

        </dl>
        <!--copyright-->
        <hr title="Separator for header">
    </div>

    <h2 class="no-num no-toc" id="abstract">Abstract</h2>

    <p>CSS Shapes describe geometric shapes for use in CSS. 
        For Level 1, CSS Shapes can be applied to floats. 
        A circle shape on a float will cause inline content 
        to wrap around the circle shape 
        instead of the float's bounding box.
    </p>

    <p class="note">
        Future levels of CSS Shapes will allow use of shapes 
        on elements other than floats. 
        Other CSS modules can make use of shapes as well, 
        such as CSS Masking [[CSS-MASKING]] 
        and CSS Exclusions [[CSS3-EXCLUSIONS]].
    </p>

    <h2 class="no-num no-toc" id="status">Status of this document</h2>
    <!--status-->

<p>A previous version of this draft has been published as part of the
Working Draft <a
href="http://www.w3.org/TR/2012/WD-css3-exclusions-20120503/"
>“<cite>CSS Exclusions and Shapes</cite>” dated 3 May 2012.</a>
   
    <h2 class="no-num no-toc" id="contents">Table of contents</h2>
    <!--toc-->

    <h2 id="intro">Introduction</h2>
    <p><em>This section is not normative.</em></p>

    <p>
      Shapes define arbitrary geometries 
      that can be used as CSS values. 
      This specification defines properties 
      to control the geometry 
      of an element's <span>float area</span>. 
      The 'shape-outside' property uses shape values 
      to define the <span>float area</span> for a float. 
    </p>
    
    <p class="note">
        If a user agent implements both CSS Shapes 
        and CSS Exclusions, 
        the 'shape-outside' property defines 
        the exclusion area for an exclusion.
    </p>

    <p class="note">
        A future level of CSS Shapes will define a shape-inside property, 
        which will define a shape to wrap content within the element.
    </p>

    <h3 id="module-interactions">Module Interactions</h3>

    <p>This module extends the float features defined in [[!CSS21]] chapter 9.</p> 

    <h3 id="values">Values</h3>

    <p>This specification follows the CSS property definition conventions from [[!CSS21]]. Value types not defined in these specifications are defined in CSS Values and Units Module Level 3 [[!CSS3VAL]].</p>

    <p>In addition to the property-specific values listed in their definitions, all properties defined in this specification also accept the inherit keyword as their property value. For readability it has not been repeated explicitly.</p>

    <h3 id="terminology">Terminology</h3>

    <p><dfn>Wrap</dfn>

    <p>
      This specification uses the term 'wrap' 
      to refer to flowing content 
      around the sides of a float area, 
      defined in [[!CSS21]] chapter 9. 
      Content wraps around the right side 
      of a left-floated box, 
      and content wraps around the left side 
      of a right-floated box. 
      One result of this wrapping 
      is that line boxes next to a float 
      are shortened as necessary 
      to avoid intersections with the float area.
    </p>
    
    <p><dfn>Float area</dfn>
    
    <p>
      The area used 
      for wrapping content 
      around a float element. 
      The rules for float behavior 
      use the sides of the float area 
      to determine where content flows. 
      By default, 
      the float area is the float element's 
      <a href="http://www.w3.org/TR/CSS2/box.html#box-dimensions">margin box</a>. 
      This specification's 'shape-outside' property 
      can be used to define arbitrary, 
      non-rectangular float areas. 
    </p>

    <h2 id="relation-to-box-model-and-float-behavior">Relation to the box model and float behavior</h2>
    
    <p>
        While the boundaries used 
        for wrapping inline flow content 
        outside a float 
        can be defined using shapes, 
        the actual box model does not change. 
        If the element has specified 
        margins, borders or padding 
        they will be computed and rendered 
        according to the [[!CSS3BOX]] module. 
        Also, float positioning and stacking are not affected 
        by defining a float area with a shape.
    </p>

    <p>
      When a shape is used to define 
      a <span>float area</span>, 
      the shape is clipped 
      to the float's margin box. 
      In other words, 
      a shape can only ever reduce 
      a <span>float area</span>, 
      not increase it. 
      A reduced float area may have no effect 
      on some line boxes 
      that would normally be affected by the float.
    </p>

    <p>A float area defined by a shape 
      may reduce the normal float area on all sides, 
      but this does not allow content to wrap 
      on both sides of a float. 
      Left floats with a 'shape-outside' still 
      only allow content wrapping on the right side, 
      and right floats only allow wrapping on the left.
    </p> 

      <div class="example">
          <p>
              In the following example 
              the left and right floating 
              <code class="html">div</code> elements 
              specify a triangular shape 
              using the 'shape-outside' property.
          </p>

<pre><code class="html">
&lt;div style="text-align:center;"&gt;
      &lt;div id="float-left"&gt;&lt;/div&gt;
      &lt;div id="float-right"&gt;&lt;/div&gt;
      &lt;div&gt;
      Sometimes a web page's text content appears to be
      funneling your attention towards a spot on the page
      to drive you to follow a particular link.  Sometimes
      you don't notice.
      &lt;/div&gt;
&lt;/div&gt;

&lt;style type="text/css"&gt;
#float-left {
      shape-outside: polygon(0 0, 100% 100%, 0 100%);
      float: left;
      width: 40%;
      height: 12ex;
  }

#float-right {
      shape-outside: polygon(100% 0, 100% 100%, 0 100%);
      float: right;
      width: 40%;
      height: 12ex;
  }
  &lt;/style&gt;
&lt;/div&gt;</code></pre>
      
        <img class="singleImgExample" src="images/float-shape-outside.png" alt="Using the shape-outside property with a float"/>
      </div>

      <div class="example">
        <p>
          Since shapes are clipped to the float's margin box, 
          adding this shape to the left float above 
          would result in the same rendering.
        <p>
<pre><code class="css">
      shape-outside: polygon(0 0, 500% 500%, 0 500%);
</code></pre>
      </div>

      <div class="example">
        <p>
          A shape with no extent will create 
          a <span>float area</span> with no extent. 
          Because wrapping only considers the float area, 
          the shape below applied to a left float 
          will allow inline content 
          to flow through all of the float's box.
        <p>
<pre><code class="css">
      shape-outside: rectangle(0,0,0%,0%);
</code></pre>
      </div>

      <div class="example">
        <p>
          A 'shape-outside' can create open areas 
          on both the left and right 
          of a float area. 
          Content still wraps only on one side 
          of a float in this case. 
          In the picture, 
          the shape is rendered in blue, 
          and the content area outside the shape in mauve. 
        <p>
<pre><code class="css">
      shape-outside: polygon(50px 0px, 100px 100px, 0px 100px);
</code></pre>
      <img class="singleImgExample" src="images/float-side-example.png" alt="Wrapping around right side of a left-float float area"/>
      </div>

      <div class="example">
        <p>
          The following styling creates 
          a shape much smaller than 
          the float's content area, 
          and adds a margin-top to the float. 
          In the picture, 
          the shape is rendered in blue, 
          the content area outside the shape in mauve, 
          and the margin area of the float box in yellow. 
          The inline content only wraps around the shape, 
          and otherwise overlays the rest 
          of the float margin box. 
        </p>
<pre><code class="html">
.float-left {
      shape-outside: polygon(0% 50%, 50% 100%, 0 100%);
      float: left;
      width: 100px;
      height: 100px;
      margin-top: 20px;
}
</code></pre>
        <img class="singleImgExample" src="images/float-margin-example.png" alt="Adding margin-top to a float with a small shape-outside"/>

        <p>
          The next picture shows a possible result 
          if two of these floats 
          were stacked next to each other. 
          Note that the floats are positioned 
          using their margin boxes, 
          not the float area.
        </p>
        <img class="singleImgExample" src="images/stacked-float-example.png" alt="Stacking two floats with a small shape-outside"/>
      </div>

      <h2 id="basic-shapes-from-svg-syntax">Basic Shapes</h2>
      <p>
          Shapes can be specified using 
          types and parameters drawn from SVG's <a href="http://www.w3.org/TR/SVG/shapes.html">basic shapes</a>. 
          The definitions use the 
          <code><a href="http://www.w3.org/TR/css3-values/#lengths">&lt;length&gt;</a></code> and  
          <code><a href="http://www.w3.org/TR/css3-values/#percentages">&lt;percentage&gt;</a></code> 
          types.
          When using this syntax 
          to define shapes, 
          the relevant box is determined 
          by the computed value of the 
          <a href="http://www.w3.org/TR/css3-ui/#box-sizing">'box-sizing'</a>
          property. 
          The coordinate system for the shape 
          has its origin on the top-left corner of the
          relevant box with the x-axis 
          running to the right 
          and the y-axis running downwards. 
          All the lengths expressed in percentages 
          are resolved from the used dimensions 
          of the relevant box. 
          For the radius <code>r</code> of the <code>circle</code> shape, 
          a percentage value is resolved from the used width and height of the relevant box as <code>sqrt((<em>width</em>)**2 + (<em>height</em>)**2))/sqrt(2)</code>.
      </p>
      
       
      <h3 id="supported-basic-shapes">Supported Shapes</h3>
      <p>The following basic shapes are supported. All basic shapes use functional notation following the rules defined in <a href="http://www.w3.org/TR/css3-values/#functional-notation">CSS Values and Units</a> [[CSS3VAL]].
      <dl>
          <dt><dfn id="rectangle">rectangle</dfn>() 
            takes four to six arguments 
            of &lt;length&gt; or &lt;percentage&gt;</dt>
          <dd>
              <ul>
                  <li>
                      The first four arguments represent 
                      <strong>x, y, width</strong> and 
                      <strong>height</strong>  
                      of the rectangle. 
                      Negative values for width and height are invalid.
                  </li>
                  <li>
                      The last two optional arguments represent 
                      <strong> rx</strong> and <strong>ry</strong>. 
                      For rounded rectangles they define 
                      the x-axis radius and y-axis radius 
                      of the ellipse used to round off 
                      the corners of the rectangle. 
                      Negative values for rx and ry are invalid. 
                      See notes below on edge cases for these arguments.
                  </li>
              </ul>
          </dd>
          <dt><dfn id="inset-rectangle">inset-rectangle</dfn>() 
            takes four to six arguments 
            of &lt;length&gt; or &lt;percentage&gt;</dt>
          <dd>
              <ul>
                  <li>
                      The first four arguments represent the 
                      <strong>top, right, bottom</strong> and 
                      <strong>left</strong> offsets 
                      from the relevant box inward 
                      that define the positions 
                      of the edges 
                      of the inset rectangle. 
                      Negative values for any 
                      of these insets are invalid.
                  </li>
                  <li>
                      The last two optional arguments represent 
                      <strong> rx</strong> and <strong>ry</strong>. 
                      For rounded inset rectangles they define 
                      the x-axis radius and y-axis radius 
                      of the ellipse used to round off 
                      the corners of the inset rectangle. 
                      Negative values for rx and ry are invalid. 
                      See notes below on edge cases for these arguments.
                  </li>
              </ul>
          </dd>
          <dt><dfn id="circle">circle</dfn>() 
            takes three arguments 
            of &lt;length&gt; or &lt;percentage&gt;</dt>
          <dd>
              <ul>
                  <li>
                      The three arguments represent 
                      <strong>cx</strong>, 
                      <strong>cy</strong>, 
                      and <strong>r</strong>. 
                      They define the x-axis and y-axis coordinates
                      of the center of the circle 
                      and the radius of the circle. 
                      A negative value for r is invalid.
                  </li>
              </ul>
          </dd>
          <dt><dfn id="ellipse">ellipse</dfn>() 
            takes four arguments 
            of &lt;length&gt; or &lt;percentage&gt;</dt>
          <dd>
              <ul>
                  <li>
                      The four arguments represent 
                      <strong>cx</strong>, 
                      <strong>cy</strong>, 
                      <strong>rx</strong>, and 
                      <strong>ry</strong>.  
                      They define the x-axis and y-axis coordinates
                      of the center of the ellipse 
                      and the x-axis and y-axis radius
                      of the ellipse. 
                      Negative values for rx and ry are invalid.
                  </li>
              </ul>
          </dd>
          <dt><dfn id="polygon">polygon</dfn>() 
            starts with an optional &lt;fill-rule&gt; argument, 
            followed by a list of arguments consisting of 
            &lt;length&gt; or &lt;percentage&gt; pairs.</dt>
          <dd>
              <ul>
                  <li><strong>fill-rule</strong> - The filling rule used to determine the interior of the
                      polygon. See <a href="http://www.w3.org/TR/SVG/painting.html#FillRuleProperty">fill-rule</a> property in SVG for details. Possible values are nonzero
                      or evenodd. Default value when omitted is nonzero.</li>
                  <li>
                      Each pair argument in the list represents <strong>x<sub>i</sub></strong> and <strong>y<sub>i</sub></strong> - 
                      the <strong>x</strong> and <strong>y</strong> axis coordinates of the i-th vertex of the polygon.
                  </li>
              </ul>
              <p>The UA must close a polygon 
                by connecting the last vertex 
                with the first vertex of the list.</p>
              <p>At least three vertices are required 
                to define a polygon with an area. 
                This means that (for this specification) 
                polygons with less than three vertices 
                (or with three or more vertices 
                arranged to enclose no area) 
                result in an empty float area, 
                which allows inline content 
                to flow through all 
                of the float's box.</p>
          </dd>
      </dl>

      <p>If either or both of the values for corner radii 
        on rectangle or inset-rectangle are omitted, then their values 
        are determined in the following manner. 
        If neither rx nor ry are specified, 
        the values are 0 for both. 
        If only one value is specified, 
        that value is used for both. 
      </p>
      <p>If the values for corner radii cause any 
        of the curves to overlap, 
        the solution for 
        <a href="http://www.w3.org/TR/css3-background/#corner-overlap">overlapping curves</a> 
        from CSS Backgrounds and Borders [[!CSS3BG]] 
        is used to avoid the overlap.
      <p>

      <h3 id='basic-shape-syntax'>Syntax of Basic Shapes</h3>

<pre>
rectangle() = 
  rectangle( &lt;shape-arg&gt;, &lt;shape-arg&gt;, &lt;shape-arg&gt;, &lt;shape-arg&gt; [, &lt;shape-arg&gt;]? [, &lt;shape-arg&gt;]? )

inset-rectangle() = 
  inset-rectangle( &lt;shape-arg&gt;, &lt;shape-arg&gt;, &lt;shape-arg&gt;, &lt;shape-arg&gt; [, &lt;shape-arg&gt;]? [, &lt;shape-arg&gt;]? )

circle() = circle( &lt;shape-arg&gt;, &lt;shape-arg&gt;, &lt;shape-arg&gt; )

ellipse() = ellipse( &lt;shape-arg&gt;, &lt;shape-arg&gt;, &lt;shape-arg&gt;, &lt;shape-arg&gt; )

polygon() = polygon( [&lt;fill-rule&gt;,]? [&lt;shape-arg&gt;]{2}# )

&lt;shape-arg&gt; = &lt;length&gt; | &lt;percentage&gt;

&lt;fill-rule&gt; = nonzero | evenodd 
</pre>      

      <h3 id='basic-shape-interpolation'>Interpolation of Basic Shapes</h3>

        <p>For interpolating between 
            one basic shape and a second, 
            the rules described below are applied. 
        </p>
        <ul>
            <li>If both basic shapes are of the same type and not of type polygon:
                <ul><li>Interpolate between each value.</li></ul>
            </li>
            <li>If one basic shape is of type rectangle and the second of type circle or ellipse:
                <ul><li>Replace the circle/ellipse with a temporary rectangle of equal dimension.</li>
                <li>Set the values for rx and ry on the temporary rectangle to ‘50%’.</li>
                <li>Interpolate between the two rectangles as above.</li></ul>
            </li>
            <li>If one basic shape is an inset-rectangle and the second is of type rectangle, circle or ellipse:
                <ul><li>Replace the inset-rectangle with a temporary rectangle of equal dimension.</li>
                <li>Interpolate between the basic shapes as above.</li></ul>
            <li>If both basic shapes are of type polygon and if both polygons have the same number of vertices:
                <ul><li>Interpolate between each value.</li></ul>
            </li>
            <li>In all other cases:
                <ul><li>No interpolation is specified.</li></ul></li>
            </ul>
      
      <h2 id="shapes-from-image">Shapes from Image</h2>
      
      <p>
          Another way of defining shapes 
          is by specifying a source image 
          whose alpha channel is used 
          to compute the shape. 
          The shape is computed to be the path 
          that encloses the area 
          where the opacity of the specified image 
          is greater than the 'shape-image-threshold' value. 
          If the 'shape-image-threshold' is not specified, 
          the initial value to be considered is 0.0.
      </p>

      <p>Sizing the shape from an image follows the <a href="http://www.w3.org/TR/2012/CR-css3-images-20120417/#concrete-size-resolution">Concrete Object Size Resolution</a> section from [[!CSS3-IMAGES]].</p>
      
      <p>For animated raster image formats 
        (such as <a href="http://www.w3.org/Graphics/GIF/spec-gif89a.txt">GIF</a>), 
        the first frame of the animation sequence is used. <!--
        For <a href="http://www.w3.org/TR/2002/WD-SVG2Reqs-20020422/">SVG</a> 
        images ([[SVG11]]), 
        the image is rendered without animations applied.--></p>

      <div class="example">
        <p>An image is floating to the left of a paragraph. The image shows the 3D version of the
           CSS logo over a transparent background. The logo has a shadow using an alpha-channel.</p>
        <p>The image defines its <span>float area</span> through the 'shape-outside' property.</p>
           <pre><code class="html">
&lt;p&gt;
  &lt;img id="CSSlogo" src="CSS-logo1s.png"/&gt;
  blah blah blah blah...
&lt;/p&gt;

&lt;style&gt;
  #CSSlogo {
    float: left;
    shape-outside: attr(src url);
    shape-image-threshold: 0.1;
  }
&lt;/style&gt;</code></pre>

       <p>The 'shape-outside' property re-uses the url from the src attribute of the img element.</p>
       <p>It is perfectly possible to display an image and use a different image for its
          <span>float area</span>.</p>

       <p>In the figure below, the alpha-channel threshold is represented by the dotted line around
          the CSS logo.</p>
       <p>It's then possible to affect where the lines of the paragraph start in three ways:</p>
       <ol>
         <li>Modifying the alpha channel in the image</li>
         <li>Changing the value of the 'shape-image-threshold' property</li>
         <li>Changing the value of the 'shape-margin' property (see example 8)</li>
       </ol>
        <div class='figure'>
            <img alt="A float shape around an image using its alpha-channel" src="images/shape-outside-image.png" width="70%"/>
            <p class="caption">A float shape around an image using its alpha-channel.</p>
        </div>
      </div>
      <!-- End section "Shapes from image" -->

      <h2 id="declaring-shapes">Declaring Shapes</h2>
      <p>
          Shapes are declared with 
          the 'shape-outside' property, 
          with possible modifications 
          from the 'shape-margin' property. 
          The shape defined by 
          the 'shape-outside' 
          and 'shape-margin' properties 
          changes the geometry 
          of a float element's 
          <span>float area</span>.
      </p>


      <h3 id="shape-outside-property">The 'shape-outside' Property</h3>

        <table class="propdef">
            <tr>
                <th>Name:</th>
                <td><dfn title="shape-outside">shape-outside</dfn></td>
            </tr>
            <tr>
                <th>Value:</th>
                <td><var>auto</var> | <var>&lt;basic-shape&gt;</var> | <var>&lt;image&gt;</var></td>
            </tr>
            <tr>
                <th>Initial:</th>
                <td>auto</td>
            </tr>
            <tr>
                <th>Applies to:</th>
                <td>floats</td>
            </tr>
            <tr>
                <th>Inherited:</th>
                <td>no</td>
            </tr>
            <tr>
                <th>Percentages:</th>
                <td>N/A</td>
            </tr>
            <tr>
                <th>Media:</th>
                <td>visual</td>
            </tr>
            <tr>
                <th>Computed&nbsp;value:</th>
                <td>computed lengths for &lt;basic-shape&gt;, the image with its URI made absolute, otherwise as specified</td>
            </tr>
        </table>
      
      <p>The values of this property have the following meanings:</p>
      <dl>
          <dt><dfn title="shape-outside!!auto">auto</dfn></dt>
          <dd>The <span>float area</span> uses the margin box as normal.</dd>
      </dl>
      <dl>
          <dt><dfn title="shape-outside!!&lt;basic-shape&gt;">&lt;basic-shape&gt;</dfn></dt>
          <dd>
              The shape is computed based on the values of one of 'rectangle', 'inset-rectangle', 'circle', 'ellipse'
              or 'polygon'.
          </dd>
      </dl>
      <dl>
          <dt><dfn title="shape-outside!!&lt;image&gt;">&lt;image&gt;</dfn></dt>
          <dd>
            <p>
              The shape is extracted 
              and computed based 
              on the alpha channel 
              of the specified <a href="http://dev.w3.org/csswg/css-values/#images">&lt;image&gt;</a> as defined by 'shape-image-threshold'.
            </p>
            <p>
              User agents must use the 
              <a href="http://www.w3.org/TR/html5/infrastructure.html#cors-enabled-fetch">potentially CORS-enabled fetch</a> 
              method defined by the [[!HTML5]] specification 
              for all URLs in a 'shape-outside' value. 
              When fetching, 
              user agents must use "Anonymous" mode, 
              set the referrer source 
              to the stylesheet's URL 
              and set the origin to the URL 
              of the containing document. 
              If this results in network errors 
              such that there is no valid fallback image, 
              the effect is as if 
              the value 'auto' 
              had been specified.
            </p>
          </dd>
      </dl>
      <!-- End section "The shape-outside Property" -->

   <h3 id="shape-image-threshold-property">The 'shape-image-threshold' Property</h3>
    
    <p>
        The 'shape-image-threshold' 
        defines the alpha channel threshold 
        used to extract the shape 
        using an image. 
        A value of 0.5 means that 
        the shape will enclose 
        all the pixels 
        that are more than 50% opaque.
    </p>

    <table class="propdef">
        <tr>
            <th>Name:</th>
            <td><dfn title="shape-image-threshold">shape-image-threshold</dfn></td>
        </tr>
        <tr>
            <th>Value:</th>
            <td><var>&lt;number&gt;</var></td>
        </tr>
        <tr>
            <th>Initial:</th>
            <td>0.0</td>
        </tr>
        <tr>
            <th>Applies to:</th>
            <td>floats</td>
        </tr>
        <tr>
            <th>Inherited:</th>
            <td>no</td>
        </tr>
        <tr>
            <th>Percentages:</th>
            <td>alpha channel of the image specified by 'shape-outside'</td>
        </tr>
        <tr>
            <th>Media:</th>
            <td>visual</td>
        </tr>
        <tr>
            <th>Computed&nbsp;value:</th>
            <td>The same as the specified value after clipping the &lt;number&gt; to the range [0.0,1.0].</td>
        </tr>
    </table>
    <p>The values of this property have the following meanings:</p>
    <dl>
        <dt><dfn title="shape-image-threshold!!&lt;number&gt;">&lt;number&gt;</dfn></dt>
        <dd>
            Sets the threshold used 
            for extracting a shape 
            from an image. 
            The shape is defined 
            by the pixels whose alpha value 
            is greater than the threshold. 
            Any values outside the range 
            0.0 (fully transparent) 
            to 1.0 (fully opaque) 
            will be clamped to this range.
        </dd>
    </dl>
    <div class="note">
      <p>A future level of CSS Shapes may define 
        a switch to use the luminance data 
        from an image instead of the alpha data. 
        When this happens, 
        shape-image-threshold will be extended 
        to apply its threshold 
        to either alpha or luminance, 
        depending on the switch state.</p>
    </div>
    <!-- End section "The shape-image-threshold property" -->
    <!-- End section "Declaring Shapes" -->

    <h3 id="shape-margin-property">The 'shape-margin' property</h3>
    <p>
        The 'shape-margin' property adds a margin to a 'shape-outside'. 
        This defines a new shape 
        that is the smallest contour 
        (in the shrink-wrap sense) 
        that includes all the points 
        that are the 'shape-margin' distance outward 
        in the perpendicular direction 
        from a point on the underlying shape. 
        Note that at points where 
        a perpendicular is not defined 
        (e.g. sharp points) 
        take all points 
        on the circle centered at the point 
        and with a radius of 'shape-margin'. 
        This property takes only non-negative values.
    </p>
    <table class="propdef">
        <tr>
            <th>Name:</th>
            <td><dfn title="shape-margin">shape-margin</dfn></td>
        </tr>
        <tr>
            <th>Value:</th>
            <td><var>&lt;length&gt;</var></td>
        </tr>
        <tr>
            <th>Initial:</th>
            <td>0</td>
        </tr>
        <tr>
            <th>Applies to:</th>
            <td>floats</td>
        </tr>
        <tr>
            <th>Inherited:</th>
            <td>no</td>
        </tr>
        <tr>
            <th>Percentages:</th>
            <td>N/A</td>
        </tr>
        <tr>
            <th>Media:</th>
            <td>visual</td>
        </tr>
        <tr>
            <th>Computed&nbsp;value:</th>
            <td>the absolute length</td>
        </tr>
    </table>

    <div class="example">
        <p>A 'shape-margin' creating an offset from a polygonal 'shape-outside'. The lighter blue area shows the shape in a 100x100px float, and the darker blue area shows the 10px offset.</p>
<pre><code class="html">
  .float {
    shape-outside: polygon(10px 10px, 90px 50px, 40px 50px, 90px 90px, 10px 90px);
    shape-margin: 10px;
  }
</code></pre>
        <img src="images/nepal-flag-shape.png" 
            alt="Example of a shape-margin offset"/>
    </div>

    <div class="example">
        <p>If shape-margin is added to the CSS logo from example 6, the line boxes wrapping around the shape are shortened further.</p>
<pre><code class="html">
  #CSSlogo {
    shape-margin: 35px;
  }
</code></pre>
    <div class='figure'>
          <img alt="A float shape around an image using its alpha-channel with a 35 pixels shape-margin" src="images/shape-outside-image-with-margin.png" width="70%"/>
          <p class="caption">A float shape around an image using its alpha-channel with a 35 pixels 'shape-margin'</p>
        </div>
    </div>
    <!-- End secion "shape-margin property" -->
    <!-- End section "Shapes" -->

    <h2 id="conformance">Conformance</h2>
    <!--conformance-->

    <h2 class="no-num" id="acknowledgments">Acknowledgments</h2>
      <p>This specification is made possible by input from 
          Andrei Bucur, 
          Alexandru Chiculita, 
          Elika Etemad, 
          Arron Eicholz, 
          Daniel Glazman,  
          Arno Gourdol, 
          Zoltan Horvath, 
          Chris Jones, 
          Bem Jones-Bey, 
          Marcus Mielke, 
          Alex Mogilevsky, 
          Hans Muller, 
          Mihnea Ovidenie, 
          Virgil Palanciuc, 
          Dirk Schulze, 
          Peter Sorotokin, 
          Bear Travis, 
          Eugene Veselov, 
          Stephen Zilles 
          and the CSS Working Group members.
      </p>
      <h2 class="no-num" id="references">References</h2>
      <h3 class="no-num" id="normative-references">Normative references</h3>
      <!--normative-->
      <h3 class="no-num" id="other-references">Other references</h3>
      <!--informative-->
      <h2 class="no-num" id="index">Index</h2>
      <!--index-->
      <h2 class="no-num" id="property-index">Property index</h2>
      <!-- properties -->

          <!-- template markup for issues pulled from Bugzilla -->
          <!-- issue template and script need a new API to access bugzilla
          <script type="text/template" id="issue-template">
      <div class="issue-marker" data-bug_id="{{bug_id}}" data-bug_status="{{bug_status}}">
          <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id={{bug_id}}">Issue-{{bug_id}}</a>
          <div class="issue-details">
              <p class="short-desc">{{short_desc}}</p>
          </div>  
      </div>
          </script>   

          <script type="text/javascript" src="../shared/scripts/BugzillaTrackerUtil.js"></script>
          <script type="text/javascript" src="../shared/scripts/BugzillaTracker.js"></script>
          <script type="text/javascript">
              checkSpecificationIssues('CSS', 'Shapes');        
          </script>
          -->
      <h2 class="no-num" id="change-log">Change Log</h2>

      <h3 class="no-num" >Since <a href="http://www.w3.org/TR/2013/WD-css-shapes-1-20130620/">June 20th 2013</a></h3>
      <ul>
          <li>Use Concrete Object Size Resolution from CSS3-IMAGES in shape from image</li>
          <li>Future-proof shape-image-threshold to possibly apply to luminance</li>
          <li>Added CORS fetching to shape-outside URLs</li>
          <li>Changed shape-outside value from &lt;uri&gt; to &lt;image&gt;</li>
          <li>Fixed basic shape grammar to use comma separators</li>
          <li>Remove 'percentages based on auto-sizing resolve to 0'</li>
          <li>Change initial value of shape-image-threshold to 0.0</li>
          <li>Change float positioning to be unaffected by shape-outside</li>
          <li>Shapes on floats clipped to float's margin box</li>
          <li>Inline content constrained to at least the float's farthest margin edge</li>
      </ul>

      <h3 class="no-num" >Since <a href="http://www.w3.org/TR/2012/WD-css3-exclusions-20120503/">May 3rd 2012</a></h3>
      <ul>
          <li>Postpone shapes from SVG elements to a future Shapes level</li>
          <li>Postpone shape-inside to a future Shapes level</li>
          <li>split exclusions from shapes into separate modules</li>
          <li>added inset-rectangle() to basic shapes</li>
          <li>Changed shape-inside overflow diagrams to show exclusion behavior</li>
          <li>Changed shape-inside to contribute to the wrapping context</li>
          <li>Defined exclusion edges relative to wrapping content's writing mode</li>
          <li>Made use of start, end, before and after consistent</li>
          <li>Added interpolation for basic shapes</li>
          <li>Changed basic shapes to depend on box specified with box-sizing</li>
          <li>Added overflow behavior for shape-inside.</li>
          <li>Added wrap-flow:minimum.</li>
          <li>Clarified processing model.</li>
          <li>Changed wrap-margin and wrap-padding to shape-margin and shape-padding.</li>
          <li>Removed wrap shorthand.</li>
      </ul>

      <h3 class="no-num" >Since <a href="http://www.w3.org/TR/2011/WD-css3-exclusions-20111213/">December 13th 2011</a></h3>
      <ul>
          <li>Clarified processing model.</li>
          <li>Clarified interaction with floats.</li>
          <li>Clarified that an exclusion element establishes a new block formatting context.</li>
      </ul>
      
  </body>
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
 
