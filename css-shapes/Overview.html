<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html lang=en>
 <head
  profile="http://dublincore.org/documents/2008/08/04/dc-html/ http://www.w3.org/2006/03/hcard">
  <meta content="text/html; charset=utf-8" http-equiv=Content-Type>
  <title>CSS Shapes Module Level 1</title>

  <link href="http://purl.org/dc/terms/" rel=schema.dcterms>
  <link href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright"
   rel=dcterms.rights>
  <meta content="CSS Shapes Module Level 1" name=dcterms.title>
  <meta content=text name=dcterms.type>
  <meta content=2013-09-24 name=dcterms.date>
  <meta content="Vincent Hardy" name=dcterms.creator>
  <meta content="Rossen Atanassov" name=dcterms.creator>
  <meta content="Alan Stearns" name=dcterms.creator>
  <meta content=W3C name=dcterms.publisher>
  <meta content="http://dev.w3.org/csswg/css-shapes/"
   name=dcterms.identifier>
  <script defer=defer
   src="http://test.csswg.org/harness/annotate.js#css-shapes-1_dev"
   type="text/javascript"></script>
  <link href="../shared/style/default.css" rel=stylesheet type="text/css">
  <style type="text/css">
    .singleImgExample {
    	display: block;
    	margin: auto;
    }
    
    .example-table {
    	table-layout: fixed; 
    	width: 100%; 
    }
    
    .example-table tr td img {
    	width: 90%;
    }
  </style>
  <link href=issues.css rel=stylesheet type="text/css">
  <link href="http://www.w3.org/StyleSheets/TR/W3C-ED.css" rel=stylesheet
   type="text/css">
  <link href="../shared/style/alternate-spec-style.css" id=st rel=stylesheet
   title="alternate spec style" type="text/css">

 <body>
  <div class=head id=div-head> <!--begin-logo-->
   <p><a href="http://www.w3.org/"><img alt=W3C height=48
    src="http://www.w3.org/Icons/w3c_home" width=72></a> <!--end-logo-->

   <h1 id=css-shapes-module>CSS Shapes Module Level 1</h1>

   <h2 class="no-num no-toc" id=longstatus-date>Editor's Draft 24 September
    2013</h2>

   <dl>
    <dt>This version:

    <dd><a
     href="http://dev.w3.org/csswg/css-shapes/">http://dev.w3.org/csswg/css-shapes/</a>

    <dt>Latest version:

    <dd><a
     href="http://www.w3.org/TR/css-shapes/">http://www.w3.org/TR/css-shapes/</a>

    <dt>Editor's Draft:

    <dd><a
     href="http://dev.w3.org/csswg/css-shapes/">http://dev.w3.org/csswg/css-shapes/</a>

    <dt>Previous version:

    <dd>None

    <dt>Editors:

    <dd class=vcard><span class=fn>Vincent Hardy</span>, <span
     class=org>Adobe Systems, Inc.</span>, <span
     class=email>vhardy@adobe.com</span>

    <dd class=vcard><span class=fn>Rossen Atanassov</span>, <span
     class=org>Microsoft Corporation</span>, <span
     class=email>ratan@microsoft.com</span>

    <dd class=vcard><span class=fn>Alan Stearns</span>, <span class=org>Adobe
     Systems, Inc.</span>, <span class=email>stearns@adobe.com</span>

    <dt>Issues List:

    <dd><a
     href="https://www.w3.org/Bugs/Public/buglist.cgi?query_format=advanced&amp;product=CSS&amp;component=Shapes&amp;resolution=---&amp;cmdtype=doit">in
     Bugzilla</a>

    <dt>Feedback:

    <dd><a
     href="mailto:www-style@w3.org?subject=%5B[css-shapes]%5D%20feedback">www-style@w3.org</a>
     with subject line “<kbd>[css-shapes] <var>… message topic
     …</var></kbd>” (<a
     href="http://lists.w3.org/Archives/Public/www-style/"
     rel=discussion>archives</a>)

    <dt>Test Suite:

    <dd><a
     href="http://test.csswg.org/suites/css3-shapes/nightly-unstable/">http://test.csswg.org/suites/css3-regions/nightly-unstable/</a>
   </dl>
   <!--begin-copyright-->
   <p class=copyright><a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright"
    rel=license>Copyright</a> © 2013 <a href="http://www.w3.org/"><abbr
    title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a
    href="http://www.csail.mit.edu/"><abbr
    title="Massachusetts Institute of Technology">MIT</abbr></a>, <a
    href="http://www.ercim.eu/"><abbr
    title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
    <a href="http://www.keio.ac.jp/">Keio</a>, <a
    href="http://ev.buaa.edu.cn/">Beihang</a>), All Rights Reserved. W3C <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a>
    and <a
    href="http://www.w3.org/Consortium/Legal/copyright-documents">document
    use</a> rules apply.</p>
   <!--end-copyright-->
   <hr title="Separator for header">
  </div>

  <h2 class="no-num no-toc" id=abstract>Abstract</h2>

  <p>CSS Shapes control the geometric shapes used for wrapping inline flow
   content outside an element. For Level 1, CSS Shapes can be applied to
   floats. A circle shape on a float will cause inline content to wrap around
   the circle shape instead of the float's bounding box.

  <p class=note> Future levels of CSS Shapes will allow use of shapes on
   elements other than floats

  <h2 class="no-num no-toc" id=status>Status of this document</h2>
  <!--begin-status-->

  <p>This is a public copy of the editors' draft. It is provided for
   discussion only and may change at any moment. Its publication here does
   not imply endorsement of its contents by W3C. Don't cite this document
   other than as work in progress.

  <p>The (<a
   href="http://lists.w3.org/Archives/Public/www-style/">archived</a>) public
   mailing list <a
   href="mailto:www-style@w3.org?Subject=%5Bcss-shapes%5D%20PUT%20SUBJECT%20HERE">
   www-style@w3.org</a> (see <a
   href="http://www.w3.org/Mail/Request">instructions</a>) is preferred for
   discussion of this specification. When sending e-mail, please put the text
   “css-shapes” in the subject, preferably like this:
   “[<!---->css-shapes<!---->] <em>…summary of comment…</em>”

  <p>This document was produced by the <a
   href="http://www.w3.org/Style/CSS/members">CSS Working Group</a> (part of
   the <a href="http://www.w3.org/Style/">Style Activity</a>).

  <p>This document was produced by a group operating under the <a
   href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February
   2004 W3C Patent Policy</a>. W3C maintains a <a
   href="http://www.w3.org/2004/01/pp-impl/32061/status"
   rel=disclosure>public list of any patent disclosures</a> made in
   connection with the deliverables of the group; that page also includes
   instructions for disclosing a patent. An individual who has actual
   knowledge of a patent which the individual believes contains <a
   href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
   Claim(s)</a> must disclose the information in accordance with <a
   href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
   6 of the W3C Patent Policy</a>.</p>
  <!--end-status-->

  <p>A previous version of this draft has been published as part of the
   Working Draft <a
   href="http://www.w3.org/TR/2012/WD-css3-exclusions-20120503/">“<cite>CSS
   Exclusions and Shapes</cite>” dated 3 May 2012.</a>

  <h2 class="no-num no-toc" id=contents>Table of contents</h2>
  <!--begin-toc-->

  <ul class=toc>
   <li><a href="#intro"><span class=secno>1. </span>Introduction</a>

   <li><a href="#definitions"><span class=secno>2. </span>Definitions</a>

   <li><a href="#shapes"><span class=secno>3. </span>Shapes</a>
    <ul class=toc>
     <li><a href="#relation-to-box-model-and-float-behavior"><span
      class=secno>3.1. </span>Relation to the box model and float
      behavior</a>

     <li><a href="#basic-shapes-from-svg-syntax"><span class=secno>3.2.
      </span>Basic Shapes</a>
      <ul class=toc>
       <li><a href="#supported-basic-shapes"><span class=secno>3.2.1.
        </span>Supported Shapes</a>

       <li><a href="#basic-shape-interpolation"><span class=secno>3.2.2.
        </span>Interpolation of Basic Shapes</a>
      </ul>

     <li><a href="#shapes-from-image"><span class=secno>3.3. </span>Shapes
      from Image</a>

     <li><a href="#declaring-shapes"><span class=secno>3.4. </span>Declaring
      Shapes</a>
      <ul class=toc>
       <li><a href="#shape-outside-property"><span class=secno>3.4.1.
        </span>The ‘<code class=property>shape-outside</code>’
        Property</a>

       <li><a href="#shape-image-threshold-property"><span class=secno>3.4.2.
        </span>The ‘<code class=property>shape-image-threshold</code>’
        Property</a>

       <li><a href="#shape-margin-property"><span class=secno>3.4.3.
        </span>The ‘<code class=property>shape-margin</code>’
        property</a>
      </ul>
    </ul>

   <li><a href="#conformance"><span class=secno>4. </span>Conformance</a>

   <li class=no-num><a href="#acknowledgments">Acknowledgments</a>

   <li class=no-num><a href="#references">References</a>
    <ul class=toc>
     <li class=no-num><a href="#normative-references">Normative
      references</a>

     <li class=no-num><a href="#other-references">Other references</a>
    </ul>

   <li class=no-num><a href="#index">Index</a>

   <li class=no-num><a href="#property-index">Property index</a>

   <li class=no-num><a href="#change-log">Change Log</a>
    <ul class=toc>
     <li class=no-num><a href="#since-june-20th-2013">Since June 20th
      2013</a>

     <li class=no-num><a href="#since-may-3rd-2012">Since May 3rd 2012</a>

     <li class=no-num><a href="#since-december-13th-2011">Since December 13th
      2011</a>
    </ul>
  </ul>
  <!--end-toc-->

  <h2 id=intro><span class=secno>1. </span>Introduction</h2>

  <p><em>This section is not normative.</em>

  <p> This specification defines properties to control the geometry of an
   element's <a href="#float-area">float area</a>.

  <h2 id=definitions><span class=secno>2. </span>Definitions</h2>

  <p><dfn id=wrap>Wrap</dfn>

  <p> This specification uses the term ‘<a href="#wrap"><code
   class=property>wrap</code></a>’ to refer to flowing content around the
   sides of a float area. Content wraps around the right side of a
   left-floated box, and content wraps around the left side of a
   right-floated box. Line boxes next to a float are shortened as necessary
   to avoid intersections with the float area.

  <p><dfn id=float-area>Float area</dfn>

  <p> The area used for wrapping (or flowing) content around a float element.
   The rules for float behavior use the sides of the float area to determine
   where content flows. By default, the float area is the float element's <a
   href="http://www.w3.org/TR/CSS2/box.html#box-dimensions">margin box</a>.
   This specification's ‘<a href="#shape-outside"><code
   class=property>shape-outside</code></a>’ property can be used to define
   arbitrary, non-rectangular float areas.

  <h2 id=shapes><span class=secno>3. </span>Shapes</h2>

  <p> Shapes define arbitrary geometric contours around which inline content
   flows. The shape-outside property defines the <a href="#float-area">float
   area</a> for a float.

  <p class=note> If a user agent implements both CSS Shapes and CSS
   Exclusions, the shape-outside property defines the exclusion area for an
   exclusion.

  <p class=note> A future level of CSS Shapes will define a shape-inside
   property, which will define a shape to wrap content within the element.

  <h3 id=relation-to-box-model-and-float-behavior><span class=secno>3.1.
   </span>Relation to the box model and float behavior</h3>

  <p> While the boundaries used for wrapping inline flow content outside a
   float can be defined using shapes, the actual box model does not change.
   If the element has specified margins, borders or padding they will be
   computed and rendered according to the <a href="#CSS3BOX"
   rel=biblioentry>[CSS3BOX]<!--{{!CSS3BOX}}--></a> module.

  <p> When a shape is used to define a <a href="#float-area">float area</a>,
   the shape is clipped to the float's margin box. In other words, a shape
   can only ever reduce a <a href="#float-area">float area</a>, not increase
   it. A reduced float area may have no effect on some line boxes that would
   normally be affected by the float.

  <div class=example>
   <p> In the following example the left and right floating <code
    class=html>div</code> elements specify a triangular shape using the ‘<a
    href="#shape-outside"><code class=property>shape-outside</code></a>’
    property.

   <pre><code class=html>
&lt;div style="text-align:center;"&gt;
      &lt;div id="float-left"&gt;&lt;/div&gt;
      &lt;div id="float-right"&gt;&lt;/div&gt;
      &lt;div&gt;
      Sometimes a web page's text content appears to be
      funneling your attention towards a spot on the page
      to drive you to follow a particular link.  Sometimes
      you don't notice.
      &lt;/div&gt;
&lt;/div&gt;

&lt;style type="text/css"&gt;
#float-left {
      shape-outside: polygon(0 0, 100% 100%, 0 100%);
      float: left;
      width: 40%;
      height: 12ex;
  }

#float-right {
      shape-outside: polygon(100% 0, 100% 100%, 0 100%);
      float: right;
      width: 40%;
      height: 12ex;
  }
  &lt;/style&gt;
&lt;/div&gt;</code></pre>
   <img alt="Using the shape-outside property with a float"
   class=singleImgExample src="images/float-shape-outside.png"></div>

  <div class=example>
   <p> Since shapes are clipped to the float's margin box, adding this shape
    to the left float above would result in the same rendering.

   <p>

   <pre><code class=css>
      shape-outside: polygon(0 0, 500% 500%, 0 500%);
</code></pre>
  </div>

  <div class=example>
   <p> A shape with no extent will create a <a href="#float-area">float
    area</a> with no extent. Because wrapping only considers the float area,
    the shape below applied to a left float will allow inline content to flow
    through all of the float's box.

   <p>

   <pre><code class=css>
      shape-outside: rectangle(0,0,0%,0%);
</code></pre>
  </div>

  <div class=example>
   <p> A shape-outside can create open areas on both the left and right of a
    float area. Content still wraps only on one side of a float in this case.
    In the picture, the shape is rendered in blue, and the content area
    outside the shape in mauve.

   <p>

   <pre><code class=css>
      shape-outside: polygon(50px 0px, 100px 100px, 0px 100px);
</code></pre>
   <img alt="Wrapping around right side of a left-float float area"
   class=singleImgExample src="images/float-side-example.png"></div>

  <div class=example>
   <p> The following styling creates a shape much smaller than the float's
    content area, and adds a margin-top to the float. In the picture, the
    shape is rendered in blue, the content area outside the shape in mauve,
    and the margin area of the float box in yellow. The inline content only
    wraps around the shape, and otherwise overlays the rest of the float
    margin box.

   <pre><code class=html>
.float-left {
      shape-outside: polygon(0% 50%, 50% 100%, 0 100%);
      float: left;
      width: 100px;
      height: 100px;
      margin-top: 20px;
}
</code></pre>
   <img alt="Adding margin-top to a float with a small shape-outside"
   class=singleImgExample src="images/float-margin-example.png">
   <p> The next picture shows a possible result if two of these floats were
    stacked next to each other. Note that the floats are positioned using
    their margin boxes, not the float area.</p>
   <img alt="Stacking two floats with a small shape-outside"
   class=singleImgExample src="images/stacked-float-example.png"></div>

  <h3 id=basic-shapes-from-svg-syntax><span class=secno>3.2. </span>Basic
   Shapes</h3>

  <p> Shapes can be specified using syntax similar to SVG's <a
   href="http://www.w3.org/TR/SVG/shapes.html">basic shapes</a>. The
   definitions use <code><a
   href="http://www.w3.org/TR/css3-values/#lengths">&lt;length&gt;</a></code>
   type and the <code><a
   href="http://www.w3.org/TR/css3-values/#percentages">&lt;percentage&gt;</a></code>
   types <a href="#CSS3VAL" rel=biblioentry>[CSS3VAL]<!--{{!CSS3VAL}}--></a>.
   When using this syntax to define shapes, the relevant box is determined by
   the computed value of the <a
   href="http://www.w3.org/TR/css3-ui/#box-sizing">‘<code
   class=property>box-sizing</code>’</a> property. The coordinate system
   for the shape has its origin on the top-left corner of the relevant box
   with the x-axis running to the right and the y-axis running downwards. All
   the lengths expressed in percentages are resolved from the used dimensions
   of the relevant box. For the radius <code>r</code> of the <a
   href="#circle"><code>circle</code></a> shape, a percentage value is
   resolved as <a
   href="http://www.w3.org/TR/SVG/coords.html#Units">specified</a> in the SVG
   recommendation <a href="#SVG11"
   rel=biblioentry>[SVG11]<!--{{!SVG11}}--></a>.

  <h4 id=supported-basic-shapes><span class=secno>3.2.1. </span>Supported
   Shapes</h4>

  <p>The following basic shapes are supported.

  <dl>
   <dt><dfn
    id=rectangle>rectangle</dfn>([&lt;length&gt;|&lt;percentage&gt;][,
    [&lt;length&gt;|&lt;percentage&gt;]]{3,5})

   <dd>
    <ul>
     <li> The first four values represent <strong>x, y, width</strong> and
      <strong>height</strong> of the rectangle. Negative values for width and
      height are invalid.

     <li> The last two optional values represent <strong> rx</strong> and
      <strong>ry</strong>. For rounded rectangles they define the x-axis
      radius and y-axis radius of the ellipse used to round off the corners
      of the rectangle. Negative values for rx and ry are invalid. See notes
      below on edge cases for these values.
    </ul>

   <dt><dfn
    id=inset-rectangle>inset-rectangle</dfn>([&lt;length&gt;|&lt;percentage&gt;][,
    [&lt;length&gt;|&lt;percentage&gt;]]{3,5})

   <dd>
    <ul>
     <li> The first four values represent the <strong>top, right,
      bottom</strong> and <strong>left</strong> offsets from the content
      rectangle inward that define the positions of the edges of the inset
      rectangle. Negative values for any of these insets are invalid.

     <li> The last two optional values represent <strong> rx</strong> and
      <strong>ry</strong>. For rounded inset rectangles they define the
      x-axis radius and y-axis radius of the ellipse used to round off the
      corners of the inset rectangle. Negative values for rx and ry are
      invalid. See notes below on edge cases for these values.
    </ul>

   <dt><dfn id=circle>circle</dfn>([&lt;length&gt;|&lt;percentage&gt;][,
    [&lt;length&gt;|&lt;percentage&gt;]]{2})

   <dd>
    <ul>
     <li> The three values values represent <strong>cx</strong>,
      <strong>cy</strong>, and <strong>r</strong>. They define the x-axis and
      y-axis coordinates of the center of the circle and the radius of the
      circle. A negative value for r is invalid.
    </ul>

   <dt><dfn id=ellipse>ellipse</dfn>([&lt;length&gt;|&lt;percentage&gt;][,
    [&lt;length&gt;|&lt;percentage&gt;]]{3})

   <dd>
    <ul>
     <li> The four values represent <strong>cx</strong>, <strong>cy</strong>,
      <strong>rx</strong>, and <strong>ry</strong>. They define the x-axis
      and y-axis coordinates of the center of the ellipse and the x-axis and
      y-axis radius of the ellipse. Negative values for rx and ry are
      invalid.
    </ul>

   <dt><dfn
    id=polygon>polygon</dfn>([&lt;fill-rule&gt;,]?[&lt;length&gt;|&lt;percentage&gt;]{2}#)

   <dd>
    <ul>
     <li><strong>fill-rule</strong> - The filling rule used to determine the
      interior of the polygon. See <a
      href="http://www.w3.org/TR/SVG/painting.html#FillRuleProperty">fill-rule</a>
      property in SVG for details. Possible values are nonzero or evenodd.
      Default value when omitted is nonzero.

     <li> The two length values represent <strong>xi</strong> and
      <strong>yi</strong> - the <strong>x</strong> and <strong>y</strong>
      axis coordinates of the i-th vertex of the polygon.
    </ul>

    <p>The UA must close a polygon by connecting the last vertex with the
     first vertex of the list.</p>
    <br>
  </dl>

  <p>The values for corner radii on rectangle or inset-rectangle are
   determined implicitly if either the rx or ry values are not specified, or
   are specified but with invalid values. If neither rx nor ry are properly
   specified, the values are 0 for both. If only one value is properly
   specified, that value is used for both. And if the values cause any of the
   curves to overlap, the solution for <a
   href="http://www.w3.org/TR/css3-background/#corner-overlap">overlapping
   curves</a> from CSS Backgrounds and Borders <a href="#CSS3BG"
   rel=biblioentry>[CSS3BG]<!--{{!CSS3BG}}--></a> is used to avoid the
   overlap.

  <p>

  <h4 id=basic-shape-interpolation><span class=secno>3.2.2.
   </span>Interpolation of Basic Shapes</h4>

  <p>For interpolating between one basic shape and a second, the rules
   described below are applied.

  <ul>
   <li>If both basic shapes are of the same type and not of type polygon:
    <ul>
     <li>Interpolate between each value.
    </ul>

   <li>If one basic shape is of type rectangle and the second of type circle
    or ellipse:
    <ul>
     <li>Replace the circle/ellipse with a temporary rectangle of equal
      dimension.

     <li>Set the values for rx and ry on the temporary rectangle to
      ‘50%’.

     <li>Interpolate between the two rectangles as above.
    </ul>

   <li>If one basic shape is an inset-rectangle and the second is of type
    rectangle, circle or ellipse:
    <ul>
     <li>Replace the inset-rectangle with a temporary rectangle of equal
      dimension.

     <li>Interpolate between the basic shapes as above.
    </ul>

   <li>If both basic shapes are of type polygon and if both polygons have the
    same number of vertices:
    <ul>
     <li>Interpolate between each value.
    </ul>

   <li>In all other cases:
    <ul>
     <li>No interpolation is specified.
    </ul>
  </ul>

  <h3 id=shapes-from-image><span class=secno>3.3. </span>Shapes from Image</h3>

  <p> Another way of defining shapes is by specifying a source image whose
   alpha channel is used to compute the shape. The shape is computed to be
   the path that encloses the area where the opacity of the specified image
   is greater than the ‘<a href="#shape-image-threshold"><code
   class=property>shape-image-threshold</code></a>’ value. If the ‘<a
   href="#shape-image-threshold"><code
   class=property>shape-image-threshold</code></a>’ is not specified, the
   initial value to be considered is 0.0.

  <p>For animated raster image formats (such as <a
   href="http://www.w3.org/Graphics/GIF/spec-gif89a.txt">GIF</a>), the first
   frame of the animation sequence is used. <!--
        For <a href="http://www.w3.org/TR/2002/WD-SVG2Reqs-20020422/">SVG</a> 
        images ([[SVG11]]), 
        the image is rendered without animations applied.-->

  <div class=example>
   <p>An image is floating to the left of a paragraph. The image shows the 3D
    version of the CSS logo over a transparent background. The logo has a
    shadow using an alpha-channel.

   <p>The image defines its <a href="#float-area">float area</a> through the
    ‘<a href="#shape-outside"><code
    class=property>shape-outside</code></a>’ property.

   <pre><code class=html>
&lt;p&gt;
  &lt;img id="CSSlogo" src="CSS-logo1s.png"/&gt;
  blah blah blah blah...
&lt;/p&gt;

&lt;style&gt;
  #CSSlogo {
    float: left;
    shape-outside: attr(src url);
    shape-image-threshold: 0.1;
  }
&lt;/style&gt;</code></pre>

   <p>The shape-outside property re-uses the url from the src attribute of
    the img element.

   <p>It is perfectly possible to display an image and use a different image
    for its <a href="#float-area">float area</a>.

   <p>In the figure below, the alpha-channel threshold is represented by the
    dotted line around the CSS logo.

   <p>It's then possible to affect where the lines of the paragraph start in
    three ways:

   <ol>
    <li>Modifying the alpha channel in the image

    <li>Changing the value of the ‘<a href="#shape-image-threshold"><code
     class=property>shape-image-threshold</code></a>’ property

    <li>Changing the value of the ‘<a href="#shape-margin"><code
     class=property>shape-margin</code></a>’ property (see example 8)
   </ol>

   <div class=figure> <img
    alt="A float shape around an image using its alpha-channel"
    src="images/shape-outside-image.png" width="70%">
    <p class=caption>A float shape around an image using its alpha-channel.
   </div>
  </div>
  <!-- End section "Shapes from image" -->

  <h3 id=declaring-shapes><span class=secno>3.4. </span>Declaring Shapes</h3>

  <p> Shapes are declared with the ‘<a href="#shape-outside"><code
   class=property>shape-outside</code></a>’ property, with possible
   modifications from the ‘<a href="#shape-margin"><code
   class=property>shape-margin</code></a>’ property. The shape defined by
   the ‘<a href="#shape-outside"><code
   class=property>shape-outside</code></a>’ and ‘<a
   href="#shape-margin"><code class=property>shape-margin</code></a>’
   properties changes the geometry of a float element's <a
   href="#float-area">float area</a>.

  <h4 id=shape-outside-property><span class=secno>3.4.1. </span>The ‘<a
   href="#shape-outside"><code class=property>shape-outside</code></a>’
   Property</h4>

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=shape-outside title=shape-outside>shape-outside</dfn>

    <tr>
     <th>Value:

     <td><var>auto</var> | <var>&lt;basic-shape&gt;</var> |
      <var>&lt;image&gt;</var>

    <tr>
     <th>Initial:

     <td>auto

    <tr>
     <th>Applies to:

     <td>floats

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed value:

     <td>computed lengths for &lt;basic-shape&gt;, the image with its URI
      made absolute, otherwise as specified
  </table>

  <p>The values of this property have the following meanings:

  <dl>
   <dt><dfn id=auto title="shape-outside!!auto">auto</dfn>

   <dd>The <a href="#float-area">float area</a> uses the margin box as
    normal.
  </dl>

  <dl>
   <dt><dfn id=ltbasic-shapegt
    title="shape-outside!!&lt;basic-shape&gt;">&lt;basic-shape&gt;</dfn>

   <dd> The shape is computed based on the values of one of ‘<a
    href="#rectangle"><code class=property>rectangle</code></a>’, ‘<a
    href="#inset-rectangle"><code
    class=property>inset-rectangle</code></a>’, ‘<a href="#circle"><code
    class=property>circle</code></a>’, ‘<a href="#ellipse"><code
    class=property>ellipse</code></a>’ or ‘<a href="#polygon"><code
    class=property>polygon</code></a>’.
  </dl>

  <dl>
   <dt><dfn id=ltimagegt
    title="shape-outside!!&lt;image&gt;">&lt;image&gt;</dfn>

   <dd> The shape is extracted and computed based on the alpha channel of the
    specified <a
    href="http://dev.w3.org/csswg/css-values/#images">&lt;image&gt;</a> <a
    href="#CSS3VAL" rel=biblioentry>[CSS3VAL]<!--{{!CSS3VAL}}--></a> User
    agents must use the <a
    href="http://www.w3.org/TR/html5/infrastructure.html#cors-enabled-fetch">potentially
    CORS-enabled fetch</a> method defined by the <a href="#HTML5"
    rel=biblioentry>[HTML5]<!--{{!HTML5}}--></a> specification for all URLs
    in a shape-outside value. When fetching, user agents must use "Anonymous"
    mode, set the referrer source to the stylesheet's URL and set the origin
    to the URL of the containing document. If this results in network errors
    such that there is no valid fallback image, the effect is as if the value
    ‘<code class=property>auto</code>’ had been specified.
  </dl>
  <!-- End section "The shape-outside Property" -->

  <h4 id=shape-image-threshold-property><span class=secno>3.4.2. </span>The
   ‘<a href="#shape-image-threshold"><code
   class=property>shape-image-threshold</code></a>’ Property</h4>

  <p> The ‘<a href="#shape-image-threshold"><code
   class=property>shape-image-threshold</code></a>’ defines the alpha
   channel threshold used to extract the shape using an image. A value of 0.5
   means that the shape will enclose all the pixels that are more than 50%
   opaque.

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=shape-image-threshold
      title=shape-image-threshold>shape-image-threshold</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;threshold&gt;</var>

    <tr>
     <th>Initial:

     <td>0.0

    <tr>
     <th>Applies to:

     <td>floats

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>alpha channel of the image specified by <a
      href="#shape-outside">shape-outside</a>

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed value:

     <td>The same as the specified value after clipping the &lt;threshold&gt;
      to the range [0.0,1.0].
  </table>

  <p>The values of this property have the following meanings:

  <dl>
   <dt><dfn id=ltthresholdgt
    title="shape-image-threshold!!&lt;threshold&gt;">&lt;threshold&gt;</dfn>

   <dd> A &lt;number&gt; value that sets the threshold used for extracting a
    shape from an image. The shape is defined by the pixels whose alpha value
    is greater than the threshold. Any values outside the range 0.0 (fully
    transparent) to 1.0 (fully opaque) will be clamped to this range.
  </dl>

  <div class=note>
   <p>A future level of CSS Shapes may define a switch to use the luminance
    data from an image instead of the alpha data. When this happens,
    shape-image-threshold will be extended to apply its threshold to either
    alpha or luminance, depending on the switch state.
  </div>
  <!-- End section "The shape-image-threshold property" -->
  <!-- End section "Declaring Shapes" -->

  <h4 id=shape-margin-property><span class=secno>3.4.3. </span>The ‘<a
   href="#shape-margin"><code class=property>shape-margin</code></a>’
   property</h4>

  <p> The ‘<a href="#shape-margin"><code
   class=property>shape-margin</code></a>’ property adds a margin to a
   shape-outside. This defines a new shape that is the smallest contour (in
   the shrink-wrap sense) that includes all the points that are the
   shape-margin distance outward in the perpendicular direction from a point
   on the underlying shape. Note that at points where a perpendicular is not
   defined (e.g. sharp points) take all points on the circle centered at the
   point and with a radius of shape-margin. This property takes only
   non-negative values.

  <table class=propdef>
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=shape-margin title=shape-margin>shape-margin</dfn>

    <tr>
     <th>Value:

     <td><var>&lt;length&gt;</var>

    <tr>
     <th>Initial:

     <td>0

    <tr>
     <th>Applies to:

     <td>floats

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed value:

     <td>the absolute length
  </table>

  <div class=example>
   <p>A ‘<a href="#shape-margin"><code
    class=property>shape-margin</code></a>’ creating an offset from a
    polygonal shape-outside. The lighter blue area shows the shape in a
    100x100px float, and the darker blue area shows the 10px offset.

   <pre><code class=html>
  .float {
    shape-outside: polygon(10px 10px, 90px 50px, 40px 50px, 90px 90px, 10px 90px);
    shape-margin: 10px;
  }
</code></pre>
   <img alt="Example of a shape-margin offset"
   src="images/nepal-flag-shape.png"></div>

  <div class=example>
   <p>If shape-margin is added to the CSS logo from example 6, the line boxes
    wrapping around the shape are shortened further.

   <pre><code class=html>
  #CSSlogo {
    shape-margin: 35px;
  }
</code></pre>

   <div class=figure> <img
    alt="A float shape around an image using its alpha-channel with a 35 pixels shape-margin"
    src="images/shape-outside-image-with-margin.png" width="70%">
    <p class=caption>A float shape around an image using its alpha-channel
     with a 35 pixels shape-margin
   </div>
  </div>
  <!-- End secion "shape-margin property" -->
  <!-- End section "Shapes" -->

  <h2 id=conformance><span class=secno>4. </span>Conformance</h2>
  <!--begin-conformance-->

  <h3 class=no-ref id=conventions> Document conventions</h3>

  <p>Conformance requirements are expressed with a combination of descriptive
   assertions and RFC 2119 terminology. The key words “MUST”, “MUST
   NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”,
   “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in the
   normative parts of this document are to be interpreted as described in RFC
   2119. However, for readability, these words do not appear in all uppercase
   letters in this specification.

  <p>All of the text of this specification is normative except sections
   explicitly marked as non-normative, examples, and notes. <a
   href="#RFC2119" rel=biblioentry>[RFC2119]<!--{{!RFC2119}}--></a>

  <p>Examples in this specification are introduced with the words “for
   example” or are set apart from the normative text with
   <code>class="example"</code>, like this:

  <div class=example>
   <p>This is an example of an informative example.
  </div>

  <p>Informative notes begin with the word “Note” and are set apart from
   the normative text with <code>class="note"</code>, like this:

  <p class=note>Note, this is an informative note.

  <h3 class=no-ref id=conformance-classes> Conformance classes</h3>

  <p>Conformance to this specification is defined for three conformance
   classes:

  <dl>
   <dt><dfn id=style-sheet title="style sheet!!as conformance class">style
    sheet</dfn>

   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
    style sheet</a>.

   <dt><dfn id=renderer>renderer</dfn>

   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
    that interprets the semantics of a style sheet and renders documents that
    use them.

   <dt><dfn id=authoring-tool>authoring tool</dfn>

   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
    that writes a style sheet.
  </dl>

  <p>A style sheet is conformant to this specification if all of its
   statements that use syntax defined in this module are valid according to
   the generic CSS grammar and the individual grammars of each feature
   defined in this module.

  <p>A renderer is conformant to this specification if, in addition to
   interpreting the style sheet as defined by the appropriate specifications,
   it supports all the features defined by this specification by parsing them
   correctly and rendering the document accordingly. However, the inability
   of a UA to correctly render a document due to limitations of the device
   does not make the UA non-conformant. (For example, a UA is not required to
   render color on a monochrome monitor.)

  <p>An authoring tool is conformant to this specification if it writes style
   sheets that are syntactically correct according to the generic CSS grammar
   and the individual grammars of each feature in this module, and meet all
   other conformance requirements of style sheets as described in this
   module.

  <h3 class=no-ref id=partial> Partial implementations</h3>

  <p>So that authors can exploit the forward-compatible parsing rules to
   assign fallback values, CSS renderers <strong>must</strong> treat as
   invalid (and <a
   href="http://www.w3.org/TR/CSS21/conform.html#ignore">ignore as
   appropriate</a>) any at-rules, properties, property values, keywords, and
   other syntactic constructs for which they have no usable level of support.
   In particular, user agents <strong>must not</strong> selectively ignore
   unsupported component values and honor supported values in a single
   multi-value property declaration: if any value is considered invalid (as
   unsupported values must be), CSS requires that the entire declaration be
   ignored.

  <h3 class=no-ref id=experimental> Experimental implementations</h3>

  <p>To avoid clashes with future CSS features, the CSS 2.1 specification
   reserves a <a
   href="http://www.w3.org/TR/CSS21/syndata.html#vendor-keywords">prefixed
   syntax</a> for proprietary and experimental extensions to CSS.

  <p>Prior to a specification reaching the Candidate Recommendation stage in
   the W3C process, all implementations of a CSS feature are considered
   experimental. The CSS Working Group recommends that implementations use a
   vendor-prefixed syntax for such features, including those in W3C Working
   Drafts. This avoids incompatibilities with future changes in the draft.

  <h3 class=no-ref id=testing> Non-experimental implementations</h3>

  <p>Once a specification reaches the Candidate Recommendation stage,
   non-experimental implementations are possible, and implementors should
   release an unprefixed implementation of any CR-level feature they can
   demonstrate to be correctly implemented according to spec.

  <p>To establish and maintain the interoperability of CSS across
   implementations, the CSS Working Group requests that non-experimental CSS
   renderers submit an implementation report (and, if necessary, the
   testcases used for that implementation report) to the W3C before releasing
   an unprefixed implementation of any CSS features. Testcases submitted to
   W3C are subject to review and correction by the CSS Working Group.

  <p>Further information on submitting testcases and implementation reports
   can be found from on the CSS Working Group's website at <a
   href="http://www.w3.org/Style/CSS/Test/">http://www.w3.org/Style/CSS/Test/</a>.
   Questions should be directed to the <a
   href="http://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a>
   mailing list. <!--end-conformance-->

  <h2 class=no-num id=acknowledgments>Acknowledgments</h2>

  <p>This specification is made possible by input from Andrei Bucur,
   Alexandru Chiculita, Arron Eicholz, Daniel Glazman, Arno Gourdol, Zoltan
   Horvath, Chris Jones, Bem Jones-Bey, Marcus Mielke, Alex Mogilevsky, Hans
   Muller, Mihnea Ovidenie, Virgil Palanciuc, Dirk Schulze, Peter Sorotokin,
   Bear Travis, Eugene Veselov, Stephen Zilles and the CSS Working Group
   members.

  <h2 class=no-num id=references>References</h2>

  <h3 class=no-num id=normative-references>Normative references</h3>
  <!--begin-normative-->
  <!-- Sorted by label -->

  <dl class=bibliography>
   <dd style="display: none"><!-- keeps the doc valid if the DL is empty -->
    <!---->

   <dt id=CSS3BG>[CSS3BG]

   <dd>Bert Bos; Elika J. Etemad; Brad Kemper. <a
    href="http://www.w3.org/TR/2012/CR-css3-background-20120724/"><cite>CSS
    Backgrounds and Borders Module Level 3.</cite></a> 24 July 2012. W3C
    Candidate Recommendation. (Work in progress.) URL: <a
    href="http://www.w3.org/TR/2012/CR-css3-background-20120724/">http://www.w3.org/TR/2012/CR-css3-background-20120724/</a>
   </dd>
   <!---->

   <dt id=CSS3BOX>[CSS3BOX]

   <dd>Bert Bos. <a
    href="http://www.w3.org/TR/2007/WD-css3-box-20070809"><cite>CSS basic box
    model.</cite></a> 9 August 2007. W3C Working Draft. (Work in progress.)
    URL: <a
    href="http://www.w3.org/TR/2007/WD-css3-box-20070809">http://www.w3.org/TR/2007/WD-css3-box-20070809</a>
   </dd>
   <!---->

   <dt id=CSS3VAL>[CSS3VAL]

   <dd>Håkon Wium Lie; Tab Atkins; Elika J. Etemad. <a
    href="http://www.w3.org/TR/2013/CR-css3-values-20130730/"><cite>CSS
    Values and Units Module Level 3.</cite></a> 30 July 2013. W3C Candidate
    Recommendation. (Work in progress.) URL: <a
    href="http://www.w3.org/TR/2013/CR-css3-values-20130730/">http://www.w3.org/TR/2013/CR-css3-values-20130730/</a>
   </dd>
   <!---->

   <dt id=HTML5>[HTML5]

   <dd>Robin Berjon; et al. <a
    href="http://www.w3.org/TR/2013/CR-html5-20130806/"><cite>HTML5.</cite></a>
    6 August 2013. W3C Candidate Recommendation. (Work in progress.) URL: <a
    href="http://www.w3.org/TR/2013/CR-html5-20130806/">http://www.w3.org/TR/2013/CR-html5-20130806/</a>
   </dd>
   <!---->

   <dt id=RFC2119>[RFC2119]

   <dd>S. Bradner. <a href="http://www.ietf.org/rfc/rfc2119.txt"><cite>Key
    words for use in RFCs to Indicate Requirement Levels.</cite></a> Internet
    RFC 2119. URL: <a
    href="http://www.ietf.org/rfc/rfc2119.txt">http://www.ietf.org/rfc/rfc2119.txt</a>
   </dd>
   <!---->

   <dt id=SVG11>[SVG11]

   <dd>Erik Dahlström; et al. <a
    href="http://www.w3.org/TR/2011/REC-SVG11-20110816/"><cite>Scalable
    Vector Graphics (SVG) 1.1 (Second Edition).</cite></a> 16 August 2011.
    W3C Recommendation. URL: <a
    href="http://www.w3.org/TR/2011/REC-SVG11-20110816/">http://www.w3.org/TR/2011/REC-SVG11-20110816/</a>
   </dd>
   <!---->
  </dl>
  <!--end-normative-->

  <h3 class=no-num id=other-references>Other references</h3>
  <!--begin-informative-->
  <!-- Sorted by label -->

  <dl class=bibliography>
   <dd style="display: none"><!-- keeps the doc valid if the DL is empty -->
    <!---->
  </dl>
  <!--end-informative-->

  <h2 class=no-num id=index>Index</h2>
  <!--begin-index-->

  <ul class=indexlist>
   <li>authoring tool, <a href="#authoring-tool"
    title="section 4."><strong>4.</strong></a>

   <li>circle, <a href="#circle"
    title="section 3.2.1."><strong>3.2.1.</strong></a>

   <li>ellipse, <a href="#ellipse"
    title="section 3.2.1."><strong>3.2.1.</strong></a>

   <li>Float area, <a href="#float-area"
    title="section 2."><strong>2.</strong></a>

   <li>inset-rectangle, <a href="#inset-rectangle"
    title="section 3.2.1."><strong>3.2.1.</strong></a>

   <li>polygon, <a href="#polygon"
    title="section 3.2.1."><strong>3.2.1.</strong></a>

   <li>rectangle, <a href="#rectangle"
    title="section 3.2.1."><strong>3.2.1.</strong></a>

   <li>renderer, <a href="#renderer"
    title="section 4."><strong>4.</strong></a>

   <li>shape-image-threshold, <a href="#shape-image-threshold"
    title="section 3.4.2."><strong>3.4.2.</strong></a>
    <ul>
     <li>&lt;threshold&gt;, <a href="#ltthresholdgt"
      title="section 3.4.2."><strong>3.4.2.</strong></a>
    </ul>

   <li>shape-margin, <a href="#shape-margin"
    title="section 3.4.3."><strong>3.4.3.</strong></a>

   <li>shape-outside, <a href="#shape-outside"
    title="section 3.4.1."><strong>3.4.1.</strong></a>
    <ul>
     <li>auto, <a href="#auto"
      title="section 3.4.1."><strong>3.4.1.</strong></a>

     <li>&lt;basic-shape&gt;, <a href="#ltbasic-shapegt"
      title="section 3.4.1."><strong>3.4.1.</strong></a>

     <li>&lt;image&gt;, <a href="#ltimagegt"
      title="section 3.4.1."><strong>3.4.1.</strong></a>
    </ul>

   <li>style sheet
    <ul>
     <li>as conformance class, <a href="#style-sheet"
      title="section 4."><strong>4.</strong></a>
    </ul>

   <li>Wrap, <a href="#wrap" title="section 2."><strong>2.</strong></a>
  </ul>
  <!--end-index-->

  <h2 class=no-num id=property-index>Property index</h2>
  <!--begin-properties-->

  <table class=proptable>
   <thead>
    <tr>
     <th>Property

     <th>Values

     <th>Initial

     <th>Applies to

     <th>Inh.

     <th>Percentages

     <th>Media

   <tbody>
    <tr>
     <th><a class=property
      href="#shape-image-threshold">shape-image-threshold</a>

     <td>&lt;threshold&gt;

     <td>0.0

     <td>floats

     <td>no

     <td>alpha channel of the image specified by shape-outside

     <td>visual

    <tr>
     <th><a class=property href="#shape-margin">shape-margin</a>

     <td>&lt;length&gt;

     <td>0

     <td>floats

     <td>no

     <td>N/A

     <td>visual

    <tr>
     <th><a class=property href="#shape-outside">shape-outside</a>

     <td>auto | &lt;basic-shape&gt; | &lt;image&gt;

     <td>auto

     <td>floats

     <td>no

     <td>N/A

     <td>visual
  </table>
  <!--end-properties-->
  <!-- template markup for issues pulled from Bugzilla -->
  <!-- issue template and script need a new API to access bugzilla
          <script type="text/template" id="issue-template">
      <div class="issue-marker" data-bug_id="{{bug_id}}" data-bug_status="{{bug_status}}">
          <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id={{bug_id}}">Issue-{{bug_id}}</a>
          <div class="issue-details">
              <p class="short-desc">{{short_desc}}</p>
          </div>  
      </div>
          </script>   

          <script type="text/javascript" src="../shared/scripts/BugzillaTrackerUtil.js"></script>
          <script type="text/javascript" src="../shared/scripts/BugzillaTracker.js"></script>
          <script type="text/javascript">
              checkSpecificationIssues('CSS', 'Shapes');        
          </script>
          -->

  <h2 class=no-num id=change-log>Change Log</h2>

  <h3 class=no-num id=since-june-20th-2013>Since <a
   href="http://www.w3.org/TR/2013/WD-css-shapes-1-20130620/">June 20th
   2013</a></h3>

  <ul>
   <li>Future-proof shape-image-threshold to possibly apply to luminance

   <li>Added CORS fetching to shape-outside URLs

   <li>Changed shape-outside value from &lt;uri&gt; to &lt;image&gt;

   <li>Fixed basic shape grammar to use comma separators

   <li>Remove ‘<code class=css>percentages based on auto-sizing resolve to
    0</code>’

   <li>Change initial value of shape-image-threshold to 0.0

   <li>Change float positioning to be unaffected by shape-outside

   <li>Shapes on floats clipped to float's margin box

   <li>Inline content constrained to at least the float's farthest margin
    edge
  </ul>

  <h3 class=no-num id=since-may-3rd-2012>Since <a
   href="http://www.w3.org/TR/2012/WD-css3-exclusions-20120503/">May 3rd
   2012</a></h3>

  <ul>
   <li>Postpone shapes from SVG elements to a future Shapes level

   <li>Postpone shape-inside to a future Shapes level

   <li>split exclusions from shapes into separate modules

   <li>added inset-rectangle() to basic shapes

   <li>Changed shape-inside overflow diagrams to show exclusion behavior

   <li>Changed shape-inside to contribute to the wrapping context

   <li>Defined exclusion edges relative to wrapping content's writing mode

   <li>Made use of start, end, before and after consistent

   <li>Added interpolation for basic shapes

   <li>Changed basic shapes to depend on box specified with box-sizing

   <li>Added overflow behavior for shape-inside.

   <li>Added wrap-flow:minimum.

   <li>Clarified processing model.

   <li>Changed wrap-margin and wrap-padding to shape-margin and
    shape-padding.

   <li>Removed wrap shorthand.
  </ul>

  <h3 class=no-num id=since-december-13th-2011>Since <a
   href="http://www.w3.org/TR/2011/WD-css3-exclusions-20111213/">December
   13th 2011</a></h3>

  <ul>
   <li>Clarified processing model.

   <li>Clarified interaction with floats.

   <li>Clarified that an exclusion element establishes a new block formatting
    context.
  </ul>
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
