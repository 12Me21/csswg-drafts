<h1>Media Queries Level 4</h1>

<pre class='metadata'>
Group: csswg
Shortname: mediaqueries
Level: 4
ED: http://dev.w3.org/csswg/mediaqueries4/
Editor: Florian Rivoal, ?, florian@rivoal.net
Former Editor: Håkon Wium Lie, Opera, howcome@opera.com
Former Editor: Tantek Çelik, Mozilla, tantek@cs.standard.edu
Former Editor: Daniel Glazman, Samsung, daniel@glazman.org
Former Editor: Anne van Kesteren, Mozilla, annevk@annevk.nl
!Issue Tracking: Inline, and <a href="http://www.w3.org/Style/CSS/Tracker/products/7">http://www.w3.org/Style/CSS/Tracker/products/7</a>
Abstract: <a>Media Queries</a> allow authors to adapt the style applied to a document based on the environment the document is being rendered in. [[HTML401]] and [[!CSS21]] introduced this mechanism, by allowing detection of the <a>media type</a>. For example, a document may use sans-serif fonts when displayed on a screen and serif fonts when printed. ''screen'' and ''print''are two media types that have been defined. Media Queries Level 3 [[MEDIAQ]] refined this mechanism by allowing detection of individual characteristics, or <a>media features</a>. For example, a document may use a different style when displayed in ''portrait'' and in ''landscape'' mode, as detected by the ''orientation'' media feature.
Abstract: Media Queries Level 4 describes the mechanism, media types, and media features that already existed in [[MEDIAQ]], and further introduces new media features.
</pre>

<h2 id="intro">
Introduction</h2>

	<em>This section is not normative.</em>

	HTML4 [[HTML401]] and CSS2 [[!CSS21]] currently support media-dependent
	style sheets tailored for different media types. For example, a
	document may use different style sheets for screen and print. In
	HTML4, this can be written as:

	<div class="example">
		<pre>
			&lt;link rel="stylesheet" type="text/css" media="screen" href="sans-serif.css">
			&lt;link rel="stylesheet" type="text/css" media="print" href="serif.css">
		</pre>
	</div>

	Inside a CSS style sheet, one can declare that sections apply to
	certain media types:

	<div class="example">
		<pre>
			@media screen {
				* { font-family: sans-serif }
			}
		</pre>
	</div>

	The ''print'' and ''screen'' media types are defined in HTML4. The
	complete list of media types in HTML4 is: ''aural'', ''braille'',
	''handheld'', ''print'', ''projection'', ''screen'', ''tty'', ''tv''. CSS2
	defines the same list, deprecates ''aural'' and adds ''embossed'' and
	''speech''. Also, ''all'' is used to indicate that the style sheet applies
	to all media types.

	Media-specific style sheets are supported by several user
	agents. The most commonly used feature is to distinguish between
	''screen'' and ''print''.

	There have been requests for ways to describe in more detail
	what type of output devices a style sheet applies to. Fortunately
	HTML4 foresaw these requests and defined a forward-compatible
	syntax for media types. Here is a quote from <a href=
	"http://www.w3.org/TR/1999/REC-html401-19991224/types.html#h-6.13">HTML4,
	section 6.13</a>:

	<blockquote cite="http://www.w3.org/TR/1999/REC-html401-19991224/types.html#h-6.13">
		Future versions of HTML may introduce new values and may allow
		parameterized values. To facilitate the introduction of these
		extensions, conforming user agents must be able to parse the <a href=
		"http://www.w3.org/TR/1999/REC-html401-19991224/present/styles.html#adef-media"><samp>media</samp></a> attribute value as follows:

		<ol>
			<li>
				The value is a comma-separated list of entries. For example,

				<pre>
				media="screen, 3d-glasses, print and resolution &gt; 90dpi"
				</pre>

				is mapped to:

				<pre>
				"screen"
				"3d-glasses"
				"print and resolution > 90dpi"
				</pre>

			<li>
				Each entry is truncated just before the first character that
				isn't a US ASCII letter [a-zA-Z] (Unicode decimal 65-90, 97-122),
				digit [0-9] (Unicode hex 30-39), or hyphen (45). In the example,
				this gives:

				<pre>
				"screen"
				"3d-glasses"
				"print"
				</pre>
		</ol>
	</blockquote>

	Media queries, as described in this specification, build on the
	mechanism outlined in HTML4. The syntax of media queries fit into the
	media type syntax reserved in HTML4. The <code class="html">media</code>
	attribute of HTML4 also exists in XHTML and generic XML. The same
	syntax can also be used inside in the ''@media'' and ''@import'' rules
	of CSS.

	However, the parsing rules for media queries are incompatible with those
	of HTML4 so that they are consistent with those of media queries used in
	CSS.

	Note: HTML5 [[HTML5]] (at the moment of writing still work in
	progress) references the Media Queries specification directly and thus
	updates the rules for HTML.

<h3 id="placement">
Module interactions</h3>

	This module replaces and extends the Media Queries, Media Type and Media Features
	defined in [[!CSS21]] sections 7 and in [[!MEDIAQ]].

<h3 id="values">
Values</h3>

	Value types not defined in this specification, such as <<integer>>,
	<<number>> or <<resolution>>, are defined in [[!CSS3VAL]].  Other CSS
	modules may expand the definitions of these value types.

	This specification also introduces one new value type.

	The <dfn type>&lt;ratio></dfn> value type is a positive (not zero or negative)
	<<integer>> followed by optional whitespace, followed by a solidus ('/'),
	followed by optional whitespace, followed by a positive <<integer>>.

<h3 id="units">
Units</h3>

	The units used in media queries are the same as in other parts of CSS, as
	defined in [[!CSS3VAL]]. For example, the pixel unit represents CSS pixels and
	not physical pixels.

	Relative units in media queries are based on the initial value, which means
	that units are never based on results of declarations. For example, in HTML,
	the ''em'' unit is relative to the initial value of 'font-size'.


<h2 id="media">
Media Queries</h2>

	A media query consists of an optional media type and zero or more
	<a>media expressions</a> that check for the conditions of
	particular <a>media features</a>.

	Statements regarding media queries in this section assume the
	<a href="#syntax">syntax section</a> is followed. Media queries that do not
	conform to the syntax are discussed in the
	<a href="#error-handling">error handling section</a>. I.e. the syntax takes
	precedence over requirements in this section.

	<div class="example">
		Here is a simple example written in HTML:

		<pre>&lt;link rel="stylesheet" media="screen and (color)" href="example.css" /></pre>

		This example expresses that a certain style sheet
		(<code>example.css</code>) applies to devices of a certain media type
		(''screen'') with certain feature (it must be a color screen).
	</div>

	<div class="example">
		Here the same media query written in an @import-rule in CSS:

		<pre>@import url(color.css) screen and (color);</pre>
	</div>

	A media query is a logical expression that is either true or
	false. A media query is true if the media type of the media query
	matches the media type of the device where the user agent is running (as
	defined in the "Applies to" line), and all expressions in the media query
	are true.

	A shorthand syntax is offered for media queries that apply to all
	media types; the keyword ''all'' can be left out (along with the
	trailing ''and''). I.e. if the media type is not explicitly given it is
	''all''.

	<div class="example">
		I.e. these are identical:

		<pre>
		@media all and (min-width:500px) { &hellip; }
		@media (min-width:500px) { &hellip; }
		</pre>

		As are these:

		<pre>
		@media (orientation: portrait) { &hellip; }
		@media all and (orientation: portrait) { &hellip; }
		</pre>
	</div>

	Several media queries can be combined in a media query list. A
	comma-separated list of media queries. If one or more of the media queries
	in the comma-separated list are true, the whole list is true, and otherwise
	false. In the media queries syntax, the comma
	expresses a logical OR, while the ''and'' keyword expresses a logical
	AND.

	<div class="example">
		Here is an example of several media queries in a comma-separated
		list using the an @media-rule in CSS:

		<pre>
		@media <em>screen and (color), projection and (color)</em> { &hellip; }
		</pre>
	</div>

	If the media query list is empty (i.e. the declaration is the empty
	string or consists solely of whitespace) it evaluates to true.

	<div class="example">
		I.e. these are equivalent:

		<pre>
		@media all { &hellip; }
		@media { &hellip; }
		</pre>
	</div>

	The logical NOT can be expressed through the ''not'' keyword. The
	presence of the keyword ''not'' at the beginning of the media query negates
	the result. I.e., if the media query had been true without the ''not''
	keyword it will become false, and vice versa. User agents that only support
	media types (as described in HTML4) will not recognize the ''not'' keyword
	and the associated style sheet is therefore not applied.

	<div class="example">
		<pre>&lt;link rel="stylesheet" media="<em>not screen and (color)</em>" href="example.css" /></pre>
	</div>

	The keyword ''only'' can also be used to hide style sheets from
	older user agents. User agents must process media queries starting
	with ''only'' as if the ''only'' keyword was not present.

	<div class="example">
		<pre>&lt;link rel="stylesheet" media="<em>only screen and (color)</em>" href="example.css" /></pre>
	</div>

	The media queries syntax can be used with HTML, XHTML, XML [[XMLSTYLE]] and the @import and @media rules of CSS.

	<div class="example">
		Here is the same example written in HTML, XHTML, XML, @import and @media:

		<pre>&lt;link rel="stylesheet" media="<em>screen and (color), projection and (color)</em>" rel="stylesheet" href="example.css"></pre>

		<pre>&lt;link rel="stylesheet" media="<em>screen and (color), projection and (color)</em>" rel="stylesheet" href="example.css" /></pre>

		<pre>&lt;?xml-stylesheet media="<em>screen and (color), projection and (color)</em>" rel="stylesheet" href="example.css" ?></pre>

		<pre>@import url(example.css) <em>screen and (color), projection and (color)</em>;</pre>

		<pre>@media <em>screen and (color), projection and (color)</em> { &hellip; }</pre>

		Note: The [[XMLSTYLE]] specification has not yet been updated to
		use media queries in the <code>media</code> pseudo-attribute.
	</div>

	If a media feature does not apply to the device where the UA is
	running, expressions involving the media feature will be false.

	<div class="example">
		The media feature ''device-aspect-ratio'' only applies to
		visual devices. On an aural device, expressions involving
		''device-aspect-ratio'' will therefore always be false:

		<pre>&lt;link rel="stylesheet" media="aural and (device-aspect-ratio: 16/9)" href="example.css" /&gt;</pre>
	</div>

	Expressions will always be false if the unit of measurement does
	not apply to the device.

	<div class="example">
		The ''px'' unit does not apply to ''speech'' devices so the following media query is always false:

		<pre>&lt;link rel="stylesheet" media="speech and (min-device-width: 800px)" href="example.css" /&gt;</pre>

		Note that the media queries in this example would have
		been true if the keyword ''not'' had been added to the beginning of
		the media query.
	</div>

	To avoid circular dependencies, it is never necessary to apply the
	style sheet in order to evaluate expressions. For example, the aspect
	ratio of a printed document may be influenced by a style sheet, but
	expressions involving ''device-aspect-ratio'' will be based on the
	default aspect ratio of the user agent.

	Note: User agents are expected, but not required, to
	re-evaluate and re-layout the page in response to changes in the user
	environment, for example if the device is tilted from landscape to
	portrait mode.

<h2 id='mq-syntax'>
Syntax</h2>

	The media query syntax is described in terms of the
	<a href="http://www.w3.org/TR/CSS21/grammar.html">CSS2 grammar</a>. As such,
	rules not defined here are defined in CSS2. The
	<code>media_query_list</code> production defined below replaces the
	<code>media_list</code> production from CSS2. [[!CSS21]]

	<pre>
	media_query_list
		: S* [media_query [ ',' S* media_query ]* ]?
		;
	media_query
		: [ONLY S+ | NOT S+]? media_type [ S+ AND S+ expression ]* S*
		| expression [ S+ AND S+ expression ]* S*
		;
	media_type
		: IDENT
		;
	expression
		: '(' S* media_feature S* [ ':' S* expr ]? ')'
		;
	media_feature
		: IDENT
		;
	</pre>

	COMMENT tokens, as defined by CSS2, do not occur in the grammar (to keep
	it  readable), but any number of these tokens may appear anywhere between
	other tokens. [[!CSS21]]

	The following new definitions are introduced:

	<pre>
	L  l|\\0{0,4}(4c|6c)(\r\n|[ \t\r\n\f])?|\\l
	Y  y|\\0{0,4}(59|79)(\r\n|[ \t\r\n\f])?|\\y
	</pre>

	The following new tokens are introduced:

	<pre>
	{O}{N}{L}{Y}      {return ONLY;}
	{N}{O}{T}         {return NOT;}
	{A}{N}{D}         {return AND;}
	{num}{D}{P}{I}    {return RESOLUTION;}
	{num}{D}{P}{C}{M} {return RESOLUTION;}
	</pre>

	<code>RESOLUTION</code> is to be added to the CSS2
	<code>term</code> production.

	CSS style sheets are generally case-insensitive, and this is
	also the case for media queries.

	In addition to conforming to the syntax, each media query needs to use
	media types and media features according to their respective specification
	in order to be considered conforming.

	<div class="example">
		Only the first media query is conforming in the example below because the
		"example" media type does not exist.

		<pre>
		@media all { body { background:lime } }
		@media example { body { background:red } }
		</pre>
	</div>

<h3 id=error-handling>
Error Handling</h3>

	For media queries that are not conforming user agents need to follow the
	rules described in this section.

	<ul>
	 <li>
		<strong>Unknown media types.</strong> Unknown media types evaluate to
		false. Effectively, they are treated identically to known media types
		that do not match the media type of the device. However, an exception is made
		for media types ''not'', ''and'', ''only'' and ''or''. Even though they do
		match the IDENT production, they must not be treated as unknown media types,
		but rather trigger the malformed query clause.

		<div class="example">
			The media query "<code>unknown</code>" will evaluate to false, unless
			<code>unknown</code> is actually a supported media type. Similarly,
			"<code>not unknown</code>" will evaluate to true.
		</div>

		Note: Unknown media types are distinct from media types that do
		not actually match the IDENT production. Those fall under the malformed
		media query clause.

	 <li>
		<strong>Unknown media features.</strong> User agents are to represent a
		media query as "<code>not all</code>" when one of the specified media
		features is not known.

		<div class="example">
			<pre>&lt;link rel="stylesheet" media="screen and (max-weight: 3kg) and (color), (color)" href="example.css" /&gt;</pre>

			In this example, the first media query will be represented as
			"<code>not all</code>" and evaluate to false and the second media query
			is evaluated as if the first had not been specified, effectively.
		</div>

		<div class="example">
			<pre>@media (min-orientation:portrait) { &hellip; }</pre>

			Is represented as "<code>not all</code>" because the ''orientation''
			feature does not accept the ''min-'' prefix.
		</div>

	 <li>
		<strong>Unknown media feature values.</strong> As with unknown media
		features, user agents are to represent a media query as
		"<code>not all</code>" when one of the specified media feature values is
		not known.

		<div class="example">
			The media query <code>(color:20example)</code> specifies an unknown
			value for the ''color'' media feature and is therefore represented as
			"<code>not all</code>".
		</div>

		<div class="example">
			This media query is represented as "<code>not all</code>" because
			negative lengths are not allowed for the ''width'' media feature:

			<pre>@media (min-width: -100px) { &hellip; }</pre>
		</div>

	 <li>
		<strong>Malformed media query.</strong> User agents are to handle
		unexpected tokens encountered while parsing a media query by reading until
		the end of the media query, while observing
		<a href="http://www.w3.org/TR/CSS21/syndata.html#block">the rules for
		matching pairs</a> of (), [], {}, "", and &#39;&#39;, and correctly handling
		escapes. Media queries with unexpected tokens are represented as
		"<code>not all</code>". [[!CSS21]]

		<div class="example">
			<pre>
			@media (example, all,), speech { /* only applicable to speech devices */ }
			@media &amp;test, screen           { /* only applicable to screen devices */ }
			</pre>
		</div>

		<div class="example">
			The following is an malformed media query because having no space
			between ''and'' and the expression is not allowed. (That is reserved for
			the functional notation syntax.)
			<pre>@media all and(color) { &hellip; }</pre>
		</div>

		<div class="example">
			The following is a malformed media query because it uses ''only'' and 'or' as media types.
			<pre>@media only and or { &hellip; }</pre>
		</div>

		Media queries are expected to follow the error handling rules of the
		host language as well.

		<div class="example">
			<pre>@media test;,all { body { background:lime } }</pre>

			&hellip; will not apply because the semicolon terminates the
			<code>@media</code> rule in CSS.
		</div>
	</ul>

<h2 id="media-features">
Media features</h2>

	Syntactically, media features resemble CSS properties: they have
	names and accept certain values. There are, however, several
	important differences between properties and media features:

	<ul>
		<li>
			Properties are used in <em>declarations</em> to give
			information about how to present a document. Media features are
			used in <em>expressions</em> to describe requirements of the output
			device.

		<li>
			Most media features accept optional ''min-'' or ''max-'' prefixes
			to express "greater or equal to" and "smaller or equal to"
			constraints. This syntax is used to avoid "&lt;" and "&gt;"
			characters which may conflict with HTML and XML. Those media features
			that accept prefixes will most often be used with prefixes, but can
			also be used alone.

		<li>
			Properties always require a value to form a declaration. Media
			features, on the other hand, can also be used without a value. For a media
			feature <var>feature</var>, <code>(<var>feature</var>)</code> will evaluate
			to true if <code>(<var>feature</var>:<var>x</var>)</code> will evaluate to
			true for a value <var>x</var> other than zero or zero followed by a unit
			identifier (i.e., other than <code>0</code>, <code>0px</code>,
			<code>0em</code>, etc.) or the keyword 'none'. Media features that are prefixed by min/max cannot
			be used without a value. When a media feature prefixed with min/max is used
			without a value it makes the media query malformed.

		<li>
			Properties may accept more complex values, e.g., calculations that
			involve several other values. Media features only accept single
			values: one keyword, one number, or a number with a unit identifier.
			(The only exceptions are the ''aspect-ratio'' and ''device-aspect-ratio''
			media features.)
	</ul>

	<div class="example">
		For example, the ''color'' media feature can form expressions without a
		value (''(color)''), or with a value (''(min-color: 1)'').
	</div>

	Note: This specification defines media features usable with visual and
	tactile devices. Similarly, media features can be defined for aural
	media types.


<h3 id="width">
width</h3>

	<pre class='descdef'>
	Name: width
	Value: <<length>>
	For: @media
	Type: range
	</pre>

	The '@media/width' media feature describes the width of the targeted display
	area of the output device. For continuous media, this is the width
	of the viewport (as described by CSS2, section 9.1.1 [[!CSS21]]) including
	the size of a rendered scroll bar (if any). For paged media, this is the
	width of the page box (as described by CSS2, section 13.2 [[!CSS21]]).

	A specified <<length>> cannot be negative.

	<div class="example">
		For example, this media query expresses that the style sheet is
		usable on printed output wider than 25cm:

		<pre>&lt;link rel="stylesheet" media="print and (min-width: 25cm)" href="http://&hellip;" /></pre>
	</div>

	<div class="example">
		This media query expresses that the style sheet is usable on
		devices with viewport (the part of the screen/paper where the
		document is rendered) widths between 400 and 700 pixels:

		<pre>@media screen and (min-width: 400px) and (max-width: 700px) { &hellip; }</pre>
	</div>

	<div class="example">
		This media query expresses that style sheet is usable on screen
		and handheld devices if the width of the viewport is greater than
		20em.

		<pre>
		@media handheld and (min-width: 20em),
			screen and (min-width: 20em) { &hellip; }
		</pre>

		The ''em'' value is relative to the initial value of
		‘font-size’.
	</div>


<h3 id="height">
height</h3>

	<pre class='descdef'>
	Name: height
	Value: <<length>>
	For: @media
	Type: range
	</pre>

	The 'height' media feature describes the height of the targeted display
	area of the output device. For continuous media, this is the height
	of the viewport including the size of a rendered scroll bar (if any). For
	paged media, this is the height of the page box.

	A specified <<length>> cannot be negative.

<h3 id="device-width">
device-width</h3>

	<pre class='descdef'>
	Name: device-width
	Value: <<length>>
	For: @media
	Type: range
	</pre>

	The 'device-width' media feature describes the width of the rendering
	surface of the output device. For continuous media, this is the width
	of the screen. For paged media, this is the width of the page sheet
	size.

	A specified &lt;length> cannot be negative.

	<div class="example">
		<pre>@media screen and (device-width: 800px) { &hellip; }</pre>

		In the example above, the style sheet will apply only to screens
		that currently displays exactly 800 horizontal pixels. The ''px'' unit is
		of the logical kind, as described in the <a href="#units">Units</a>
		section.
	</div>



<h3 id="device-height">
device-height</h3>

	<pre class='descdef'>
	Name: device-height
	Value: <<length>>
	For: @media
	Type: range
	</pre>

	The 'device-height' media feature describes the height of the rendering
	surface of the output device. For continuous media, this is the height
	of the screen. For paged media, this is the height of the page sheet
	size.

	A specified &lt;length> cannot be negative.

	<div class="example">
		<pre>&lt;link rel="stylesheet" media="screen and (device-height: 600px)" /&gt;</pre>

		In the example above, the style sheet will apply only to screens
		that have exactly 600 vertical pixels. Note that the definition of the
		''px'' unit is the same as in other parts of CSS.
	</div>


<h3 id='orientation'>
orientation</h3>

	<pre class='descdef'>
	Name: orientation
	Value: portrait | landscape
	For: @media
	Type: discrete
	</pre>

	The 'orientation' media feature is ''portrait'' when the value of the
	'height' media feature is greater than or equal to the value of the
	'width' media feature. Otherwise 'orientation' is ''landscape''.

	<div class="example">
		<pre>
		@media all and (orientation:portrait) { &hellip; }
		@media all and (orientation:landscape) { &hellip; }
		</pre>
	</div>


<h3 id='aspect-ratio'>
aspect-ratio</h3>

	<pre class='descdef'>
	Name: aspect-ratio
	Value: <<ratio>>
	For: @media
	Type: range
	</pre>

	The 'aspect-ratio' media feature is defined as the ratio of the value
	of the ''width'' media feature to the value of the ''height'' media
	feature.


<h3 id='device-aspect-ratio'>
device-aspect-ratio</h3>

	<pre class='descdef'>
	Name: device-aspect-ratio
	Value: <<ratio>>
	For: @media
	Type: range
	</pre>

	The 'device-aspect-ratio media feature is defined as the ratio of the
	value of the 'device-width' media feature to the value of the
	'device-height media feature.

	<div class="example">
		For example, if a screen device with square pixels has 1280 horizontal
		pixels and 720 vertical pixels (commonly referred to as "16:9"), the
		following Media Queries will all match the device:

		<pre>
		@media screen and (device-aspect-ratio: 16/9) { &hellip; }
		@media screen and (device-aspect-ratio: 32/18) { &hellip; }
		@media screen and (device-aspect-ratio: 1280/720) { &hellip; }
		@media screen and (device-aspect-ratio: 2560/1440) { &hellip; }
		</pre>
	</div>


<h3 id="color">
color</h3>

	<pre class='descdef'>
	Name: color
	Value: <<integer>>
	For: @media
	Type: range
	</pre>

	The 'color' media feature describes the number of bits per color
	component of the output device. If the device is not a color device,
	the value is zero.

	A specified <<integer>> cannot be negative.

	<div class="example">
		For example, these two media queries express that a style sheet
		applies to all color devices:

		<pre>
		@media all and (color) { &hellip; }
		@media all and (min-color: 1) { &hellip; }
		</pre>
	</div>

	<div class="example">
		This media query expresses that a style sheet applies to color
		devices with 2 or more bits per color component:

		<pre>@media all and (min-color: 2) { &hellip; }</pre>
	</div>

	If different color components are represented by
	different number of bits, the smallest number is used.

	<div class="example">
		For instance, if an 8-bit color system represents the red
		component with 3 bits, the green component with 3 bits and the blue
		component with 2 bits, the ''color'' media feature will have a value
		of 2.
	</div>

	In a device with indexed colors, the minimum number of bits per
	color component in the lookup table is used.

	Note: The described functionality is only able to describe color
	capabilities at a superficial level. If further functionality is
	required, RFC2531 [[RFC2531]] provides more specific media features
	which may be supported at a later stage.


<h3 id="color-index">
color-index</h3>

	<pre class='descdef'>
	Name: color-index
	Value: <<integer>>
	For: @media
	Type: range
	</pre>

	The 'color-index' media feature describes the number of entries
	in the color lookup table of the output device. If the device does not
	use a color lookup table, the value is zero.

	A specified <<integer>> cannot be negative.

	<div class="example">
		For example, here are two ways to express that a style sheet
		applies to all color index devices:

		<pre>
		@media all and (color-index) { &hellip; }
		@media all and (min-color-index: 1) { &hellip; }
		</pre>
	</div>


	<div class="example">
		This media query expresses that a style sheet applies to a color
		index device with 256 or more entries:

		<pre>
		&lt;?xml-stylesheet media="all and (min-color-index: 256)"
			href="http://www.example.com/&hellip;" ?&gt;
		</pre>
	</div>

<h3 id="monochrome">
monochrome</h3>

	<pre class='descdef'>
	Name: monochrome
	Value: <<integer>>
	For: @media
	Type: range
	</pre>

	The 'monochrome' media feature describes the number of bits per
	pixel in a monochrome frame buffer. If the device is not a
	monochrome device, the output device value will be 0.

	A specified <<integer>> cannot be negative.

	<div class="example">
		For example, here are two ways to express that a style sheet
		applies to all monochrome devices:

		<pre>
		@media all and (monochrome) { &hellip; }
		@media all and (min-monochrome: 1) { &hellip; }
		</pre>
	</div>

	<div class="example">
		Express that a style sheet applies to monochrome
		devices with more than 2 bits per pixels:

		<pre>@media all and (min-monochrome: 2) { &hellip; }</pre>
	</div>


	<div class="example">
		Express that there is one style sheet for color pages and another for monochrome:

		<pre>
		&lt;link rel="stylesheet" media="print and (color)" href="http://&hellip;" /&gt;
		&lt;link rel="stylesheet" media="print and (monochrome)" href="http://&hellip;" /&gt;
		</pre>
	</div>

<h3 id="resolution">
resolution</h3>

	<pre class='descdef'>
	Name: resolution
	Value: <<resolution>>
	For: @media
	Type: range
	</pre>

	The 'resolution' media feature describes the resolution of the
	output device, i.e. the density of the pixels. When querying devices
	with non-square pixels, in 'min-resolution' queries the least-dense
	dimension must be compared to the specified value and in
	'max-resolution' queries the most-dense dimensions must be compared
	instead. A 'resolution' (without a "min-" or "max-" prefix) query
	never matches a device with non-square pixels.

	For printers, this corresponds to the screening resolution (the
	resolution for printing dots of arbitrary color).

	<p class="issue">
		Another media feature should probably be added to deal with the type of resolution authors want to know to deal with monochrome printing.

	<div class="example">
		For example, this media query expresses that a style sheet is
		usable on devices with resolution greater than 300 dots per
		CSS ''inch'':

		<pre>@media print and (min-resolution: 300dpi) { &hellip; }</pre>
	</div>


	<div class="example">
		This media query expresses that a style sheet is
		usable on devices with resolution greater than 118 dots per
		CSS ''centimeter'':

		<pre>@media print and (min-resolution: 118dpcm) { &hellip; }</pre>
	</div>



<h3 id="scan">
scan</h3>

<pre class='descdef'

<div class="media-feature"><span class="label">Value:</span>
progressive | interlace<br>
<span class="label">Applies to:</span> "tv" media types<br>
<span class="label">Accepts min/max prefixes:</span> no<br>
</div>

The ''scan'' media feature describes the scanning process of "tv"
output devices.

<div class="example">

For example, this media query expresses that a style sheet is
usable on tv devices with progressive scanning:

<pre>@media tv and (scan: progressive) { &hellip; }</pre>
</div>

<h3 id="grid">grid</h3>

<div class="media-feature"><span class="label">Value:</span> <<integer>><br>
<span class="label">Applies to:</span> visual and tactile media types<br>
<span class="label">Accepts min/max prefixes:</span> no<br>
</div>

The ''grid'' media feature is used to query whether the output device
is grid or bitmap. If the output device is grid-based (e.g., a "tty"
terminal, or a phone display with only one fixed font), the value will
be 1. Otherwise, the value will be 0.

Only 0 and 1 are valid values. (This includes -0.) Thus everything else
creates a malformed media query.

<div class="example">

Here are two examples:

<pre>
@media handheld and (grid) and (max-width: 15em) { &hellip; }</code>
<code>@media handheld and (grid) and (max-device-height: 7em) { &hellip; }
</pre>

</div>


<h3 id="script">script</h3>
<div class="media-feature"><span class="label">Value:</span> <<integer>><br>
	<span class="label">Applies to:</span>all media types<br>
	<span class="label">Accepts min/maxprefixes:</span> no<br
</div>

The 'script' media feature is used to query whether ECMAscript is supported
on the current document. If the user agent supports ECMAscript, and that
support is active for the current document the value must be 1. Otherwise, the
value must be 0.

Some user agents have the ability to turn off ECMAscript support on a per
script basis or per domain basis, allowing some, but not all, scripts to run in
a particular document. The ''script'' media feature does not allow fine grained
detection of which script is allowed to run. In this scenario, the value of the
'script' media feature should be 1 if scripts originating on the same domain as
the document are allowed to run, and 0 otherwise.

Note: A future level of CSS may extend this media feature to allow
fine-grained detection of which script is allowed to run.

Only 0 and 1 are valid values. (This includes -0.) Thus everything else
creates a malformed media query.

<h3 id="pointer">pointer</h3>
<div class="media-feature"><span class="label">Value:</span> none | coarse | fine<br>
<span class="label">Applies to:</span> visual and tactile media types<br>
<span class="label">Accepts min/max prefixes:</span> no<br>
</div>

The ''pointer'' media feature is used to query about the presence and
accuracy of a pointing device such as a mouse. If a device has multiple input
mechanisms, it is recommended that the UA reports the characteristics of the
least capable pointing device of the primary input mechanisms. This
media query takes the following values:

<dl>
	<dt><dfn title="pointer:none">''none''</dfn>
	<dd>The input mechanism of the device does not include a pointing device.

	<dt><dfn title="pointer:coarse">''coarse''</dfn>
	<dd>The input mechanism of the device includes a pointing device of limited accuracy.

	<dt><dfn title="pointer:fine">''fine''</dfn>
	<dd>The input mechanism of the device includes an accurate pointing device.
</dl>

Both ''coarse'' and ''fine'' indicate the presence of a pointing device, but
differ in accuracy. A pointing device with which it would be difficult or
impossible to reliably pick one of several small adjacent targets at a zoom
factor of 1 would qualify as ''coarse''. Changing the zoom level does not
affect the value of this media feature.

Note: As the UA may provide the user with the ability to zoom, or as
secondary pointing devices may have a different accuracy, the user may be able
to perform accurate clicks even if the value of this media feature is
''coarse''. This media feature does not indicate that the user will never be
able to click accurately, only that it is inconvenient for him to do so.
Authors are expected to react to a value of ''coarse'' by designing pages that
do not rely on accurate clicking to be operated.

Note: Typical examples of a ''fine'' pointing system are a mouse, a track-pad or a
stylus-based touch screen. Finger-based touch screens would qualify as ''coarse''.

For accessibility reasons, even on devices whose pointing device can be
described as ''fine'', the UA may give a value of ''coarse'' or ''none'' to
this media query, to indicate that the user has difficulties
manipulating the input device accurately or at all.

<div class="example">
	<pre>
/* Make radio buttons and check boxes larger if we have an inaccurate pointing device */
@media (pointer:coarse) {
	input[type="checkbox"], input[type="radio"] {
		min-width:30px;
		min-height:40px;
		background:transparent;
	}
}
</pre>
</div>

<h3 id="hover">hover</h3>
<div class="media-feature"><span class="label">Value:</span> <<integer>><br>
<span class="label">Applies to:</span> visual and tactile media types<br>
<span class="label">Accepts min/max prefixes:</span> no<br>
</div>

The ''hover'' media feature is used to query whether primary pointing system
used on the output device can hover or not.  If it can, the value will be 1.
Otherwise, the value will be 0.

If a device has multiple pointing devices, some of which support hovering
and some of which not, it is  recommended that the UA reports the hovering
ability of the least capable of the primary pointing devices.

Note:
The value of ''hover'' media query should for example be 0 on a touch screen
device that can also be controlled via an optional mouse. Authors should
therefore be careful not to assume that the ':hover' pseudo class will never
match on device where 'hover:0' is true, but they should design layouts
that do not depend on hovering to be fully usable.

For accessibility reasons, even on devices that do support hovering,
the UA may give a value of 0 to this media query, to opt into layouts that work
well without hovering.

Only 0 and 1 are valid values. (This includes -0.) Thus everything else
creates a malformed media query.

<div class="example">
	<pre>
/* Only use a hover-activated drop down menu on devices that can hover. */
@media (hover) {
	.menu &gt; li        {display:inline-block;}
	.menu ul          {display:none; position:absolute;}
	.menu li:hover ul {display:block; list-style:none; padding:0;}
	/* ... */
}
</pre>
</div>


<h3 id="luminosity">luminosity</h3>
<div class="media-feature"><span class="label">Value:</span> dim | normal | washed<br>
<span class="label">Applies to:</span> visual media types<br>
<span class="label">Accepts min/max prefixes:</span> no<br>
</div>

The ''luminosity'' media feature is used to query about the ambient luminosity in
which the device is used, to allow the author to adjust style of the document
in response. The following values are valid:

<dl>
	<dt><dfn title="luminosity:dim">''dim''</dfn>
	<dd>The device is used in a dim environment, where excessive contrast
	and brightness would be distracting or uncomfortable to the reader. For
	example: night time, or a dimly illuminated indoor environment.

	<dt><dfn title="luminosity:normal">''normal''</dfn>
	<dd>The device is used in a environment with a level of luminosity in
	the ideal range for the screen, and which does not necessitate any
	particular adjustment.

	<dt><dfn title="luminosity:washed">''washed''</dfn>
	<dd>The device is used in an exceptionally bright environment, causing the screen to be washed out and difficult to read. For example: bright daylight.
</dl>

User Agents should set the thresholds between the 3 levels in a way that
takes into account the characteristics of the device.

<div class="note">Even though it is expected that User Agents will adjust the
	value of this media feature based on ambient light sensors, this
	specification intentionally refrains from defining the 3 levels in
	terms of a measurement in lux, for several reasons:
	<ul>
		<li>Devices equipped with a light sensor usually adjust the
		brightness of the screen automatically. Depending on the level
		of adjustment, the thresholds for needing a low contrast or
		hight contrast content may vary.
		<li>Different screen technologies wash out at very different
		levels of ambient luminosity; e-ink displays remain readable in
		bright daylight, while liquid crystal displays do not.
		<li>Many embedded light sensors are inaccurately calibrated,
		making it difficult to establish useful thresholds valid across
		devices.
	</ul>
</div>

For accessibility purposes, User Agents may offer manual controls allowing
the user to switch between the 3 levels of independently of the environment
luminosity, as high contrast or low contrast styles may be more suitable for
users with visual disabilities.
<div class="issue">Using this media feature for accessibility purposes overlaps
	a lot with the high-contrast media feature proposed by Microsoft: <a
		href="http://msdn.microsoft.com/en-us/library/windows/apps/hh465764.aspx">http://msdn.microsoft.com/en-us/library/windows/apps/hh465764.aspx</a>.
	Can we adjust this so that it covers all use cases for both, or somehow
	modify them to work in an orthogonal, rather than overlapping,
	fashion?</div>

<div class="example">
	<pre>
@media (luminosity: normal) {
	p { background: url("texture.jpg"); color: #333 }
}
@media (luminosity: dim) {
	p { background: #222; color: #ccc }
}
@media (luminosity: washed) {
	p { background: white; color: black; font-size: 2em; }
}
</pre>
</div>


<h2 id="changes">Changes</h2>
<h3 id="changes-2012">Changes Since the Media Queries Level 3</h3>
The following changes were made to this specification since the
<a href="http://www.w3.org/TR/2012/PR-css3-mediaqueries-20120426/">26 April 2012
Proposed Recomendation of Media Queries Level 3</a>:
<ul>
	<li>For a media feature <var>feature</var>,
	<code>(<var>feature</var>)</code> will evaluate to true if
	<code>(<var>feature</var>:<var>x</var>)</code> will evaluate to true
	for a value <var>x</var> other than zero or zero followed by a unit
	identifier (i.e., other than <code>0</code>, <code>0px</code>,
	<code>0em</code>, etc.)<ins> or the keyword 'none'</ins>.
	<li>The <a href="#script">''script'' media feature</a> was added.
	<li>The <a href="#pointer">''pointer'' media feature</a> was added.
	<li>The <a href="#hover">''hover'' media feature</a> was added.
	<li>The <a href="#luminosity">''luminosity'' media feature</a> was added.
	<li>''or'', ''and'', ''only'' and ''not'' are invalid media types.
	<li>White space is required around the keyword “and” as well as after "not" and "only".
</ul>

<h2 id="conformance">
Conformance</h2>

<h3 id="conventions">
Document conventions</h3>

	Conformance requirements are expressed with a combination of
	descriptive assertions and RFC 2119 terminology. The key words “MUST”,
	“MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
	“RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
	document are to be interpreted as described in RFC 2119.
	However, for readability, these words do not appear in all uppercase
	letters in this specification.

	All of the text of this specification is normative except sections
	explicitly marked as non-normative, examples, and notes. [[!RFC2119]]

	Examples in this specification are introduced with the words “for example”
	or are set apart from the normative text with <code>class="example"</code>,
	like this:

	<div class="example">
		This is an example of an informative example.
	</div>

	Informative notes begin with the word “Note” and are set apart from the
	normative text with <code>class="note"</code>, like this:

	Note: Note, this is an informative note.

<h3 id="conformance-classes">
Conformance classes</h3>

	Conformance to CSS Media Queries Level 4
	is defined for three conformance classes:
	<dl>
		<dt><dfn title="style sheet!!as conformance class">style sheet</dfn>
			<dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
			style sheet</a>.
		<dt><dfn>renderer</dfn>
			<dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
			that interprets the semantics of a style sheet and renders
			documents that use them.
		<dt><dfn id="authoring-tool">authoring tool</dfn>
			<dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
			that writes a style sheet.
	</dl>

	A style sheet is conformant to CSS Media Queries Level 4
	if all of its statements that use syntax defined in this module are valid
	according to the generic CSS grammar and the individual grammars of each
	feature defined in this module.

	A renderer is conformant to CSS Media Queries Level 4
	if, in addition to interpreting the style sheet as defined by the
	appropriate specifications, it supports all the features defined
	by CSS Media Queries Level 4 by parsing them correctly
	and rendering the document accordingly. However, the inability of a
	UA to correctly render a document due to limitations of the device
	does not make the UA non-conformant. (For example, a UA is not
	required to render color on a monochrome monitor.)

	An authoring tool is conformant to CSS Media Queries Level 4
	if it writes style sheets that are syntactically correct according to the
	generic CSS grammar and the individual grammars of each feature in
	this module, and meet all other conformance requirements of style sheets
	as described in this module.

<h3 id="partial">
Partial implementations</h3>

	So that authors can exploit the forward-compatible parsing rules to
	assign fallback values, CSS renderers <strong>must</strong>
	treat as invalid (and <a href="http://www.w3.org/TR/CSS21/conform.html#ignore">ignore
	as appropriate</a>) any at-rules, properties, property values, keywords,
	and other syntactic constructs for which they have no usable level of
	support. In particular, user agents <strong>must not</strong> selectively
	ignore unsupported component values and honor supported values in a single
	multi-value property declaration: if any value is considered invalid
	(as unsupported values must be), CSS requires that the entire declaration
	be ignored.

<h3 id="experimental">
Experimental implementations</h3>

	To avoid clashes with future CSS features, the CSS2.1 specification
	reserves a <a href="http://www.w3.org/TR/CSS21/syndata.html#vendor-keywords">prefixed
	syntax</a> for proprietary and experimental extensions to CSS.

	Prior to a specification reaching the Candidate Recommendation stage
	in the W3C process, all implementations of a CSS feature are considered
	experimental. The CSS Working Group recommends that implementations
	use a vendor-prefixed syntax for such features, including those in
	W3C Working Drafts. This avoids incompatibilities with future changes
	in the draft.


<h3 id="testing">
Non-experimental implementations</h3>

	Once a specification reaches the Candidate Recommendation stage,
	non-experimental implementations are possible, and implementors should
	release an unprefixed implementation of any CR-level feature they
	can demonstrate to be correctly implemented according to spec.

	To establish and maintain the interoperability of CSS across
	implementations, the CSS Working Group requests that non-experimental
	CSS renderers submit an implementation report (and, if necessary, the
	testcases used for that implementation report) to the W3C before
	releasing an unprefixed implementation of any CSS features. Testcases
	submitted to W3C are subject to review and correction by the CSS
	Working Group.

	Further information on submitting testcases and implementation reports
	can be found from on the CSS Working Group's website at
	<a href="http://www.w3.org/Style/CSS/Test/">http://www.w3.org/Style/CSS/Test/</a>.
	Questions should be directed to the
	<a href="http://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a>
	mailing list.

<h2 class="no-num" id="acknowledgments">
Acknowledgments</h2>

This specification is the product of the W3C Working Group on
Cascading Style Sheets.

Comments from
 Arve Bersvendsen,
 Bj&ouml;rn H&ouml;hrmann,
 Chris Lilley,
 Christoph P&auml;per,
 L. David Baron,
 Fran&ccedil;ois Remy,
 Melinda Grant,
 Nicholas C. Zakas
 Philipp Hoschka,
 Rick Byers,
 Rijk van Geijtenbeek,
 Roger Gimson,
 Sigurd Lerstad,
 Simon Kissane,
 Simon Pieters,
 Steven Pemberton and
 Susan Lesch,
improved this specification.

<h2 class="no-num" id="references">
References</h2>

<h3 class="no-num" id="normative-references">
Normative references</h3>
<!--normative-->

<h3 class="no-num" id="other-references">
Other references</h3>
<!--informative-->

<h2 class="no-num" id="index">
Index</h2>
<!--index-->

</body>
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->

