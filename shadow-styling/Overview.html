<!DOCTYPE html><html lang=en><head>
  <meta content="text/html; charset=utf-8" http-equiv=Content-Type>
  <title>Shadow DOM Styling</title>
  <style>
@media print {
  html { margin: 0 !important; }
  body { font-family: serif; }
  th, td { font-family: inherit; }
  a { color: inherit !important; }
  .example:before { font-family: serif !important; }
  a:link, a:visited { text-decoration: none !important; }
  a:link:after, a:visited:after { /* create a cross-ref "see..." */; }
}
@page {
  margin: 1.5cm 1.1cm;
}
h1, h2, h3, h4, h5, h6 { page-break-after: avoid; }
figure, div.figure, div.sidefigure, pre, table.propdef, table.propdef-extra,
.example { page-break-inside: avoid; }
dt { page-break-after: avoid; }

body {
  background: white;
  /* background-image: floating-margin-image-goes-here; */
  background-position: top left;
  background-attachment: fixed;
  background-repeat: no-repeat;
  color: black;
  counter-reset: exampleno figure issue;
  font-family: sans-serif;
  line-height: 1.5;
  margin: 0 auto;
  max-width: 50em;
  padding: 2em 1em 2em 70px;
}

/* General structural markup */

h1, h2, h3, h4, h5, h6 { text-align: left; }
h1, h2, h3 { color: #005A9C; }
h1 { font: 170% sans-serif; }
h2 { font: 140% sans-serif; }
h3 { font: 120% sans-serif; }
h4 { font: bold 100% sans-serif; }
h5 { font: italic 100% sans-serif; }
h6 { font: small-caps 100% sans-serif; }
h2, h3, h4, h5, h6 { margin-top: 3em; }
h1 + h2 { margin-top: 0em; }
h2 + h3, h3 + h4, h4 + h5, h5 + h6 { margin-top: 1.2em; }

.head { margin-bottom: 1em; }
.head h1 { margin-top: 2em; clear: both; }
.head table { margin-left: 2em; margin-top: 2em; }
.head dd { margin-bottom: 0; }

p.copyright { font-size: small; }
p.copyright small { font-size: small; }

pre { margin: 1em 0 1em 2em; }
pre, code, .idl-code {
  font-size: .9em;
  font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
}
dt dfn code { font-size: inherit; }

dfn { font-weight: bolder; }

s, del {text-decoration: line-through; color: red; }
u, ins {text-decoration: underline; background: #bfa; }

sup {
  vertical-align: super;
  font-size: 80%
}

details { display: block; }

dt { font-weight: bold; }
dd { margin: 0 0 1em 2em; }
ul, ol { margin-left: 0; padding-left: 2em; }
li { margin: 0.25em 2em 0.5em 0; padding-left: 0; }

td.pre {
  white-space: pre-wrap;
}

.css, .property { color: #005a9c; }
.property { white-space: nowrap; }


/* Boilerplate sections */

ul.indexlist { margin-left: 0; columns: 13em; }
ul.indexlist li { margin-left: 0; list-style: none }
ul.indexlist li li { margin-left: 1em; }
ul.indexlist a { font-weight: bold; }
ul.indexlist ul, ul.indexlist dl { font-size: smaller; }
ul.indexlist dl { margin-top: 0; }
ul.indexlist dt { margin: .2em 0 .2em 20px; }
ul.indexlist dd { margin: .2em 0 .2em 40px; }

.toc {
  font-weight: bold;
  line-height: 1.3;
  list-style: none;
  margin: 1em 0 0 5em;
  padding: 0;
}
.toc ul { margin: 0; padding: 0; font-weight: normal; }
.toc ul ul { margin: 0 0 0 2em; font-style: italic; }
.toc ul ul ul { margin: 0}
.toc > li { margin: 1.5em 0; padding: 0; }
.toc li { clear: both; }
.toc ul.toc li { margin: 0.3em 0 0 0; }
.toc a { border-bottom-style: none; }
.toc a:hover, ul.toc a:focus { border-bottom-style: solid; }
/* Section numbers in a column of their own */
.toc span.secno {float: left; width: 4em; margin-left: -5em}
.toc ul ul span.secno { margin-left: -7em; }

table.proptable {
  font-size: small;
  border-collapse: collapse;
  border-spacing: 0;
  text-align: left;
  margin: 1em 0;
}
table.proptable td, table.proptable th {
  padding: 0.4em;
  text-align: center;
}
table.proptable tr:hover td { background: #DEF; }


/* Links */

a[href] { color: inherit; border-bottom: 1px solid silver; text-decoration: none; }
a[href]:hover { background: #ffa; }
a[href]:active { color: #C00; background: transparent; }
img, a.logo { border-style: none; }
.heading, .issue, .note, .example, li, dt { position: relative; }
/* CSS-ish link types */
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {content: "“";}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {content: "”";}
[data-link-type].production::before,
[data-link-type].production::after { content: ""; }
/* Element-type link styling */
[data-link-type=element] { font-family: monospace; }
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after { content: ">" }
/* Self-links */
a.self-link {
  position: absolute;
  top: 0;
  left: -2.5em;
  width: 2em;
  height: 2em;
  text-align: center;
  border: none;
  transition: opacity .2s;
  opacity: .5;
}
a.self-link:hover {
  opacity: 1;
}
.heading > a.self-link {
  font-size: 83%;
}
li > a.self-link {
  left: -3.5em;
}
dfn > a.self-link {
  top: auto;
  left: auto;
  opacity: 0;
  width: 1.5em;
  height: 1.5em;
  background: gray;
  color: white;
  font-style: normal;
  transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
  opacity: 1;
}
dfn > a.self-link:hover {
  color: black;
}
a.self-link::before { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before { content: "#"; }


/* Figures */

figure {
  display: block;
  text-align: center;
  margin: 2.5em 0;
}
figure.sidefigure {
  float: right;
  width: 50%;
  margin: 0 0 0.5em 0.5em
}
figure pre {
  text-align: left;
  display: table;
  margin: 1em auto;
}
figure table {
  margin: auto;
}
figure img, figure object {
  display: block;
  margin: auto;
  max-width: 100%
}
figcaption {
  counter-increment: figure;
  font-size: 90%;
  font-style: italic;
  text-align: center;
}
figcaption::before {
  content: "Figure " counter(figure) ". ";
  font-weight: bold;
}
dd figure { margin-left: -2em; }


/* Definition tables */

table.definition {
  border-spacing: 0;
  padding: 0 1em 0.5em;
  width: 100%;
  table-layout: fixed;
  margin: 1.2em 0;
}
table.definition td, table.definition th {
  padding: 0.5em;
  vertical-align: baseline;
  border-bottom: 1px solid #bbd7e9;
}
table.definition th:first-child {
  font-style: italic;
  font-weight: normal;
  text-align: left;
  width: 8.3em;
  padding-left: 1em;
}
table.definition > tbody > tr:last-child > th,
table.definition > tbody > tr:last-child > td {
  border-bottom: none;
}
table.definition tr:first-child > th,
table.definition tr:first-child > td {
  padding-top: 1em;
}
/* Footnotes at the bottom of a definition table */
table.definition td.footnote {
  font-style: normal;
  padding-top: .6em;
  width: auto;
}
table.definition td.footnote::before {
  content: " ";
  display: block;
  height: 0.6em;
  width: 4em;
  border-top: thin solid;
}


/* IDL fragments */

pre.idl {
  padding: .5em 1em;
  margin: 1.2em 0;
}
pre.idl :link, pre.idl :visited {
  color:inherit;
  background:transparent;
}


/* Data tables */
/* Comes in plain, long, complex, or define varieties */

.data {
  margin: 1em auto;
  border-collapse: collapse;
  width: 100%;
  border: hidden;
}
.data {
  text-align: center;
  width: auto;
}
.data caption {
  width: 100%;
}
.data td, .data th {
  padding: 0.5em;
  border-width: 1px;
  border-color: silver;
  border-top-style: solid;
}
.data thead td:empty {
  padding: 0;
  border: 0;
}
.data thead th[scope="row"] {
  text-align: right;
  color: inherit;
}
.data thead,
.data tbody {
  color: inherit;
  border-bottom: 2px solid;
}
.data colgroup {
  border-left: 2px solid;
}
.data tbody th:first-child,
.data tbody td[scope="row"]:first-child {
  text-align: right;
  color: inherit;
  border-right: 2px solid;
  border-top: 1px solid silver;
  padding-right: 1em;
}
.data.define td:last-child {
  text-align: left;
}
.data tbody th[rowspan],
.data tbody td[rowspan] {
  border-left: 1px solid silver;
}
.data tbody th[rowspan]:first-child,
.data tbody td[rowspan]:first-child {
  border-left: 0;
  border-right: 1px solid silver;
}
.data.complex th,
.data.complex td {
  border: 1px solid silver;
}
.data td.long {
 vertical-align: baseline;
 text-align: left;
}
.data img {
  vertical-align: middle;
}


/* Switch/case <dl>s */

dl.switch {
 padding-left: 2em;
}
dl.switch > dt {
 text-indent: -1.5em;
}
dl.switch > dt:before {
 content: '↪';
 padding: 0 0.5em 0 0;
 display: inline-block;
 width: 1em;
 text-align: right;
 line-height: 0.5em;
}


/* Style for At Risk features (intended as editorial aid, not intended for publishing) */
.atrisk::before {
 position: absolute;
 margin-left: -5em;
 margin-top: -2px;
 padding: 4px;
 border: 1px solid;
 content: 'At risk';
 font-size: small;
 background-color: white;
 color: gray;
 border-radius: 1em;
 text-align: center;
}


/* Obsoletion notice */
details.annoying-warning[open] {
  background: #fdd;
  color: red;
  font-weight: bold;
  text-align: center;
  padding: .5em;
  border: thick solid red;
  border-radius: 1em;
  position: fixed;
  left: 1em;
  right: 1em;
  bottom: 1em;
  z-index: 1000;
}
details.annoying-warning:not([open]) > summary {
  background: #fdd;
  color: red;
  font-weight: bold;
  text-align: center;
  padding: .5em;
}


/* Examples */

.example {
  counter-increment: exampleno;
}
.example::before {
  content: "Example";
  content: "Example " counter(exampleno);
  min-width: 7.5em;
  text-transform: uppercase;
  display: block;
}
.illegal-example::before {
  content: "Invalid Example";
  content: "Invalid Example" counter(exampleno);
}
.example, .illegal-example, .html, .illegal-html, .xml, .illegal-xml {
  padding: 0.5em;
  margin: 1em 0;
  position: relative;
  clear: both;
}
pre.example, pre.illegal-example, pre.html,
pre.illegal-html, pre.xml, pre.illegal-xml {
  padding-top: 1.5em;
}
.illegal-example { color: red; }
.illegal-example p { color: black; }
.html { color: #600; }
.illegal-html { color: red; }
.illegal-html p { color: black; }
.xml { color: #600; }
.illegal-xml { color: red; }
.illegal-xml p { color: black; }
code.css { font-family: inherit; font-size: 100% }
code.html { color: #600 } /* inline HTML */
code.xml { color: #600 }  /* inline XML */


/* Issues */

.issue {
  border-color: #E05252;
  background: #FBE9E9;
  counter-increment: issue;
}
.issue:before {
  content: "Issue " counter(issue);
  padding-right: 1em;
  text-transform: uppercase;
  color: #E05252;
}


/* Whys */

details.why > summary {
  font-style: italic;
}
details.why[open] > summary {
  border-bottom: 1px silver solid;
}


/* All the blocks get similarly styled */

table.definition, pre.idl, .example, .note, details.why, .issue {
  border: none;
  border-left: .5em solid black;
  border-left: .5rem solid black;
}
.issue, .note, .example, .why {
  padding: .5em;
  margin-top: 1em;
  margin-bottom: 1em;
}
table.definition, pre.idl {
  background: hsl(210, 70%, 95%);
  border-color: hsl(210, 80%, 75%);
}
.example {
  background: hsl(50, 70%, 95%);
  border-color: hsl(50, 70%, 60%);
}
.example::before {
  color: hsl(50, 70%, 60%);
}
.note, details.why {
  background: hsl(120, 70%, 95%);
  border-color: hsl(120, 70%, 60%);
}
.note::before {
  color: hsl(120, 70%, 60%);
}
.issue {
  background: hsl(0, 70%, 95%);
  border-color: hsl(0, 70%, 60%);
}
.issue::before {
  color: hsl(0, 70%, 60%);
}
span.issue, span.note {
  padding: .1em .5em .15em;
  border-right-width: .5em;
  border-right-style: solid;
}
  </style>
</head>
<body class=h-entry>
<div class=head>
  <p data-fill-with=logo></p>
  <h1 class="p-name no-ref" id=title>Shadow DOM Styling</h1>
  <h2 class="no-num no-toc no-ref heading settled heading" id=subtitle><span class=content>Editor’s Draft,
    <span class=dt-updated><span class=value-title title=20140208>8 February 2014</span></span></span></h2>
  <div data-fill-with=spec-metadata><dl><dt>This version:<dd><a class=u-url href=http://dev.w3.org/csswg/shadow-styling>http://dev.w3.org/csswg/shadow-styling</a><dt>Editor’s Draft:<dd><a href=http://dev.w3.org/csswg/shadow-styling>http://dev.w3.org/csswg/shadow-styling</a><dt>Test Suite:<dd>None Yet<dt>Editors:
<dd class="p-author h-card vcard"><a class="p-name fn u-url url" href=http://xanthir.com/contact/>Tab Atkins Jr.</a> (<span class="p-org org">Google</span>)</dl></div>
  <div data-fill-with=warning></div>
  <p class=copyright data-fill-with=copyright><a href=http://creativecommons.org/publicdomain/zero/1.0/ rel=license><img alt=CC0 src=http://i.creativecommons.org/p/zero/1.0/80x15.png></a>
To the extent possible under law, the editors have waived all copyright
and related or neighboring rights to this work.
In addition, as of 8 February 2014,
the editors have made this specification available under the
<a href=http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0 rel=license>Open Web Foundation Agreement Version 1.0</a>,
which is available at http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0.
Parts of this work may be from another specification document.  If so, those parts are instead covered by the license of that specification document.
</p>
  <hr title="Separator for header">
</div>

<h2 class="no-num no-toc no-ref heading settled heading" id=abstract><span class=content>Abstract</span></h2>
<p class=p-summary data-fill-with=abstract>This specification defines the additions to CSS to accommodate Shadow DOM styling.
</p>
<div data-fill-with=at-risk></div>

<h2 class="no-num no-toc no-ref heading settled heading" id=contents><span class=content>Table of contents</span></h2>
<div data-fill-with=table-of-contents><ul class=toc><li><a href=#intro><span class=secno>1</span>
Introduction</a><li><a href=#shadow-dom><span class=secno>2</span>
Shadow DOM CSS Concepts</a><ul class=toc><li><a href=#shadow-trees><span class=secno>2.1</span>
Shadow Trees</a><li><a href=#distribution-lists><span class=secno>2.2</span>
Distribution Lists</a><li><a href=#inheritance0><span class=secno>2.3</span>
Inheritance and Shadow DOM</a></ul><li><a href=#selectors-data-model><span class=secno>3</span>
Extensions to the Selectors Data Model</a><ul class=toc><li><a href=#host-element><span class=secno>3.1</span>
Host Elements in a Shadow Tree</a></ul><li><a href=#inheritance><span class=secno>4</span>
Shadow DOM Combinators</a><ul class=toc><li><a href=#shadow-combinator><span class=secno>4.1</span>
Selecting Into A Shadow Tree: the <span class=css data-link-type=maybe title=/shadow>/shadow</span> combinator</a><li><a href=#shadow-all-combinator><span class=secno>4.2</span>
Selecting All Elements In A Shadow Tree: the <span class=css data-link-type=maybe title=/shadow-all>/shadow-all</span> combinator</a><li><a href=#shadow-deep-combinator><span class=secno>4.3</span>
Selecting Through All Shadows: the <span class=css data-link-type=maybe title=/shadow-deep>/shadow-deep</span> combinator</a><li><a href=#content-combinator><span class=secno>4.4</span>
Selecting Distributed Elements: the <span class=css data-link-type=maybe title=/content>/content</span> combinator</a></ul><li><a href=#selectors><span class=secno>5</span>
Shadow DOM Selectors</a><ul class=toc><li><a href=#top-selector><span class=secno>5.1</span>
Selecting Root-like Elements: the <span class=css data-link-type=maybe title=:top>:top</span> pseudo-class</a><li><a href=#host-selector><span class=secno>5.2</span>
Selecting the Host Element: the <span class=css data-link-type=maybe title=:host>:host</span> and <span class=css data-link-type=maybe title=:host()>:host()</span> pseudo-classes</a><li><a href=#ancestor-selector><span class=secno>5.3</span>
Selecting Based on an Ancestor Outside the Shadow Tree: the <span class=css data-link-type=maybe title=:ancestor()>:ancestor()</span> pseudo-class</a></ul><li><a href=#cascading><span class=secno>6</span>
Changes to the Cascading Model</a><li><a href=#conformance><span class=secno></span>
Conformance</a><li><a href=#references><span class=secno></span>
References</a><ul class=toc><li><a href=#normative><span class=secno></span>
Normative References</a><li><a href=#informative><span class=secno></span>
Informative References</a></ul><li><a href=#index><span class=secno></span>
Index</a><li><a href=#property-index><span class=secno></span>
Property index</a><li><a href=#issues-index><span class=secno></span>Issues Index</a></ul></div>



<h2 class="heading settled heading" data-level=1 id=intro><span class=secno>1 </span><span class=content>
Introduction</span><a class=self-link href=#intro></a></h2>

<p>	...

<h2 class="heading settled heading" data-level=2 id=shadow-dom><span class=secno>2 </span><span class=content>
Shadow DOM CSS Concepts</span><a class=self-link href=#shadow-dom></a></h2>

<p>	The Shadow DOM spec augments the DOM with several new concepts,
	several of which are relevant to CSS.

<h3 class="heading settled heading" data-level=2.1 id=shadow-trees><span class=secno>2.1 </span><span class=content>
Shadow Trees</span><a class=self-link href=#shadow-trees></a></h3>

<p>	A <dfn data-dfn-type=dfn data-export="" id=shadow-tree>shadow tree<a class=self-link href=#shadow-tree></a></dfn> is a document fragment
	that can be attached to any element in the DOM.
	An element can have any number of <a data-link-type=dfn href=#shadow-tree title="shadow trees">shadow trees</a>,
	which are ordered by creation time.
	The most recently-createed <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a> on an element
	is the <dfn data-dfn-type=dfn data-export="" id=active-shadow-tree>active shadow tree<a class=self-link href=#active-shadow-tree></a></dfn> for that element.

<p>	An element with a <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a> is a <dfn data-dfn-type=dfn data-export="" id=shadow-host>shadow host<a class=self-link href=#shadow-host></a></dfn>.
	It is the <dfn data-dfn-type=dfn data-export="" id=host-element0>host element<a class=self-link href=#host-element0></a></dfn> for its shadow trees.

<p>	The descendants of a <a data-link-type=dfn href=#shadow-host title="shadow host">shadow host</a>
	must not generate boxes as normal.
	Instead, the contents of the <a data-link-type=dfn href=#active-shadow-tree title="active shadow tree">active shadow tree</a> generates boxes
	as if it were the contents of the element instead.

<h3 class="heading settled heading" data-level=2.2 id=distribution-lists><span class=secno>2.2 </span><span class=content>
Distribution Lists</span><a class=self-link href=#distribution-lists></a></h3>

<p>	While the children of a <a data-link-type=dfn href=#shadow-host title="shadow host">shadow host</a> do not generate boxes normally,
	they can be explicitly pulled into a <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a> and forced to render normally.
	This is done by assigning the elements to a <dfn data-dfn-type=dfn data-export="" id=distribution-list>distribution list<a class=self-link href=#distribution-list></a></dfn>.
	An element with a <a data-link-type=dfn href=#distribution-list title="distribution list">distribution list</a> is an <dfn data-dfn-type=dfn data-export="" id=insertion-point>insertion point<a class=self-link href=#insertion-point></a></dfn>.

<p>	This specification does not define how to assign elements to a <a data-link-type=dfn href=#distribution-list title="distribution list">distribution list</a>,
	instead leaving that to the Shadow DOM spec.
	At the time this spec is written, however,
	only <a data-link-type=element title=content>content</a> elements in a <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a> can have <a data-link-type=dfn href=#distribution-list title="distribution lists">distribution lists</a>.

<p>	An <a data-link-type=dfn href=#insertion-point title="insertion point">insertion point</a> must not generate any boxes.
	Instead, the elements in its <a data-link-type=dfn href=#distribution-list title="distribution list">distribution list</a> generate boxes as normal,
	as if they all replaced the <a data-link-type=dfn href=#insertion-point title="insertion point">insertion point</a> in-place.
	<span class=note>(Akin to the behavior of <a class=css data-link-type=propdesc href=http://dev.w3.org/csswg/css-display-3/#propdef-display-box title=display-box>display-box: contents</a>.)</span>

<h3 class="heading settled heading" data-level=2.3 id=inheritance0><span class=secno>2.3 </span><span class=content>
Inheritance and Shadow DOM</span><a class=self-link href=#inheritance0></a></h3>

<p>	The <a data-link-type=dfn href=#top-level-elements title="top-level elements">top-level elements</a> of a <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a>
	inherit from their <a data-link-type=dfn href=#host-element0 title="host element">host element</a>.

<p>	The elements in a <a data-link-type=dfn href=#distribution-list title="distribution list">distribution list</a> inherit normally,
	from their parent.
	Shadow DOM does not change the behavior of inheritance here.

<h2 class="heading settled heading" data-level=3 id=selectors-data-model><span class=secno>3 </span><span class=content>
Extensions to the Selectors Data Model</span><a class=self-link href=#selectors-data-model></a></h2>

<p>	Elements in the <a data-link-type=dfn href=http://dev.w3.org/csswg/selectors-4/#element-tree title="element tree">element tree</a>
	additionally have zero or more <a data-link-type=dfn href=#shadow-tree title="shadow trees">shadow trees</a>
	and zero or one <a data-link-type=dfn href=#distribution-list title="distribution lists">distribution lists</a>.

<p class=note>	Note: The "descendants" of an element
	are based on the children of the element,
	which does not include the <a data-link-type=dfn href=#shadow-tree title="shadow trees">shadow trees</a> or <a data-link-type=dfn href=#distribution-list title="distribution lists">distribution lists</a> of the element.

<p>	When a selector is matched against a <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a>,
	the <a data-link-type=dfn title="initial selector match list">initial selector match list</a>
	is the <a data-link-type=dfn href=#shadow-host title="shadow host">shadow host</a>,
	followed by all the <a data-link-type=dfn href=#top-level-elements title="top-level elements">top-level elements</a> of the <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a>
	and their descendants,
	ordered by a pre-order traversal.

<h3 class="heading settled heading" data-level=3.1 id=host-element><span class=secno>3.1 </span><span class=content>
Host Elements in a Shadow Tree</span><a class=self-link href=#host-element></a></h3>

<p>	A <a data-link-type=dfn href=#shadow-host title="shadow host">shadow host</a> is outside of the <a data-link-type=dfn href=#shadow-tree title="shadow trees">shadow trees</a> it hosts,
	but it is sometimes useful to be able to style it from inside the <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a> context.

<p>	For the purpose of Selectors,
	a <a data-link-type=dfn href=#host-element0 title="host element">host element</a> also appears in each of its <a data-link-type=dfn href=#shadow-tree title="shadow trees">shadow trees</a>,
	with the contents of the <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a> treated as its children.
	If an element has multiple <a data-link-type=dfn href=#shadow-tree title="shadow trees">shadow trees</a>,
	it appears in each <a data-link-type=dfn href=#shadow-tree title="shadow tree’s">shadow tree’s</a> context independently;
	each <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a> sees <em>itself</em> as the contents of the <a data-link-type=dfn href=#host-element0 title="host element">host element</a>,
	not the other <a data-link-type=dfn href=#shadow-tree title="shadow trees">shadow trees</a>.

<p>	The <a data-link-type=dfn href=#host-element0 title="host element">host element</a> is not selectable by <strong>any means</strong>
	except for the <a class=css data-link-type=maybe href=#selectordef-host0 title=:host>:host</a> pseudo-class.
	That is, in this context the <a data-link-type=dfn href=#shadow-host title="shadow host">shadow host</a>
	has no tagname, ID, classes, or attributes,
	and the only additional information is has is that the <a class=css data-link-type=maybe href=#selectordef-host0 title=:host>:host</a> pseudo-class matches it.

	</p><details class=why>
		<summary>Why is the shadow host so weird?</summary>

<p>		The <a data-link-type=dfn href=#shadow-host title="shadow host">shadow host</a> lives outside the <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a>,
		and its markup is in control of the page author,
		not the component author.

<p>		It would not be very good if a component used a particular class name
		internally in a <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a>,
		and the page author using the component accidentally <em>also</em>
		used the the same class name and put it on the <a data-link-type=dfn href=#host-element0 title="host element">host element</a>.
		Such a situation would result in accidental styling
		that is impossible for the component author to predict,
		and confusing for the page author to debug.

<p>		However, there are still some reasonable use-cases for letting a stylesheet in a <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a>
		style its <a data-link-type=dfn href=#host-element0 title="host element">host element</a>.
		So, to allow this situation but prevent accidental styling,
		the <a data-link-type=dfn href=#host-element0 title="host element">host element</a> appears but is completely featureless
		and unselectable except through <a class=css data-link-type=maybe href=#selectordef-host0 title=:host>:host</a>.
	</details>



<h2 class="heading settled heading" data-level=4 id=inheritance><span class=secno>4 </span><span class=content>
Shadow DOM Combinators</span><a class=self-link href=#inheritance></a></h2>

<p>	Shadow DOM defines several new combinators
	to help style the contents of <a data-link-type=dfn href=#shadow-tree title="shadow trees">shadow trees</a> and <a data-link-type=dfn href=#distribution-list title="distribution lists">distribution lists</a>.

	<p class=issue id=issue-7dae9ca8><a class=self-link href=#issue-7dae9ca8></a>
		I’m assuming here that "/foo" is the syntax we’ll agree on for named combinators.

<h3 class="heading settled heading" data-level=4.1 id=shadow-combinator><span class=secno>4.1 </span><span class=content>
Selecting Into A Shadow Tree: the <a class=css data-link-type=maybe href=#selectordef-shadow title=/shadow>/shadow</a> combinator</span><a class=self-link href=#shadow-combinator></a></h3>

<p>	When a <dfn class=css-code data-dfn-type=selector data-export="" id=selectordef-shadow>/shadow<a class=self-link href=#selectordef-shadow></a></dfn> combinator is encountered in a selector,
	first filter the <a data-link-type=dfn href=http://dev.w3.org/csswg/selectors-4/#selector-match-list title="selector match list">selector match list</a> to only include elements with <a data-link-type=dfn href=#shadow-tree title="shadow trees">shadow trees</a>.
	Then replace every element in the <a data-link-type=dfn href=http://dev.w3.org/csswg/selectors-4/#selector-match-list title="selector match list">selector match list</a>
	with the <a data-link-type=dfn href=#host-element0 title="host element">host element</a> and <a data-link-type=dfn href=#top-level-elements title="top-level elements">top-level elements</a> of each <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a> of the element.

<h3 class="heading settled heading" data-level=4.2 id=shadow-all-combinator><span class=secno>4.2 </span><span class=content>
Selecting All Elements In A Shadow Tree: the <a class=css data-link-type=maybe href=#selectordef-shadow-all title=/shadow-all>/shadow-all</a> combinator</span><a class=self-link href=#shadow-all-combinator></a></h3>

<p>	When a <dfn class=css-code data-dfn-type=selector data-export="" id=selectordef-shadow-all>/shadow-all<a class=self-link href=#selectordef-shadow-all></a></dfn> combinator is encountered in a selector,
	first filter the <a data-link-type=dfn href=http://dev.w3.org/csswg/selectors-4/#selector-match-list title="selector match list">selector match list</a> to only include elements with <a data-link-type=dfn href=#shadow-tree title="shadow trees">shadow trees</a>.
	Then replace every element in the <a data-link-type=dfn href=http://dev.w3.org/csswg/selectors-4/#selector-match-list title="selector match list">selector match list</a>
	with all the elements in all the <a data-link-type=dfn href=#shadow-tree title="shadow trees">shadow trees</a> of the element.

<h3 class="heading settled heading" data-level=4.3 id=shadow-deep-combinator><span class=secno>4.3 </span><span class=content>
Selecting Through All Shadows: the <a class=css data-link-type=maybe href=#selectordef-shadow-deep title=/shadow-deep>/shadow-deep</a> combinator</span><a class=self-link href=#shadow-deep-combinator></a></h3>

<p>	When a <dfn class=css-code data-dfn-type=selector data-export="" id=selectordef-shadow-deep>/shadow-deep<a class=self-link href=#selectordef-shadow-deep></a></dfn> combinator is encountered in a selector,
	replace every element in the <a data-link-type=dfn href=http://dev.w3.org/csswg/selectors-4/#selector-match-list title="selector match list">selector match list</a>
	with every element reachable from the original element
	by traversing any number of child lists or shadow trees.

<h3 class="heading settled heading" data-level=4.4 id=content-combinator><span class=secno>4.4 </span><span class=content>
Selecting Distributed Elements: the <a class=css data-link-type=maybe href=#selectordef-content title=/content>/content</a> combinator</span><a class=self-link href=#content-combinator></a></h3>

<p>	When a <dfn class=css-code data-dfn-type=selector data-export="" id=selectordef-content>/content<a class=self-link href=#selectordef-content></a></dfn> combinator is encountered in a selector,
	first filter the <a data-link-type=dfn href=http://dev.w3.org/csswg/selectors-4/#selector-match-list title="selector match list">selector match list</a> to only include elements with <a data-link-type=dfn href=#distribution-list title="distribution lists">distribution lists</a>.
	Then replace every element in the <a data-link-type=dfn href=http://dev.w3.org/csswg/selectors-4/#selector-match-list title="selector match list">selector match list</a>
	with the elements in the <a data-link-type=dfn href=#distribution-list title="distribution list">distribution list</a> of each element.

<h2 class="heading settled heading" data-level=5 id=selectors><span class=secno>5 </span><span class=content>
Shadow DOM Selectors</span><a class=self-link href=#selectors></a></h2>

<p>	Shadow DOM defines a few new selectors
	to help select elements in useful way related to Shadow DOM.

<h3 class="heading settled heading" data-level=5.1 id=top-selector><span class=secno>5.1 </span><span class=content>
Selecting Root-like Elements: the <a class=css data-link-type=maybe href=#selectordef-top title=:top>:top</a> pseudo-class</span><a class=self-link href=#top-selector></a></h3>

<p>	The <dfn class=css-code data-dfn-type=selector data-export="" id=selectordef-top>:top<a class=self-link href=#selectordef-top></a></dfn> pseudo-class
	matches all elements which are not the children of other elements.
	These are called <dfn data-dfn-type=dfn data-export="" id=top-level-elements>top-level elements<a class=self-link href=#top-level-elements></a></dfn>.

	<div class=example>
		For example, the root of a document has no element parent.
		(In the DOM, it’s the child of a <code>Document</code> object,
		which is not an element.)

<p>		Similarly, elements that are children of a <code>ShadowRoot</code> object do not have element parents,
		nor do elements that are appended directly to a <code>DocumentFragment</code>.
	</div>

<p class=note>	Note: Note that this definition is based on the data model of the host document,
	not necessarily the data model of Selectors.
	For example, <a data-link-type=dfn href=#top-level-elements title="top-level elements">top-level elements</a> in a <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a>
	are considered to have the <a data-link-type=dfn href=#host-element0 title="host element">host element</a> as their parent
	<em>for the purposes of Selectors</em>,
	but they still match <a class=css data-link-type=maybe href=#selectordef-top title=:top>:top</a> as they are not actually the child of an element.

<h3 class="heading settled heading" data-level=5.2 id=host-selector><span class=secno>5.2 </span><span class=content>
Selecting the Host Element: the <a class=css data-link-type=maybe href=#selectordef-host0 title=:host>:host</a> and <a class=css data-link-type=maybe href=#selectordef-host title=:host()>:host()</a> pseudo-classes</span><a class=self-link href=#host-selector></a></h3>

<p>	The <dfn class=css-code data-dfn-type=selector data-export="" id=selectordef-host0>:host<a class=self-link href=#selectordef-host0></a></dfn> pseudo-class,
	when evaluated in the context of a <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a>,
	matches the <a data-link-type=dfn href=#shadow-tree title="shadow tree’s">shadow tree’s</a> <a data-link-type=dfn href=#host-element0 title="host element">host element</a>.
	In any other context,
	it matches nothing.

<p>	The <dfn class=css-code data-dfn-type=selector data-export="" id=selectordef-host>:host()<a class=self-link href=#selectordef-host></a></dfn> function pseudo-class
	has the syntax:

<pre>:host( <a class="production css-code" data-link-type=type href=http://dev.w3.org/csswg/selectors-4/#ltcompound-selector title="<compound-selector>">&lt;compound-selector&gt;</a> )</pre>
<p>	When evaluated in the context of a <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a>,
	it matches the <a data-link-type=dfn href=#shadow-tree title="shadow tree’s">shadow tree’s</a> <a data-link-type=dfn href=#host-element0 title="host element">host element</a>
	if the <a data-link-type=dfn href=#host-element0 title="host element">host element</a>,
	in its normal context,
	matches the selector argument.
	In any other context,
	it matches nothing.

	<div class=example>
		For example, say you had a component with a <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a> like the following:

		<pre>  &lt;x-foo class="foo"&gt;
    &lt;"shadow tree"&gt;
      &lt;div class="foo"&gt;...&lt;/div&gt;
    &lt;/&gt;
  &lt;/x-foo&gt;
</pre>
<p>		For a stylesheet within the <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a>:

<p>		<ul>
			<li><a class=css data-link-type=maybe href=#selectordef-host0 title=:host>:host</a> matches the <code>&lt;x-foo&gt;</code> element.
			<li><span class=css data-link-type=maybe title=x-foo>x-foo</span> matches nothing.
			<li><span class=css data-link-type=maybe title=.foo>.foo</span> matches only the <code>&lt;div&gt;</code> element.
			<li><span class=css data-link-type=maybe title=.foo:host>.foo:host</span> matches nothing
			<li><span class=css data-link-type=maybe title=:host(.foo)>:host(.foo)</span> matches the <code>&lt;x-foo&gt;</code> element.
		</ul>
	</div>

<h3 class="heading settled heading" data-level=5.3 id=ancestor-selector><span class=secno>5.3 </span><span class=content>
Selecting Based on an Ancestor Outside the Shadow Tree: the <a class=css data-link-type=maybe href=#selectordef-ancestor title=:ancestor()>:ancestor()</a> pseudo-class</span><a class=self-link href=#ancestor-selector></a></h3>

<p>	Ordinary, selectors within a <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a>
	can’t see elements outside the <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a> at all.
	Sometimes, however, it’s useful to select an ancestor that lies somewhere outside the shadow tree,
	above it in the document.

	<div class=example>
		For example, a group of components can define a handful of color themes
		they they know how to respond to.
		Page authors could opt into a particular theme
		by adding a specific class to the components,
		or higher up in the document.
	</div>

<p>	The <dfn class=css-code data-dfn-type=selector data-export="" id=selectordef-ancestor>:ancestor()<a class=self-link href=#selectordef-ancestor></a></dfn> functional pseudo-class tests whether there is an ancestor,
	outside the <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a>,
	which matches a particular selector.
	Its syntax is:

<pre>:ancestor( <a class="production css-code" data-link-type=type href=http://dev.w3.org/csswg/selectors-4/#ltcompound-selector title="<compound-selector>">&lt;compound-selector&gt;</a> )</pre>
<p>	When evaluated in the context of a <a data-link-type=dfn href=#shadow-tree title="shadow tree">shadow tree</a>,
	the <a class=css data-link-type=maybe href=#selectordef-ancestor title=:ancestor()>:ancestor()</a> pseudo-class matches any element,
	if the <a data-link-type=dfn href=#host-element0 title="host element">host element</a> or one of its ancestors matches the provided <a class="production css-code" data-link-type=type href=http://dev.w3.org/csswg/selectors-4/#ltcompound-selector title="<compound-selector>">&lt;compound-selector&gt;</a>.
	For the purpose of this pseudo-class,
	the "ancestor" of an element is its parent,
	if it has one,
	or else its <a data-link-type=dfn href=#host-element0 title="host element">host element</a>,
	if it has one.

<p class=note>	Note: This means that the selector pierces through shadow boundaries on the way up,
	looking for elements that match its argument,
	until it reaches the document root.

<h2 class="heading settled heading" data-level=6 id=cascading><span class=secno>6 </span><span class=content>
Changes to the Cascading Model</span><a class=self-link href=#cascading></a></h2>

<p>	Shadow DOM enables new ways to target an element and apply styles to it,
	which don’t quite fit into the existing CSS cascade.

	<p class=issue id=issue-9ae761db><a class=self-link href=#issue-9ae761db></a>
		I need to go look up what was decided/written down
		for the cascading precedence
		of rules from outside a shadow tree reaching in, via the /shadow-* combinators,
		and of rules from inside a shadow tree reaching out, via the /content combinator.
		Also, the cascading precedence of styles inside a shadow tree applying to a host element,
		versus the outside document’s styles applying to the host element.

<h2 class="no-ref no-num heading settled heading" id=conformance><span class=content>
Conformance</span><a class=self-link href=#conformance></a></h2>

    <p>
        Conformance requirements are expressed with a combination of descriptive assertions and RFC 2119 terminology.
        The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
        in the normative parts of this document
        are to be interpreted as described in RFC 2119.
        However, for readability,
        these words do not appear in all uppercase letters in this specification.

    <p>
        All of the text of this specification is normative
        except sections explicitly marked as non-normative, examples, and notes. <a data-biblio-type=normative data-link-type=biblio href=#rfc2119 title=rfc2119>[RFC2119]</a>

    <p>
        Examples in this specification are introduced with the words “for example”
        or are set apart from the normative text with <code>class="example"</code>, like this:

    <div class=example>
        This is an example of an informative example.
    </div>

    <p>
        Informative notes begin with the word “Note”
        and are set apart from the normative text with <code>class="note"</code>, like this:

    <p class=note>
        Note, this is an informative note.

<h2 class="no-num no-ref heading settled heading" id=references><span class=content>
References</span><a class=self-link href=#references></a></h2>

<h3 class="no-num no-ref heading settled heading" id=normative><span class=content>
Normative References</span><a class=self-link href=#normative></a></h3>
<div data-fill-with=normative-references><dl><dt id=rfc2119 title=RFC2119><a class=self-link href=#rfc2119></a>[RFC2119]<dd>S. Bradner. <a href=http://www.ietf.org/rfc/rfc2119.txt>Key words for use in RFCs to Indicate Requirement Levels</a>. URL: <a href=http://www.ietf.org/rfc/rfc2119.txt>http://www.ietf.org/rfc/rfc2119.txt</a></dl></div>

<h3 class="no-num no-ref heading settled heading" id=informative><span class=content>
Informative References</span><a class=self-link href=#informative></a></h3>
<div data-fill-with=informative-references><dl></dl></div>

<h2 class="no-num no-ref heading settled heading" id=index><span class=content>
Index</span><a class=self-link href=#index></a></h2>
<div data-fill-with=index><ul class=indexlist>
<li>active shadow tree, <a href=#active-shadow-tree title="section 2.1">2.1</a>
<li>:ancestor(), <a href=#selectordef-ancestor title="section 5.3">5.3</a>
<li>/content, <a href=#selectordef-content title="section 4.4">4.4</a>
<li>distribution list, <a href=#distribution-list title="section 2.2">2.2</a>
<li>:host(), <a href=#selectordef-host title="section 5.2">5.2</a>
<li>:host, <a href=#selectordef-host0 title="section 5.2">5.2</a>
<li>host element, <a href=#host-element0 title="section 2.1">2.1</a>
<li>insertion point, <a href=#insertion-point title="section 2.2">2.2</a>
<li>/shadow, <a href=#selectordef-shadow title="section 4.1">4.1</a>
<li>/shadow-all, <a href=#selectordef-shadow-all title="section 4.2">4.2</a>
<li>/shadow-deep, <a href=#selectordef-shadow-deep title="section 4.3">4.3</a>
<li>shadow host, <a href=#shadow-host title="section 2.1">2.1</a>
<li>shadow tree, <a href=#shadow-tree title="section 2.1">2.1</a>
<li>:top, <a href=#selectordef-top title="section 5.1">5.1</a>
<li>top-level elements, <a href=#top-level-elements title="section 5.1">5.1</a>
</ul></div>

<h2 class="no-num no-ref heading settled heading" id=property-index><span class=content>
Property index</span><a class=self-link href=#property-index></a></h2>
<div data-fill-with=property-index><p>No properties defined.</div>



<h2 class="no-num heading settled" id=issues-index><span class=content>Issues Index</span><a class=self-link href=#issues-index></a></h2><div style="counter-reset: issue"><div class=issue>
		I’m assuming here that "/foo" is the syntax we’ll agree on for named combinators.

<a href=#issue-7dae9ca8> ↵ </a></div><div class=issue>
		I need to go look up what was decided/written down
		for the cascading precedence
		of rules from outside a shadow tree reaching in, via the /shadow-* combinators,
		and of rules from inside a shadow tree reaching out, via the /content combinator.
		Also, the cascading precedence of styles inside a shadow tree applying to a host element,
		versus the outside document’s styles applying to the host element.

<a href=#issue-9ae761db> ↵ </a></div></div>