<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html lang=en>
 <head profile="http://www.w3.org/2006/03/hcard"><meta
  content="text/html; charset=utf-8" http-equiv=Content-Type>

  <title>CSS Fragmentation Controls Module Level 3</title>
  <link href=default.css rel=stylesheet type="text/css">
  <link href="http://www.w3.org/StyleSheets/TR/W3C-ED.css" rel=stylesheet
  type="text/css">

 <body>
  <div class=head> <!--begin-logo-->
   <p><a href="http://www.w3.org/"><img alt=W3C height=48
    src="http://www.w3.org/Icons/w3c_home" width=72></a> <!--end-logo-->

   <h1 id=css-fragmentation-module>CSS Fragmentation Controls Module Level 3</h1>

   <h2 class="no-num no-toc" id=longstatus-date>Editor's Draft 26 October
    2011</h2>

   <dl>
    <dt>This version:

    <dd><a
     href="http://www.w3.org/TR/2011/ED-css3-breaks-20111026/">http://www.w3.org/csswg/css3-breaks/</a>

    <dt>Latest version:

    <dd><a
     href="http://www.w3.org/TR/css3-breaks/">http://www.w3.org/csswg/css3-breaks/</a>

    <dt>Previous version:

    <dd>None

    <dt>Editors:

    <dd class=vcard><span class=fn>Rossen Atanassov</span>, <span
     class=org><a class="fn org url"
     href="http://www.microsoft.com/">Microsoft Corporation</a></span>, <span
     class=email>ratan@microsoft.com</span>

    <dd class=vcard><span class=fn><a class=fn
     href="http://fantasai.inkedblade.net/contact">Elika J.
     Etemad</a></span>, <span class=org><a class="fn org url"
     href="http://www.mozilla.com/">Mozilla Corporation</a></span>
   </dl>
   <!--begin-copyright-->
   <p class=copyright><a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright"
    rel=license>Copyright</a> &copy; 2011 <a
    href="http://www.w3.org/"><acronym
    title="World Wide Web Consortium">W3C</acronym></a><sup>&reg;</sup> (<a
    href="http://www.csail.mit.edu/"><acronym
    title="Massachusetts Institute of Technology">MIT</acronym></a>, <a
    href="http://www.ercim.eu/"><acronym
    title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>,
    <a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a>
    and <a
    href="http://www.w3.org/Consortium/Legal/copyright-documents">document
    use</a> rules apply.</p>
   <!--end-copyright-->
   <hr title="Separator for header">
  </div>

  <h2 class="no-num no-toc" id=abstract>Abstract</h2>

  <p> This module describes the fragmentation model that partitions a flow
   into pages. It builds on the Page model module and introduces and defines
   the fragmentation model. It adds functionality for pagination, breaking
   variable fragment size and orientation, widows and orphans.

  <h2 class="no-num no-toc" id=status>Status of this document</h2>
  <!--begin-status-->

  <p>This is a public copy of the editors' draft. It is provided for
   discussion only and may change at any moment. Its publication here does
   not imply endorsement of its contents by W3C. Don't cite this document
   other than as work in progress.

  <p>The (<a
   href="http://lists.w3.org/Archives/Public/www-style/">archived</a>) public
   mailing list <a
   href="mailto:www-style@w3.org?Subject=%5Bcss3-breaks%5D%20PUT%20SUBJECT%20HERE">
   www-style@w3.org</a> (see <a
   href="http://www.w3.org/Mail/Request">instructions</a>) is preferred for
   discussion of this specification. When sending e-mail, please put the text
   &#8220;css3-breaks&#8221; in the subject, preferably like this:
   &#8220;[<!---->css3-breaks<!---->] <em>&hellip;summary of
   comment&hellip;</em>&#8221;

  <p>This document was produced by the <a href="/Style/CSS/members">CSS
   Working Group</a> (part of the <a href="/Style/">Style Activity</a>).

  <p>This document was produced by a group operating under the <a
   href="/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent
   Policy</a>. W3C maintains a <a href="/2004/01/pp-impl/32061/status"
   rel=disclosure>public list of any patent disclosures</a> made in
   connection with the deliverables of the group; that page also includes
   instructions for disclosing a patent. An individual who has actual
   knowledge of a patent which the individual believes contains <a
   href="/Consortium/Patent-Policy-20040205/#def-essential">Essential
   Claim(s)</a> must disclose the information in accordance with <a
   href="/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the
   W3C Patent Policy</a>.</p>
  <!--end-status-->
  <!--<p>The following features are at risk: &hellip;</p>-->

  <h2 class="no-num no-toc" id=contents>Table of contents</h2>
  <!--begin-toc-->

  <ul class=toc>
   <li><a href="#intro"><span class=secno>1. </span>Introduction</a>
    <ul class=toc>
     <li><a href="#placement"><span class=secno>1.1. </span>Module
      Interactions</a>

     <li><a href="#values"><span class=secno>1.2. </span>Values</a>
    </ul>

   <li><a href="#page-breaks"><span class=secno>2. </span>Page Breaks</a>
    <ul class=toc>
     <li><a href="#pg-br-before-after"><span class=secno>2.1. </span> Break
      before/after elements: <span class=property>&lsquo;<code
      class=property>page-break-before</code>&rsquo;</span>, <span
      class=property>&lsquo;<code
      class=property>page-break-after</code>&rsquo;</span>, <span
      class=property>&lsquo;<code
      class=property>page-break-inside</code>&rsquo;</span> </a>

     <li><a href="#using-named-pages"><span class=secno>2.2. </span>Using
      named pages: &lsquo;<code class=property>page</code>&rsquo;</a>

     <li><a href="#breaks-inside"><span class=secno>2.3. </span>Breaks inside
      elements: &lsquo;<code class=property>orphans</code>&rsquo;,
      &lsquo;<code class=property>widows</code>&rsquo;</a>

     <li><a href="#allowed-pg-brk"><span class=secno>2.4. </span>Allowed page
      breaks</a>

     <li><a href="#forced-pg-brk"><span class=secno>2.5. </span>Forced page
      breaks</a>

     <li><a href="#best-pg-brk"><span class=secno>2.6. </span>"Best" page
      breaks</a>
    </ul>

   <li><a href="#conformance"><span class=secno>3. </span>Conformance</a>
    <ul class=toc>
     <li><a href="#conventions"><span class=secno>3.1. </span>Document
      Conventions</a>

     <li><a href="#conformance-classes"><span class=secno>3.2.
      </span>Conformance Classes</a>

     <li><a href="#partial"><span class=secno>3.3. </span> Partial
      Implementations</a>

     <li><a href="#experimental"><span class=secno>3.4. </span> Experimental
      Implementations</a>

     <li><a href="#testing"><span class=secno>3.5. </span> Non-Experimental
      Implementations</a>

     <li><a href="#cr-exit-criteria"><span class=secno>3.6. </span> CR Exit
      Criteria</a>
    </ul>

   <li class=no-num><a href="#acknowledgments">Acknowledgments</a>

   <li class=no-num><a href="#references">References</a>
    <ul class=toc>
     <li class=no-num><a href="#normative-references">Normative
      references</a>

     <li class=no-num><a href="#other-references">Other references</a>
    </ul>

   <li class=no-num><a href="#index">Index</a>

   <li class=no-num><a href="#property-index">Property index</a>
  </ul>
  <!--end-toc-->

  <h2 id=intro><span class=secno>1. </span>Introduction</h2>

  <p><em>This section is not normative.</em>

  <p> Paged media (e.g., paper, transparencies, photo album pages, pages
   displayed on computer screens as printed output simulations) differ from
   <a href="/TR/CSS2/media.html#continuous-media-group"> continuous media</a>
   in that the content of the document is split into one or more discrete
   static display surfaces. To handle pages, CSS3 Paged Media describes how:

  <ul>
   <li><a href="#page-breaks">page breaks</a> are created and avoided;

   <li>the page properties such as size, orientation, margins, border, and
    padding are specified;

   <li>headers and footers are established within the page margins;

   <li>content such as page counters are placed in the headers and footers;
    and

   <li>orphans and widows can be controlled.
  </ul>

  <p> This module defines a <a href="#page-model">page model</a> that
   specifies how a document is formatted within a rectangular area, called
   the <a href="#page-box-page-rule"> page box</a>, that has finite width and
   height.

  <p> Although CSS3 does not specify how user agents transfer page boxes to
   sheets, it does include certain mechanisms for telling user agents about
   the intended page sheet <a href="#page-size">size and orientation</a>. In
   the general case, CSS3 assumes that one page box will be transferred to
   one surface of similar size.

  <p> All properties defined in this specification also accept the <a
   href="http://www.w3.org/TR/CSS21/cascade.html#value-def-inherit">
   inherit</a> keyword as their value, but for readability it has not been
   listed explicitly.

  <h3 id=placement><span class=secno>1.1. </span>Module Interactions</h3>

  <p>This module replaces and extends the pagination controls defined in <a
   href="#CSS21" rel=biblioentry>[CSS21]<!--{{CSS21}}--></a> <a
   href="http://www.w3.org/TR/CSS21/page.html#page-breaks">section 13.3</a>
   and in <a href="#CSS3PAGE"
   rel=biblioentry>[CSS3PAGE]<!--{{CSS3PAGE}}--></a>.</p>
  <!-- End section "Modules Interactions" -->

  <h3 id=values><span class=secno>1.2. </span>Values</h3>

  <p> This specification follows the <a
   href="http://www.w3.org/TR/CSS21/about.html#property-defs"> CSS property
   definition conventions</a> from <a href="#CSS21"
   rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>. Value types not defined in
   this specification are defined in CSS Level 2 Revision 1 <a href="#CSS21"
   rel=biblioentry>[CSS21]<!--{{!CSS21}}--></a>. Other CSS modules may expand
   the definitions of these value types: for example <a href="#CSS3COLOR"
   rel=biblioentry>[CSS3COLOR]<!--{{CSS3COLOR}}--></a>, when combined with
   this module, expands the definition of the &lt;color&gt; value type as
   used in this specification.

  <p> In addition to the property-specific values listed in their
   definitions, all properties defined in this specification also accept the
   <a href="http://www.w3.org/TR/CSS21/cascade.html#value-def-inherit">
   inherit</a> keyword as their property value. For readability it has not
   been repeated explicitly.

  <h2 id=page-breaks><span class=secno>2. </span>Page Breaks</h2>

  <p> The following sections explain page breaking in CSS3 paged media. Five
   properties indicate where the user agent <em class=RFC2119>MAY</em> or <em
   class=RFC2119>SHOULD</em> break pages, and on what page (left or right)
   the subsequent content <em class=RFC2119> SHOULD</em> resume. Each page
   break ends layout in the current <a href="#page-box">page box</a> and
   causes remaining pieces of the document tree to be laid out in a new page
   box.

  <p> When a page break splits a box, the box's bottom margins, borders, and
   padding have no visual effect where the split occurs; the box's background
   and left and right margins, border, and padding extend to the bottom of
   the page, through an ensuing blank page if one exists, and onto the top of
   the subsequent page.

  <h3 id=pg-br-before-after><span class=secno>2.1. </span> Break before/after
   elements: <span class=property>&lsquo;<a href="#page-break-before"><code
   class=property>page-break-before</code></a>&rsquo;</span>, <span
   class=property>&lsquo;<a href="#page-break-after"><code
   class=property>page-break-after</code></a>&rsquo;</span>, <span
   class=property>&lsquo;<a href="#page-break-inside"><code
   class=property>page-break-inside</code></a>&rsquo;</span></h3>

  <table class=propdef summary="property definition">
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=page-break-before>page-break-before</dfn>

    <tr>
     <th>Value:

     <td>auto | always | avoid | left | right

    <tr>
     <th>Initial:

     <td>auto

    <tr>
     <th>Applies to:

     <td>block-level elements

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>paged

    <tr>
     <th>Computed value:

     <td>specified value
  </table>

  <table class=propdef summary="property definition">
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=page-break-after>page-break-after</dfn>

    <tr>
     <th>Value:

     <td>auto | always | avoid | left | right

    <tr>
     <th>Initial:

     <td>auto

    <tr>
     <th>Applies to:

     <td>block-level boxes, table row groups, table rows (but see prose)

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>paged

    <tr>
     <th>Computed value:

     <td>specified value
  </table>

  <table class=propdef summary="property definition">
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=page-break-inside>page-break-inside</dfn>

    <tr>
     <th>Value:

     <td>auto | avoid

    <tr>
     <th>Initial:

     <td>auto

    <tr>
     <th>Applies to:

     <td>block-level boxes, table row groups, table rows, and table cells
      (but see prose)

    <tr>
     <th>Inherited:

     <td>no

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>paged

    <tr>
     <th>Computed value:

     <td>specified value
  </table>

  <p>Values for these properties have the following meanings:

  <dl>
   <dt>auto

   <dd>Neither force nor forbid a page break before / after / inside the
    generated box.

   <dt>always

   <dd>Always force a page break before / after the generated box.

   <dt>avoid

   <dd>Avoid a page break before / after / inside the generated box.

   <dt>left

   <dd> Force one or two page breaks before (after) the generated box so that
    the next page is formatted as a left page.

   <dt>right

   <dd> Force one or two page breaks before (after) the generated box so that
    the next page is formatted as a right page.
  </dl>

  <p> A potential page break location is typically under the influence of the
   parent element's <span class=property>&lsquo;<a
   href="#page-break-inside"><code
   class=property>page-break-inside</code></a>&rsquo;</span> property, the
   <span class=property> &lsquo;<a href="#page-break-after"><code
   class=property>page-break-after</code></a>&rsquo;</span> property of the
   preceding element, and the <span class=property> &lsquo;<a
   href="#page-break-before"><code
   class=property>page-break-before</code></a>&rsquo;</span> property of the
   following element. When these properties have values other than <span
   class=css>&lsquo;<code class=property>auto</code>&rsquo;</span>, the
   values <span class=css>&lsquo;<code
   class=property>always</code>&rsquo;</span>, <span class=css>&lsquo;<code
   class=property>left</code>&rsquo;</span>, and <span class=css>
   &lsquo;<code class=property>right</code>&rsquo;</span> take precedence
   over <span class=css>&lsquo;<code
   class=property>avoid</code>&rsquo;</span>. See the section on <a
   href="#allowed-pg-brk">allowed page breaks</a> for the exact rules on how
   these properties affect page breaks.

  <p> User Agents must apply these properties to block-level boxes and to
   table rows, table row groups, and&#8212;in the case of &lsquo;<a
   href="#page-break-inside"><code
   class=property>page-break-inside</code></a>&rsquo;&#8212;table cells of
   block-level tables in the normal flow of the root element. User agents
   should also apply these properties to floated boxes whose containing block
   is in the normal flow of the root element. User agents may also apply
   these properties to other boxes.

  <h3 id=using-named-pages><span class=secno>2.2. </span>Using named pages:
   &lsquo;<a href="#page"><code class=property>page</code></a>&rsquo;</h3>

  <table class=propdef summary="property definition">
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=page>page</dfn>

    <tr>
     <th>Value:

     <td>auto | &lt;identifier&gt;

    <tr>
     <th>Initial:

     <td>auto

    <tr>
     <th>Applies to:

     <td>block-level elements

    <tr>
     <th>Inherited:

     <td>no (but see prose)

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>paged

    <tr>
     <th>Computed value:

     <td>specified value
  </table>

  <p> The <span class=property>&lsquo;<a href="#page"><code
   class=property>page</code></a>&rsquo;</span> property is used to specify a
   particular type of page where an element <em class=RFC2119>SHOULD</em> be
   displayed.

  <div class=example>
   <p>This example will put all tables on a right-hand side landscape page
    (named "rotated"):</p>

   <pre>
@page rotated { size: landscape }
table { page: rotated; page-break-before: right }
        </pre>
  </div>

  <p> The <span class=property>&lsquo;<a href="#page"><code
   class=property>page</code></a>&rsquo;</span> property works as follows: If
   a block box with inline content has a <span class=property>&lsquo;<a
   href="#page"><code class=property>page</code></a>&rsquo;</span> property
   that is different from the preceding block box with inline content, then
   one or two page breaks are inserted between them, and the boxes after the
   break are rendered on a page box of the named type. See <a
   href="#forced-pg-brk">"Forced page breaks" below</a>.

  <p> The &lsquo;<a href="#page"><code class=property>page</code></a>&rsquo;
   property does not inherit. However, if the &lsquo;<a href="#page"><code
   class=property>page</code></a>&rsquo; value on an element is &lsquo;<code
   class=css>auto</code>&rsquo;, then it is treated as having the same name
   as its nearest ancestor with a non-auto value. When indicated on the root
   element, the effective name is the empty string.

  <p> Because a previous version of this specification indicated that the
   &lsquo;<a href="#page"><code class=property>page</code></a>&rsquo;
   property is inherited, an implementation that inherits the &lsquo;<a
   href="#page"><code class=property>page</code></a>&rsquo; property and
   treats &lsquo;<code class=css>auto</code>&rsquo; as always naming the
   empty string remains conformant to CSS3 Paged Media. Therefore authors
   should not explicitly specify the &lsquo;<code
   class=css>auto</code>&rsquo; value on a descendant of an element with a
   non-&lsquo;<code class=css>auto</code>&rsquo; &lsquo;<a href="#page"><code
   class=property>page</code></a>&rsquo; value as the resulting behavior will
   be unpredictable.

  <p> Page names are case-sensitive identifiers. However the &lsquo;<code
   class=css>auto</code>&rsquo; value, being a CSS keyword, is <a
   href="http://www.w3.org/TR/CSS21/syndata.html#characters">case-insensitive</a>.
   

  <div class=example>
   <p> In this example, the two tables are rendered on landscape pages
    (indeed, on the same page, if they fit). The page type "narrow" is used
    for the &lt;p&gt; after the second table, as the page properties for the
    table element are no longer in effect:</p>

   <pre>
@page narrow { size: 9cm 18cm }
@page rotated { size: landscape }
div { page: narrow }
table { page: rotated }
</pre>
   with this document:
   <pre>
&lt;div&gt;
&lt;table&gt;...&lt;/table&gt;
&lt;table&gt;...&lt;/table&gt;
&lt;p&gt;This text is rendered on a 'narrow' page&lt;/p&gt;
&lt;/div&gt;
</pre>
  </div>

  <h3 id=breaks-inside><span class=secno>2.3. </span>Breaks inside elements:
   &lsquo;<a href="#orphans"><code class=property>orphans</code></a>&rsquo;,
   &lsquo;<a href="#widows"><code class=property>widows</code></a>&rsquo;</h3>

  <table class=propdef summary="property definition">
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=orphans>orphans</dfn>

    <tr>
     <th>Value:

     <td>&lt;integer&gt;

    <tr>
     <th>Initial:

     <td>2

    <tr>
     <th>Applies to:

     <td>block-level elements

    <tr>
     <th>Inherited:

     <td>yes

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed value:

     <td>specified value
  </table>

  <table class=propdef summary="property definition">
   <tbody>
    <tr>
     <th>Name:

     <td><dfn id=widows>widows</dfn>

    <tr>
     <th>Value:

     <td>&lt;integer&gt;

    <tr>
     <th>Initial:

     <td>2

    <tr>
     <th>Applies to:

     <td>block-level elements

    <tr>
     <th>Inherited:

     <td>yes

    <tr>
     <th>Percentages:

     <td>N/A

    <tr>
     <th>Media:

     <td>visual

    <tr>
     <th>Computed value:

     <td>specified value
  </table>

  <p> The <span class=property>&lsquo;<a href="#orphans"><code
   class=property>orphans</code></a>&rsquo;</span> property specifies the
   minimum number of line boxes in a block element that <em
   class=RFC2119>MUST</em> be left at the bottom of a page. The <span
   class=property>&lsquo;<a href="#widows"><code
   class=property>widows</code></a>&rsquo;</span> property specifies the
   minimum number of line boxes of a block element that <em
   class=RFC2119>MUST</em> be left at the top of a page. Examples of how they
   are used to control page breaks are given below.

  <p> Only positive integers are allowed as values of &lsquo;<a
   href="#orphans"><code class=property>orphans</code></a>&rsquo; and
   &lsquo;<a href="#widows"><code class=property>widows</code></a>&rsquo;.
   Negative values and zero are invalid must cause the declaration to be <a
   href="http://www.w3.org/TR/CSS21/conform.html#ignore"> ignored</a>.

  <p> If a block contains fewer lines than the value of &lsquo;<a
   href="#widows"><code class=property>widows</code></a>&rsquo; or &lsquo;<a
   href="#orphans"><code class=property>orphans</code></a>&rsquo;, the rule
   simply becomes that all lines in the block must be kept together.

  <h3 id=allowed-pg-brk><span class=secno>2.4. </span>Allowed page breaks</h3>

  <p>In the normal flow, page breaks <em class=RFC2119>may</em> occur at the
   following places:

  <ol>
   <li id=brk-btw-blocks> In the vertical margin between sibling block boxes
    (or rows in a table). When an unforced page break occurs here, both the
    adjoining &lsquo;<code class=property>margin-top</code>&rsquo; and
    &lsquo;<code class=property>margin-bottom</code>&rsquo; are set to zero.

   <li id=brk-btw-lines>Between line boxes inside a block box.

   <li id=brk-end-block> Between the content edge of a block box and the
    outer edges of its child content (margin edges of block-level children or
    line box edges for inline-level children) <em>if</em> there is a
    (non-zero) gap between them.
  </ol>

  <p>These breaks are subject to the following rules:

  <ul>
   <li> <strong>Rule A:</strong> Breaking at <a
    href="#brk-btw-blocks">(1)</a> is allowed only if the &lsquo;<a
    href="#page-break-after"><code
    class=property>page-break-after</code></a>&rsquo; and &lsquo;<a
    href="#page-break-before"><code
    class=property>page-break-before</code></a>&rsquo; properties of all the
    elements generating boxes that meet at this margin allow it, which is
    when at least one of them has the value <span class=css>&lsquo;<code
    class=property>always</code>&rsquo;</span>, <span class=css>&lsquo;<code
    class=property>left</code>&rsquo;</span>, or <span class=css>&lsquo;<code
    class=property>right</code>&rsquo;</span>, or when all of them are <span
    class=css>&lsquo;<code class=property>auto</code>&rsquo;</span>.

   <li> <strong>Rule B:</strong> However, if all of them are <span
    class=css>&lsquo;<code class=property>auto</code>&rsquo;</span> and a
    common ancestor of all the elements has a <span class=property>&lsquo;<a
    href="#page-break-inside"><code
    class=property>page-break-inside</code></a>&rsquo;</span> value of <span
    class=css>&lsquo;<code class=property>avoid</code>&rsquo;</span>, then
    breaking here is not allowed.

   <li> <strong>Rule C:</strong> Breaking at <a href="#brk-btw-lines">(2)</a>
    is allowed only if the number of line boxes between the break and the
    start of the enclosing block box is the value of &lsquo;<a
    href="#orphans"><code class=property>orphans</code></a>&rsquo; or more,
    and the number of line boxes between the break and the end of the box is
    the value of &lsquo;<a href="#widows"><code
    class=property>widows</code></a>&rsquo; or more.

   <li> <strong>Rule D:</strong> In addition, breaking at <a
    href="#brk-btw-blocks">(2)</a> or <a href="#brk-end-block">(3)</a> is
    allowed only if the &lsquo;<a href="#page-break-inside"><code
    class=property>page-break-inside</code></a>&rsquo; property of all
    ancestors is &lsquo;<code class=css>auto</code>&rsquo;.
  </ul>

  <p> If the above doesn't provide enough break points to keep content from
   overflowing the page boxes, then rules A, B and D are dropped in order to
   find additional breakpoints. In this case the UA may use the &lsquo;<code
   class=property>avoid</code>&rsquo;s that are in effect at those points to
   weigh the appropriateness of the new breakpoints; however, this
   specification does not suggest a precise algorithm.

  <p> If that still does not lead to sufficient break points, rule C is
   dropped as well, to find still more break points.

  <h3 id=forced-pg-brk><span class=secno>2.5. </span>Forced page breaks</h3>

  <p> A page break <em class=RFC2119>MUST</em> occur at <a
   href="#brk-btw-blocks">(1)</a> if, among the'page-break-after' and
   &lsquo;<a href="#page-break-before"><code
   class=property>page-break-before</code></a>&rsquo; properties of all the
   elements generating boxes that meet at this margin, there is at least one
   with the value <span class=css>&lsquo;<code
   class=property>always</code>&rsquo;</span>, <span class=css>&lsquo;<code
   class=property>left</code>&rsquo;</span>, or <span class=css> &lsquo;<code
   class=property>right</code>&rsquo;</span>.

  <p> When multiple &lsquo;<a href="#page-break-before"><code
   class=property>page-break-before</code></a>&rsquo; and/or &lsquo;<a
   href="#page-break-after"><code
   class=property>page-break-after</code></a>&rsquo; properties with values
   of "always", "left" or "right" apply at a margin, only one of them should
   generate page breaks. That is, no content-empty pages are generated by
   page-break properties, except for at most one content-empty page as may be
   required by &lsquo;<code class=property>right</code>&rsquo; and
   &lsquo;<code class=property>left</code>&rsquo; values to position ensuing
   content on a right- or left-facing page.

  <p> A page break <em class=RFC2119>MUST</em> also occur at <a
   href="#brk-btw-blocks">(1)</a> if the last line box above this margin and
   the first one below it do not have the same value for &lsquo;<a
   href="#page"><code class=property>page</code></a>&rsquo;.

  <p> When a forced page break occurs at <a href="#brk-btw-blocks">(1)</a>,
   the used values of any adjoining &lsquo;<code
   class=property>margin-bottom</code>&rsquo; are set to zero.

  <h3 id=best-pg-brk><span class=secno>2.6. </span>"Best" page breaks</h3>

  <p> CSS3 does <em>not</em> define which of a set of allowed page breaks <em
   class=RFC2119> MUST</em> be used; except as defined earlier in the
   section, CSS3 does not forbid a user agent to break at every possible
   break point, or to not break at all. But CSS3 does recommend that user
   agents observe the following guidelines (while recognizing that they are
   sometimes contradictory):

  <ul>
   <li>Break as few times as possible.

   <li>Make all pages that don't end with a forced break appear to have about
    the same height.

   <li>Avoid breaking inside a replaced element.
  </ul>

  <div class=example>
   <p> Suppose, for example, that the style sheet contains <span
    class=css>&lsquo;<code class=css>orphans : 4</code>&rsquo;</span>, <span
    class=css>&lsquo;<code class=css>widows : 2</code>&rsquo;</span>, and
    there are 20 lines (line boxes) available at the bottom of the current
    page, and the next block in normal flow is considered for placement:</p>

   <ul>
    <li> If the block contains 20 line boxes or fewer, it <em
     class=RFC2119>SHOULD</em> be placed on the current page.

    <li> If the block contains 21 or 22 line boxes, the second part of the
     paragraph <em class=RFC2119>MUST</em> not violate the <span
     class=property>&lsquo;<a href="#widows"><code
     class=property>widows</code></a>&rsquo;</span> constraint, and so the
     second part <em class=RFC2119>MUST</em> contain at least two line boxes;
     likewise the first part <em class=RFC2119>MUST</em> contain at least
     four line boxes.

    <li> If the block contains 23 line boxes or more, the first part <em
     class=RFC2119> SHOULD</em> contain 20 lines and the second part the
     remaining lines. (But if any part of the block is placed on the current
     page, that part <em class=RFC2119>MUST</em> contain at least four line
     boxes and the second part at least two line boxes.)
   </ul>

   <p> Now suppose that <span class=property>&lsquo;<a href="#orphans"><code
    class=property>orphans</code></a>&rsquo;</span> is <span
    class=css>&lsquo;<code class=css>10</code>&rsquo;</span>, <span
    class=property>&lsquo;<a href="#widows"><code
    class=property>widows</code></a>&rsquo;</span> is <span
    class=css>&lsquo;<code class=css>20</code>&rsquo;</span>, and there are 8
    lines available at the bottom of the current page:</p>

   <ul>
    <li> If the block contains 8 lines or fewer, it <em
     class=RFC2119>SHOULD</em> be placed on the current page.

    <li> If the block contains 9 lines or more, it <em class=RFC2119>MAY
     NOT</em> be split (that would violate the orphan constraint), so it <em
     class=RFC2119>MUST</em> move as a block to the next page.
   </ul>
  </div>
  <!-- End section "Page Breaks" -->

  <h2 id=conformance><span class=secno>3. </span>Conformance</h2>

  <h3 id=conventions><span class=secno>3.1. </span>Document Conventions</h3>

  <p> Conformance requirements are expressed with a combination of
   descriptive assertions and RFC 2119 terminology. The key words “MUST”,
   “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”,
   “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and
   “OPTIONAL” in the normative parts of this document are to be
   interpreted as described in RFC 2119. However, for readability, these
   words do not appear in all uppercase letters in this specification.

  <p> All of the text of this specification is normative except sections
   explicitly marked as non-normative, examples, and notes. <a
   href="#RFC2119" rel=biblioentry>[RFC2119]<!--{{!RFC2119}}--></a>

  <p> Examples in this specification are introduced with the words “for
   example” or are set apart from the normative text with
   <code>class="example"</code>, like this:

  <div class=example>
   <p>This is an example of an informative example.</p>
  </div>

  <p> Informative notes begin with the word “Note” and are set apart from
   the normative text with <code>class="note"</code>, like this:

  <p class=note>Note, this is an informative note.

  <h3 id=conformance-classes><span class=secno>3.2. </span>Conformance
   Classes</h3>

  <p>Conformance to CSS Fragmentation is defined for three conformance
   classes:

  <dl>
   <dt><dfn id=style-sheet title="style sheet!!as conformance class">style
    sheet</dfn>

   <dd> A <a href="http://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
    style sheet</a>.

   <dt><dfn id=renderer>renderer</dfn>

   <dd> A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
    that interprets the semantics of a style sheet and renders documents that
    use them.

   <dt><dfn id=authoring-tool>authoring tool</dfn>

   <dd> A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a>
    that writes a style sheet.
  </dl>

  <p> A style sheet is conformant to CSS Fragmentation if all of its
   declarations that use properties defined in this module have values that
   are valid according to the generic CSS grammar and the individual grammars
   of each property as given in this module.

  <p> A renderer is conformant to CSS Fragmentation if, in addition to
   interpreting the style sheet as defined by the appropriate specifications,
   it supports all the features defined by CSS Fragmentation by parsing them
   correctly and rendering the document accordingly. However, the inability
   of a UA to correctly render a document due to limitations of the device
   does not make the UA non-conformant. (For example, a UA is not required to
   render color on a monochrome monitor.)

  <p> An authoring tool is conformant to CSS Fragmentation if it writes style
   sheets that are syntactically correct according to the generic CSS grammar
   and the individual grammars of each feature in this module, and meet all
   other conformance requirements of style sheets as described in this
   module.

  <h3 id=partial><span class=secno>3.3. </span> Partial Implementations</h3>

  <p> So that authors can exploit the forward-compatible parsing rules to
   assign fallback values, CSS renderers <strong>must</strong> treat as
   invalid (and <a href="http://www.w3.org/TR/CSS21/conform.html#ignore">
   ignore as appropriate</a>) any at-rules, properties, property values,
   keywords, and other syntactic constructs for which they have no usable
   level of support. In particular, user agents <strong>must not</strong>
   selectively ignore unsupported component values and honor supported values
   in a single multi-value property declaration: if any value is considered
   invalid (as unsupported values must be), CSS requires that the entire
   declaration be ignored.

  <h3 id=experimental><span class=secno>3.4. </span> Experimental
   Implementations</h3>

  <p> To avoid clashes with future CSS features, the CSS2.1 specification
   reserves a <a
   href="http://www.w3.org/TR/CSS21/syndata.html#vendor-keywords">prefixed
   syntax</a> for proprietary and experimental extensions to CSS.

  <p> Prior to a specification reaching the Candidate Recommendation stage in
   the W3C process, all implementations of a CSS feature are considered
   experimental. The CSS Working Group recommends that implementations use a
   vendor-prefixed syntax for such features, including those in W3C Working
   Drafts. This avoids incompatibilities with future changes in the draft.

  <h3 id=testing><span class=secno>3.5. </span> Non-Experimental
   Implementations</h3>

  <p> Once a specification reaches the Candidate Recommendation stage,
   non-experimental implementations are possible, and implementors should
   release an unprefixed implementation of any CR-level feature they can
   demonstrate to be correctly implemented according to spec.

  <p> To establish and maintain the interoperability of CSS across
   implementations, the CSS Working Group requests that non-experimental CSS
   renderers submit an implementation report (and, if necessary, the
   testcases used for that implementation report) to the W3C before releasing
   an unprefixed implementation of any CSS features. Testcases submitted to
   W3C are subject to review and correction by the CSS Working Group.

  <p> Further information on submitting testcases and implementation reports
   can be found from on the CSS Working Group's website at <a
   href="http://www.w3.org/Style/CSS/Test/">
   http://www.w3.org/Style/CSS/Test/</a>. Questions should be directed to the
   <a href="http://lists.w3.org/Archives/Public/public-css-testsuite">
   public-css-testsuite@w3.org</a> mailing list.

  <h3 id=cr-exit-criteria><span class=secno>3.6. </span> CR Exit Criteria</h3>

  <p> For this specification to be advanced to Proposed Recommendation, there
   must be at least two independent, interoperable implementations of each
   feature. Each feature may be implemented by a different set of products,
   there is no requirement that all features be implemented by a single
   product. For the purposes of this criterion, we define the following
   terms:

  <dl>
   <dt>independent

   <dd> each implementation must be developed by a different party and cannot
    share, reuse, or derive from code used by another qualifying
    implementation. Sections of code that have no bearing on the
    implementation of this specification are exempt from this requirement.

   <dt>interoperable

   <dd> passing the respective test case(s) in the official CSS test suite,
    or, if the implementation is not a Web browser, an equivalent test. Every
    relevant test in the test suite should have an equivalent test created if
    such a user agent (UA) is to be used to claim interoperability. In
    addition if such a UA is to be used to claim interoperability, then there
    must one or more additional UAs which can also pass those equivalent
    tests in the same way for the purpose of interoperability. The equivalent
    tests must be made publicly available for the purposes of peer review.

   <dt>implementation

   <dd> a user agent which:
    <ol class=inline>
     <li>implements the specification.

     <li>is available to the general public. The implementation may be a
      shipping product or other publicly available version (i.e., beta
      version, preview release, or “nightly build”). Non-shipping product
      releases must have implemented the feature(s) for a period of at least
      one month in order to demonstrate stability.

     <li>is not experimental (i.e., a version specifically designed to pass
      the test suite and is not intended for normal usage going forward).
    </ol>
  </dl>

  <p> The specification will remain Candidate Recommendation for at least six
   months.

  <h2 class=no-num id=acknowledgments>Acknowledgments</h2>

  <p> The editors would like to extend special thanks to Michael Day, and the
   former <a href="#CSS3PAGE"
   rel=biblioentry>[CSS3PAGE]<!--{{CSS3PAGE}}--></a> editors Jim Bigelow
   (HP), Melinda Grant (HP), Håkon Wium Lie (Opera), and Jacob Refstrup (HP)
   for their contributions to this specification.

  <h2 class=no-num id=references>References</h2>

  <h3 class=no-num id=normative-references>Normative references</h3>
  <!--begin-normative-->
  <!-- Sorted by label -->

  <dl class=bibliography>
   <dt style="display: none"><!-- keeps the doc valid if the DL is empty -->
    <!---->

   <dt id=CSS21>[CSS21]

   <dd>Bert Bos; et al. <a
    href="http://www.w3.org/TR/2011/REC-CSS2-20110607/"><cite>Cascading Style
    Sheets Level 2 Revision 1 (CSS&#160;2.1) Specification.</cite></a> 7 June
    2011. W3C Recommendation. URL: <a
    href="http://www.w3.org/TR/2011/REC-CSS2-20110607/">http://www.w3.org/TR/2011/REC-CSS2-20110607/</a>
    </dd>
   <!---->

   <dt id=RFC2119>[RFC2119]

   <dd>S. Bradner. <a href="http://www.ietf.org/rfc/rfc2119.txt"><cite>Key
    words for use in RFCs to Indicate Requirement Levels.</cite></a> Internet
    RFC 2119. URL: <a
    href="http://www.ietf.org/rfc/rfc2119.txt">http://www.ietf.org/rfc/rfc2119.txt</a>
    </dd>
   <!---->
  </dl>
  <!--end-normative-->

  <h3 class=no-num id=other-references>Other references</h3>
  <!--begin-informative-->
  <!-- Sorted by label -->

  <dl class=bibliography>
   <dt style="display: none"><!-- keeps the doc valid if the DL is empty -->
    <!---->

   <dt id=CSS3COLOR>[CSS3COLOR]

   <dd>Tantek &#199;elik; Chris Lilley; L. David Baron. <a
    href="http://www.w3.org/TR/2011/REC-css3-color-20110607/"><cite>CSS Color
    Module Level 3.</cite></a> 7 June 2011. W3C Recommendation. URL: <a
    href="http://www.w3.org/TR/2011/REC-css3-color-20110607/">http://www.w3.org/TR/2011/REC-css3-color-20110607/</a>
    </dd>
   <!---->

   <dt id=CSS3PAGE>[CSS3PAGE]

   <dd>H&#229;kon Wium Lie; Melinda Grant. <a
    href="http://www.w3.org/TR/2006/WD-css3-page-20061010"><cite>CSS3 Module:
    Paged Media.</cite></a> 10 October 2006. W3C Working Draft. (Work in
    progress.) URL: <a
    href="http://www.w3.org/TR/2006/WD-css3-page-20061010">http://www.w3.org/TR/2006/WD-css3-page-20061010</a>
    </dd>
   <!---->
  </dl>
  <!--end-informative-->

  <h2 class=no-num id=index>Index</h2>
  <!--begin-index-->

  <ul class=indexlist>
   <li>authoring tool, <a href="#authoring-tool"
    title="authoring tool"><strong>3.2.</strong></a>

   <li>orphans, <a href="#orphans" title=orphans><strong>2.3.</strong></a>

   <li>page, <a href="#page" title=page><strong>2.2.</strong></a>

   <li>page-break-after, <a href="#page-break-after"
    title=page-break-after><strong>2.1.</strong></a>

   <li>page-break-before, <a href="#page-break-before"
    title=page-break-before><strong>2.1.</strong></a>

   <li>page-break-inside, <a href="#page-break-inside"
    title=page-break-inside><strong>2.1.</strong></a>

   <li>renderer, <a href="#renderer" title=renderer><strong>3.2.</strong></a>
    

   <li>style sheet
    <ul>
     <li>as conformance class, <a href="#style-sheet"
      title="style sheet, as conformance class"><strong>3.2.</strong></a>
    </ul>

   <li>widows, <a href="#widows" title=widows><strong>2.3.</strong></a>
  </ul>
  <!--end-index-->

  <h2 class=no-num id=property-index>Property index</h2>
  <!--begin-properties-->

  <table class=proptable>
   <thead>
    <tr>
     <th>Property

     <th>Values

     <th>Initial

     <th>Applies&nbsp;to

     <th>Inh.

     <th>Percentages

     <th>Media

   <tbody>
    <tr>
     <th><a class=property href="#orphans">orphans</a>

     <td>&lt;integer&gt;

     <td>2

     <td>block-level elements

     <td>yes

     <td>N/A

     <td>visual

    <tr>
     <th><a class=property href="#page">page</a>

     <td>auto | &lt;identifier&gt;

     <td>auto

     <td>block-level elements

     <td>no (but see prose)

     <td>N/A

     <td>paged

    <tr>
     <th><a class=property href="#page-break-after">page-break-after</a>

     <td>auto | always | avoid | left | right

     <td>auto

     <td>block-level boxes, table row groups, table rows (but see prose)

     <td>no

     <td>N/A

     <td>paged

    <tr>
     <th><a class=property href="#page-break-before">page-break-before</a>

     <td>auto | always | avoid | left | right

     <td>auto

     <td>block-level elements

     <td>no

     <td>N/A

     <td>paged

    <tr>
     <th><a class=property href="#page-break-inside">page-break-inside</a>

     <td>auto | avoid

     <td>auto

     <td>block-level boxes, table row groups, table rows, and table cells
      (but see prose)

     <td>no

     <td>N/A

     <td>paged

    <tr>
     <th><a class=property href="#widows">widows</a>

     <td>&lt;integer&gt;

     <td>2

     <td>block-level elements

     <td>yes

     <td>N/A

     <td>visual
  </table>
  <!--end-properties-->
</html>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-declaration:"~/SGML/HTML4.decl"
sgml-default-doctype-name:"html"
sgml-minimize-attributes:t
sgml-nofill-elements:("pre" "style" "br")
sgml-live-element-indicator:t
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:t
sgml-general-insert-case:lower
sgml-always-quote-attributes:t
sgml-indent-step:nil
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
